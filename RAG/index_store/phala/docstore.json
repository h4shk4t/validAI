{"docstore/data": {"c9984c89-30d1-4089-9c5d-fe758fc9cdad": {"__data__": {"id_": "c9984c89-30d1-4089-9c5d-fe758fc9cdad", "embedding": null, "metadata": {"file_path": "phala-docs_dist/trusted-execution-environments-tee-and-compute-verifiability.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "c8ef2a01-36a7-4468-9b6f-e24d744bc58b", "node_type": "4", "metadata": {}, "hash": "7eefac65ca76fea21236a0d7bc124db69846317b4e2ca4b96dede8ce69817307", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "dbe61b05-b284-42e3-96cf-d98a7e02e457", "node_type": "1", "metadata": {}, "hash": "444c8bf827862d41c9910aaff7cb3b745b63e92c41c8a535e238f61fa68e79b8", "class_name": "RelatedNodeInfo"}}, "text": "# Trusted Execution Environments (TEE) and Compute Verifiability\n\n<figure><img src=\"../../.gitbook/assets/TEE-Compute-Verifiability.png\" alt=\"\"><figcaption></figcaption></figure>\n\nUntil now, the Phala network has more than 30K TEE devices registered and running, becoming the biggest TEE network in Web3.\n\nA TEE is a secure area within the main processor of a device. It ensures external processes or computations, even those with higher privileges, cannot access or alter the data inside it. This isolative feature directly wheels in a trust-minimized environment, heightening the protection against potential security threats.\n\n<figure><img src=\"../../.gitbook/assets/TEE.png\" alt=\"\"><figcaption></figcaption></figure>\n\nThe unassailable security of TEEs is not just limited to protecting critical data. They also authenticate and verify the data computations that take place within them. This feature illuminates the foreground of TEEs in multi-proof systems, addressing the challenge of computing verifiability.\n\nPhala currently only supports Intel SGX (Software Guard Extension) as the TEE hardware, and will support Intel TDX and NVIDIA GPU TEE soon. Check [here](https://sgx101.gitbook.io/sgx101/sgx-bootstrap/overview) for more info about SGX.\n\n## How are TEE Devices Being Verified?\n\nVerification is the cornerstone of guaranteeing TEE's trust-minimized environment. Verifying a TEE device (in Phala's context, Intel SGX device), generally refers to verifying the hardware information of the device, which includes checking if the CPU is genuine hardware manufactured by vendors such as Intel, the cert-chain is valid and provided by the manufacture that can be trusted. Verification of the TEE device before running any program in it (Enclave) is necessary because it can provide security guarantees from a hardware perspective that the program is running the actual copy of the code that the user expects through [**Remote Attestation**](https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation#remote-attestation-primitives).\n\nCurrently, Phala enforces the verification on the Phala blockchain when the TEE device (the worker) is going to register.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2161, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "dbe61b05-b284-42e3-96cf-d98a7e02e457": {"__data__": {"id_": "dbe61b05-b284-42e3-96cf-d98a7e02e457", "embedding": null, "metadata": {"file_path": "phala-docs_dist/trusted-execution-environments-tee-and-compute-verifiability.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "c8ef2a01-36a7-4468-9b6f-e24d744bc58b", "node_type": "4", "metadata": {}, "hash": "7eefac65ca76fea21236a0d7bc124db69846317b4e2ca4b96dede8ce69817307", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c9984c89-30d1-4089-9c5d-fe758fc9cdad", "node_type": "1", "metadata": {}, "hash": "d72ba3dc161bfe368681f92c9d363157eed575b245512cbee2f5e926d2e76a47", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "7339c7e4-1602-4931-b622-4c9be7f5f183", "node_type": "1", "metadata": {}, "hash": "ffeb7587ff4fbb02a69d0b8d9d6f1b46694c5d8b155cc31c7df2a99dc34eb9b1", "class_name": "RelatedNodeInfo"}}, "text": "Recently we have been searching the Zero Knowledge-based TEE device verification, which aims to leverage the ZK technique to verify TEE devices off-chain in a trustless manner.\n\n1. **Verified on Phala Blockchain**: Employing Phala Blockchain positions an extra layer of transparency and trust in the verification process. The verification process's details are recorded on the blockchain, allowing users to transparently view and verify the operations. Check the code [here](https://github.com/Phala-Network/phala-blockchain/tree/master/crates/sgx-attestation) if you wanna explore more.\n2.  **Verified on Ethereum with a ZK DCAP Verifier**: Verification of TEEs on Ethereum directly is expensive in gas cost, but we can only verify the ZKP on-chain of a DCAP verifier, where we move the heavy computation to off-chain. Check the PoC code [here](https://github.com/tolak/zk-dcap-verifier) to see how we verify DCAP based on RiscZero zkVM with a local prover.\\\n\n\n    <figure><img src=\"../../.gitbook/assets/TEE-ZKProver.png\" alt=\"\"><figcaption></figcaption></figure>\n\n## How to Generate TEE-Proof for Programs\n\nUnlike generating ZKP (Zero Knowledge Proof), which needs to have a specific circuit for the proven program, TEE-proof generation is cheaper in the cost of computation. When thinking about the TEE-proof generation, we need to get out of that Zero-Knowledge mindset for a moment. Here are two considerations when proving the program execution result is trust in TEE:\n\n1.  If the execution environment is trust\n\n    As we mentioned earlier, every TEE device was verified when registered on the Phala blockchain. A bunch of items will be checked, and finally, we will evaluate a confidential level according to the check. See [here](https://docs.phala.network/compute-providers/basic-info/confidence-level-and-sgx-function) for more information.\n2.  If the key used to sign the proof is secure\n\n    Since we already guarantee the execution environment is trusted, the data signed by the key derived in the environment should be trusted too.", "mimetype": "text/plain", "start_char_idx": 2162, "end_char_idx": 4209, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7339c7e4-1602-4931-b622-4c9be7f5f183": {"__data__": {"id_": "7339c7e4-1602-4931-b622-4c9be7f5f183", "embedding": null, "metadata": {"file_path": "phala-docs_dist/trusted-execution-environments-tee-and-compute-verifiability.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "c8ef2a01-36a7-4468-9b6f-e24d744bc58b", "node_type": "4", "metadata": {}, "hash": "7eefac65ca76fea21236a0d7bc124db69846317b4e2ca4b96dede8ce69817307", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "dbe61b05-b284-42e3-96cf-d98a7e02e457", "node_type": "1", "metadata": {}, "hash": "444c8bf827862d41c9910aaff7cb3b745b63e92c41c8a535e238f61fa68e79b8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "420796bb-f1b6-4d26-a42a-d06ac6cfd7bf", "node_type": "1", "metadata": {}, "hash": "b6b46bbf6da46014cdde0d173021161d1878a2e72907376770efe10a87162754", "class_name": "RelatedNodeInfo"}}, "text": "By introducing [Key Hierarchy](https://docs.phala.network/developers/advanced-topics/blockchain-infrastructure/secret-key-hierarchy#key-hierarchy-management) and [Key Rotation](https://github.com/Phala-Network/phala-blockchain/pull/810) mechanisms, the safety of the key is guaranteed in both cryptographic and economic ways. Check this [article](https://medium.com/phala-network/technical-analysis-of-why-phala-will-not-be-affected-by-the-intel-sgx-chip-vulnerabilities-e045b0189dc2) for the analysis of Phala security design.\n\nWith the above two premises, the TEE-proof generation is pretty simple. Every multi-proof program running on the system will have a dedicated app key which is derived from WASM Virtual Machine - SideVM, the SideVM is running inside TEE. Every user can deploy a Javascript Engine for themselves, the key will be injected when developer upload their Javascript code to the JS engine where developer can use this key to sign transaction in their Javascript code. To generate the TEE-proof, the program needs to use this key to sign the output of the execution result of their business logic. For example, if you are going to verify the TEE proof on Ethereum, you can sign the result with the ECDSA signature scheme. See **How to Build with Multi-Proof** section for how to generate TEE-proof with JS SDK.\n\n## Comparison: TEE Compute Verification vs. ZK Compute Verification\n\nWhile TEE-Proofs and ZK-Proofs share the same goal of ensuring computational integrity and verifiability, they differ in their construction and operation:\n\n1. **Computation Cost**: The computation cost for generating a TEE-Proof is significantly lower than for a ZK-Proof. While a ZK-Proof requires intricate cryptographic operations and a relatively large amount of computational resources, a TEE-Proof is generated as a result of computation inside a TEE. This makes the TEE-Proof computation incredibly efficient, providing an edge, especially for systems dealing with more extensive calculations.\n2. **Proof Size and On-Chain Verification Cost**: ZK-Proofs, architected based on elliptic curve cryptography, the proof sizes differ from different proof systems, some of them are extremely expensive.", "mimetype": "text/plain", "start_char_idx": 4210, "end_char_idx": 6413, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "420796bb-f1b6-4d26-a42a-d06ac6cfd7bf": {"__data__": {"id_": "420796bb-f1b6-4d26-a42a-d06ac6cfd7bf", "embedding": null, "metadata": {"file_path": "phala-docs_dist/trusted-execution-environments-tee-and-compute-verifiability.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "c8ef2a01-36a7-4468-9b6f-e24d744bc58b", "node_type": "4", "metadata": {}, "hash": "7eefac65ca76fea21236a0d7bc124db69846317b4e2ca4b96dede8ce69817307", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "7339c7e4-1602-4931-b622-4c9be7f5f183", "node_type": "1", "metadata": {}, "hash": "ffeb7587ff4fbb02a69d0b8d9d6f1b46694c5d8b155cc31c7df2a99dc34eb9b1", "class_name": "RelatedNodeInfo"}}, "text": "While TEE-Proofs are more cost-efficient to compute, they come with const proof sizes, e.g. the length of the signature, meaning they occupy small space and cost less to verify on-chain.\n3. **Security, Liveness, and Complexity**: Both TEE-Proofs and ZK-Proofs ensure robust security. However, ZK-Proofs, based on cryptographic hardness assumptions, offer mathematically guaranteed security but are complex to create and verify. TEE-Proofs, on the other hand, are simpler to produce and validate but trust in the TEE hardware and the integrity of the software it runs to provide the desired security level. Phala network adds an extra economic security guarantee on top of the default TEE security infrastructure, making the whole system more robust.\n\n## What's Next?\n\nNow you already have a fundamental understanding of the underlying techniques of TEE, if you are a developer, please follow the next section to see how you can develop multi-proof with our JS SDK.", "mimetype": "text/plain", "start_char_idx": 6414, "end_char_idx": 7378, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "bac1b89c-b880-4cec-911a-015366f29681": {"__data__": {"id_": "bac1b89c-b880-4cec-911a-015366f29681", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-a-local-testnet-with-docker.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8414b16a-51cf-4de3-9122-b3477e611f51", "node_type": "4", "metadata": {}, "hash": "64e39105b79e02eb86b8e1e85a77a06e39707cc9832c0dbde18075e0e23c7110", "class_name": "RelatedNodeInfo"}}, "text": "# Run a Local Testnet With Docker\n\nRun a local testnet with [`docker` support](https://docs.docker.com/desktop/). All you need to do to get a local testnet started is run:\n\n{% hint style=\"danger\" %}\nRunning the local testnet may return an error if port **`8000`** is already in use.\n{% endhint %}\n\n```shell\nnpm run dev\n```\n\n**Make a Request to Your Local Build**\n\n```shell\n# GET request\ncurl http://127.0.0.1:8000/local\n# GET request with URL queries\ncurl http://127.0.0.1:8000/local?query1=one&query2=two\n# POST request\ncurl http://127.0.0.1:8000/local -X POST -H 'content-type: application/json' -d '{\"foo\": \"bar\"}'\n```\n\n**Add Secrets to Your Local Build**\n\n```shell\ncurl http://127.0.0.1:8000/vaults -H 'Content-Type: application/json' -d '{\"cid\": \"local\", \"data\": {\"secretKey\":\"secretValue\"}}'\n```\n\n**Check The Logs of Your Local Build**\n\n```shell\ncurl 'http://127.0.0.1:8000/logs/all/local'\n```", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 899, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b0036f4b-a010-449c-9f2e-eb1095fe5554": {"__data__": {"id_": "b0036f4b-a010-449c-9f2e-eb1095fe5554", "embedding": null, "metadata": {"file_path": "phala-docs_dist/asset-integration-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb", "node_type": "4", "metadata": {}, "hash": "22f144233eccd631e93d21571be42ccf2c8d8a1c9c53f8db00e6ef70ffbc111d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "93b8fffa-5eb2-4fda-bd33-b3452a6cc9d7", "node_type": "1", "metadata": {}, "hash": "a1d84c991f3660d10de7e2e7d0167cb0fc39618f9e1283714bdc292ad9a4d158", "class_name": "RelatedNodeInfo"}}, "text": "# Asset Integration Guide\n\n## Why Integrating SubBridge <a href=\"#why-integrating-subbridge\" id=\"why-integrating-subbridge\"></a>\n\nA TL;DR answer is that: SubBridge greatly reduces the efforts to transfer your assets to/from multiple blockchains.\n\nGenerally speaking, it takes two steps to bridge your asset to another chain:\n\n1. To find an asset _route_ to your target chain so you can transfer your token there, which may be consisted of one bridge or multiple bridges;\n2. To ensure that your token can be recognized and handled in the target chain, this usually involves ad-hoc negotiation and program development;\n\nAnd SubBridge can simplify both steps for you:\n\n1. Instead of connecting your chain to others one-by-one, by integrating SubBridge you will be able to get the routes to any other chains that have already supported SubBridge (for now, this includes Polkadot parachains, Ethereum and Moonriver EVM);\n2. SubBridge provides a unified interface (based on Polkadot XCM protocol) to abstract your asset and the corresponding asset-handling example, also our technical team is glad to provide support during your integration.\n\n### Overview <a href=\"#overview\" id=\"overview\"></a>\n\nSubBridge supports both parachain assets and EVM assets, making it possible to transfer them between parachains and EVM chains. All supported assets are whitelisted, which means it would be failed if you transfer assets through SubBridge without registration. Refer to Supported Assets to check the asset list we have integrated.\n\n* A parachain asset means the asset is reserved on a parachain. For example, GLMR is reserved on Moonbeam.\n* An EVM asset means the asset is reserved on an EVM chain, in general, it\u2019s an ERC-20 smart contract deployed on EVM. **Note we currently only support assets deployed on Ethereum and Moonriver EVM.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1826, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "93b8fffa-5eb2-4fda-bd33-b3452a6cc9d7": {"__data__": {"id_": "93b8fffa-5eb2-4fda-bd33-b3452a6cc9d7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/asset-integration-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb", "node_type": "4", "metadata": {}, "hash": "22f144233eccd631e93d21571be42ccf2c8d8a1c9c53f8db00e6ef70ffbc111d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b0036f4b-a010-449c-9f2e-eb1095fe5554", "node_type": "1", "metadata": {}, "hash": "b4700414df53f64f17c12b8d3de0cdc388089dd20abed75b33523efc9ee9f0be", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "0f2621ae-c17e-4e77-b36e-fc37748b665d", "node_type": "1", "metadata": {}, "hash": "d661db953773b449f226c6eb4be79de3822b1a0a70ad3d0eab6eff63d43b0e7c", "class_name": "RelatedNodeInfo"}}, "text": "**\n\nYou need to do the following steps to finish integration with SubBridge:\n\n* Open an issue on [subbridge-integration](https://github.com/Phala-Network/subbridge-integration) repo to provide asset registry information;\n* Test registration locally or on Rococo;\n* Register assets on Khala Network;\n* \\[Optional] Integrate SubBridge into your app;\n\n## Provide Asset Registry Information <a href=\"#provide-asset-registry-information\" id=\"provide-asset-registry-information\"></a>\n\nIf you are interested in integrating your asset into SubBridge, please go to [integration repo](https://github.com/Phala-Network/subbridge-integration) to open an issue with the template below:\n\n```\n### Who we are\n\n*** Brief introduction of your project and team ***\n\n### Asset registry information\n\n- name\n- symbol\n- decimals\n- location (represented as a MultiLocation in XCM)\n- contract address(EVM assets only)\n- is mintable (EVM assets only)\n```\n\n* `location` must be a [MultiLocation](https://polkadot.network/blog/xcm-the-cross-consensus-message-format/). For example, the location of `KAR` is `MultiLocation::new(1, X2(Parachain(2000), General(0x0080)))`. If your asset is an EVM asset, the `location` should be `MultiLocation::new(1, X3(Parachain(2004), GeneralIndex(chain_id), GeneralKey(erc20_address)))`. `chain_id` should match the chain your asset deployed on. So far chain id of Ethereum is `0`, and chain id of Moonriver EVM is `2`.\n* `is mintable` represents whether your ERC20 smart contract support `mint` and `burn`, if set as true, your users will need to give the mint authority to our contract when the first time they use SubBridge. Check [**Assets Registration**](technical-details.md#asset-registration) find more details about what we have done on registration.\n\nAfter the issue is opened, feel free to notify the team on our [Discord channel](https://discord.gg/phala-network) if we haven\u2019t replied immediately. Now you are ready to work with the team to finish the integration stuff when we approve the request on the issue.", "mimetype": "text/plain", "start_char_idx": 1826, "end_char_idx": 3857, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0f2621ae-c17e-4e77-b36e-fc37748b665d": {"__data__": {"id_": "0f2621ae-c17e-4e77-b36e-fc37748b665d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/asset-integration-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb", "node_type": "4", "metadata": {}, "hash": "22f144233eccd631e93d21571be42ccf2c8d8a1c9c53f8db00e6ef70ffbc111d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "93b8fffa-5eb2-4fda-bd33-b3452a6cc9d7", "node_type": "1", "metadata": {}, "hash": "a1d84c991f3660d10de7e2e7d0167cb0fc39618f9e1283714bdc292ad9a4d158", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "0dca9f70-6754-4422-88e7-53515f8f90ad", "node_type": "1", "metadata": {}, "hash": "8990ac24d5dfe96f8399dcb34a0d63a422f323ab405a34d69c7f37f4e7e82b89", "class_name": "RelatedNodeInfo"}}, "text": "## Test Registration <a href=\"#test-registration\" id=\"test-registration\"></a>\n\nBefore onboarding your asset to the Khala network, we must make sure everything works properly on the [Rhala network](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Frhala-api.phala.network%2Fws#/explorer), which is our test parachain on Rococo. For parachain assets, you can choose to test the registration locally before running a test with the Phala team on Rococo. We have provided a [config file](https://github.com/Phala-Network/subbridge-integration/blob/main/thala\\_karura.config.json) which contains the information on how to run our test runtime `Thala` with `polkadot-launch`. Check [here](https://github.com/paritytech/polkadot-launch) to find more about `polkadot-launch`.\n\nFor both parachain assets and EVM assets, the necessary step is to test the whole integration stuff on Rococo with the Phala team. The parachain registration on Rococo is maintained by Parity, if you are a parachain asset and you haven\u2019t been a Rococo parachain, please **notice the Parity team to onboard your chain on Rococo, also don\u2019t forget to let them open HRMP channels between your parachain and Rhala network**. If you are an EVM asset, please **deploy an ERC20 asset on Kovan in advance, which will be used to config the EVM bridge.", "mimetype": "text/plain", "start_char_idx": 3859, "end_char_idx": 5165, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0dca9f70-6754-4422-88e7-53515f8f90ad": {"__data__": {"id_": "0dca9f70-6754-4422-88e7-53515f8f90ad", "embedding": null, "metadata": {"file_path": "phala-docs_dist/asset-integration-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb", "node_type": "4", "metadata": {}, "hash": "22f144233eccd631e93d21571be42ccf2c8d8a1c9c53f8db00e6ef70ffbc111d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "0f2621ae-c17e-4e77-b36e-fc37748b665d", "node_type": "1", "metadata": {}, "hash": "d661db953773b449f226c6eb4be79de3822b1a0a70ad3d0eab6eff63d43b0e7c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "27ac237f-ed95-4694-8c71-f9251786f49d", "node_type": "1", "metadata": {}, "hash": "fee18e1e9907e6a9e1007bbd47478283bf2ed089a4e6a39bf904b97e485ee328", "class_name": "RelatedNodeInfo"}}, "text": "** The architecture of the test net is as follow:\n\n<figure><img src=\"../../.gitbook/assets/subbridge-rhala.png\" alt=\"\"><figcaption><p>Rhala Testnet Architecture</p></figcaption></figure>\n\nAs shown, we have deployed a test ChainBridge that bridges the Rhala network and Kovan, contracts information is as below:\n\n| Contract     | Address                                    |\n| ------------ | ------------------------------------------ |\n| bridge       | 0x0316Ea56000BCdB7D7EAED54fd70898a1fF90C09 |\n| erc20Handler | 0x7b11b07318E2E01b28A75da99F7EB8d635A6d46b |\n\nTo start integration testing, please **transfer some assets to our test account in advance**\n\n* For parachain asset, please transfer 10000 of your asset to account `0x7804e66ec9eea3d8daf6273ffbe0a8af25a8879cf43f14d0ebbb30941f578242` on your parachain\n* For EVM asset, please transfer 10000 of your asset(ERC20) to account `0xA29D4E0F035cb50C0d78c8CeBb56Ca292616Ab20` on Kovan\n\nNow it\u2019s time to let us know that you have everything ready to do the test with the Phala team on Rococo. We will register your asset on the Rhala network and enable ChainBridge transfer if you are an EVM asset or you certainly want to bridge your parachain asset to EVM chains. Check [**Assets Registration**](technical-details.md#asset-registration) to find more details.\n\n## Register assets on the Khala network <a href=\"#register-assets-on-the-khala-network\" id=\"register-assets-on-the-khala-network\"></a>\n\nAfter we have confirmed all functions are working properly on Rococo, we will start integrating your asset on the Khala network. If your asset is a parachian asset, please refer to [**Parachain assets integration guide**](../../other-products/subbridge/broken-reference/) and if your assets is an EVM asset, please refer to [**EVM assets integration guide**](../../other-products/subbridge/broken-reference/).", "mimetype": "text/plain", "start_char_idx": 5165, "end_char_idx": 7023, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "27ac237f-ed95-4694-8c71-f9251786f49d": {"__data__": {"id_": "27ac237f-ed95-4694-8c71-f9251786f49d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/asset-integration-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb", "node_type": "4", "metadata": {}, "hash": "22f144233eccd631e93d21571be42ccf2c8d8a1c9c53f8db00e6ef70ffbc111d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "0dca9f70-6754-4422-88e7-53515f8f90ad", "node_type": "1", "metadata": {}, "hash": "8990ac24d5dfe96f8399dcb34a0d63a422f323ab405a34d69c7f37f4e7e82b89", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "521e975b-a36f-4899-a124-90652cc8cdc2", "node_type": "1", "metadata": {}, "hash": "416b6e8bdefee1789abe53d8ad819006212c3ca38b45f2779234f159f2b59a2d", "class_name": "RelatedNodeInfo"}}, "text": "#### Parachain Assets Integration Guide <a href=\"#parachain-assets-integration-guide\" id=\"parachain-assets-integration-guide\"></a>\n\nSubBridge contains an XCM-based bridge that can let assets transferred between parachains. If the parachian your asset reserved hasn\u2019t opened HRMP channel with Khala network, the first thing we should do is follow these steps to open bi-direction HRMP channels:\n\n> \ud83d\udca1 Steps 1 - 3 are the stuff to open HRMP channels between our two parachains. You can directly jump to Step 4 if it has been done. **Information of PHA are as follows**:\n\n| Type     | Value                                     |\n| -------- | ----------------------------------------- |\n| Name     | PHA                                       |\n| Symbol   | PHA                                       |\n| Decimals | 12                                        |\n| ED       | 0.01 PHA                                  |\n| Location | MultiLocation::new(1, X1(Parachain(2004)) |\n\n**Step 1: Construct the call to send a request to open the HRMP channel to the Khala network**\n\n* Head to: [https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkusama.api.onfinality.io%2Fpublic-ws#/extrinsics](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkusama.api.onfinality.io%2Fpublic-ws#/extrinsics)\n* Choose extrinsic with parameters: _hrmp -> hrmpInitOpenChannel { recipient: 2004 , proposedMaxCapacity: 1000, proposedMaxMessageSize: 102400}_\n* Copy the encoded call data, it should be `0x3c00d4070000e803000000900100`\n\n<figure><img src=\"././.gitbook/assets/subbridge-openhrmp.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "521e975b-a36f-4899-a124-90652cc8cdc2": {"__data__": {"id_": "521e975b-a36f-4899-a124-90652cc8cdc2", "embedding": null, "metadata": {"file_path": "phala-docs_dist/asset-integration-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb", "node_type": "4", "metadata": {}, "hash": "22f144233eccd631e93d21571be42ccf2c8d8a1c9c53f8db00e6ef70ffbc111d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "27ac237f-ed95-4694-8c71-f9251786f49d", "node_type": "1", "metadata": {}, "hash": "fee18e1e9907e6a9e1007bbd47478283bf2ed089a4e6a39bf904b97e485ee328", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "e0cc4e7c-4ce7-4cfe-aa42-433d01bc30b7", "node_type": "1", "metadata": {}, "hash": "d3febb923117bbeb8436ae61dad0165c82617f1c99dd8d2413e4fecd00487444", "class_name": "RelatedNodeInfo"}}, "text": "png\" alt=\"\"><figcaption><p>Send HRMP Open Request</p></figcaption></figure>\n\n**Step 2: Construct an XCM message and send it to the relay chain(Kusama)**\n\nThe XCM message you constructed should contain the following 5 instructions:\n\n* WithdrawAsset\n* BuyExecution\n* Transact\n* RefundSurplus\n* DepositAsset\n\nHere is an example to send the request to Moonriver from Khala `0x03000821040101009d1f02000000210001010002140004000000000700e876481713000000000700e876481700060002286bee383c00e7070000e803000000900100140d0100040001010070617261d4070000000000000000000000000000000000000000000000000000`, you can decode the call at page [https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkhala.api.onfinality.io%2Fpublic-ws#/extrinsics/decode](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkhala.api.onfinality.io%2Fpublic-ws#/extrinsics/decode)\n\n**Tips:**\n\n* Make sure the XCM message is sent from the root account (either SUDO or via governance)\n* Make sure your parachian sovereign account has enough KSM on the Kusama network\n* The destination should be (1, Here)\n* Asset id(MultiLocation) should be set to (0, Here)\n* Recipient of `DepositAsset` should be an `AccountId32` and put your parachain sovereign account public key to id field.\n\n> \ud83d\udca1 Please let us know when the XCM message is executed successfully on Kusama, then we will propose to send an XCM message to receive the request and send open the request to your parachain at the same time.\n\n**Step 3: Receive HRMP open request from Khala network**\n\nHRMP channel is a one-way channel, which means you also need to receive our open request on your side or your parachain will not be able to receive messages from our parachain. The steps to receive the request from the Khala network are similar to the open request we did before.", "mimetype": "text/plain", "start_char_idx": 8574, "end_char_idx": 10345, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e0cc4e7c-4ce7-4cfe-aa42-433d01bc30b7": {"__data__": {"id_": "e0cc4e7c-4ce7-4cfe-aa42-433d01bc30b7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/asset-integration-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb", "node_type": "4", "metadata": {}, "hash": "22f144233eccd631e93d21571be42ccf2c8d8a1c9c53f8db00e6ef70ffbc111d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "521e975b-a36f-4899-a124-90652cc8cdc2", "node_type": "1", "metadata": {}, "hash": "416b6e8bdefee1789abe53d8ad819006212c3ca38b45f2779234f159f2b59a2d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b5699e8a-d37a-4bc8-b10c-91835303ac70", "node_type": "1", "metadata": {}, "hash": "777987083bb8f16f0a190a707547fc88ec281ccc6bdcb30c433b189a48772d61", "class_name": "RelatedNodeInfo"}}, "text": "When the Khala network successfully sends the open request, you should do as follow:\n\n* Head to [https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkusama.api.onfinality.io%2Fpublic-ws#/extrinsics](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkusama.api.onfinality.io%2Fpublic-ws#/extrinsics)\n* Choose extrinsic with parameters: _hrmp -> hrmpAcceptOpenChannel { sender: 2004 }_\n* Copy the encoded call data, it should be 0x3c01d4070000\n\n<figure><img src=\"../../.gitbook/assets/subbridge-accepthrmp.png\" alt=\"\"><figcaption><p>Accept HRMP Open Request</p></figcaption></figure>\n\n**Step 4: Register PHA on your parachain**\n\nSince the HRMP channel already opened between our two parachains, the last thing we need to do is to register your asset into our parachain and register our asset(PHA) into your parachain. You can refer to [**Assets Registration**](technical-details.md#asset-registration) to see what we have done to register an asset. Please note that the location of `PHA` is **MultiLocation::new(1, X1(Parachain(2004))**. You may want to add it to your runtime XCM trader config according to your implementation.\n\n#### EVM Assets Integration Guide <a href=\"#evm-assets-integration-guide\" id=\"evm-assets-integration-guide\"></a>\n\nIf the smart contract of your asset is ERC20 compatible, we can easily integrate it into SubBridge. Currently, we have integrated [ChainBridge](https://chainbridge.chainsafe.io/) as our EVM bridge. It already deployed on both Ethereum mainnet and Moonriver EVM, here is the deployed ChainBridge contracts information:\n\n* SygmaBridge smart contract info\n\nHead to [Sygma shared repo](https://github.com/sygmaprotocol/sygma-shared-configuration/blob/main/mainnet/shared-config-mainnet.json) for the contract deployment information and more.", "mimetype": "text/plain", "start_char_idx": 10346, "end_char_idx": 12115, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b5699e8a-d37a-4bc8-b10c-91835303ac70": {"__data__": {"id_": "b5699e8a-d37a-4bc8-b10c-91835303ac70", "embedding": null, "metadata": {"file_path": "phala-docs_dist/asset-integration-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb", "node_type": "4", "metadata": {}, "hash": "22f144233eccd631e93d21571be42ccf2c8d8a1c9c53f8db00e6ef70ffbc111d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e0cc4e7c-4ce7-4cfe-aa42-433d01bc30b7", "node_type": "1", "metadata": {}, "hash": "d3febb923117bbeb8436ae61dad0165c82617f1c99dd8d2413e4fecd00487444", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "91c3cb72-6b3c-4281-84df-82c032e3d276", "node_type": "1", "metadata": {}, "hash": "81c6f759644081c25ff2cc5514cacd2fc489ffc6069e37ef57597f32ee7ec5ab", "class_name": "RelatedNodeInfo"}}, "text": "* ChainBridge smart contract info\n\n**Ethereum mainnet:**\n\n| Contract      | Address                                    |\n| ------------- | ------------------------------------------ |\n| bridge        | 0x8F92e7353b180937895E0C5937d616E8ea1A2Bb9 |\n| erc20Handler1 | 0xEEc0fb4913119567cDfC0c5fc2Bf8f9F9B226c2d |\n| erc20Handler2 | 0xcd38b15a419491c7c1238b0659f65c755792e257 |\n\n**Moonriver EVM:**\n\n| Contract     | Address                                    |\n| ------------ | ------------------------------------------ |\n| bridge       | 0xCe6652551A989C13B41f70cac504341A5F711c8d |\n| erc20Handler | 0xf88337a0db6e24Dff0fCD7F92ab0655B97A68d38 |\n\n**Relayers:**\n\n| Relayer  | Address                                    |\n| -------- | ------------------------------------------ |\n| relayer1 | 0xA97Dc452Ca3699c4Eb62171FE2f994ff7aE48400 |\n| relayer2 | 0xdca0f5B3686cc87415100808a2568879fE74E01a |\n| relayer2 | 0x4EE535bE2ce432151916E36B3c684E1dB8Cbf8c1 |\n\nCompare with the registration of parachain assets, registration of EVM assets is more convenient. You should be relaxed because we will do everything need with the registration information provided by you. If you are aware of things we did when registering an asset, please refer to [**Assets Registration**](technical-details.md#asset-registration) for more information.\n\n> \ud83d\udca1 You should receive the update when we finish the registration.\n\n## Integrate SubBridge into Your App <a href=\"#integrate-subbridge-into-your-app\" id=\"integrate-subbridge-into-your-app\"></a>\n\nIt\u2019s better to integrate SubBridge into your App if you\u2019d like to let your users use it easily.", "mimetype": "text/plain", "start_char_idx": 12117, "end_char_idx": 13729, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "91c3cb72-6b3c-4281-84df-82c032e3d276": {"__data__": {"id_": "91c3cb72-6b3c-4281-84df-82c032e3d276", "embedding": null, "metadata": {"file_path": "phala-docs_dist/asset-integration-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb", "node_type": "4", "metadata": {}, "hash": "22f144233eccd631e93d21571be42ccf2c8d8a1c9c53f8db00e6ef70ffbc111d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b5699e8a-d37a-4bc8-b10c-91835303ac70", "node_type": "1", "metadata": {}, "hash": "777987083bb8f16f0a190a707547fc88ec281ccc6bdcb30c433b189a48772d61", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "dd632383-6c01-47d5-8fa5-4460fedeb8df", "node_type": "1", "metadata": {}, "hash": "d8a1df1fabcaf50c7f39019595e12178edce3c444c757ad516ba98c52ec6fd22", "class_name": "RelatedNodeInfo"}}, "text": "Integrating SubBridge into your app is super easy, the only thing you need to do is follow the `dest` specification we defined previously on your client. The difference between doing crosschain transfer on a parachain and an EVM chain is that in the former case you will need to interact with the XCM implementation pallet on that parachain, while in the latter you will need to interact with the smart contract deployed by Phala.\n\n* Issuing crosschain transfer on other parachains or Khala network\n\nFor example, when issuing a crosschain transfer to the Khala network or EVM chains from Karura, you should use the [xtoken\u00bbtransfer](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkarura.polkawallet.io#/extrinsics), while issuing a crosschain transfer to other parachains or EVM chains from Khala, you should use the [xtransfer\u00bbtransfer](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkhala.api.onfinality.io%2Fpublic-ws#/extrinsics). So interfaces may be different between different parachains depends on its implementation.\n\n* Issuing crosschain transfer on EVM chains with SygmaBridge\n\nSo far we have already supported SygmaBridge and ChainBridge as EVM bridge, and we will integrate more EVM bridges in the future. The following is based on interaction with SygmaBridge, with less fee being paied compared with ChainBridge. According to the mechanism of the ERC20 protocol, before calling `Bridge.deposit` which is the interface to issue crosschain transfer we need to call [ERC20 approve](https://docs.openzeppelin.com/contracts/2.x/api/token/erc20#IERC20-approve-address-uint256-) method to let user approve the specific amount of assets to `ERC20Handler` contract of SygmaBridge. This operation will allow `ERC20Handler` to spend up to the specific number of assets from the user account. After approval done, we can deposit asset through SygmaBridge contract. Luckily, Sygma has provided SDK to handle all of these stuffs, head to their [SDK repo](https://github.com/sygmaprotocol/sygma-sdk) for more details.", "mimetype": "text/plain", "start_char_idx": 13730, "end_char_idx": 15745, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "dd632383-6c01-47d5-8fa5-4460fedeb8df": {"__data__": {"id_": "dd632383-6c01-47d5-8fa5-4460fedeb8df", "embedding": null, "metadata": {"file_path": "phala-docs_dist/asset-integration-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb", "node_type": "4", "metadata": {}, "hash": "22f144233eccd631e93d21571be42ccf2c8d8a1c9c53f8db00e6ef70ffbc111d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "91c3cb72-6b3c-4281-84df-82c032e3d276", "node_type": "1", "metadata": {}, "hash": "81c6f759644081c25ff2cc5514cacd2fc489ffc6069e37ef57597f32ee7ec5ab", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "9f0b1ecc-8641-466d-9082-95bd6e0e2f48", "node_type": "1", "metadata": {}, "hash": "d94ab0ceb29298145cd14abd0edde4c03f174ce50c345772ceedada99beec1ba", "class_name": "RelatedNodeInfo"}}, "text": "We prepared the following 5 examples that almost covered all of the scenarios. If the transaction is issued on parachain, we have provided an encoded call you can decode on https://polkadot.js.app, and if the transaction is issued on EVM chains, we have provided a code snippet.\n\n**Example1: transfer an asset from Phala network to other parachain**\n\nAn example of transferring 100 PHA from the Phala network to Moonbeam, the recipient address is `0xA29D4E0F035cb50C0d78c8CeBb56Ca292616Ab20`:\n\n```\n0x5200000000000b00407a10f35a010200511f0300a29d4e0f035cb50c0d78c8cebb56ca292616ab20010700f2052a0102127a00\n```\n\n**Example2: transfer an asset from Phala network to another EVM chain**\n\nAn example of transferring 100 PHA from Khala network to Ethereum with Sygma bridge, recipient is `0xA29D4E0F035cb50C0d78c8CeBb56Ca292616Ab20`. Note small amount of PHA will be deducted as the fee of SygmaBridge:\n\n```\n0x5200000000000b00407a10f35a000306057379676d6100000000000000000000000000000000000000000000000000000005000614a29d4e0f035cb50c0d78c8cebb56ca292616ab2000000000000000000000000000\n```\n\n**Example3: transfer an asset from Moonbeam to Phala network**\n\nAn example of transferring 100 PHA from Karura to Khala network, the recipient is `Alice`.", "mimetype": "text/plain", "start_char_idx": 15747, "end_char_idx": 16980, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "9f0b1ecc-8641-466d-9082-95bd6e0e2f48": {"__data__": {"id_": "9f0b1ecc-8641-466d-9082-95bd6e0e2f48", "embedding": null, "metadata": {"file_path": "phala-docs_dist/asset-integration-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb", "node_type": "4", "metadata": {}, "hash": "22f144233eccd631e93d21571be42ccf2c8d8a1c9c53f8db00e6ef70ffbc111d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "dd632383-6c01-47d5-8fa5-4460fedeb8df", "node_type": "1", "metadata": {}, "hash": "d8a1df1fabcaf50c7f39019595e12178edce3c444c757ad516ba98c52ec6fd22", "class_name": "RelatedNodeInfo"}}, "text": "Karura XCM transfer based on the implementation of \\[xtoken pallet]https://github.com/open-web3-stack/open-runtime-module-library/tree/master/xtokens):\n\n```\n0x6a010300010100cd1f000b00407a10f35a03010200511f01007804e66ec9eea3d8daf6273ffbe0a8af25a8879cf43f14d0ebbb30941f578242010700f2052a0102127a00\n```\n\n**Example4: transfer an asset from any parachain to EVM chain**\n\nAn example of transferring 100 PHA from Moonbeam to Ethereum with SygmaBridge, recipient is `0xA29D4E0F035cb50C0d78c8CeBb56Ca292616Ab20`. Note small amount of PHA will be deducted as the fee of SygmaBridge:\n\n```\n0x6a010300010100cd1f000b00407a10f35a03010400cd1f06057379676d6100000000000000000000000000000000000000000000000000000005000614a29d4e0f035cb50c0d78c8cebb56ca292616ab20000000000000000000000000010700f2052a0102127a00\n```\n\n**Example5: transfer an asset from EVM to substrate parachain**\n\nSygma SDK provided us example code of transfer fungible token from Goerli testnet to Substrate chain, head to [here](https://github.com/sygmaprotocol/sygma-sdk/tree/main/examples/evm-to-substrate-fungible-transfer) for the details.", "mimetype": "text/plain", "start_char_idx": 16981, "end_char_idx": 18071, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "218abb79-8114-4ab8-ad28-2b64ff5535f6": {"__data__": {"id_": "218abb79-8114-4ab8-ad28-2b64ff5535f6", "embedding": null, "metadata": {"file_path": "phala-docs_dist/solo-worker-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33", "node_type": "4", "metadata": {}, "hash": "5c75fe607c5b359f098e40dbc789eb50d9b0b1698710bc54eafc82ffcd134c56", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "01f571f5-98c6-4aba-bff0-5b9813e9560e", "node_type": "1", "metadata": {}, "hash": "b432bd27f12fd902890b8dec7b72d497d143d756429b395cd08591a414c32f5b", "class_name": "RelatedNodeInfo"}}, "text": "# Solo Worker Deployment\n\nCurrently, there is no one-click deployment script for workers on Phala Network. Computation providers need to run docker compose manually for solo worker deployment.\n\n## Basic Requirements\n\n### SGX Function\n\nRunning Phala worker requires SGX-capable CPU. Please choose a device that supports SGX and enable SGX in the BIOS. For more information, please check: [choose your CPU](https://wiki.phala.network/en-us/mine/khala-mining/hardware-requirements/#check-your-cpu)\n\n### Device Configuration\n\nSolo workers on Phala need to run 3 components: **Node**, **pherry**, and **pRuntime**. The requirements for each component are as follows:\n\n| Components  | RAM Space | Harddisk Space | Remark                                           |\n| ----------- | --------- | -------------- | ------------------------------------------------ |\n| Node        | 4GB+      | 900GB+ NVME    | harddisk requirement increasing, 2t will be best |\n| pherry      | 2GB       | 0              | -                                                |\n| pRuntime    | 2GB       | 500MB          | increase slowly                                  |\n| **Totally** | 8GB+      | 2TB            | -                                                |\n\n> The number of cores of the worker needs to be **4 or more**, the stronger the CPU computing power of the worker, the better the rewards in reward calculation. For details, please refer to: [Gemini Tokenomics](https://wiki.phala.network/en-us/general/phala-network/tokenomics/)\n\n### OS Requirements\n\nWe strongly recommend that you use Ubuntu 22.04.2 LTS, download link: https://ubuntu.com/download/server\n\n> The desktop version of the OS is less stable than Server version, so we strongly recommend using the server version.\n\nAnd please make sure that the kernel version is linux-image-5.15.0-82-generic or above, the intel-microcode should be 20230808 or above.\n\n> If you do not want to update the current Ubuntu system version, please be sure to check the kernel version. Because pRuntime will use the SGX driver built into the kernel.\n\nAfter the OS is installed, we strongly recommend that you remotely connect and deploy the worker through SSH or other methods. This will help you with document input and maintenance.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2262, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "01f571f5-98c6-4aba-bff0-5b9813e9560e": {"__data__": {"id_": "01f571f5-98c6-4aba-bff0-5b9813e9560e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/solo-worker-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33", "node_type": "4", "metadata": {}, "hash": "5c75fe607c5b359f098e40dbc789eb50d9b0b1698710bc54eafc82ffcd134c56", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "218abb79-8114-4ab8-ad28-2b64ff5535f6", "node_type": "1", "metadata": {}, "hash": "461c82ef2a30c765cbb55930b4f1060da12d649ed0a85fcfe02281930cff3ea8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "d96915f6-6127-424b-9c6b-17a9785a2964", "node_type": "1", "metadata": {}, "hash": "1d3c0400ccc4c1e0be9f174ca4ff19074e3c11c0c8b084179baccd6dfa2b2ad8", "class_name": "RelatedNodeInfo"}}, "text": "## Deployment of Components <a href=\"#deployment-of-components\" id=\"deployment-of-components\"></a>\n\n### Preparations\n\nAfter installing the OS above, first install the necessary Docker program.\n\n```undefined\nsudo apt update && sudo apt upgrade -y && sudo apt autoremove -y\nsudo apt install docker-compose\n```\n\nThen create a folder locally, and create a docker-compose document within it.\n\n```bash\nmkdir phala-deployment\ncd ./phala-deployment\ntouch docker-compose.yml\n```\n\n### Document Editing\n\nEdit the docker-compose document using the following commands:\n\n```bash\nvim ./docker-compose.yml \n```\n\nAfter entering, you will access the document.\n\nAt this point, enter `a` and you will start editing the document. Paste the following content into the document. (Please note that the file content remains consistent and the indentation alignment of each line is consistent with this document)\n\n```javascript\nversion: \"3\"\nservices:\n  node:\n    image: phalanetwork/phala-node-with-launcher:latest\n    container_name: node\n    hostname: node\n    restart: always\n    ports:\n     - \"9944:9944\"\n     - \"9945:9945\"\n     - \"30333:30333\"\n     - \"30334:30334\"\n    environment:\n     - NODE_NAME=PNODE\n     - NODE_ROLE=MINER\n     - PARACHAIN_EXTRA_ARGS=--max-runtime-instances 32 --runtime-cache-size 8 --rpc-max-response-size 64\n     - RELAYCHAIN_EXTRA_ARGS=--max-runtime-instances 32 --runtime-cache-size 8 --rpc-max-response-size 64\n    volumes:\n     - /var/phala/node-data:/root/data\n\n  phala-pherry:\n    image: phalanetwork/phala-pherry:latest\n    container_name: phala-pherry\n    hostname: phala-pherry\n    restart: always\n    entrypoint:\n      [\n        \"/root/pherry\",\n        \"-r\",\n        \"--parachain\",\n        \"--mnemonic={gas fee memory seed}\",\n        \"--substrate-ws-endpoint=ws://{node ip}:9945\",\n        \"--collator-ws-endpoint=ws://{node ip}:9944\",\n        \"--pruntime-endpoint=http://{pruntime ip}:8000\",\n        \"--operator={owner address}\",", "mimetype": "text/plain", "start_char_idx": 2264, "end_char_idx": 4207, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d96915f6-6127-424b-9c6b-17a9785a2964": {"__data__": {"id_": "d96915f6-6127-424b-9c6b-17a9785a2964", "embedding": null, "metadata": {"file_path": "phala-docs_dist/solo-worker-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33", "node_type": "4", "metadata": {}, "hash": "5c75fe607c5b359f098e40dbc789eb50d9b0b1698710bc54eafc82ffcd134c56", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "01f571f5-98c6-4aba-bff0-5b9813e9560e", "node_type": "1", "metadata": {}, "hash": "b432bd27f12fd902890b8dec7b72d497d143d756429b395cd08591a414c32f5b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "4cd93a78-7c88-4168-8231-0103c2db8e66", "node_type": "1", "metadata": {}, "hash": "ee4d5b476432e54b9b8de414ddc6c6ac8ae65cd9e5c177b7581ce6c2ae0d5d6b", "class_name": "RelatedNodeInfo"}}, "text": "\"--fetch-blocks=512\",\n        \"--fast-sync\",\n        \"--auto-restart\"\n      ]\n\n  phala-pruntime:\n    image: phalanetwork/phala-pruntime-v2-with-handover:latest\n    container_name: phala-pruntime\n    hostname: phala-pruntime\n    ports:\n    - \"8000:8000\"\n    devices:\n    - /dev/sgx_enclave:/dev/sgx_enclave\n    - /dev/sgx_provision:/dev/sgx_provision\n    environment:\n    - EXTRA_OPTS=--cores={core_num} --checkpoint-interval=3600\n    - ROCKET_ADDRESS=0.0.0.0\n    volumes:\n    - /var/phala/pruntimev2:/opt/pruntime/data\n```\n\nSome parameters need to be customized by yourself, including:\n\n* In phala-pherry, replace {gas fee memory seed} in \u201c\u2013mnemonic={gas fee memory seed}\u201d with the mnemonic seed of the gas fee account. For example:\n  * \u201c\u2013mnemonic=a b c d e \u2026 h\u201d\n* In phala-pherry, replace the {node ip} with your own node\u2019s IP in both \u201c\u2013substrate-ws-endpoint=ws://{node ip}:9945\u201d and \u201c\u2013collator-ws-endpoint=ws://{node ip}:9944\u201d; Replace {pruntime ip} in \u201c\u2013pruntime-endpoint=http://{pruntime ip}:8000\u201d with the IP of your own pruntime worker; If you are running these components on the same device, the easiest way is to replace them all with 127.0.0.1. For example:\n  * \u201c\u2013substrate-ws-endpoint=ws://127.0.0.1:9945\u201d\n  * \u201c\u2013collator-ws-endpoint=ws://127.0.0.1:9944\u201d\n  * \u201c\u2013pruntime-endpoint=http://127.0.0.1:8000\u201d\n* In phala-pherry, replace {owner address} in \u201c\u2013operator={owner address}\u201d with the Phala network address of the mining pool\u2019s main account.", "mimetype": "text/plain", "start_char_idx": 4216, "end_char_idx": 5666, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4cd93a78-7c88-4168-8231-0103c2db8e66": {"__data__": {"id_": "4cd93a78-7c88-4168-8231-0103c2db8e66", "embedding": null, "metadata": {"file_path": "phala-docs_dist/solo-worker-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33", "node_type": "4", "metadata": {}, "hash": "5c75fe607c5b359f098e40dbc789eb50d9b0b1698710bc54eafc82ffcd134c56", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d96915f6-6127-424b-9c6b-17a9785a2964", "node_type": "1", "metadata": {}, "hash": "1d3c0400ccc4c1e0be9f174ca4ff19074e3c11c0c8b084179baccd6dfa2b2ad8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f504ba58-fc67-4c63-8888-b6579af50093", "node_type": "1", "metadata": {}, "hash": "bc4ead7ebd544dc6c07c394769f3bcdfb28940defa12a4d78a8dfeb2432bbfa7", "class_name": "RelatedNodeInfo"}}, "text": "For example:\n  * \u201c-operator=446u\u2026WewDEZyv\u201d\n* In phala-pruntime, change \u2013cores={core\\_num} to the number of cores of your machine, such as \u2013cores=4.\n\nAfter entering, complete the following steps to finish the text editing and save successfully.\n\n```javascript\n1\u3001Click \"esc\"\n2\u3001Enter \":wq\"\n3\u3001Click \"Enter\"\uff0cquit the editing page\n```\n\n### Program Execution\n\nInside the newly created folder, run docker-compose, and the essential components for Solo worker will run successfully.\n\n```undefined\nsudo docker-compose up -d\n```\n\n## Status Check\n\n### Node Check\n\nEnter the following command to get the last 100 lines of node log information\n\n```bash\nsudo docker logs node --tail 100\n```\n\n> If you have changed the component name through customizing docker-compose.yml, please replace \u201cnode\u201d to your customized name in the command.\n\nA typical node log in sync will look like this:\n\n```yaml\n2021-09-15 13:33:27 [Relaychain] \u2699\ufe0f  Syncing 10.4 bps, target=#9236775 (20 peers), best: #9227955 (0xa897\u20264f36), finalized #9227895 (0x1d6d\u20261527), \u2b07 1.7MiB/s \u2b06 657.8kiB/s\n2021-09-15 13:33:27 [Parachain] \u2699\ufe0f  Syncing 40.4 bps, target=#400531 (1 peers), best: #396657 (0xb898\u20266c02), finalized #396443 (0xf470\u20262f54), \u2b07 378.7kiB/s \u2b06 1.6kiB/s\n```\n\nDetermine whether the parachain and relaychain are synchronizing normally by judging the height of the \u201ctarget\u201d, \u201cbest\u201d, and \u201cfinalized\u201d.\n\n* Polkadot chain (relaychain) produces a block every 6 seconds.\n* Phala chain (parachain) produces a block every 12 seconds.", "mimetype": "text/plain", "start_char_idx": 5667, "end_char_idx": 7150, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f504ba58-fc67-4c63-8888-b6579af50093": {"__data__": {"id_": "f504ba58-fc67-4c63-8888-b6579af50093", "embedding": null, "metadata": {"file_path": "phala-docs_dist/solo-worker-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33", "node_type": "4", "metadata": {}, "hash": "5c75fe607c5b359f098e40dbc789eb50d9b0b1698710bc54eafc82ffcd134c56", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "4cd93a78-7c88-4168-8231-0103c2db8e66", "node_type": "1", "metadata": {}, "hash": "ee4d5b476432e54b9b8de414ddc6c6ac8ae65cd9e5c177b7581ce6c2ae0d5d6b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "aef2f48c-cf0d-46bc-a2e6-801008c8327a", "node_type": "1", "metadata": {}, "hash": "10d0f1c1b159b6c67164cd0c137eeaf301d670c5b8a9250d02ee0c39fa807306", "class_name": "RelatedNodeInfo"}}, "text": "### Pherry Check\n\nEnter the following command to get the most recent 100 lines of Pherry log information:\n\n```bash\nsudo docker logs phala-pherry --tail 100\n```\n\n> If you have changed the component name through customizing docker-compose.yml, please replace \u201cphala-pherry\u201d to your customized name in the command.\n\nA typical pherry log will look like this:\n\n```yaml\n[2023-05-10T11:18:38.733183Z INFO  pherry] get_block: Got block Some(8347280) hash 0x921c\u2026c876\n[2023-05-10T11:18:38.734430Z INFO  pherry] get_block: Got block Some(8347281) hash 0x66ca\u2026de13\n.\n[2023-05-10T11:18:38.835415Z INFO  pherry] fetching parachain header 9257\n[2023-05-10T11:18:38.835652Z INFO  pherry] fetching parachain header 9258\n.\n[2023-05-10T11:18:38.900188Z INFO  phactory_api::pruntime_client] Response: 200 OK\n[2023-05-10T11:18:38.900338Z INFO  pherry] .req_sync_para_header: SyncedTo { synced_to: 9414 }\n[2023-05-10T11:18:38.900342Z INFO  pherry] batch syncing from 9229 to 9414 (186 blocks)\n[2023-05-10T11:18:38.900345Z INFO  pherry] fetch_storage_changes (9229-9232)\n[2023-05-10T11:18:38.905124Z INFO  pherry::prefetcher] prefetching (9233-9236)\n[2023-05-10T11:18:38.905130Z INFO  pherry] fetch_storage_changes (9233-9236)\n.\n[2023-05-10T11:18:39.203944Z INFO  pherry] fetch_storage_changes (9415-9416)\n[2023-05-10T11:18:39.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "aef2f48c-cf0d-46bc-a2e6-801008c8327a": {"__data__": {"id_": "aef2f48c-cf0d-46bc-a2e6-801008c8327a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/solo-worker-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33", "node_type": "4", "metadata": {}, "hash": "5c75fe607c5b359f098e40dbc789eb50d9b0b1698710bc54eafc82ffcd134c56", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f504ba58-fc67-4c63-8888-b6579af50093", "node_type": "1", "metadata": {}, "hash": "bc4ead7ebd544dc6c07c394769f3bcdfb28940defa12a4d78a8dfeb2432bbfa7", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "8fd53175-b691-4a72-9c76-ca79d7847376", "node_type": "1", "metadata": {}, "hash": "85f3ad7f26726e56b900523e72fde26e5338cf02b07e169aab3b419390aac6a3", "class_name": "RelatedNodeInfo"}}, "text": "209291Z INFO  phactory_api::pruntime_client] Response: 200 OK\n[2023-05-10T11:18:39.209617Z WARN  pherry] Cannot find justification within window (from: 8347137, to: 8347327)\n[2023-05-10T11:18:39.214032Z INFO  phactory_api::pruntime_client] Response: 200 OK\n[2023-05-10T11:18:39.214046Z INFO  pherry] pRuntime get_info response: PhactoryInfo {\n        initialized: true,\n        registered: false,\n        genesis_block_hash: Some(\n            \".\",\n        ),\n        public_key: Some(\n            \".\",\n        ),\n        ecdh_public_key: Some(\n            \".\",\n        ),\n        headernum: 8347137,\n        para_headernum: 9415,\n        blocknum: 9415,\n        state_root: \".\",\n        dev_mode: false,\n        pending_messages: 0,\n        score: 0,\n        gatekeeper: Some(\n            GatekeeperStatus {\n                role: None,\n                master_public_key: \"\",\n            },\n        ),\n        version: \"2.0.1\",\n        git_revision: \".\",\n        memory_usage: Some(\n            MemoryUsage {\n                rust_used: 1973339,\n                rust_peak_used: 9071307,\n                total_peak_used: 328859648,\n            },\n        ),\n        waiting_for_paraheaders: false,\n        system: Some(\n            SystemInfo {\n                registered: false,\n                public_key: \".\",\n                ecdh_public_key: \".\",\n                gatekeeper: Some(\n                    GatekeeperStatus {\n                        role: None,\n                        master_public_key: \"\",\n                    },\n                ),\n                number_of_clusters: 0,\n                number_of_contracts: 0,\n                max_supported_consensus_version: 0,\n                genesis_block: 0,\n            },\n        ),\n        can_load_chain_state: false,\n    }\n[2023-05-10T11:18:39.222654Z INFO  pherry] try to sync blocks.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8fd53175-b691-4a72-9c76-ca79d7847376": {"__data__": {"id_": "8fd53175-b691-4a72-9c76-ca79d7847376", "embedding": null, "metadata": {"file_path": "phala-docs_dist/solo-worker-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33", "node_type": "4", "metadata": {}, "hash": "5c75fe607c5b359f098e40dbc789eb50d9b0b1698710bc54eafc82ffcd134c56", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "aef2f48c-cf0d-46bc-a2e6-801008c8327a", "node_type": "1", "metadata": {}, "hash": "10d0f1c1b159b6c67164cd0c137eeaf301d670c5b8a9250d02ee0c39fa807306", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "510d2b5f-1143-4af7-8ae8-d6eb2e59b083", "node_type": "1", "metadata": {}, "hash": "1302b90ea2c4b561809521d148f47a347bcce00fe924b1334c6b55d5ad927cc4", "class_name": "RelatedNodeInfo"}}, "text": "next required: (relay_header=8347137, para_header=9415, body=9415), relay finalized tip: 17850681, buffered: 191\n[2023-05-10T11:18:39.223867Z INFO  pherry] get_block: Got block Some(8347328) hash 0xd305\u202604ff\n[2023-05-10T11:18:39.226657Z INFO  pherry] get_block: Got block Some(8347329) hash 0x27f2\u2026bc9a\n```\n\nYou can search for issues in these logs and confirm whether the synchronization is going normally. Also, you can obtain the worker\u2019s public key and the real-time calculated P-value (score) from them.\n\n### pRuntime Check\n\nEnter the following command to get the most recent 100 lines of pRuntime log information:\n\n```bash\nsudo docker logs phala-pruntime --tail 100\n```\n\n> If you have changed the component name through customizing docker-compose.yml, please replace \u201cphala-pruntime\u201d to your customized name in the command.", "mimetype": "text/plain", "start_char_idx": 10321, "end_char_idx": 11149, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "510d2b5f-1143-4af7-8ae8-d6eb2e59b083": {"__data__": {"id_": "510d2b5f-1143-4af7-8ae8-d6eb2e59b083", "embedding": null, "metadata": {"file_path": "phala-docs_dist/solo-worker-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33", "node_type": "4", "metadata": {}, "hash": "5c75fe607c5b359f098e40dbc789eb50d9b0b1698710bc54eafc82ffcd134c56", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "8fd53175-b691-4a72-9c76-ca79d7847376", "node_type": "1", "metadata": {}, "hash": "85f3ad7f26726e56b900523e72fde26e5338cf02b07e169aab3b419390aac6a3", "class_name": "RelatedNodeInfo"}}, "text": "A typical pRuntime log in sync will look like this:\n\n```yaml\n2023-05-10T11:55:38.478826Z  INFO phactory::prpc_service: State synced\n2023-05-10T11:55:38.479089Z  INFO phactory::storage::storage_ext: Got 17 messages from OutboundMessages    \n2023-05-10T11:55:38.479330Z  INFO phactory::prpc_service: Dispatching block=440838\n2023-05-10T11:55:38.482465Z  INFO phactory::prpc_service: State synced\n2023-05-10T11:55:38.482647Z  INFO phactory::storage::storage_ext: Got 11 messages from OutboundMessages    \n2023-05-10T11:55:38.482825Z  INFO pruntime::runtime: pRPC returned code=200 size=4\n2023-05-10T11:55:38.482881Z  INFO prpc_measuring: POST /prpc/PhactoryAPI.DispatchBlocks cost 18221 microseconds, status: 200   \n```\n\nYou can determine whether the synchronization is proceeding normally by checking the synchronized height and progress.\\\\", "mimetype": "text/plain", "start_char_idx": 11151, "end_char_idx": 11989, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ee4e3602-7035-4aa0-9e80-9db78cd3d56d": {"__data__": {"id_": "ee4e3602-7035-4aa0-9e80-9db78cd3d56d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/why-multi-proof-and-how-we-can-help.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9e5be949-8f78-433e-b475-259a252e05bd", "node_type": "4", "metadata": {}, "hash": "35084c46c5473f98967abc1b2a753a9ca67d93a9dcfa8084c12e3131ebf4284f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ec7d0d0c-99e2-4955-9808-ba6bead2dbcb", "node_type": "1", "metadata": {}, "hash": "9eeb17c584edc304db705691c142adbc0c1342b468fa3d81ceb56d0ea0c798f1", "class_name": "RelatedNodeInfo"}}, "text": "# Why Multi-Proof and How We Can Help\n\n## The Need for Multi-Proof Systems\n\nIn the blockchain space, our vision is to bring privacy, security, and verifiability to users. Our ultimate goal is to design a system that can simultaneously fulfill these attributes. However, relying on a single proof system to achieve this is impractical for several reasons:\n\n* No single cryptographic system can be guaranteed to be 100% secure. For instance, zero-knowledge proofs (zk) can have soundness bugs that are difficult to detect, while Multi-Party Computation (MPC) is susceptible to collusion risks between nodes.\n* Privacy in zkRollups cannot be fully guaranteed because sequencers can extract user transaction data during proof generation.\n* Verifiability in Fully Homomorphic Encryption (FHE) computations is challenging because the FHE server may not perform computations correctly, and without knowing the correct result, we cannot verify its accuracy.\n\nThere are several benefits we can gain by introducing TEE:\n\n1. **Hardware-grade safety:** The privacy, confidentiality, and data integrity is guaranteed by hardware secure enclave.\n2. **No computation overhead:** Applications run TEE have nearly same speed compare with running in normal CPU env\n3. **Low verification cost:** The Gas consumption to verify TEE proof is minimal, requiring just an ECDSA verification.\n\nBy building on the Phala TEE network, you can gain additional advantages:\n\n* **Data Sharing**: Phala TEE supports confidential data exchange use cases, such as Maximal Extractable Value (MEV), blockchain games, and AI model training.\n* **Availability**: With 35,000 TEE workers, Phala\u2019s Phat Contract is programmable to meet the needs of various blockchain projects, ensuring robust availability.\n* **Trust of Multiple Parties**: Phala TEE ensures that your application, project, or blockchain use case remains operational and free from legislative risks, maintaining trust across multiple parties.\n* **Out-of-the-Box SDK**: Our SDKs for Rust and JavaScript enable developers to launch their applications on our TEE network quickly, often within hours.\n\nWe can not guarantee any single cryptography system is 100% secure. At the same time, the current Zero-Knowledge (ZK) solution is secure theoretically but still does not guarantee system-wide bug-free operation, especially from an engineering perspective, which remains challenging due to the complexity of ZK implementation.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2447, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ec7d0d0c-99e2-4955-9808-ba6bead2dbcb": {"__data__": {"id_": "ec7d0d0c-99e2-4955-9808-ba6bead2dbcb", "embedding": null, "metadata": {"file_path": "phala-docs_dist/why-multi-proof-and-how-we-can-help.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9e5be949-8f78-433e-b475-259a252e05bd", "node_type": "4", "metadata": {}, "hash": "35084c46c5473f98967abc1b2a753a9ca67d93a9dcfa8084c12e3131ebf4284f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ee4e3602-7035-4aa0-9e80-9db78cd3d56d", "node_type": "1", "metadata": {}, "hash": "66280db0bac8917986f1df9ed0007221a97e1b4d2aacd2e2bdb46a849d8429a6", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f009a205-0e36-4963-a0ca-515460e59cf5", "node_type": "1", "metadata": {}, "hash": "14e45245d7445c3e170f2e84bca51a5a999d7f4c0610ad7d928e405b4e3f02ac", "class_name": "RelatedNodeInfo"}}, "text": "Here's where multi-proof systems come into play, to hedge the bugs in ZK implementation, a hardware solution, Trusted Execution Environment (TEE), can be used as a 2-factor verifier to offer double security to ZK projects like zk-Rollups. Inspired by Vitalik Buterin's [presentation](https://hackmd.io/@vbuterin/zk\\_slides\\_20221010#/) and a recent [post](https://ethresear.ch/t/2fa-zk-Rollups-using-sgx/14462) by Justin Drake.\n\n<figure><img src=\"../../.gitbook/assets/Why-Multi-Proof.png\" alt=\"\"><figcaption></figcaption></figure>\n\n### Use Cases\n\nLet's delve into some practical examples at the intersection of multi-proof systems. The practical real-world applications of multi-proof technology can be particularly seen in:\n\n1. **Build coprocessor for FHE-based blockchain**:\n\nMost FHE-based blockchain networks introduce a threshold signature-based MPC network to manage keys and perform decryption on behalf of the user, effectively acting as an FHE coprocessor. However, MPC introduces collusion risks between nodes. A better approach is to build the coprocessor using TEE, which offers several benefits:\n\n* **Key Security**: The program can be proven immutable, and access is restricted, essentially treating TEE as a form of two-factor authentication (2FA). For more details, you can check out this [post](https://ethresear.ch/t/sgx-as-2fa-for-fhe-mpc/19780) we published earlier on the Ethereum research forum.\n*   **Encryption/Decryption Validity**: Currently, we cannot guarantee the integrity of plaintext during both the encryption and decryption steps, especially since decryption is often outsourced to the MPC network. Instead of introducing Zero-Knowledge Proofs (ZKP) during encryption and decryption, an alternative approach is to run the MPC nodes inside a TEE. This can simultaneously address both key security and decryption integrity issues, and with lower computational cost. For more information, check out the [blog](https://phala.network/posts/build-fhe-coprocessor-on-tee-using-javascript) we posted.\n\n    <figure><img src=\"../../.gitbook/assets/FHE-Coprocessor.png\" alt=\"\"><figcaption></figcaption></figure>\n\n2.", "mimetype": "text/plain", "start_char_idx": 2448, "end_char_idx": 4587, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f009a205-0e36-4963-a0ca-515460e59cf5": {"__data__": {"id_": "f009a205-0e36-4963-a0ca-515460e59cf5", "embedding": null, "metadata": {"file_path": "phala-docs_dist/why-multi-proof-and-how-we-can-help.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9e5be949-8f78-433e-b475-259a252e05bd", "node_type": "4", "metadata": {}, "hash": "35084c46c5473f98967abc1b2a753a9ca67d93a9dcfa8084c12e3131ebf4284f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ec7d0d0c-99e2-4955-9808-ba6bead2dbcb", "node_type": "1", "metadata": {}, "hash": "9eeb17c584edc304db705691c142adbc0c1342b468fa3d81ceb56d0ea0c798f1", "class_name": "RelatedNodeInfo"}}, "text": "**Build 2FA for ZK-Rollups**:\n\nInspired by Vitalik Buterin's [presentation](https://hackmd.io/@vbuterin/zk\\_slides\\_20221010#/) and a recent [post](https://ethresear.ch/t/2fa-zk-Rollups-using-sgx/14462) by Justin Drake, we have awared that there are few improvement space exist in zk implementation. For example, we currently can not guarantee that the ZK circuit is bug free since it's tens of thousands code and we also cannot guarantee the privacy of user transaction because the sequencer can say anything.\n\nTo solve thoese problem, zk-Rollup can run a separate STF (state transition function) in TEE, and the result returned by STF will be signed by the key derived in TEE (check this [article](https://phala.network/posts/introducing-phala-sgxprover-a-twofactor-authentication-solution-for-zkrollups) for more details), then submitted on-chain verifier along with the ZKP, the security levels can be significantly improved while ensuring computational efficiencies.\n\n<figure><img src=\"../../.gitbook/assets/Use-Cases-Multi-Proof.png\" alt=\"\"><figcaption></figcaption></figure>\n\n3\\. **TEE-Proof for ZK/MPC Bridges**:\n\nZK/MPC bridges also can run the copy of the relayer in TEE, instead generate proof or MPC signature, the program can generate TEE-proof and submit it to the destination chain. The inclusion of TEE-proof provides secondary security, strengthening the system against potential breaches and leaks.\n\n4. **TEE-Proof for zkVM-based application**:\n\nA zkVM-based application can simply move their guest code to TEE, guest code often has no relation to ZK primitive. We can generate the TEE proof for the output of the guest code, which can be used to provide a secondary security guarantee for the zkVM.\n\n<figure><img src=\"../../.gitbook/assets/Use-Cases-Multi-Proof-2.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 4588, "end_char_idx": 6417, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7ce9ee5f-c9c0-4e39-a278-9da48800ae20": {"__data__": {"id_": "7ce9ee5f-c9c0-4e39-a278-9da48800ae20", "embedding": null, "metadata": {"file_path": "phala-docs_dist/access-from-ui.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "3a0fc6e6-646d-4d0f-a1cc-88a9d68cb045", "node_type": "4", "metadata": {}, "hash": "a56d447926e4085f127090a85d0f7c55ea7d5c3b57809499e4bd80f17931feba", "class_name": "RelatedNodeInfo"}}, "text": "# Access from UI\n\n<figure><img src=\"../../.gitbook/assets/WIP.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 108, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ba477c28-2940-4ebd-8ca5-7601eda57082": {"__data__": {"id_": "ba477c28-2940-4ebd-8ca5-7601eda57082", "embedding": null, "metadata": {"file_path": "phala-docs_dist/error-summary.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "63932883-a029-4ad9-aea6-1a8894eb02dd", "node_type": "4", "metadata": {}, "hash": "4f7fcf4f6bd2d99bacbd20167f512a5462945e949d78fb3b2f4308b62ae8827c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "253c7cf8-a3c6-4f17-b2e0-9f0ef37124d7", "node_type": "1", "metadata": {}, "hash": "4dffbf1bb233e5dd762dc323b45a3df9a7c0ffa3654adeb1604d798f458cbd1a", "class_name": "RelatedNodeInfo"}}, "text": "# Error Summary\n\n## Mining <a href=\"#mining\" id=\"mining\"></a>\n\n### Worker <a href=\"#worker\" id=\"worker\"></a>\n\n| Error name                          | Meaning                                                                             | Solution                                                                                                                                                                                                                                       |\n| ----------------------------------- | ----------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| WorkerNotRegistered                 | The worker is not registered in the registry when adding to the pool                | Check the synchronization process and mining status of the worker                                                                                                                                                                              |\n| BenchmarkMissing                    | The worker doesn\u2019t have a valid benchmark when adding to the pool                   | Make sure the worker is mining and wait for the benchmark uploaded                                                                                                                                                                             |\n| WorkerDoesNotExist                  | The worker is already added to the pool                                             | -                                                                                                                                                                                                                                              |\n| WorkerInAnotherPool                 | The worker is already added to another pool                                         | Remove it from the pool to which the worker is added before if it\u2019s not the pool you want to add the worker to                                                                                                                                 |\n| UnauthorizedOperator                | The access to a worker is granted by its operator parameter set by register\\_worker | Check the config on the mining scripts                                                                                                                                                                                                         |\n| InsufficientFreeStake               | Cannot start mining because there\u2019s no enough free stake                            | The stake amount you set to the work is more than the free stake amount in the pool. Set a number that is less than the free stake or delegates more PHA in the pool                                                                           |\n| WorkersExceedLimit                  | Failed to add a worker because the number of the workers exceeds the upper limit.   | Create another pool or remove the useless worker in this pool (Make sure the worker is stopped and reclaimed before you remove it)                                                                                                             |\n| CannotRestartWithLessStake          | Restarted with a less stake is not allowed in the tokenomic.                        | -                                                                                                                                                                                                                                              |\n| MinerNotReady                       | Miner is not in Ready state to proceed.                                             | Wait for a 7 days period of Cool-down and reclaim it when the period is finished                                                                                                                                                               |\n| MinerNotMining                      | Miner is not in Mining state to stop mining.                                        | -                                                                                                                                                                                                                                              |\n| CoolDownNotReady                    | Cannot reclaim the worker because it\u2019s still in cooldown period.                    | Wait for the 7 days period of Cool-down and reclaim it when the period is finished                                                                                                                                                             |\n| TooMuchStake                        | Cannot start mining because there\u2019s too much stake (exceeds Vmax).", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 4987, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "253c7cf8-a3c6-4f17-b2e0-9f0ef37124d7": {"__data__": {"id_": "253c7cf8-a3c6-4f17-b2e0-9f0ef37124d7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/error-summary.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "63932883-a029-4ad9-aea6-1a8894eb02dd", "node_type": "4", "metadata": {}, "hash": "4f7fcf4f6bd2d99bacbd20167f512a5462945e949d78fb3b2f4308b62ae8827c", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ba477c28-2940-4ebd-8ca5-7601eda57082", "node_type": "1", "metadata": {}, "hash": "31ad770f2a1410d457eba5a34ab550ec6a2156407002183cccccb38f15978ed3", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "983592b6-ca6d-4b1d-9a5d-6cfae8940017", "node_type": "1", "metadata": {}, "hash": "bbb5f1d02efae4da2a233ee9c18d77736ad93632611bebd687d177bc38e71894", "class_name": "RelatedNodeInfo"}}, "text": "| The stake amount you set for the worker is more than the maximum stake amount of the worker. Set a lower number and try again. How to calculate the maximum stake: Phala Tokenomics                                                            |\n| BenchmarkTooLow                     | Indicating the initial benchmark score is too low to start mining.                  | Make sure your worker has a high-quality computing power. Restart your mining scripts and check the mining score on the mining status. If the mining score is still under 100, the worker will not be allowed to participate the Phala Mining. |\n| MinerNotFound                       | Miner not found.                                                                    | -                                                                                                                                                                                                                                              |\n| MinerNotBound                       | Not permitted because the miner is not bound with a worker.                         | -                                                                                                                                                                                                                                              |\n| WorkerNotBound                      | Not permitted because the worker is not bound with a miner account.                 | -                                                                                                                                                                                                                                              |\n| InternalErrorBadTokenomicParameters | Internal error. The tokenomic parameter is not set.                                 | Please contact the Phala Team the bug you meet, thank you                                                                                                                                                                                      |\n\n### Pool <a href=\"#pool\" id=\"pool\"></a>\n\n| Error name                   | Meaning                                                                         | Solution                                                                 |\n| ---------------------------- | ------------------------------------------------------------------------------- | ------------------------------------------------------------------------ |\n| InadequateCapacity           | The stake capacity is set too low to cover the existing stake                   | Set a higher cap that is not less than the amount of existing delegation |\n| NoRewardToClaim              | There\u2019s no pending reward to claim                                              | Keep patient and learn about the Principles of payment events            |\n| AlreadyInContributeWhitelist | Can not add the staker to whitelist because the staker is already in whitelist.", "mimetype": "text/plain", "start_char_idx": 5005, "end_char_idx": 7997, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "983592b6-ca6d-4b1d-9a5d-6cfae8940017": {"__data__": {"id_": "983592b6-ca6d-4b1d-9a5d-6cfae8940017", "embedding": null, "metadata": {"file_path": "phala-docs_dist/error-summary.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "63932883-a029-4ad9-aea6-1a8894eb02dd", "node_type": "4", "metadata": {}, "hash": "4f7fcf4f6bd2d99bacbd20167f512a5462945e949d78fb3b2f4308b62ae8827c", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "253c7cf8-a3c6-4f17-b2e0-9f0ef37124d7", "node_type": "1", "metadata": {}, "hash": "4dffbf1bb233e5dd762dc323b45a3df9a7c0ffa3654adeb1604d798f458cbd1a", "class_name": "RelatedNodeInfo"}}, "text": "| -                                                                        |\n| ExceedWhitelistMaxLen        | Too many stakers in contribution whitelist that exceed the limit                | remove the useless whitelist in this pool                                |\n\n## Delegate <a href=\"#delegate\" id=\"delegate\"></a>\n\n| Error name               | Meaning                                                                             | Solution                                                                         |\n| ------------------------ | ----------------------------------------------------------------------------------- | -------------------------------------------------------------------------------- |\n| StakeExceedsCapacity     | The stake added to a pool exceeds its capacity                                      | You can\u2019t add the delegation amount more than the delegatable amount of the pool |\n| InsufficientContribution | The contributed stake is smaller than the minimum threshold                         | Set a delegation amount that is more than 0.01 PHA                               |\n| InsufficientBalance      | Trying to contribute more than the available balance                                | You don\u2019t have enough transferrable balance. Check your transferrable balance    |\n| InvalidWithdrawalAmount  | The withdrawal amount is too small (considered as dust)                             | The withdrawal amount should be more than 0.01 PHA                               |\n| NoRewardToClaim          | There\u2019s no pending reward to claim                                                  | Keep patient and learn about the Principles of payment events                    |\n| NotInContributeWhitelist | Invalid staker to contribute because origin isn\u2019t in Pool\u2019s contribution whitelist. | Ask the pool owner to add you to the whitelist                                   |", "mimetype": "text/plain", "start_char_idx": 7998, "end_char_idx": 9901, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d5047fa7-b0c6-4296-b4d9-99999e99152f": {"__data__": {"id_": "d5047fa7-b0c6-4296-b4d9-99999e99152f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/sidevm.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "5e1257f0-751b-4336-b6eb-8b187e368904", "node_type": "4", "metadata": {}, "hash": "2a323aed57c650904b09af66aa9e21fd6b0a9cf272b8a1d5411cd5221c30c0b0", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "444df373-b34b-4ce1-86f9-9d635090f8b6", "node_type": "1", "metadata": {}, "hash": "3d75484749aee5445d5ffe62c2490d39277516c51d5baef2bdc4584c65070ac6", "class_name": "RelatedNodeInfo"}}, "text": "# SideVM\n\n## About SideVM <a href=\"#about-sidevm\" id=\"about-sidevm\"></a>\n\nSideVM is the core extension of Phat Contract. Despite the advantages above, the raw Phat Contract still has limitations compared with current Web2 backend programs:\n\n* Lifecycle limitation. The Phat Contract execution is triggered when users send on-chain transactions or off-chain queries to it, and the instance is destroyed when the execution finishes. This makes it impossible to do async requests or keep a long-live network connection;\n* Program environment limitation. The Phat Contract inherits the limitations of Ink! and only supports `no_std` crates. This also limits the resources a contract can use (e.g. listening to a port for connections).\n\nSideVM is proposed to tackle these limitations. It runs in a different runtime. This means it can continuously execute, support `std` library, and listen to the port.\n\n## Prepare Environment <a href=\"#prepare-environment\" id=\"prepare-environment\"></a>\n\nThe SideVM support is already equipped to our public testnet. But it requires manual authorization to your contract to enable it to call the `start_sidevm()` function. Contact us is the `#dev` channel in our [Discord server](https://discord.gg/phala-network) to get support.\n\nAlso, you can run your local testnet following our tutorial and then do the testing.\n\n## Play with it <a href=\"#play-with-it\" id=\"play-with-it\"></a>\n\n### Programming SideVM <a href=\"#programming-sidevm\" id=\"programming-sidevm\"></a>\n\nWe use [https://github.com/Phala-Network/phat-contract-examples/tree/master/start\\_sidevm](https://github.com/Phala-Network/phat-contract-examples/tree/master/start\\_sidevm) as an example. It contains both the Phat contract and the SideVM program under `sideprog` folder.\n\nThe SideVM part listens to a local port. It will be launched by this [line of code](https://github.com/Phala-Network/phat-contract-examples/blob/master/start\\_sidevm/lib.rs#L29) if called.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1955, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "444df373-b34b-4ce1-86f9-9d635090f8b6": {"__data__": {"id_": "444df373-b34b-4ce1-86f9-9d635090f8b6", "embedding": null, "metadata": {"file_path": "phala-docs_dist/sidevm.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "5e1257f0-751b-4336-b6eb-8b187e368904", "node_type": "4", "metadata": {}, "hash": "2a323aed57c650904b09af66aa9e21fd6b0a9cf272b8a1d5411cd5221c30c0b0", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d5047fa7-b0c6-4296-b4d9-99999e99152f", "node_type": "1", "metadata": {}, "hash": "bd13c6891a5f47d4b70b1451aa5cd3cc75d80e0611538cef3d216f02ba7b1cb4", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ac9266c2-bc8d-4a24-b116-80a3dc2380c1", "node_type": "1", "metadata": {}, "hash": "4c970640b31b2841c0ce35505026018efcb640f0573e8c84044789ee998e32be", "class_name": "RelatedNodeInfo"}}, "text": "### Compile Phat Contract and SideVM Program <a href=\"#compile-phat-contract-and-sidevm-program\" id=\"compile-phat-contract-and-sidevm-program\"></a>\n\nJust `make` under the folder and it will give you\n\n1. SideVM program `sideprog.wasm`\n2. Phat contract under `target/ink/start_sidevm.contract`\n\n### Upload SideVM Program and Instantiate the Contract <a href=\"#upload-sidevm-program-and-instantiate-the-contract\" id=\"upload-sidevm-program-and-instantiate-the-contract\"></a>\n\nWe have a [frontend](https://phat.phala.network/) but it does not support the SideVM program upload yet. So we need to upload it manually.\n\n### **Upload SideVM Program**\n\nUse [Polkadot.js](https://polkadot.js.org/apps/) and change the endpoint to `Phala (PoC 6)` under `TEST NETWORKS`.\n\n![](https://i.imgur.com/gerZoKj.png)\n\nIn `Developer` - `Extrinsics`, choose `phalaFatContracts` and `clusterUploadResource`. Change `resourceType` to `SidevmCode`, and drag your `sideprog.wasm` here.\n\nSubmit the transaction and you shall see its success.\n\n**Interact with Phat UI**\n\nGo to [https://phat.phala.network/](https://phat.phala.network/), click `sign in` and link your address. You need to ensure the `RPC Endpoint` is [wss://poc6.phala.network/ws](wss://poc5.phala.network/ws) and `Default PRuntime Endpoint` [https://phat-cluster-us.phala.network/poc6/pruntime/0xac5087e0](https://phat-cluster-us.phala.network/poc6/pruntime/0xac5087e0).\n\n![](../../.gitbook/assets/SelectPoC6.png)\n\nClick `Upload` and drag your `target/ink/start_sidevm.contract`. Choose the default constructor and Cluster `0x0000000000000000000000000000000000000000000000000000000000000000`. Click `Submit`. You should see something like\n\n![](https://i.imgur.com/M8PoeTO.png)\n\n**Start SideVM with Query**\n\nYou can directly interact with your contract with Contract UI.", "mimetype": "text/plain", "start_char_idx": 1957, "end_char_idx": 3764, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ac9266c2-bc8d-4a24-b116-80a3dc2380c1": {"__data__": {"id_": "ac9266c2-bc8d-4a24-b116-80a3dc2380c1", "embedding": null, "metadata": {"file_path": "phala-docs_dist/sidevm.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "5e1257f0-751b-4336-b6eb-8b187e368904", "node_type": "4", "metadata": {}, "hash": "2a323aed57c650904b09af66aa9e21fd6b0a9cf272b8a1d5411cd5221c30c0b0", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "444df373-b34b-4ce1-86f9-9d635090f8b6", "node_type": "1", "metadata": {}, "hash": "3d75484749aee5445d5ffe62c2490d39277516c51d5baef2bdc4584c65070ac6", "class_name": "RelatedNodeInfo"}}, "text": "The `start_sidevm` query is used to start the SideVM program. It contains the [invoke](https://github.com/Phala-Network/phat-contract-examples/blob/master/start\\_sidevm/lib.rs#L29) to `pink::start_sidevm()`.\n\nFrom the Worker log, we can see\n\n![](https://i.imgur.com/DWjOeyh.png)\n\nActually, we implemented the log server with SideVM too ([ref](https://github.com/Phala-Network/phala-blockchain/pull/855)).\n\n### More Resources <a href=\"#more-resources\" id=\"more-resources\"></a>\n\nWe do not have many documents on SideVM yet, feel free to ask us directly.\n\n* Previous SideVM design: [https://github.com/Phala-Network/rfcs/blob/main/pink-sidevm/pink-sidevm.md](https://github.com/Phala-Network/rfcs/blob/main/pink-sidevm/pink-sidevm.md)\n* SideVM program examples under [https://github.com/Phala-Network/phala-blockchain/tree/master/crates/pink/sidevm/examples](https://github.com/Phala-Network/phala-blockchain/tree/master/crates/pink/sidevm/examples)\n* Our SideVM-related PRs: [https://github.com/Phala-Network/phala-blockchain/pulls?q=sidevm+](https://github.com/Phala-Network/phala-blockchain/pulls?q=sidevm+)", "mimetype": "text/plain", "start_char_idx": 3766, "end_char_idx": 4873, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f3a7eff2-ddf1-44ff-af65-f3f2630f1fa5": {"__data__": {"id_": "f3a7eff2-ddf1-44ff-af65-f3f2630f1fa5", "embedding": null, "metadata": {"file_path": "phala-docs_dist/archive-node-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "5d3e58fe-9b67-499c-a738-8eeecbd66f37", "node_type": "4", "metadata": {}, "hash": "1c65070f32d40b1d4adeb43ec7818d7ac18be591d48d4800f5917441f9882ce4", "class_name": "RelatedNodeInfo"}}, "text": "---\ndescription: >-\n  If you don't have enough harddisk for a full node. Here is a deployment method\n  to save your space:\n---\n\n# Archive node deployment\n\n**Use the docker compose like this to deploy your Node and headers cache**\n\n```docker\nversion: \"3\"\nservices:\n  node:\n    image: phalanetwork/khala-node-with-launcher:latest\n    container_name: node\n    hostname: node\n    restart: always\n    ports:\n     - \"9944:9944\"\n     - \"9945:9945\"\n     - \"30333:30333\"\n     - \"30334:30334\"\n    environment:\n     - NODE_NAME=NODE\n     - NODE_ROLE=ARCHIVE\n     - PARACHAIN_EXTRA_ARGS=--max-runtime-instances 32 --runtime-cache-size 8 --rpc-max-response-size 64\n     - RELAYCHAIN_EXTRA_ARGS=--max-runtime-instances 32 --runtime-cache-size 8 --rpc-max-response-size 64 --blocks-pruning archive-canonical --state-pruning 50400\n    volumes:\n     - /var/khala/node-data:/root/data\n\n  khala-headers-cache:\n    image: phalanetwork/headers-cache:latest\n    container_name: khala-headers-cache\n    network_mode: host\n    restart: always\n    environment:\n      - ROCKET_PORT=22111\n      - ROCKET_ADDRESS=0.0.0.0\n      - RUST_LOG=info\n    command:\n      - serve\n      - --grab-headers\n      - --node-uri=ws://{node-ip}:9945\n      - --para-node-uri=ws://{node-ip}:9944\n      - --interval=60\n    volumes:\n      - ./khala-headers-cache-public:/opt/headers-cache/data\n```\n\nIt can be connected to both Prb3 or pherry, and then connected to pRuntime. But remember:\n\n**You can't start syncing the headers cache with an existing archive node, they can only starting syncing from 0 together.**", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1564, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "40253e65-9ca5-4038-a557-5d58429109d8": {"__data__": {"id_": "40253e65-9ca5-4038-a557-5d58429109d8", "embedding": null, "metadata": {"file_path": "phala-docs_dist/test-and-benchmark.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "4ef2603e-462d-4bb6-bab8-785bc848a684", "node_type": "4", "metadata": {}, "hash": "94339534cc91f5e3794fdcdb732068043dbd04e709e2053014ccef350a485749", "class_name": "RelatedNodeInfo"}}, "text": "# Test and Benchmark\n\n<figure><img src=\"../../.gitbook/assets/WIP.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 112, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8fc7e2d2-f5d2-45a7-ba99-d8ef4e69d8e9": {"__data__": {"id_": "8fc7e2d2-f5d2-45a7-ba99-d8ef4e69d8e9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/monitor-workers-status.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6dc5aa10-e555-4656-b63a-e4dbbdc9da59", "node_type": "4", "metadata": {}, "hash": "f5c1fc50f75278217c1ceb3e43cb04c6d5a16b99708af6a713fc2f41af8e8ea9", "class_name": "RelatedNodeInfo"}}, "text": "# Monitor Worker's Status\n\n### Verify the Status of your Worker <a href=\"#verify-the-status-of-your-worker\" id=\"verify-the-status-of-your-worker\"></a>\n\nYou can see the synchronization progress at any time of your worker. Check your worker\u2019s status with:\n\n```\nsudo phala status\n```\n\nYour worker\u2019s status shows the\n\n* `node name`\n* `number of cores`\n* `gas account and balance`\n* `StakePool account`\n* `Worker public key`\n* `Alarm of node loss syncing`\n\n> A warning will be sent if your gas account balance is under 2 PHA so you can recharge your GAS account on time.\n\n<figure><img src=\"../../../.gitbook/assets/2-3-1.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 662, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "bf5abd89-c750-4168-af07-447e48dc895c": {"__data__": {"id_": "bf5abd89-c750-4168-af07-447e48dc895c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/framehub.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8c17c1e8-7a5d-4faa-80b7-52b6e054f3e9", "node_type": "4", "metadata": {}, "hash": "8260fbb92d0661d3309dbc91f7e2d75bfddd5c7b25dfb5517d16b8c226492b8f", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83d\uddbc\ufe0f FrameHub\n\n<figure><img src=\"../.gitbook/assets/FramHub-Template.png\" alt=\"\"><figcaption></figcaption></figure>\n\nMore info coming soon. Check out our [repo](https://github.com/Phala-Network/framehub-template) to deploy today.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 229, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c6f9952b-1dff-4207-893f-adbdb1c7d393": {"__data__": {"id_": "c6f9952b-1dff-4207-893f-adbdb1c7d393", "embedding": null, "metadata": {"file_path": "phala-docs_dist/switch-workers-from-solo-to-prb-mode.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "25ffb768-e9d3-4978-ad98-0eb8765b01a6", "node_type": "4", "metadata": {}, "hash": "c91c08db59ee71c94e6683beb191b034190321b71930ed145a46e2c986caa291", "class_name": "RelatedNodeInfo"}}, "text": "# Switch Workers from Solo to PRB Mode\n\nSolo workers need to run node, pherry, and pRuntime simultaneously. If you want to switch your worker to PRB mode, you need to perform three steps:\n\n1. Set up at least one PRB Server, details: [PRB deployment](https://wiki.phala.network/en-us/mine/phala-worker/prbv3-deployment/)\n2. Disable the Node and pherry in the Solo miner, leaving only pRuntime running\n3. Add the Worker to the PRB UI, details: [Using PRBv3](https://wiki.phala.network/en-us/mine/phala-worker/using-prbv3/)\n\nIf you are using the docker compose content under this Wiki: [Solo worker deployment](https://wiki.phala.network/en-us/mine/phala-worker/solo-worker-deployment/)\n\nThe command to disable Node and pherry is as follows:\n\n```bash\nsudo docker container rm -f node\nsudo docker container rm -f phala-pherry\n```\n\n> If you have customized the docker compose content, please use `sudo docker container ps` to query the running service names and replace `node` and `phala-pherry` in the above commands.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1013, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "661884b2-19a3-4731-a13e-e678668775af": {"__data__": {"id_": "661884b2-19a3-4731-a13e-e678668775af", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-from-morpheus-plugin.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "2e92a757-0686-4f31-980b-b742f6a67efb", "node_type": "4", "metadata": {}, "hash": "205ae1cde8c58ec838e9593e0683541ddfb807287091a2d3daa947b0a3707bb1", "class_name": "RelatedNodeInfo"}}, "text": "# Connect from Morpheus Plugin\n\n<figure><img src=\"../../.gitbook/assets/WIP.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 122, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c9423d09-6394-4c5d-a428-32bfe0b2c563": {"__data__": {"id_": "c9423d09-6394-4c5d-a428-32bfe0b2c563", "embedding": null, "metadata": {"file_path": "phala-docs_dist/khala-governance.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a6a5cc87-e099-4ac1-ab49-37fd5379aadf", "node_type": "4", "metadata": {}, "hash": "0db6d2eaa83b7012c981b5ebd82a9574afe6ae8a9a191b386c17d6e115778307", "class_name": "RelatedNodeInfo"}}, "text": "# Khala Governance\n\nKhala and Phala adopt the same governance mechanism as Kusama and Polkadot. This is a relatively mature mechanism that governs to ensure the majority of the stake can always command a network. No matter whether the proposal is submitted by the public (PHA token holders) or the council, it will eventually have to go through a referendum where all holders, weighted by stake, make decisions.\n\nTo dive deeply into Phala/Khala governance, please refer to the Governance section.\n\n## Council <a href=\"#council\" id=\"council\"></a>\n\nTo represent passive stakeholders, Phala/Khala introduced the idea of a \u201ccouncil\u201d. each council member represents an on-chain account. Phala and Khala share the same council which currently consists of 5 members. This is expected to increase over the next few months to 11 members. The council will end up having a fixed number of seats. Click here to learn how to be part of it.\n\n## Participate in Khala Democracy <a href=\"#participate-in-khala-democracy\" id=\"participate-in-khala-democracy\"></a>\n\nKhala Governance Khala Polkadot.js", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1080, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "3b379737-9a53-4c7a-ab95-ebdb98b92b7f": {"__data__": {"id_": "3b379737-9a53-4c7a-ab95-ebdb98b92b7f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/community-builders.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "5c14c8ab-4c40-4fe1-82bc-8d044635ce6c", "node_type": "4", "metadata": {}, "hash": "bd0afc1562daab7f2957035d0052d0db6a9659271fe7bd585d96b2c1d9b4fc68", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83d\udc77 Community Builders", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 22, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7aa3c3c1-f09e-4aec-929d-796ee04ce5ce": {"__data__": {"id_": "7aa3c3c1-f09e-4aec-929d-796ee04ce5ce", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-dashboard-profile.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a53edfbb-ded7-4527-a274-a9813568a5c1", "node_type": "4", "metadata": {}, "hash": "235c505c3cee8567d5ad4ac2edc624537278fa662d9f88b8b1de83068987b662", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83d\udc7e Create a Dashboard Profile\n\n## Create a Profile <a href=\"#user-content-create-a-phala-profile\" id=\"user-content-create-a-phala-profile\"></a>\n\nYou can get an account from one of the following:\n\n* [Polkadot.js Wallet Extension](https://bit.ly/3RMUjqy)\n* [Talisman Wallet](https://bit.ly/3ZzAPYD)\n* [SubWallet](https://bit.ly/3tjS8R7) (**Support for iOS/Android**)\n* [Metamask](https://bit.ly/3RCiQ1b) (**Support for** [**EIP-712**](https://bit.ly/pha-eip-712))\n\nFirst, create your Phala Profile account on the [Phala PoC6 Testnet](https://bit.ly/3LHccmR) or [Phala Mainnet](https://bit.ly/3LHccmR). Here is a quick 1 minute [YouTube video](https://bit.ly/46clfo4) on setting up from scratch. Here is what your Phala Profile account overview should look like:\n\n<figure><img src=\"../../../.gitbook/assets/image (9).png\" alt=\"\"><figcaption></figcaption></figure>\n\n## Get Test Tokens\n\nTo get test tokens go to the [faucet](https://bit.ly/phala-faucet) and request tokens for both Phala PoC6 Testnet. Connect your wallet and click on `Send Me PHA` to get `100 PHA` sent to your wallet.\n\n<figure><img src=\"../../../.gitbook/assets/image (10).png\" alt=\"\"><figcaption></figcaption></figure>\n\nAnother way to get test tokens can be found [here](https://phat.phala.network) via the Phat UI.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1281, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0eaa648d-a6bd-4ef1-bf18-bb40a6e04e3a": {"__data__": {"id_": "0eaa648d-a6bd-4ef1-bf18-bb40a6e04e3a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5fcd07d3-db46-475b-86c4-fed2592fa40a", "node_type": "1", "metadata": {}, "hash": "567a655feda44ced81b90853d7065c035596e0f1bca3f60f149e38507ac79c0c", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83e\udec2 Connect Airstack Phat Contract to EVM Consumer Contract\n\nIn the previous section we described how the Airstack Starter Kit works. Let's revisit the diagram and description below.\n\n<figure><img src=\"../../../../.gitbook/assets/AirstackUserJourney (1).png\" alt=\"\"><figcaption></figcaption></figure>\n\nThe diagram above displays the user journey of (1) Alice requesting a trust score for Eve from the EVM Consumer Contract. When (2) a new action request is added to the queue, (3) the Phala Network Phat Contract will pop the action off the queue and perform the off-chain work to compute a trust score.\n\nFirst (4) the Phat Contract will create a `batchHttpRequest` to query 3 separate subgraph endpoints to determine if Eve has transacted on-chain with Alice, has a Lens Profile, has a Farcaster account, has a primary ENS Domain, and if Alice & Eve have common POAPs. Once this data is returned then (5) the Phat Contract will compute a score based on some scoring criteria. You can view the code [here](https://bit.ly/pc-airstack-repo). Lastly, (6) the trust score for Eve has been returned to the EVM Consumer Contract and Eve's score is set in the Consumer Contract's storage for anyone to query.\n\n## Getting Started\n\nIf you have not setup Airstack code repo locally, go back to the [Quick Start](quick-start.md) section and follow the initial setup steps.\n\n### Before Deployment\n\nBefore deploying, you will need to either export your Phala Account via polkadot.js extension or store your private key in the .env (optionally you can manually enter during deployment as well).\n\n**Option 1: Export Polkadot account as json file**\n\nGo to your browser and click on the polkadot.js extension. Select your account and click \"Export Account\". Next, you will be prompted for your password before saving the file to your project directory. **Note** this is what will be set to `POLKADOT_WALLET_ACCOUNT_PASSPHRASE`. Make sure to save the file as `polkadot-account.json` in the **root** of your project directory.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2007, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5fcd07d3-db46-475b-86c4-fed2592fa40a": {"__data__": {"id_": "5fcd07d3-db46-475b-86c4-fed2592fa40a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "0eaa648d-a6bd-4ef1-bf18-bb40a6e04e3a", "node_type": "1", "metadata": {}, "hash": "867ffa1a77a68c382ea3f1f90082d9b7c68277a15414fac6526f1eb76f7d3d71", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c2ffe13b-04b8-4953-8811-2b9316986787", "node_type": "1", "metadata": {}, "hash": "6357197c7f4b43c989433ebdf2fa6f79f20ac0445a7944581e87313db58ca4a4", "class_name": "RelatedNodeInfo"}}, "text": "<figure><img src=\"../../../../.gitbook/assets/image (5) (1).png\" alt=\"\"><figcaption></figcaption></figure>\n\n<figure><img src=\"../../../../.gitbook/assets/image (3) (1).png\" alt=\"\"><figcaption></figcaption></figure>\n\n<figure><img src=\"../../../../.gitbook/assets/image (4) (1).png\" alt=\"\"><figcaption></figcaption></figure>\n\n**Option 2: Set mnemonic phrase to `POLKADOT_WALLET_SURI`**\n\nAfter creating your Phala Profile, set your `.env` variable `POLKADOT_WALLET_SURI` to the mnemonic phrase from generating the new Polkadot Account.\n\nHere is a screenshot of how to set `POLKADOT_WALLET_SURI`:\n\n<figure><img src=\"../../../../.gitbook/assets/image (8).png\" alt=\"\"><figcaption></figcaption></figure>\n\n## Deployments (Local, Testnet, Mainnet)\n\nThis guide will be separated into 3 tabs including:\n\n* **Local**: Local Testnet Deployment\n* **Testnet**: PoC6 Testnet & EVM Chain Testnet Deployment\n* **Mainnet**: Phala Mainnet & EVM Chain Mainnet Deployment\n\n> **Secrets (**[**What are Secrets**](../featured-blueprints/handling-secrets.md)**?", "mimetype": "text/plain", "start_char_idx": 2009, "end_char_idx": 3044, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c2ffe13b-04b8-4953-8811-2b9316986787": {"__data__": {"id_": "c2ffe13b-04b8-4953-8811-2b9316986787", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5fcd07d3-db46-475b-86c4-fed2592fa40a", "node_type": "1", "metadata": {}, "hash": "567a655feda44ced81b90853d7065c035596e0f1bca3f60f149e38507ac79c0c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "71854785-92c0-4061-8701-c8fca24fc1df", "node_type": "1", "metadata": {}, "hash": "a71ae5b01c13027bcb46f6a00f025d3ed7c4c1d9a1fd998da98d2a37ecad5fcb", "class_name": "RelatedNodeInfo"}}, "text": "):**\n>\n> * `apiUrl` - The endpoint base URL to the separate subgraph endpoints hosted on Airstack\n> * `apiKey` - an [API key](get-an-airstack-api-key.md) created on Airstack\n>\n> ```\n> {\n>     \"apiUrl\": \"https://api.airstack.xyz/gql\",\n>     \"apiKey\": \"3a41775a358a4cb99ca9a29c1f6fc486\"\n> }\n> ```\n\n{% tabs %}\n{% tab title=\"Local\" %}\nIn the previous [Quick Start](quick-start.md) section, we installed the dependencies and ran 2 separate tests locally, but these tests were not run against a live local testnet.&#x20;\n\nThis section will describe the process of:\n\n* Start up a local hardhat node\n* Deploy the EVM Consumer Contract to the local testnet\n* Run the `@phala/fn watch` command to run a local instance of the Airstack Phat Contract\n* Simulate a sample request by executing `npm run localhost-push-request`\n* See the Airstack Phat Contract reply with a result to the EVM Consumer Contract\n\n### Testing Locally\n\nFirst step is to install the package dependencies with the following command:\n\n```bash\nnpm install\n```\n\nWith all the dependencies installed, we are ready to build Airstack Phat Contract.\n\n```bash\nnpx @phala/fn build\n```\n\nTo simulate the expected result locally, run the Phat Contract script now with this command:\n\n> Use `decode` and `encode` playground at [https://playground.ethers.org](https://playground.ethers.org).\n\n```bash\nnpx @phala/fn run dist/index.js -a 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000de1683287529b9b4c3132af8aad210644b259cfd '{\"apiUrl\": \"https://gateway.thegraph.com/api/\", \"apiKey\": \"cd22a01e5b7f9828cddcb52caf03ee79\"}'\n```\n\nHere is the expected output of this call where the encoded call will request a trust score result for the address `hashwarlock.eth`. The result is `16`.", "mimetype": "text/plain", "start_char_idx": 3044, "end_char_idx": 4809, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "71854785-92c0-4061-8701-c8fca24fc1df": {"__data__": {"id_": "71854785-92c0-4061-8701-c8fca24fc1df", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c2ffe13b-04b8-4953-8811-2b9316986787", "node_type": "1", "metadata": {}, "hash": "6357197c7f4b43c989433ebdf2fa6f79f20ac0445a7944581e87313db58ca4a4", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "09758bdf-b827-4e82-87ad-43609b41be27", "node_type": "1", "metadata": {}, "hash": "2bc89150b3ca7cce4882ec39e146b469c38210df28eebf49267dc64c3c6c6875", "class_name": "RelatedNodeInfo"}}, "text": "```bash\nnpx @phala/fn run dist/index.js -a 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000964256674e42d61f0ff84097e28f65311786ccb000000000000000000000000eaf55242a90bb3289db8184772b0b98562053559 '{\"apiUrl\": \"https://api.airstack.xyz/gql\", \"apiKey\": \"3a41775a358a4cb99ca9a29c1f6fc486\"}' \n\nhandle req: 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000964256674e42d61f0ff84097e28f65311786ccb000000000000000000000000eaf55242a90bb3289db8184772b0b98562053559\n[1]: 0x964256674E42D61f0fF84097E28f65311786ccB0 0xeaf55242a90bb3289dB8184772b0B98562053559\nRequest received for profile 0x964256674E42D61f0fF84097E28f65311786ccB0 0xeaf55242a90bb3289dB8184772b0B98562053559\nTokens Sent on ETH Check... Result [0]\nTokens Sent on ETH Check... Result [0]\nLens Profile Check... Result [7]\nFarcaster Account Check... Result [14]\nPrimary ENS Account.", "mimetype": "text/plain", "start_char_idx": 4811, "end_char_idx": 5723, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "09758bdf-b827-4e82-87ad-43609b41be27": {"__data__": {"id_": "09758bdf-b827-4e82-87ad-43609b41be27", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "71854785-92c0-4061-8701-c8fca24fc1df", "node_type": "1", "metadata": {}, "hash": "a71ae5b01c13027bcb46f6a00f025d3ed7c4c1d9a1fd998da98d2a37ecad5fcb", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5d50ca51-8d55-4c54-a0a0-1f33f2b8539c", "node_type": "1", "metadata": {}, "hash": "af896c85e8f63e53a404aad3865ca083eb80b57b77a922154117c342222f2fb7", "class_name": "RelatedNodeInfo"}}, "text": "Result [24]\nCommon POAPs Check... Result[24]\nresponse: 0,1,0x964256674E42D61f0fF84097E28f65311786ccB0,24\n{\"output\":\"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000964256674e42d61f0ff84097e28f65311786ccb00000000000000000000000000000000000000000000000000000000000000018\"}\n```\n\n#### Deploy a Local Hardhat Node\n\nNow that we have a simple understanding of the expected functionality of the Phat Contract, we can now take our tests to a local testnet. Here we will use Hardhat to deploy the EVM Consumer Contract then listen from new action requests and reply with built Phat Contract script.\n\nFirst we will start a local hardhat node.\n\n```sh\nnpm run localhost-node\n```\n\nWith our hardhat node running locally, we can now deploy the `OracleConsumerContract.sol` contract to the local hardhat network.\n\n```bash\nnpm run localhost-deploy\n```\n\n```bash\nnpm run localhost-deploy\n> the-graph-phat-contract@1.0.0 localhost-deploy\n> hardhat run --network localhost ./scripts/localhost/deploy.ts\n\nCompiled 18 Solidity files successfully (evm target: london).\nDeploying...\nDeployed { consumer: '0x5FbDB2315678afecb367f032d93F642f64180aa3' }\n```\n\nMake sure to copy the deployed contract address when you deploy your own contract locally. Note you contract address will be different than `0x5FbDB2315678afecb367f032d93F642f64180aa3`. We will now start watching the hardhat node deployed contract for any new requests from Airstack Phat Contract.", "mimetype": "text/plain", "start_char_idx": 5724, "end_char_idx": 7257, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5d50ca51-8d55-4c54-a0a0-1f33f2b8539c": {"__data__": {"id_": "5d50ca51-8d55-4c54-a0a0-1f33f2b8539c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "09758bdf-b827-4e82-87ad-43609b41be27", "node_type": "1", "metadata": {}, "hash": "2bc89150b3ca7cce4882ec39e146b469c38210df28eebf49267dc64c3c6c6875", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c0c506c7-1164-40c4-a5b4-2ccaff0f688e", "node_type": "1", "metadata": {}, "hash": "3b4238499c7341ebb249fa70bd5afc4bc2e7b5c571b97db88c9bdfc83e89b43a", "class_name": "RelatedNodeInfo"}}, "text": "```bash\nnpx @phala/fn watch 0x5FbDB2315678afecb367f032d93F642f64180aa3 artifacts/contracts/OracleConsumerContract.sol/OracleConsumerContract.json dist/index.js -a '{\"apiUrl\": \"https://api.airstack.xyz/gql\", \"apiKey\": \"3a41775a358a4cb99ca9a29c1f6fc486\"}'\n```\n\n```bash\nnpx @phala/fn watch 0x5FbDB2315678afecb367f032d93F642f64180aa3 artifacts/contracts/OracleConsumerContract.sol/OracleConsumerContract.json dist/index.js -a '{\"apiUrl\": \"https://api.airstack.xyz/gql\", \"apiKey\": \"3a41775a358a4cb99ca9a29c1f6fc486\"}'\nListening for OracleConsumerContract MessageQueued events...\n```\n\nLet\u2019s now make a new request and see what happens with the listener\u2019s output. In separate tab, you will push a request with the following.\n\n> **Note**: The file can be edited [here](https://github.com/Phala-Network/airstack-phat-contract/blob/010d9c1f8b28fd74328c1e4ef633f55a6850f2f9/scripts/localhost/push-request.ts#L16) where you can change the `target` address.\n\n```bash\nLOCALHOST_CONSUMER_CONTRACT_ADDRESS=0x5FbDB2315678afecb367f032d93F642f64180aa3 npm run localhost-push-request\n```\n\n```bash\nLOCALHOST_CONSUMER_CONTRACT_ADDRESS=0x5FbDB2315678afecb367f032d93F642f64180aa3 npm run localhost-push-request\n> the-graph-phat-contract@1.0.0 localhost-push-request\n> hardhat run --network localhost ./scripts/localhost/push-request.ts\n\nPushing a request.\nReceived event [ResponseReceived]: {\n  reqId: BigNumber { value: \"1\" },\n  target: '0x011c23b3AadAf3D4991f3aBeE262A34d18e9fdb5',", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c0c506c7-1164-40c4-a5b4-2ccaff0f688e": {"__data__": {"id_": "c0c506c7-1164-40c4-a5b4-2ccaff0f688e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5d50ca51-8d55-4c54-a0a0-1f33f2b8539c", "node_type": "1", "metadata": {}, "hash": "af896c85e8f63e53a404aad3865ca083eb80b57b77a922154117c342222f2fb7", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c0375d4d-28b2-4053-abfd-ab7383c4acf3", "node_type": "1", "metadata": {}, "hash": "87ab64e61c19f8fcb2f49a139cf4ec60987253b793ea505d3e0582a4172fac1f", "class_name": "RelatedNodeInfo"}}, "text": "value: BigNumber { value: \"70\" }\n}\n```\n\nIf you check back the tab where the Phat Contract is listening for new requests, the console log may look similar to below:\n\n```bash\nReceived event [MessageQueued]: {\n  tail: 0n,\n  data: '0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000964256674e42d61f0ff84097e28f65311786ccb000000000000000000000000eaf55242a90bb3289db8184772b0b98562053559'\n}\nhandle req: 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000964256674e42d61f0ff84097e28f65311786ccb000000000000000000000000eaf55242a90bb3289db8184772b0b98562053559\n[1]: 0x964256674E42D61f0fF84097E28f65311786ccB0 0xeaf55242a90bb3289dB8184772b0B98562053559\nRequest received for profile 0x964256674E42D61f0fF84097E28f65311786ccB0 0xeaf55242a90bb3289dB8184772b0B98562053559\nTokens Sent on ETH Check. Result [0]\nTokens Sent on ETH Check. Result [0]\nLens Profile Check. Result [7]\nFarcaster Account Check. Result [14]\nPrimary ENS Account.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c0375d4d-28b2-4053-abfd-ab7383c4acf3": {"__data__": {"id_": "c0375d4d-28b2-4053-abfd-ab7383c4acf3", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c0c506c7-1164-40c4-a5b4-2ccaff0f688e", "node_type": "1", "metadata": {}, "hash": "3b4238499c7341ebb249fa70bd5afc4bc2e7b5c571b97db88c9bdfc83e89b43a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "3ca8bbee-8f80-41da-ad5c-a03b4161564a", "node_type": "1", "metadata": {}, "hash": "05a5cd03d0fb9bdc6e359c0e4acb3d3b4ae56733bdc16465f5acbd9094a0b5cc", "class_name": "RelatedNodeInfo"}}, "text": "Result [24]\nCommon POAPs Check... Result[24]\nresponse: 0,1,0x964256674E42D61f0fF84097E28f65311786ccB0,24\nJS Execution output: 0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000964256674e42d61f0ff84097e28f65311786ccb00000000000000000000000000000000000000000000000000000000000000018\n```\n\n:tada: **Congratulations!**&#x20;\n\nYou've completed deploying and testing the Airstack Phat Contract successfully in a local testnet. Now let's move to deploying to an EVM Testnet and connecting a deployed Phat Contract on PoC6 Testnet to visualize how this works autonomously.\n{% endtab %}\n\n{% tab title=\"Testnet\" %}\n{% hint style=\"danger\" %}\n**Important**\n\nThis guide references the `mumbai` testnet chain.&#x20;\n\nThe`mumbai` testnet is [deprecated since 2024/04/08](https://polygon.technology/blog/introducing-the-amoy-testnet-for-polygon-pos), meaning the steps to deploy to a testnet will no longer work out of the box.\n\nYou can opt to use the [`amoy`](https://polygon.technology/blog/introducing-the-amoy-testnet-for-polygon-pos) testnet or any other EVM testnet instead.\n{% endhint %}\n\nIn the previous [Quick Start](quick-start.md) section, we installed the dependencies.", "mimetype": "text/plain", "start_char_idx": 9731, "end_char_idx": 10999, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "3ca8bbee-8f80-41da-ad5c-a03b4161564a": {"__data__": {"id_": "3ca8bbee-8f80-41da-ad5c-a03b4161564a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c0375d4d-28b2-4053-abfd-ab7383c4acf3", "node_type": "1", "metadata": {}, "hash": "87ab64e61c19f8fcb2f49a139cf4ec60987253b793ea505d3e0582a4172fac1f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "8c4c2de4-254c-4e0c-ba72-9e9f4198c034", "node_type": "1", "metadata": {}, "hash": "e28a55cff8a39f13a067b277b4babdcd4a68075eaa56486872afade757106bd3", "class_name": "RelatedNodeInfo"}}, "text": "Now it is time to deploy and test to an EVM public testnet.&#x20;\n\nThe following steps will be performed:\n\n* Deploy the EVM Consumer Contract to the target EVM chain\n  * The EVM Consumer Contract will request actions to be executed off-chain by the Phat Contract\n* Deploy Airstack Phat Contract to the Phala PoC6 Testnet\n  * Once deployed, update the `ATTESTOR_ROLE` in the EVM Consumer Contract to the `Attestor Address` in the Phat Contract 2.0 UI Dashboard\n* Send a `request(address target)` transaction to get a trust score about an EVM target address\n* See Airstack Phat Contract respond with an action reply with a score for the target address\n\n### Minimum Requirements\n\n* [ ] Create a [Phala Dashboard Profile](../create-a-dashboard-profile.md) on Phala PoC6 Testnet\n  * [ ] Add funds to the EVM Gas Account to pay TX fees on target EVM Testnet Chain\n* [ ] Finished the [Quick Start](quick-start.md)\n* [ ] (Recommended) Go through the `Local` tab deployment process\n* [ ] Burner Account for EVM Consumer Contract deployment\n\n### Deployment\n\nIn this example, we will use Polygon Mumbai Testnet as the target EVM Testnet Chain, but this can be changed to any EVM testnet of the developers choice.\n\n#### Install Dependencies & Compile Contracts <a href=\"#user-content-install-dependencies--compile-contracts\" id=\"user-content-install-dependencies--compile-contracts\"></a>\n\n```sh\n# install dependencies\n$ npm install\n\n# compile contracts\n$ npm run compile\n```\n\n#### Deploy to Polygon Mumbai Testnet <a href=\"#user-content-deploy-to-polygon-mumbai-testnet\" id=\"user-content-deploy-to-polygon-mumbai-testnet\"></a>\n\nWith the contracts successfully compiled, now we can begin deploying first to Polygon Mumbai Testnet. If you have not gotten `MATIC` for Mumbai Testnet then get `MATIC` from a [faucet](https://bit.ly/3ZyFoT3). Ensure to save the address after deploying the Consumer Contract because this address will be use in the \"Configure Client\" section of Phat Contract 2.0 UI.", "mimetype": "text/plain", "start_char_idx": 11000, "end_char_idx": 12982, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8c4c2de4-254c-4e0c-ba72-9e9f4198c034": {"__data__": {"id_": "8c4c2de4-254c-4e0c-ba72-9e9f4198c034", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "3ca8bbee-8f80-41da-ad5c-a03b4161564a", "node_type": "1", "metadata": {}, "hash": "05a5cd03d0fb9bdc6e359c0e4acb3d3b4ae56733bdc16465f5acbd9094a0b5cc", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "6ba1a58c-4941-4d99-974c-9b7df14b1912", "node_type": "1", "metadata": {}, "hash": "82045d02df59f991d74422e1bd1af3101c04f65fb72e2007e8481294e4250722", "class_name": "RelatedNodeInfo"}}, "text": "The deployed address will also be set to the environment variable `MUMBAI_CONSUMER_CONTRACT_ADDRESS`.\n\n<pre class=\"language-sh\"><code class=\"lang-sh\"><strong>npm run test-deploy\n</strong></code></pre>\n\n```sh\n# deploy contracts to testnet mumbai\nnpm run test-deploy\n# > the-graph-phat-contract@1.0.0 test-deploy\n# > hardhat run --network mumbai ./scripts/mumbai/deploy.ts\n#\n# Deploying...\n#\n# \ud83c\udf89 Your Consumer Contract has been deployed, check it out here: https://mumbai.polygonscan.com/address/0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355\n#\n# You also need to set up the consumer contract address in your .env file:\n#\n# MUMBAI_CONSUMER_CONTRACT_ADDRESS=0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355\n#\n# Done\n```\n\n#### **(Optional) Verify Contract on Polygon Mumbai Testnet**\n\nEnsure to update the `mumbai.arguments.ts` file with the constructor arguments used to instantiate the Consumer Contract. If you add additional parameters to the constructor function then make sure to update the `mumbai.arguments.ts` file.\n\n> **Note**: Your contract address will be different than `0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355` when verifying your contract. Make sure to get your actual contract address from the console log output after executing `npm run test-deploy`.\n\n```sh\nnpm run test-verify -- <MUMBAI_CONSUMER_CONTRACT_ADDRESS>\n```\n\n```sh\nnpm run test-verify -- 0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355\n# > the-graph-phat-contract@1.0.0 test-verify\n# > hardhat verify --network mumbai --constructor-args mumbai.arguments.ts 0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355\n#\n# Nothing to compile\n# No need to generate any newer typings.", "mimetype": "text/plain", "start_char_idx": 12983, "end_char_idx": 14609, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6ba1a58c-4941-4d99-974c-9b7df14b1912": {"__data__": {"id_": "6ba1a58c-4941-4d99-974c-9b7df14b1912", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "8c4c2de4-254c-4e0c-ba72-9e9f4198c034", "node_type": "1", "metadata": {}, "hash": "e28a55cff8a39f13a067b277b4babdcd4a68075eaa56486872afade757106bd3", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "1d0f5633-39cd-4d32-bef4-9fbed685153f", "node_type": "1", "metadata": {}, "hash": "d565826130b123d9c230f07c839febc83289f4bdb3f522fc9979af79701129ad", "class_name": "RelatedNodeInfo"}}, "text": "# Successfully submitted source code for contract\n# contracts/OracleConsumerContract.sol:OracleConsumerContract at 0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355\n# for verification on the block explorer. Waiting for verification result...\n#\n# Successfully verified contract OracleConsumerContract on Etherscan.\n# https://mumbai.polygonscan.com/address/0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355#code\n```\n\n#### Deploy Phat Contract to PoC6 Testnet <a href=\"#user-content-deploy-phat-contract-to-poc5-testnet\" id=\"user-content-deploy-phat-contract-to-poc5-testnet\"></a>\n\nFor customizing your Phat Contract, checkout Phat Contract custom configurations in [Cusomizing Your Phat Contract](../featured-blueprints/customizing-your-phat-contract.md) to learn more before deploying to PoC6 testnet.\n\nNow that are Phat Contract has built successfully, let's deploy to Phala PoC6 Testnet with the following command:\n\n```shell\n# If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn upload --coreSettings='{\"apiUrl\": \"https://api.airstack.xyz/gql\", \"apiKey\": \"3a41775a358a4cb99ca9a29c1f6fc486\"}'\n# If polkadot-account.json is in the root of project\nnpx @phala/fn upload -a ./polkadot-account.json --coreSettings='{\"apiUrl\": \"https://api.airstack.xyz/gql\", \"apiKey\": \"3a41775a358a4cb99ca9a29c1f6fc486\"}'\n```\n\nHere is the expected output:\n\n> Note: your contract IDs will vary and not be the same as the IDs below.\n\n```bash\nnpx @phala/fn upload -a ./polkadot-account.json --coreSettings='{\"apiUrl\": \"https://api.airstack.xyz/gql\", \"apiKey\": \"3a41775a358a4cb99ca9a29c1f6fc486\"}'\n# ?", "mimetype": "text/plain", "start_char_idx": 14610, "end_char_idx": 16235, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "1d0f5633-39cd-4d32-bef4-9fbed685153f": {"__data__": {"id_": "1d0f5633-39cd-4d32-bef4-9fbed685153f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "6ba1a58c-4941-4d99-974c-9b7df14b1912", "node_type": "1", "metadata": {}, "hash": "82045d02df59f991d74422e1bd1af3101c04f65fb72e2007e8481294e4250722", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "4f8eb095-f85d-465f-ba8e-0618196010ef", "node_type": "1", "metadata": {}, "hash": "c07c663a8479ef83ac700ce44e3018ed2e12cf82114b07157a7364f5af844e93", "class_name": "RelatedNodeInfo"}}, "text": "Please enter your client RPC URL https://polygon-mumbai.g.alchemy.com/v2/JLjOfWJycWFOA0kK_SJ4jLGjtXkMN1wc\n# ? Please enter your consumer address 0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355\n# ? Please Enter hahaha account password [hidden]\n# \u2713 Compiled successfully.\n# \u2713 Connected to the endpoint: wss://poc6.phala.network/ws\n#\n# You are connecting to a testnet.\n#\n# \u2713 Your Brick Profile contract ID: 0x2a9f9a07886e11e1c5d63a176e3f75253d6765aadb90beb112fb3e55f7c98ea8\n# \u2713 The ActionOffchainRollup contract has been instantiated: 0xc9b96a665c3f1730606760f056b78bbb493f31a2b5406f8dd19e138561177336\n# ? Please select an external account: [1] 0x20050cae178a72e7c5adc207a060a16e65bbb7cf. https://polygon-mumbai.g.alchemy.com/v2/JLjOfWJycWFOA0kK_SJ4jLGjtXkMN1wc\n# \u2713 Checking your settings\n# ? Please enter your project name My Phat Contract 6\n# \u2713 \ud83c\udf89 Your workflow has been added, you can check it out here: https://bricks.phala.network/workflows/0x2a9f9a07886e11e1c5d63a176e3f75253d6765aadb90beb112fb3e55f7c98ea8/6\n# Your Attestor address: 0x4a8e621202af9206959017c3795721f327f2ef28\n# Your WORKFLOW_ID: 6\n```\n\nGo to the PoC6 Testnet [Phat Contract 2.0 UI](https://bit.ly/3LHccmR) Dashboard and you can see your newly deployed Phat Contract.", "mimetype": "text/plain", "start_char_idx": 16236, "end_char_idx": 17467, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4f8eb095-f85d-465f-ba8e-0618196010ef": {"__data__": {"id_": "4f8eb095-f85d-465f-ba8e-0618196010ef", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "1d0f5633-39cd-4d32-bef4-9fbed685153f", "node_type": "1", "metadata": {}, "hash": "d565826130b123d9c230f07c839febc83289f4bdb3f522fc9979af79701129ad", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5f0e0039-4a54-4216-abdd-ce9a7cb0e837", "node_type": "1", "metadata": {}, "hash": "943e9ba5519fab83b974d15d6d70b76f4a6b2d77359f7220664ae8a2a1129628", "class_name": "RelatedNodeInfo"}}, "text": "<figure><img src=\"../../../../.gitbook/assets/DeployedTheGraphPC.png\" alt=\"\"><figcaption></figcaption></figure>\n\n#### **Interact with Consumer Contract on Polygon Mumbai**\n\nTest Consumer Contract on Mumbai with a few tests to check for malformed requests failures, successful requests, and set the attestor.\n\n```sh\nnpm run test-set-attestor\n```\n\n```sh\nnpm run test-set-attestor\n# > the-graph-phat-contract@1.0.0 test-set-attestor\n# > hardhat run --network mumbai ./scripts/mumbai/set-attestor.ts\n#\n# Setting attestor...\n# \ud83d\udea8NOTE\ud83d\udea8\n# Make sure to set the Consumer Contract Address in your Phat Contract 2.0 UI dashboard (https://bricks.phala.network)\n# - Go to the 'Configuration' tab and update the 'Client' box\n# - Set value to 0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355\n# Done\n```\n\nTest pushing a malform request.\n\n```sh\nnpm run test-push-malformed-request\n```\n\n```sh\nnpm run test-push-malformed-request\n# > the-graph-phat-contract@1.0.0 test-push-malformed-request\n# > hardhat run --network mumbai ./scripts/mumbai/push-malformed-request.ts\n#\n# Pushing a malformed request...\n# Done\n```\n\nWe can visualize the response from the Phat Contract in the block explorer.\n\n<figure><img src=\"../../../../.gitbook/assets/malformreq-thegraph-pc.png\" alt=\"\"><figcaption></figcaption></figure>\n\nTest pushing a valid request.\n\n```sh\nnpm run test-push-request\n```\n\n```sh\nnpm run test-push-request\n# Pushing a request...\n# Done\n# \u2728  Done in 2.97s.\n```\n\nThe next 2 images will show the request to the Consumer Contract with a reply from the Phat Contract, and the last picture shows what the Phat Contract replied with.", "mimetype": "text/plain", "start_char_idx": 17469, "end_char_idx": 19072, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5f0e0039-4a54-4216-abdd-ce9a7cb0e837": {"__data__": {"id_": "5f0e0039-4a54-4216-abdd-ce9a7cb0e837", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "4f8eb095-f85d-465f-ba8e-0618196010ef", "node_type": "1", "metadata": {}, "hash": "c07c663a8479ef83ac700ce44e3018ed2e12cf82114b07157a7364f5af844e93", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "004cc633-2261-4ba4-8596-4448dcbed85b", "node_type": "1", "metadata": {}, "hash": "451294148764362283676ec56aa711f20c1d1296ddc93cf1e215d55b89a9b6a8", "class_name": "RelatedNodeInfo"}}, "text": "<figure><img src=\"../../../../.gitbook/assets/push-request-thegraph.png\" alt=\"\"><figcaption></figcaption></figure>\n\nHere is the emitted event `ResponseReceived` with the score `70` for `target` address `0x011c23b3AadAf3D4991f3aBeE262A34d18e9fdb5.`\n\n<figure><img src=\"../../../../.gitbook/assets/thegraph-pc-reply-info.png\" alt=\"\"><figcaption></figcaption></figure>\n\n#### Update Phat Contract on Phala PoC6 Testnet <a href=\"#user-content-update-phat-contract-on-phala-poc5-testnet\" id=\"user-content-update-phat-contract-on-phala-poc5-testnet\"></a>\n\nSometimes you may have had a bug in your script or you want to test things out on the fly without deploying a whole new Phat Contract. The `npx @phala/fn update` command will update your Phat Contract easily in the command line.&#x20;\n\nNow let's update the Phat Contract:\n\n```bash\n# If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn update\n# If polkadot-account.json is in the root of project\nnpx @phala/fn update -a ./polkadot-account.json\n```\n\n```bash\nnpx @phala/fn update -a ./polkadot-account.json\n# ? Please Enter hahaha account password [hidden]\n# \u2713 Compiled successfully.\n# \u2713 Connected to the endpoint: wss://poc6.phala.network/ws\n#\n# You are connecting to a testnet.\n#\n# \u2713 Your Brick Profile contract ID: 0x2a9f9a07886e11e1c5d63a176e3f75253d6765aadb90beb112fb3e55f7c98ea8\n# \u2713 The JavaScript code for workflow 6 has been updated.\n```\n\n:tada: **Congratulations!** You have now completed a full testnet deployment and have a fully functional Phat Contract connected to Airstack to compute a score and return to your EVM Consumer Contract.", "mimetype": "text/plain", "start_char_idx": 19074, "end_char_idx": 20731, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "004cc633-2261-4ba4-8596-4448dcbed85b": {"__data__": {"id_": "004cc633-2261-4ba4-8596-4448dcbed85b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5f0e0039-4a54-4216-abdd-ce9a7cb0e837", "node_type": "1", "metadata": {}, "hash": "943e9ba5519fab83b974d15d6d70b76f4a6b2d77359f7220664ae8a2a1129628", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "6c647c1e-824e-41df-b594-693c6dd1e923", "node_type": "1", "metadata": {}, "hash": "bb7e32d78f4e279c3d46e9261aff84f90604f454307b97815d77cdfd58b465b1", "class_name": "RelatedNodeInfo"}}, "text": "The steps for mainnet deployment are nearly identical, but let's take a look at the process in the `Mainnet` tab.\n{% endtab %}\n\n{% tab title=\"Mainnet\" %}\nIn the previous `Testnet` tab, you went through the full deployment process to connect Airstack Phat Contract to a Consumer Contract on an EVM Testnet Chain. Now it is time to take these talents to **Mainnet** :sunglasses:.&#x20;\n\nThe following steps will be performed:\n\n* Deploy the EVM Consumer Contract to the target EVM  Mainnet chain\n  * The EVM Consumer Contract will request actions to be executed off-chain by the Phat Contract\n* Deploy Airstack Phat Contract to the Phala Mainnet\n  * Once deployed, update the `ATTESTOR_ROLE` in the EVM Consumer Contract to the `Attestor Address` in the Phat Contract 2.0 UI Dashboard\n* Send a `request(address target)` transaction to get a trust score about an EVM target address\n* See Airstack Phat Contract respond with an action reply with a score for the target address\n\n### Minimum Requirements\n\n* [ ] Create a [Phala Dashboard Profile](../create-a-dashboard-profile.md) on Phala Mainnet\n  * [ ] Add funds to the EVM Gas Account to pay TX fees on target EVM Mainnet Chain\n* [ ] Finished the [Quick Start](quick-start.md)\n* [ ] (Recommended) Go through the `Local` AND `Testnet` tabs to understand the deployment process fully\n* [ ] Burner Account for EVM Consumer Contract deployment\n\n### Deployment\n\nIn this example, we will use Polygon PoS Mainnet as the target EVM Mainnet Chain, but this can be changed to any EVM chain of the developer's choice.\n\n#### Install Dependencies & Compile Contracts <a href=\"#user-content-install-dependencies--compile-contracts\" id=\"user-content-install-dependencies--compile-contracts\"></a>\n\n```sh\n# install dependencies\n$ npm install\n\n# compile contracts\n$ npm run compile\n```\n\n#### Deploy to Polygon Mainnet <a href=\"#user-content-deploy-to-polygon-mumbai-testnet\" id=\"user-content-deploy-to-polygon-mumbai-testnet\"></a>\n\nWith the contracts successfully compiled, now we can begin deploying first to Polygon PoS Mainnet.", "mimetype": "text/plain", "start_char_idx": 20732, "end_char_idx": 22791, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6c647c1e-824e-41df-b594-693c6dd1e923": {"__data__": {"id_": "6c647c1e-824e-41df-b594-693c6dd1e923", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "004cc633-2261-4ba4-8596-4448dcbed85b", "node_type": "1", "metadata": {}, "hash": "451294148764362283676ec56aa711f20c1d1296ddc93cf1e215d55b89a9b6a8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "328111e6-56f2-4362-8668-ba4286a747e5", "node_type": "1", "metadata": {}, "hash": "66a18ea74af3b6a99e68b5227fdd9c7e7281595fe80e131db87348d963e249bb", "class_name": "RelatedNodeInfo"}}, "text": "If you have not gotten `MATIC` then get `MATIC` from an exchange or through their [Wallet Suite](https://wallet.polygon.technology/). Ensure to save the address after deploying the Consumer Contract because this address will be use in the \"Configure Client\" section of Phat Contract 2.0 UI. The deployed address will also be set to the environment variable `POLYGON_CONSUMER_CONTRACT_ADDRESS`.\n\n<pre class=\"language-sh\"><code class=\"lang-sh\"><strong>npm run main-deploy\n</strong></code></pre>\n\n```sh\n# deploy contracts to Polygon PoS mainnet\nnpm run main-deploy\n# > the-graph-phat-contract@1.0.0 main-deploy\n# > hardhat run --network polygon ./scripts/polygon/deploy.ts\n#\n# Deploying...\n#\n# \ud83c\udf89 Your Consumer Contract has been deployed, check it out here: https://polygonscan.com/address/0x0b9aC89924483077899d2B52bc8AF794F546a1e9\n#\n# You also need to set up the consumer contract address in your .env file:\n#\n# POLYGON_CONSUMER_CONTRACT_ADDRESS=0x0b9aC89924483077899d2B52bc8AF794F546a1e9\n# \n# Done\n```\n\n#### **(Optional) Verify Contract on Polygon Mainnet**\n\nEnsure to update the `polygon.arguments.ts` file with the constructor arguments used to instantiate the Consumer Contract. If you add additional parameters to the constructor function then make sure to update the `polygon.arguments.ts` file.\n\n> **Note**: Your contract address will be different than `0x0b9aC89924483077899d2B52bc8AF794F546a1e9` when verifying your contract. Make sure to get your actual contract address from the console log output after executing `npm run main-deploy`.", "mimetype": "text/plain", "start_char_idx": 22792, "end_char_idx": 24337, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "328111e6-56f2-4362-8668-ba4286a747e5": {"__data__": {"id_": "328111e6-56f2-4362-8668-ba4286a747e5", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "6c647c1e-824e-41df-b594-693c6dd1e923", "node_type": "1", "metadata": {}, "hash": "bb7e32d78f4e279c3d46e9261aff84f90604f454307b97815d77cdfd58b465b1", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "6829efe5-25fe-40cf-8fcb-348f94b6f3ce", "node_type": "1", "metadata": {}, "hash": "b839f4c0e05a2ff31b76908f6798ec9a1ca3b85bd46aae6b028e84eec25cb1ba", "class_name": "RelatedNodeInfo"}}, "text": "```sh\nnpm run main-verify -- <MUMBAI_CONSUMER_CONTRACT_ADDRESS>\n```\n\n```sh\nnpm run main-verify -- 0x0b9aC89924483077899d2B52bc8AF794F546a1e9\n# > the-graph-phat-contract@1.0.0 main-verify\n# > hardhat verify --network polygon --constructor-args polygon.arguments.ts 0x0b9aC89924483077899d2B52bc8AF794F546a1e9\n#\n# Nothing to compile\n# No need to generate any newer typings.\n# Successfully submitted source code for contract\n# contracts/OracleConsumerContract.sol:OracleConsumerContract at 0x0b9aC89924483077899d2B52bc8AF794F546a1e9\n# for verification on the block explorer. Waiting for verification result...\n#\n# Successfully verified contract OracleConsumerContract on Etherscan.\n# https://polygonscan.com/address/0x0b9aC89924483077899d2B52bc8AF794F546a1e9#code\n```\n\n#### Deploy Phat Contract to Phala Mainnet <a href=\"#user-content-deploy-phat-contract-to-poc5-testnet\" id=\"user-content-deploy-phat-contract-to-poc5-testnet\"></a>\n\nFor customizing your Phat Contract, checkout Phat Contract custom configurations in [Customizing Your Phat Contract ](../featured-blueprints/customizing-your-phat-contract.md)to learn more before deploying to Phala Mainnet.", "mimetype": "text/plain", "start_char_idx": 24339, "end_char_idx": 25492, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6829efe5-25fe-40cf-8fcb-348f94b6f3ce": {"__data__": {"id_": "6829efe5-25fe-40cf-8fcb-348f94b6f3ce", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "328111e6-56f2-4362-8668-ba4286a747e5", "node_type": "1", "metadata": {}, "hash": "66a18ea74af3b6a99e68b5227fdd9c7e7281595fe80e131db87348d963e249bb", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "8f3ddd7c-e54e-4bbf-9abe-f2aed45c625d", "node_type": "1", "metadata": {}, "hash": "097250894e93b6cf2b271829c649d472cfff0922421597ecd75d3ecfec2d042f", "class_name": "RelatedNodeInfo"}}, "text": "Now that are Phat Contract has built successfully, let's deploy to Phala Mainnet with the following command:\n\n<pre class=\"language-shell\"><code class=\"lang-shell\"># If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn upload --mode=production --coreSettings='{\"apiUrl\": \"https://api.airstack.xyz/gql\", \"apiKey\": \"3a41775a358a4cb99ca9a29c1f6fc486\"}'\n# If polkadot-account.json is in the root of project\n<strong>npx @phala/fn upload --mode=production -a ./polkadot-account.json --coreSettings='{\"apiUrl\": \"https://api.airstack.xyz/gql\", \"apiKey\": \"3a41775a358a4cb99ca9a29c1f6fc486\"}'\n</strong></code></pre>\n\nHere is the expected output:\n\n> Note: your contract IDs will vary and not be the same as the IDs below.\n\n```bash\nnpx @phala/fn upload --mode=production -a ./polkadot-account.json --coreSettings='{\"apiUrl\": \"https://api.airstack.xyz/gql\", \"apiKey\": \"3a41775a358a4cb99ca9a29c1f6fc486\"}'\n# ? Please enter your client RPC URL https://polygon-mainnet.g.alchemy.com/v2/UZpqlxsFm0aVm_euopH95rQ6YxiRa3VC\n# ? Please enter your consumer address 0x0b9aC89924483077899d2B52bc8AF794F546a1e9\n# ? Please Enter hahaha account password [hidden]\n# \u2713 Compiled successfully.", "mimetype": "text/plain", "start_char_idx": 25494, "end_char_idx": 26717, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8f3ddd7c-e54e-4bbf-9abe-f2aed45c625d": {"__data__": {"id_": "8f3ddd7c-e54e-4bbf-9abe-f2aed45c625d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "6829efe5-25fe-40cf-8fcb-348f94b6f3ce", "node_type": "1", "metadata": {}, "hash": "b839f4c0e05a2ff31b76908f6798ec9a1ca3b85bd46aae6b028e84eec25cb1ba", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "48f7a985-7632-413f-a701-c077fae4455f", "node_type": "1", "metadata": {}, "hash": "9c4ad978a4bd56baf0fe5e1b47c92ed9433b11d22650b0c22c5d2154fbe2e571", "class_name": "RelatedNodeInfo"}}, "text": "# \u2713 Connected to the endpoint: wss://api.phala.network/ws\n# \u2713 Your Brick Profile contract ID: 0x6e96d8c209fc14b69533e3627c4766b6eeef8f77a25348b2d77b28c90b0bd012\n# \u2713 The ActionOffchainRollup contract has been instantiated: 0xe2ac2edc835de67f71f76ef686ebb4e48bdf0c2da2b6862329cca00c3c9b8349\n# ? Please select an external account: [0] 0x8438ce1a6196b7edae83cbc2a58d33db6fae6bee. https://polygon-mainnet.g.alchemy.com/v2/W1kyx17tiFQFT2b19mGOqppx90BLHp0a\n# \u2713 Checking your settings\n# ? Please enter your project name My Phat Contract 0\n# \u2713 \ud83c\udf89 Your workflow has been added, you can check it out here: https://bricks.phala.network/workflows/0x6e96d8c209fc14b69533e3627c4766b6eeef8f77a25348b2d77b28c90b0bd012/0\n# Your Attestor address: 0x2829d70d48516b7d1be2b5f5f424b41ce4da8056\n# Your WORKFLOW_ID: 0\n```\n\nGo to the [Phat Contract 2.0 Dashboard](https://bit.ly/3LHccmR) and you can see your newly deployed Phat Contract.\n\n<figure><img src=\"../../../../.gitbook/assets/deploy-thegraph-main.png\" alt=\"\"><figcaption></figcaption></figure>\n\n#### **Interact with Consumer Contract on Polygon PoS Mainnet**\n\nConsumer Contract on Mumbai with a few transactions to set the attestor, check for malformed requests failures, and successfully fulfilled requests.", "mimetype": "text/plain", "start_char_idx": 26718, "end_char_idx": 27959, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "48f7a985-7632-413f-a701-c077fae4455f": {"__data__": {"id_": "48f7a985-7632-413f-a701-c077fae4455f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "8f3ddd7c-e54e-4bbf-9abe-f2aed45c625d", "node_type": "1", "metadata": {}, "hash": "097250894e93b6cf2b271829c649d472cfff0922421597ecd75d3ecfec2d042f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ea61934e-26f3-48ef-a810-965ca2b9498e", "node_type": "1", "metadata": {}, "hash": "361a020327b01210180f5171d5d433207224e56d198c146c7b8f127424b00c28", "class_name": "RelatedNodeInfo"}}, "text": "```sh\nnpm run main-set-attestor\n```\n\n<pre class=\"language-sh\"><code class=\"lang-sh\">npm run main-set-attestor\n<strong># > the-graph-phat-contract@1.0.0 main-set-attestor\n</strong># > hardhat run --network polygon ./scripts/polygon/set-attestor.ts\n#\n# Setting attestor...\n# \ud83d\udea8NOTE\ud83d\udea8\n# Make sure to set the Consumer Contract Address in your Phat Contract 2.0 UI dashboard (https://bricks.phala.network)\n# - Go to the 'Configuration' tab and update the 'Client' box\n# - Set value to 0x0b9aC89924483077899d2B52bc8AF794F546a1e9\n# Done\n</code></pre>\n\nTry pushing a malform request to ensure failures behave appropriately.\n\n```sh\nnpm run main-push-malformed-request\n```\n\n```sh\nnpm run main-push-malformed-request\n# > the-graph-phat-contract@1.0.0 main-push-malformed-request\n# > hardhat run --network polygon ./scripts/polygon/push-malformed-request.ts\n#\n# Pushing a malformed request...\n# Done\n```\n\nWe can visualize the response from the Phat Contract in the Polygonscan block explorer.\n\n<figure><img src=\"../../../../.gitbook/assets/malform-request-pc-main.png\" alt=\"\"><figcaption></figcaption></figure>\n\nTest pushing a valid request that will get a valid reply of a trust score value for a `target` address.\n\n```sh\nnpm run main-push-request\n```\n\n```sh\nnpm run main-push-request\n# > the-graph-phat-contract@1.0.0 main-push-request\n# > hardhat run --network polygon ./scripts/polygon/push-request.ts\n#\n# Pushing a request...\n# Done\n```\n\nThe next 2 images will show the request to the Consumer Contract with a reply from the Phat Contract, and the last picture shows what the Phat Contract replied with.", "mimetype": "text/plain", "start_char_idx": 27961, "end_char_idx": 29555, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ea61934e-26f3-48ef-a810-965ca2b9498e": {"__data__": {"id_": "ea61934e-26f3-48ef-a810-965ca2b9498e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "48f7a985-7632-413f-a701-c077fae4455f", "node_type": "1", "metadata": {}, "hash": "9c4ad978a4bd56baf0fe5e1b47c92ed9433b11d22650b0c22c5d2154fbe2e571", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "4b79c314-1c0e-4e31-9b16-5fbcb5fab11b", "node_type": "1", "metadata": {}, "hash": "ed8eed8cbb2f40d6e7de3e736252385519027b4c6f0d99c08e3217ec32321512", "class_name": "RelatedNodeInfo"}}, "text": "<figure><img src=\"../../../../.gitbook/assets/push-request-thegraph-main.png\" alt=\"\"><figcaption></figcaption></figure>\n\nHere is the emitted event `ResponseReceived` with the score `206` for `target` address `0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045` (aka vitalik.eth)\n\n<figure><img src=\"../../../../.gitbook/assets/thegraph-pc-reply-info-vitalik.png\" alt=\"\"><figcaption></figcaption></figure>\n\n#### Update Phat Contract on Phala Mainnet <a href=\"#user-content-update-phat-contract-on-phala-poc5-testnet\" id=\"user-content-update-phat-contract-on-phala-poc5-testnet\"></a>\n\nSometimes you may have had a bug in your script or you want to test things out on the fly without deploying a whole new Phat Contract. The `npx @phala/fn update` command will update your Phat Contract easily in the command line.&#x20;\n\nNow let's update the Phat Contract:\n\n```bash\n# If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn update --mode=production\n# If polkadot-account.json is in the root of project\nnpx @phala/fn update --mode=production -a ./polkadot-account.json\n```\n\n<pre class=\"language-bash\"><code class=\"lang-bash\">npx @phala/fn update --mode=production -a ./polkadot-account.json\n<strong># ? Please Enter hahaha account password [hidden]\n</strong># \u2713 Compiled successfully.\n# \u2713 Connected to the endpoint: wss://api.phala.network/ws\n# \u2713 Your Brick Profile contract ID: 0x6e96d8c209fc14b69533e3627c4766b6eeef8f77a25348b2d77b28c90b0bd012\n# \u2713 The JavaScript code for workflow 0 has been updated.\n</code></pre>\n\n:tada: **Congratulations!** You have now completed a full mainnet deployment and have a fully functional Phat Contract connected to Airstack to compute a score and return to your EVM Consumer Contract.", "mimetype": "text/plain", "start_char_idx": 29557, "end_char_idx": 31324, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4b79c314-1c0e-4e31-9b16-5fbcb5fab11b": {"__data__": {"id_": "4b79c314-1c0e-4e31-9b16-5fbcb5fab11b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad", "node_type": "4", "metadata": {}, "hash": "ec75d52b15171f90778c54bbdbc79bf2b5540fef3b32bfc53415c153b769eccc", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ea61934e-26f3-48ef-a810-965ca2b9498e", "node_type": "1", "metadata": {}, "hash": "361a020327b01210180f5171d5d433207224e56d198c146c7b8f127424b00c28", "class_name": "RelatedNodeInfo"}}, "text": "{% endtab %}\n{% endtabs %}", "mimetype": "text/plain", "start_char_idx": 31325, "end_char_idx": 31351, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f0e87cc5-2e2b-4b81-9dd1-0bb66aec88e0": {"__data__": {"id_": "f0e87cc5-2e2b-4b81-9dd1-0bb66aec88e0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/blockchain-entities.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f3c032c1-9905-468b-accf-e95821366a3a", "node_type": "4", "metadata": {}, "hash": "4ae86b0f4f3172e9790f172892ea0ecbbadc15f71c24dfc50d06e4a9c66ac22f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f87b0d55-80b0-4c89-9bd2-2107672e6235", "node_type": "1", "metadata": {}, "hash": "f92b890c45bf45d7d6930dd7cc6d327876fa3692a4b20c589a0cec6b35f21e5d", "class_name": "RelatedNodeInfo"}}, "text": "# Blockchain Entities\n\n## Overview <a href=\"#overview\" id=\"overview\"></a>\n\nThe last chapter covered Phala\u2019s architecture, whereas this page will touch on Phala\u2019s entities and the types of nodes that make Phala Network.\n\nIn Phala Network, there are three kinds of entities:\n\n* _Client_, which operates on normal devices without any special hardware requirements;\n* _Worker_, which operates on Secure Enclave and serves as the computation nodes for confidential smart contracts;\n* _Gatekeeper_, which operates on Secure Enclave and serves as the authorities and key managers;\n\nThe image below visualizes the interaction between Phala\u2019s entities.\n\n<figure><img src=\"../../.gitbook/assets/phala-design.png\" alt=\"\"><figcaption></figcaption></figure>\n\nThe basic design of Phala Network is meant to ensure the security and confidentiality of the blockchain and its Phat Contract. However, with more security improvements, Phala Network can defend against advanced attacks.\n\n## Entity Key Initialization <a href=\"#entity-key-initialization\" id=\"entity-key-initialization\"></a>\n\nIn Phala, the communication between any entity should be encrypted, so each entity generates the following entity key pairs with a pseudorandom number generator during initialization:\n\n1. `IdentityKey`\n   * an `sr25519` key pair to uniquely identify an entity;\n2. `EcdhKey`\n   * an `sr25519` key pair for secure communication;\n\n#### pRuntime Initialization <a href=\"#pruntime-initialization\" id=\"pruntime-initialization\"></a>\n\nDuring initialization, `pRuntime` automatically generates the entity key pairs above with a random number generator. The generated key pairs are managed in `pRuntime` in the Secure Enclave, which means the workers and gatekeepers can only use it with the limited APIs exported by `pRuntime`, and can never gain the plaintext key pairs to read the encrypted data out of the Secure Enclave.\n\nThe generated key pairs can be locally encrypted and cached on the disk with [Sealing](https://sgx101.gitbook.io/sgx101/sgx-bootstrap/sealing) and decrypted and loaded when restarting. This applies to both gatekeepers and workers.\n\n### Secure Communication Channels <a href=\"#secure-communication-channels\" id=\"secure-communication-channels\"></a>\n\nThe `EcdhKey` public key in the `pRuntime` of a worker or gatekeeper is publicly available.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2326, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f87b0d55-80b0-4c89-9bd2-2107672e6235": {"__data__": {"id_": "f87b0d55-80b0-4c89-9bd2-2107672e6235", "embedding": null, "metadata": {"file_path": "phala-docs_dist/blockchain-entities.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f3c032c1-9905-468b-accf-e95821366a3a", "node_type": "4", "metadata": {}, "hash": "4ae86b0f4f3172e9790f172892ea0ecbbadc15f71c24dfc50d06e4a9c66ac22f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f0e87cc5-2e2b-4b81-9dd1-0bb66aec88e0", "node_type": "1", "metadata": {}, "hash": "9c2bbc43489814155bb5560194f51c7086e952b8e1ee7515a011c154dd531a8a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "39139ae0-d787-4ea4-9dde-fb5915be0211", "node_type": "1", "metadata": {}, "hash": "fae9e534e0c777034ae1e52b2d696f4b96fa6dbd8e6d1acbc423934b765047d2", "class_name": "RelatedNodeInfo"}}, "text": "Therefore an [ECDH key agreement protocol](https://wiki.openssl.org/index.php/Elliptic\\_Curve\\_Diffie\\_Hellman) can be applied to establish a secure communication channel between a worker (or a gatekeeper) and any other entity non-interactively.\n\nA channel between two entities, `A` and `B` is denoted as $$Channel(Pk_A, Pk_B)$$, where $$Pk_A$$ and $$Pk_B$$ are the public keys of their ECDH key pairs correspondingly. A shared secret can be derived from one\u2019s ECDH private key and the counterpart\u2019s public key via the Diffie Hellman algorithm. Then the final communication key `CommKey(A, B)` can be calculated via a one-way function. Finally, `CommKey(A, B)` is used to encrypt the messages between the two entities.\n\n> In Khala, the `EcdhKey` is an `sr25519` key pair. We can adopt the [child key derivation (CKD) functions](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki#child-key-derivation-ckd-functions) from Bitcoin BIP32 to derive `CommKey(A, B)` from the key agreed by ECDH.\n>\n> The messages are end-to-end encrypted with `aes-gcm-256`.\n\nThe public keys of the entities are registered on-chain. So we can build on-chain or off-chain communication channels:\n\n* On-chain Communication\n  1. Both `A` and `B` know each other\u2019s public keys from the blockchain. They can derives `CommKey(A, B)`;\n  2. `A` posts a cipher message encrypted by `CommKey(A, B)` to the blockchain;\n  3. `B` receives it, and decrypts it with `CommKey(A, B)`;\n* Off-chain (`A` is off-chain and `B` is an on-chain worker) Communication\n  1. `A` can learn `B`\u2019s public key from the blockchain and derive `CommKey(A, B)`;\n  2. `A` learns the API endpoint of `B` from its `WorkerInfo` in `WorkerState` on chain;\n  3.", "mimetype": "text/plain", "start_char_idx": 2327, "end_char_idx": 4035, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "39139ae0-d787-4ea4-9dde-fb5915be0211": {"__data__": {"id_": "39139ae0-d787-4ea4-9dde-fb5915be0211", "embedding": null, "metadata": {"file_path": "phala-docs_dist/blockchain-entities.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f3c032c1-9905-468b-accf-e95821366a3a", "node_type": "4", "metadata": {}, "hash": "4ae86b0f4f3172e9790f172892ea0ecbbadc15f71c24dfc50d06e4a9c66ac22f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f87b0d55-80b0-4c89-9bd2-2107672e6235", "node_type": "1", "metadata": {}, "hash": "f92b890c45bf45d7d6930dd7cc6d327876fa3692a4b20c589a0cec6b35f21e5d", "class_name": "RelatedNodeInfo"}}, "text": "`A` sends a signed cipher message (encrypted by `CommKey(A, B)`) with its public key to `B` directly;\n  4. `B` gets `A`\u2019s public key from the message, and derives `CommKey(A, B)` to decrypt it;\n\n### Client-worker Payload Example <a href=\"#client-worker-payload-example\" id=\"client-worker-payload-example\"></a>\n\nA client communicates with a worker only for contract invocation. An invocation consists of at least the following payloads.\n\n```\n{\n    from: Client_IdentityKey,\n    payload: {\n        to: Contract_IdentityKey,\n        input: \"0xdeadbeef\",\n    },\n    nonce: 12345,\n    sig: UserSignature,\n}\n```\n\n* `nonce` is necessary for defending against Double-spend and Replay Attacks.\n* `from` shows the identity of the caller, and can be verified with `sig`. `from` will be further passed to the contract.\n* Since a worker can run multiple contracts (or even different instances of the same contract), `to` is needed to specify the invocation target.\n* `input` encodes the invoked function and arguments, it should be serialized according to the ABI of contracts.\n\n## Serialization <a href=\"#serialization\" id=\"serialization\"></a>\n\n> #### `EcdhKey` Rotation <a href=\"#ecdhkey-rotation\" id=\"ecdhkey-rotation\"></a>\n>\n> Unlike the `IdentityKey` which shows the identity of a worker or gatekeeper thus should not be changed, we recommend a regular rotation of the `EcdhKey` to ensure the security of the communication channels between different entities. In the future, `pRuntime` will automatically rotate the managed `EcdhKey` key after certain time interval.", "mimetype": "text/plain", "start_char_idx": 4036, "end_char_idx": 5594, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "313c4042-1b79-4b14-8a7d-22585abb5234": {"__data__": {"id_": "313c4042-1b79-4b14-8a7d-22585abb5234", "embedding": null, "metadata": {"file_path": "phala-docs_dist/wrappedbalances-and-w-pha.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "01b25634-c273-42f2-8e77-1391bca42203", "node_type": "4", "metadata": {}, "hash": "51361e12ef654c5280ea70bd3966b221d97b1ad386803f7503ab86c0ef3f58ca", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "1e406d39-7cff-4960-8462-30cae67f3dd6", "node_type": "1", "metadata": {}, "hash": "4dcf7e1f323c89489a408aa7eff2230574bf7e9019b0649a2402f4f22fbba6c0", "class_name": "RelatedNodeInfo"}}, "text": "# WrappedBalances & W-PHA\n\nWrappedBalances is the name of a pallet with the function of wrapping W-PHA to delegate. And it also has the role of bookkeeping, which will record the total value of the Delegation and W-PHA in the address, and can help the user to cast a governance vote that does not exceed this total value.\n\nW-PHA (Wrapped PHA) is the token that users use PHA to wrap from WrappedBalances 1-to-1. Used to contribute to StakePool or Vault to obtain Delegation NFT and earn delegation rewards.\n\n## Why do we need W-PHA <a href=\"#why-do-we-need-w-pha\" id=\"why-do-we-need-w-pha\"></a>\n\nIn the StakePool V1, the PHA could be used as a delegation. While delegated in the StakePool, the Delegator can also use it for daily community governance voting. Because when you delegate your PHA to the StakePool, the status of the token will be adjusted to \u201clocked\u201d, but it will remain in your address. Then you can use it for governance voting. This logic caused the Delegation to be unable to be transferred or traded.\n\nIn the process of NFTization of the Delegation, to improve the liquidity of the Delegation, we hope to set the NFTs in a tradable state and use a suitable mechanism to give these Delegation NFTs governance voting rights.\n\nTherefore, we need to introduce the concept of WrappedBalances and W-PHA.\n\n## How does it work <a href=\"#how-does-it-work\" id=\"how-does-it-work\"></a>\n\nW-PHA is an asset on the Khala chain (Delegation is not yet enabled on the Phala chain, so there is no W-PHA on Phala yet). Therefore, when you wrap a W-PHA from WrappedBalances, your PHA will be transferred to the pallet (WrappedBalances) and locked there.\n\nDelegators can only use W-PHA to delegate into a StakePool or a Vault.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1723, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "1e406d39-7cff-4960-8462-30cae67f3dd6": {"__data__": {"id_": "1e406d39-7cff-4960-8462-30cae67f3dd6", "embedding": null, "metadata": {"file_path": "phala-docs_dist/wrappedbalances-and-w-pha.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "01b25634-c273-42f2-8e77-1391bca42203", "node_type": "4", "metadata": {}, "hash": "51361e12ef654c5280ea70bd3966b221d97b1ad386803f7503ab86c0ef3f58ca", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "313c4042-1b79-4b14-8a7d-22585abb5234", "node_type": "1", "metadata": {}, "hash": "a97822a73949cd2738537a0313d1a8bd04d56dee1d44448fdd75352c2d43f42c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "61c5e031-75d0-4232-be51-987ce8fe8935", "node_type": "1", "metadata": {}, "hash": "4b3b176793ba121ff45be745519f5acdb69e06fe848e8596c3a542eec68f5292", "class_name": "RelatedNodeInfo"}}, "text": "* When the user delegates to a Vault or a StakePool, W-PHA will be transferred from the user address to the account of the pools\n* When the Vault delegates to a StakePool, W-PHA will be transferred from the Vault address to the StakePool account\n* When StakePool stakes the Delegation to the worker, W-PHA will be transferred to the worker staking account corresponding to the StakePool\n\n> Please Note that use the \u201ccontribute\u201d for all delegating operations to the pools and use the \u201cstart working\u201d to set the worker to the active state.\n>\n> Do not transfer tokens to any pool or worker address manually. The protocol controls these addresses, and the tokens you manually transfer in cannot be transferred out forever.\n\nWrappedBalances is a ledger responsible for calculating how much W-PHA each user has. When the user transfers W-PHA to the pool as a delegation, because of the existence of the Delegation NFT, it will treat the Delegation NFT as a delegation certificate. Therefore, the W-PHA will be counted into the address holding the Delegation NFT.\n\nThe process of W-PHA being transferred between the user and the pool will be fully calculated by WrappedBalances.\n\n### PHA and W-PHA are always one-to-one exchange <a href=\"#pha-and-w-pha-are-always-one-to-one-exchange\" id=\"pha-and-w-pha-are-always-one-to-one-exchange\"></a>\n\nWhenever a W-PHA is minted, a PHA will be locked in the pallet, which is a protocol-controlled rule.\n\nWhen the W-PHA delegated into the StakePool is used as a delegation to obtain delegation rewards, the Delegation rewards it obtained (PHA) will be directly locked into the pallet, and the protocol will mint the same amount of W-PHA at the same time, which will automatically be delegated into the corresponding StakePool as a delegation. And be recorded in the corresponding Delegation NFT.\n\nBecause of this minting logic, W-PHA will not be issued maliciously, and it can be unwrapped to PHA at any time unless the holder uses its right to vote in WrappedBalances.", "mimetype": "text/plain", "start_char_idx": 1725, "end_char_idx": 3725, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "61c5e031-75d0-4232-be51-987ce8fe8935": {"__data__": {"id_": "61c5e031-75d0-4232-be51-987ce8fe8935", "embedding": null, "metadata": {"file_path": "phala-docs_dist/wrappedbalances-and-w-pha.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "01b25634-c273-42f2-8e77-1391bca42203", "node_type": "4", "metadata": {}, "hash": "51361e12ef654c5280ea70bd3966b221d97b1ad386803f7503ab86c0ef3f58ca", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "1e406d39-7cff-4960-8462-30cae67f3dd6", "node_type": "1", "metadata": {}, "hash": "4dcf7e1f323c89489a408aa7eff2230574bf7e9019b0649a2402f4f22fbba6c0", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "2241d840-b04f-40c3-8aa9-9f2cd473658c", "node_type": "1", "metadata": {}, "hash": "dce5aa64480ca8c94d551e0d3fe9253e06cd9506435a292afdffaf8508225c4c", "class_name": "RelatedNodeInfo"}}, "text": "## Use your Delegation to vote <a href=\"#use-your-delegation-to-vote\" id=\"use-your-delegation-to-vote\"></a>\n\n### You will not vote with any W-PHA or Delegation NFT <a href=\"#you-will-not-vote-with-any-w-pha-or-delegation-nft\" id=\"you-will-not-vote-with-any-w-pha-or-delegation-nft\"></a>\n\nWhen you vote in WrappedBalances, you will not use any W-PHA or Delegation NFT to vote.\n\nWrappedBalances uses a proxy voting mechanism.\n\nWhen you wrap PHA to W-PHA through WrappedBalances, your voting rights will be held by the pallet along with the transfer of PHA. Therefore, WrappedBalances' bookkeeping function records how many voting rights it manages that belong to you. Then, when you want to initiate a vote in the pallet, it will calculate how many equivalent PHA assets you have locked in it based on the W-PHA and Delegation NFT you hold, which means how many voting rights you are represented by it. Then, you can direct WrappedBalances to cast these votes on your behalf.\n\nThis is the original logic of this proxy voting mechanism. The operation is to initiate a vote transaction in WrappedBalances, and the rest of the proxy voting will be completed by the protocol. As long as you have enough voting rights, the vote you initiate will be a success.\n\nOnce you vote for a proposal in WrappedBalances, it will temporarily lock a part of your W-PHA assets to lock the voting rights. This part of W-PHA will not be transferred or unwrapped to PHA until your vote is over.\n\n### Different initiation methods, the same result <a href=\"#different-initiation-methods-the-same-result\" id=\"different-initiation-methods-the-same-result\"></a>\n\nYou can still use PHA to initiate voting in the [Polkadot.js](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkhala.api.onfinality.io%2Fpublic-ws#/democracy) or [Subsquare](https://www.subsquare.io/). At the same time, you can use your proxy voting rights through WrappedBalances. But you cannot use your W-PHA or Delegation NFT to vote on Subsquare.", "mimetype": "text/plain", "start_char_idx": 3727, "end_char_idx": 5709, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "2241d840-b04f-40c3-8aa9-9f2cd473658c": {"__data__": {"id_": "2241d840-b04f-40c3-8aa9-9f2cd473658c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/wrappedbalances-and-w-pha.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "01b25634-c273-42f2-8e77-1391bca42203", "node_type": "4", "metadata": {}, "hash": "51361e12ef654c5280ea70bd3966b221d97b1ad386803f7503ab86c0ef3f58ca", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "61c5e031-75d0-4232-be51-987ce8fe8935", "node_type": "1", "metadata": {}, "hash": "4b3b176793ba121ff45be745519f5acdb69e06fe848e8596c3a542eec68f5292", "class_name": "RelatedNodeInfo"}}, "text": "So, for the time being, you can only use the locked assets in WrappedBalances to vote through making transactions in [extrinsics page of Polkadot.js](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkhala.api.onfinality.io%2Fpublic-ws#/extrinsics).\n\nThis is a short-term phenomenon.\n\nWe are going to gather all the governance behaviors in the Phala APP. At that time, you will be able to use your PHA or Delegation for governance in the Phala App at the same time. Please look forward to it.", "mimetype": "text/plain", "start_char_idx": 5710, "end_char_idx": 6198, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "83e3fbed-da02-4f00-9900-7ba5f10867f0": {"__data__": {"id_": "83e3fbed-da02-4f00-9900-7ba5f10867f0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/language-basics.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "2fa9ff2c-d7ea-4b9f-90e9-c705bc6fad99", "node_type": "4", "metadata": {}, "hash": "c6626c088ab13c098ca4946a88ade1da3e98a4e7e3f568c6f4f051f0513dc080", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f0f92408-e371-4618-999b-f0c7c54640b2", "node_type": "1", "metadata": {}, "hash": "bbd90c522fa0d4a7c75c6f3157630a139dd151a002779ab0fad27c588a5288a4", "class_name": "RelatedNodeInfo"}}, "text": "# Language Basics\n\nThe Phat Contract is written in ink! language, which is extended from Rust language (more language support will be provided in the future). It is finally compiled into WebAssembly (WASM), which also takes [security](https://training.linuxfoundation.org/blog/webassembly-security-now-and-in-the-future/) into consideration when designed, then you can upload and deploy them.\n\nRust is thought to be a hard language, but no worries! It deserves the effort since Rust is fast and helps prevent many million-dollar bugs. Also, I sincerely believe one day you will find it charming since all your enemy is just the Rust compiler itself\ud83d\ude3c.\n\nThe prospering ecosystem is another reason to use Rust-based ink! to develop your contract. There are many secure and high-performance libraries for you to use without building all the wheels from scratch.\n\nThis section will not teach you about Rust and ink! language itself. Instead, it provides some helpful links and comments to get you prepared quickly.\n\n## Rust <a href=\"#rust\" id=\"rust\"></a>\n\n### Tooling <a href=\"#tooling\" id=\"tooling\"></a>\n\nWhen using Rust, you will always rely on the following official tools to manage your toolchain and compile your projects:\n\n* [rustup](https://rustup.rs/), which helps you install and manage different versions of Rust compilers;\n* cargo, the package manager is installed automatically along with the Rust compiler. Each Rust project contains a `Cargo.toml` file to describe its metadata and dependencies, and `cargo` downloads the dependencies and builds the project for you. The [cargo book](https://doc.rust-lang.org/cargo/reference/index.html) can help, and ensure you understand the [\\[dependencies\\]](https://doc.rust-lang.org/cargo/reference/specifying-dependencies.html) and [\\[features\\]](https://doc.rust-lang.org/cargo/reference/features.html) sections in `Cargo.toml` before going on.\n\n### Language Basics <a href=\"#language-basics\" id=\"language-basics\"></a>\n\nThe best material is surely the official [Rust book](https://doc.rust-lang.org/book/).", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2057, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f0f92408-e371-4618-999b-f0c7c54640b2": {"__data__": {"id_": "f0f92408-e371-4618-999b-f0c7c54640b2", "embedding": null, "metadata": {"file_path": "phala-docs_dist/language-basics.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "2fa9ff2c-d7ea-4b9f-90e9-c705bc6fad99", "node_type": "4", "metadata": {}, "hash": "c6626c088ab13c098ca4946a88ade1da3e98a4e7e3f568c6f4f051f0513dc080", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "83e3fbed-da02-4f00-9900-7ba5f10867f0", "node_type": "1", "metadata": {}, "hash": "7a8f88536f9fa7f0e254d5cdc814771e2b2c9ba201de506095fc25c32f4dd7e5", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "33074e4c-d42c-4ba0-b913-4273ca386676", "node_type": "1", "metadata": {}, "hash": "2e56ef9691f86fe14f130657d824612aa69b08a5007876e33169ce384822b6c6", "class_name": "RelatedNodeInfo"}}, "text": "* For a beginner, learning the first 6 sections is enough for your journey in the Phat Contract world;\n* I also recommend finishing the 7 - 10 sections when you decide to go a little deeper.\n\nThere are also many [books recommended by the community](https://www.reddit.com/r/rust/comments/sjclfb/best\\_book\\_to\\_learn\\_rust/) for more advanced topics.\n\n## ink! <a href=\"#ink\" id=\"ink\"></a>\n\nink! is the default contract programming language in the Polkadot ecosystem. The native ink! contracts can run on different blockchains (like Polkadot and Phala), but Phala adds its secret ingredient called [pink-extension](https://github.com/Phala-Network/phala-blockchain/tree/master/crates/pink) (short for Phala ink! Extension) to form Phat Contract which is only functional in Phala cloud.\n\n> Phat Contract is the superset of ink! contract.\n\n### ink! Macros <a href=\"#ink-macros\" id=\"ink-macros\"></a>\n\nThe difference between an ink! contract and a normal Rust program are the macros in it. As shown in our example contract, you need to annotate the Rust code with ink! macros so the compiler can learn your contract structure. For example,\n\n```\n#[ink(storage)]\npub struct OnchainState;\n```\n\n`#[ink(storage)]` tells us the following struct `OnchainState` saves the contract states and needs to be stored on-chain. And\n\n```\n#[ink(message)]\npub fn query_handler(&self, from: AccountId) {\n    // actual implementation\n}\n```\n\n`#[ink(message)]` means the following functions are meant to be called by other contracts or users in different ways.\n\nFor a complete list of these macros and a more detailed tutorial, refer to the [official document](https://ink.substrate.io/).\n\n### Use Crates in Your Contract <a href=\"#use-crates-in-your-contract\" id=\"use-crates-in-your-contract\"></a>\n\n> If you do not know what\u2019s Crate, you may need to go over your Rust book.\n\n[crates.io](https://crates.io/) is the market for Rust crates. While only the crates with `no_std` support can be used in your ink! contract.", "mimetype": "text/plain", "start_char_idx": 2059, "end_char_idx": 4049, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "33074e4c-d42c-4ba0-b913-4273ca386676": {"__data__": {"id_": "33074e4c-d42c-4ba0-b913-4273ca386676", "embedding": null, "metadata": {"file_path": "phala-docs_dist/language-basics.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "2fa9ff2c-d7ea-4b9f-90e9-c705bc6fad99", "node_type": "4", "metadata": {}, "hash": "c6626c088ab13c098ca4946a88ade1da3e98a4e7e3f568c6f4f051f0513dc080", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f0f92408-e371-4618-999b-f0c7c54640b2", "node_type": "1", "metadata": {}, "hash": "bbd90c522fa0d4a7c75c6f3157630a139dd151a002779ab0fad27c588a5288a4", "class_name": "RelatedNodeInfo"}}, "text": "The reason is [explained by the official](https://ink.substrate.io/faq#why-is-rusts-standard-library-stdlib-not-available-in-ink).", "mimetype": "text/plain", "start_char_idx": 4050, "end_char_idx": 4180, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "2aacd6b5-06f0-4768-9557-d912fd984081": {"__data__": {"id_": "2aacd6b5-06f0-4768-9557-d912fd984081", "embedding": null, "metadata": {"file_path": "phala-docs_dist/collator.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "0700ad4b-aecb-4725-b750-4cdca264a36c", "node_type": "4", "metadata": {}, "hash": "97752a628d09fffacf401c6b61b807aa7d331c3a6e3dde518647dad3c3b480ee", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "04457e25-31b6-4ece-894c-4d858cf467dc", "node_type": "1", "metadata": {}, "hash": "2d818b63a6d9a94a2ac129d51b4bbace6df683d5070aa47b22ada4b8b5d28291", "class_name": "RelatedNodeInfo"}}, "text": "# Collator\n\n> Collators on Phala (Khala) are supposed to be Gatekeepers, who also run the `pRuntime` as the Gatekeeper role, helping manage the keys in the network. However, Gatekeeper is not open for election now.\n\n## Concepts <a href=\"#concepts\" id=\"concepts\"></a>\n\nPhala Network is currently running its collators on Aura consensus. Aura is a simple block authoring engine that rotates the block producers among the registered collator candidates one by one.\n\n```\n            Host              Session\n            Api               Manager\n Collator <===== [Session]  <--------- [CollatorSelection]\n   node            pallet                     pallet\n```\n\nOn the blockchain, the block authoring is handled collaboratively by `Session` and `CollatorSelection` pallets. The `Session` pallet controls how the blocks are produced and validated. Therefore it has a list of the selected block authors. However, the `Session` doesn\u2019t decide the list on its own. Instead, it delegates that to the `CollatorSelection` pallet.\n\n> The `CollatorSelection` pallet implements the `SessionManager` trait and is injected as the manager of the `Session` pallet in the runtime.\n\nThe `CollatorSelection` pallet is a minimal PoS system. It has a configurable bound amount for all the collator candidates. Anyone can run a collator as long as they meet the minimal bound. It also kicks the unresponsive collator out after each session. Besides the public collators, it also holds a special group of collators called `invulnerables`, who are not vulnerable to kicks even if they are offline.\n\n## Prepare a new collator <a href=\"#prepare-a-new-collator\" id=\"prepare-a-new-collator\"></a>\n\n1. Create an account with a minimum amount of bound available (16 PHA by default)\n2. Deploy a collator full node with the `--collator` flag enabled\n3. Generate a session key. Two options:\n   1. Call RPC `api.rpc.author.rotateKeys()` to generate a new session key in the node, and note the public key it outputs\n   2. Generate the session key externally (dangerous), calculate the public key, and note it\n4.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2075, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "04457e25-31b6-4ece-894c-4d858cf467dc": {"__data__": {"id_": "04457e25-31b6-4ece-894c-4d858cf467dc", "embedding": null, "metadata": {"file_path": "phala-docs_dist/collator.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "0700ad4b-aecb-4725-b750-4cdca264a36c", "node_type": "4", "metadata": {}, "hash": "97752a628d09fffacf401c6b61b807aa7d331c3a6e3dde518647dad3c3b480ee", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "2aacd6b5-06f0-4768-9557-d912fd984081", "node_type": "1", "metadata": {}, "hash": "4d33e11dc0a19e22d700e2007f86b0cec179fff3d2a8251d29f3eada05be7915", "class_name": "RelatedNodeInfo"}}, "text": "Set the session (public) key of the collator account by calling `session.setKeys()`\n5. Start the collator node\n\n## Enable an invulnerable collator <a href=\"#enable-an-invulnerable-collator\" id=\"enable-an-invulnerable-collator\"></a>\n\n> This operation can only be done with the Sudo permission. To apply for a public collator, please refer to the next section.\n\nCall `collatorSelection.setInvulnerables(list)`, where `list` is the full list of all the invulnerables collators including the old ones. The current invulnerable collator list can be found from `collatorSelection.invulnerables()`.\n\n## Apply for a public collator <a href=\"#apply-for-a-public-collator\" id=\"apply-for-a-public-collator\"></a>\n\nTo become a public collator, you will need to put a fixed amount of the deposit. The deposit can be found at `collatorSelection.candidacyBond()`. Up to a certain number of the public collators are allowed (the genesis collators are not included). The number can be found at `collatorSelection.desiredCandidates()`, and the current candidates can be found at `collatorSelection.candidates()`. As of writing, the bond is 1000 PHA, and the desired candidate number is 12.\n\nAfter the collator account and the node is setup correctly, submit a proposal by calling `collatorSelection.registerAsCandidate()` from the account. Once it\u2019s submitted, you will need to wait for two sessions to become a collator.\n\nThe blockchain will detect offline collators. If the produced blocks in a session is under a threshold, it will be kicked out from the collator candidate list, and the bond will be returned in full.\n\nAt any time, a collator account can signal the intention to leave the collator candidate list by calling `collatorSelection.leaveIntent()`.", "mimetype": "text/plain", "start_char_idx": 2076, "end_char_idx": 3819, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6dafc8f1-69cf-40c3-8355-5934a327c9c5": {"__data__": {"id_": "6dafc8f1-69cf-40c3-8355-5934a327c9c5", "embedding": null, "metadata": {"file_path": "phala-docs_dist/khala-worker-rewards.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "500f5bf0-4994-4954-b069-6ed2e43cda0c", "node_type": "4", "metadata": {}, "hash": "fcb75f1b8020cb9c455128a74d7eab66a9a23326190f4e8a8925fed4a18f1996", "class_name": "RelatedNodeInfo"}}, "text": "# Khala Worker Rewards\n\nAfter [Gemini Upgrade](https://khala.subsquare.io/democracy/referendum/27), Khala and Phala share 70% PHA tokens of the total supply for workers' subsidy allocation. You can learn about the Supply-end Tokenomics details [here](../basic-info/worker-rewards.md).", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 284, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "12b4f9ac-4c84-456e-826a-d74334aa406f": {"__data__": {"id_": "12b4f9ac-4c84-456e-826a-d74334aa406f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/access-from-other-agents.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "043a364a-ffe8-4acc-a2af-bda8366b06f0", "node_type": "4", "metadata": {}, "hash": "4b02952b09d4bdefb0577f3b687b6a77903822bf0f45bd12baf4090ed3745252", "class_name": "RelatedNodeInfo"}}, "text": "# Access from Other Agents\n\n:construction\\_site: Work In Progress\n\n<figure><img src=\"../../.gitbook/assets/Phala-Agent-Plugins.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 173, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "86869b8a-acb9-4688-8e49-df1361bddae8": {"__data__": {"id_": "86869b8a-acb9-4688-8e49-df1361bddae8", "embedding": null, "metadata": {"file_path": "phala-docs_dist/introduction.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "003a24a6-401e-49c8-afaf-e3d680346bbb", "node_type": "4", "metadata": {}, "hash": "92e3e64981c34ed3eda77169a0a76dd49383379a55a5277a89985cc6fea39260", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83e\ude99 Introduction\n\nPHA is the native token of the Phala blockchain. It serves several key functions and holders can use the token in a few different ways:\n\n* Workers, the compute providers for Phala Network, receive PHA rewards. Read about how [rewards are calculated](../../compute-providers/basic-info/worker-rewards.md) or [becoming a Worker](../../compute-providers/run-workers-on-phala/).\n* Running programs, or [AI Agent Contracts](../../tech-specs/ai-agent-contract/), on Phala Network.\n* Phala Network is a DAO governed by PHA token holders. Read about Phala's Governance mechanism [here](governance/).\n* PHA token can be staked or delegated to stakers to support the security of the network and earn rewards. Read about [delegation](delegation/) or get started on the [app](https://app.phala.network/).", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 810, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8ccb1bbb-461d-4ec0-ab08-a0d7beab7576": {"__data__": {"id_": "8ccb1bbb-461d-4ec0-ab08-a0d7beab7576", "embedding": null, "metadata": {"file_path": "phala-docs_dist/quick-start.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "30e4242e-dde2-42c3-81aa-9063efdf6da1", "node_type": "4", "metadata": {}, "hash": "43e4687d8eab5f003a8fe0e6470e7d0fe0f66634c788f57585abf41e3aae6b4f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c0fe8691-693f-497c-83d9-6167a8e5a9b7", "node_type": "1", "metadata": {}, "hash": "ff6e10e6503c3b5a70b4ff6fd369f09fc6727ab246a98ab5a22964a94a1db099", "class_name": "RelatedNodeInfo"}}, "text": "---\ndescription: >-\n  Connect your subgraphs from The Graph to your on-chain dApps via Phat\n  Contract.\n---\n\n# \ud83e\udd8b Quick Start\n\n## Overview\n\nThe Graph template enables you to connect to subgraph endpoints for data and utilize the data to calculate a trust score and send to a Web3 dApp on an EVM chain.\n\n<figure><img src=\"../../../../.gitbook/assets/The_Graph.png\" alt=\"\"><figcaption></figcaption></figure>\n\n## Prerequisites <a href=\"#user-content-prerequisites\" id=\"user-content-prerequisites\"></a>\n\n* Active Phala Profile with version `>= 1.0.1` via [Phat Contract 2.0 UI](https://bit.ly/3LHccmR)\n* [Hardhat](https://bit.ly/469uyW5)\n* API Key from [The Graph](https://bit.ly/subgraph-api-key)\n* For EVM Mainnet deployments:\n  * Ex: Polygonscan API Key that can be generated on [polygonscan](https://bit.ly/3rBkypp)\n* RPC Endpoint for EVM Chain Mainnet & EVM Chain Testnet\n  * [Alchemy](https://bit.ly/46uObaH) - This repo example uses Alchemy's API Key.\n  * [Infura](https://bit.ly/3PXXCtN)\n  * Personal RPC Node (Ex. [ProjectPi](https://bit.ly/3RGf7QS))\n* Polkadot Account for Phala PoC6 Testnet and Mainnet deployment\n  * [Phala Faucet](https://bit.ly/3Tomopi)\n* Node >= 18.x\n\n## How it Works\n\n<figure><img src=\"../../../../.gitbook/assets/TheGraphFlow.jpg\" alt=\"\"><figcaption></figcaption></figure>\n\nThe diagram above displays the user journey of (1) Alice requesting a trust score for Eve from the EVM Consumer Contract. When (2) a new action request is added to the queue, (3) the Phala Network Phat Contract will pop the action off the queue and perform the off-chain work to compute a trust score.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1604, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c0fe8691-693f-497c-83d9-6167a8e5a9b7": {"__data__": {"id_": "c0fe8691-693f-497c-83d9-6167a8e5a9b7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/quick-start.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "30e4242e-dde2-42c3-81aa-9063efdf6da1", "node_type": "4", "metadata": {}, "hash": "43e4687d8eab5f003a8fe0e6470e7d0fe0f66634c788f57585abf41e3aae6b4f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "8ccb1bbb-461d-4ec0-ab08-a0d7beab7576", "node_type": "1", "metadata": {}, "hash": "39603edcfd2dbfec967be1ecd7fdaced64267c6003eb372a83d4d69f65acc2b7", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "14a9fada-3171-4bfe-946d-bfd8bb012437", "node_type": "1", "metadata": {}, "hash": "a1bff1a51504283795bedc2b81645eb9f60376ca1695b62a1d0751323a661e3b", "class_name": "RelatedNodeInfo"}}, "text": "First (4) the Phat Contract will create a `batchHttpRequest` to query 3 separate subgraph endpoints to determine if Eve has any ERC-721 NFTs, a NounsDAO NFT,  an ENS Domain, and if any accounts delegate votes to Eve on Snapshot. Once this data is returned then (5) the Phat Contract will compute a score based on some scoring criteria. You can view the code [here](https://github.com/Phala-Network/the-graph-phat-contract/blob/da510bbbefd7a4cca16bf04b090136cf0d5d7503/src/index.ts#L108). Lastly, (6) the trust score for Eve has been returned to the EVM Consumer Contract and Eve's score is set in the Consumer Contract's storage for anyone to query.\n\n## Quick Start\n\nMake sure you have created a Phat Dashboard Profile and claimed some PoC6 Testnet Tokens. Instructions on creating a profile can be found [here](../create-a-dashboard-profile.md). Also, make sure to get an [API Key from The Graph](get-an-api-key-for-the-graph.md) to avoid being rate limited by the default API Key provided by the Phala team.\n\nTo kickstart your journey with The Graph Starter Kit, you install the `@phala/fn` CLI tool.&#x20;\n\nYou can do this using your node package manager (`npm`) or use node package execute (`npx`). For the purpose of this tutorial, we will be using `npx`.\n\nOnce you have the CLI tool installed, you can create your first Phala Oracle template with the following command.\n\n```\nnpx @phala/fn@latest init example\n```\n\n\ud83d\udea8 Note \ud83d\udea8\n\n> When selecting your template, elect `the-graph-starter-kit`.\n\n```\nnpx @phala/fn@latest init example\n? Please select one of the templates for your \"example\" project: \n  phat-contract-starter-kit: Send data from any API to your smart contract with Javascript. \n  lensapi-oracle-consumer-contract: Send data from Lens API to your smart contract to empower your Web3 Social dApp. \n  vrf-oracle: TEE-guarded Verifiable Random Function template to bring randomness to your smart contract.", "mimetype": "text/plain", "start_char_idx": 1606, "end_char_idx": 3520, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "14a9fada-3171-4bfe-946d-bfd8bb012437": {"__data__": {"id_": "14a9fada-3171-4bfe-946d-bfd8bb012437", "embedding": null, "metadata": {"file_path": "phala-docs_dist/quick-start.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "30e4242e-dde2-42c3-81aa-9063efdf6da1", "node_type": "4", "metadata": {}, "hash": "43e4687d8eab5f003a8fe0e6470e7d0fe0f66634c788f57585abf41e3aae6b4f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c0fe8691-693f-497c-83d9-6167a8e5a9b7", "node_type": "1", "metadata": {}, "hash": "ff6e10e6503c3b5a70b4ff6fd369f09fc6727ab246a98ab5a22964a94a1db099", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5a18a4aa-f877-40d7-bfa8-428e47a2a75b", "node_type": "1", "metadata": {}, "hash": "1c3e50b306321af1ed768a9cba57ab24c49ef07542d1d39126c2bbc5cd68ac44", "class_name": "RelatedNodeInfo"}}, "text": "airstack-phat-contract: Request an account\u2019s data from Airstack\u2019s API to compute trust score and send to your Web3 dApp on-chain. \n\u276f thegraph-phat-contract: Connect your subgraphs from The Graph to your on-chain dApps via Phat Contract.  \n```\n\n\ud83d\uded1 **Not so fast!** What is it exactly that we are building? \ud83d\uded1\n\n> **What are we building?**\n>\n> The artifact we are compiling is a JavaScript file, serving as the Phat Contract Oracle's tailored logic. This script is designed to respond to requests initiated from the Consumer Contract. The diagram provided above offers a visual representation of this request-response interaction.\n>\n> **Why is it important?**\n>\n> In the context of the off-chain environment, on-chain Smart Contracts are inherently limited. Their functionality is confined to the information available to them within the on-chain ecosystem. This limitation underscores the critical need for a secure off-chain oracle, such as the Phat Contract. This oracle is capable of fetching and transforming data, thereby enhancing the intelligence and awareness of Smart Contracts about on-chain activities. This is a pivotal step towards bridging the gap between the on-chain and off-chain worlds, making Smart Contracts not just smart, but also informed.\n\nAfter creating The Graph template repo, `cd` into the new project and install the package dependencies. You can do this with the following command:\n\n```\nnpm install\n```\n\nNow, build the default Phat Contract script with this command:\n\n```\nnpx @phala/fn build\n```\n\nTo simulate the expected result locally, run the Phat Contract script now with the `npx @phala/fn run`command to test the expected output when passing an encoded hexstring and the `secrets` into the `main` function of the Phat Contract. This is helpful to test locally quick to understand the functionality of your compiled Phat Contract.\n\n> Go to [https://playground.ethers.org](https://playground.ethers.org) to `decode` and `encode` the hexstring you want to pass into your Phat Contract `main` function.", "mimetype": "text/plain", "start_char_idx": 3524, "end_char_idx": 5554, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5a18a4aa-f877-40d7-bfa8-428e47a2a75b": {"__data__": {"id_": "5a18a4aa-f877-40d7-bfa8-428e47a2a75b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/quick-start.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "30e4242e-dde2-42c3-81aa-9063efdf6da1", "node_type": "4", "metadata": {}, "hash": "43e4687d8eab5f003a8fe0e6470e7d0fe0f66634c788f57585abf41e3aae6b4f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "14a9fada-3171-4bfe-946d-bfd8bb012437", "node_type": "1", "metadata": {}, "hash": "a1bff1a51504283795bedc2b81645eb9f60376ca1695b62a1d0751323a661e3b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5036d751-e2a4-4bfb-a037-9bc27e51d686", "node_type": "1", "metadata": {}, "hash": "a4ae5cb6d73590f7123bd1832910763cfbe399d8d3dd452600b93efa207aae2e", "class_name": "RelatedNodeInfo"}}, "text": ">\n> In this example, the hexstring  `0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000de1683287529b9b4c3132af8aad210644b259cfd` represents types `uint id` and `address target`&#x20;\n>\n> Here is what you will enter in the playground:\n>\n> * `utils.defaultAbiCoder.decode(['uint id', 'address target'], '0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000de1683287529b9b4c3132af8aad210644b259cfd')`\n> * `[ BigNumber { value: \"1\" }, \"0xdE1683287529B9B4C3132af8AaD210644B259CfD\", id: BigNumber { value: \"1\" }, target: \"0xdE1683287529B9B4C3132af8AaD210644B259CfD\" ]`\n>\n> You can easily validate this by encoding the types and data with the `utils.defaultAbiCoder.encode()` function like below.", "mimetype": "text/plain", "start_char_idx": 5555, "end_char_idx": 6322, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5036d751-e2a4-4bfb-a037-9bc27e51d686": {"__data__": {"id_": "5036d751-e2a4-4bfb-a037-9bc27e51d686", "embedding": null, "metadata": {"file_path": "phala-docs_dist/quick-start.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "30e4242e-dde2-42c3-81aa-9063efdf6da1", "node_type": "4", "metadata": {}, "hash": "43e4687d8eab5f003a8fe0e6470e7d0fe0f66634c788f57585abf41e3aae6b4f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5a18a4aa-f877-40d7-bfa8-428e47a2a75b", "node_type": "1", "metadata": {}, "hash": "1c3e50b306321af1ed768a9cba57ab24c49ef07542d1d39126c2bbc5cd68ac44", "class_name": "RelatedNodeInfo"}}, "text": ">\n> * `utils.defaultAbiCoder.encode(['uint id', 'address target'], [1, \"0xdE1683287529B9B4C3132af8AaD210644B259CfD\"])`\n> * `\"0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000de1683287529b9b4c3132af8aad210644b259cfd\"`\n\n```\nnpx @phala/fn run dist/index.js -a 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000de1683287529b9b4c3132af8aad210644b259cfd '{\"apiUrl\": \"https://gateway.thegraph.com/api/\", \"apiKey\": \"cd22a01e5b7f9828cddcb52caf03ee79\"}'\n```\n\nFinally, run the local end-to-end tests with this command. Here we will simulate locally the interaction between the Phat Contract and the Consumer Contract with hardhat.\n\n```\nnpm run localhost-test \n```\n\n\ud83e\udd73 **Congratulations!**\n\nYou have successfully completed the quick start. For the next steps, you will learn how to deploy The Graph Phat Contract to PoC6 Testnet & Phala Mainnet, and also deploy the EVM Consumer Contract on the target EVM chain. Then you will connect to the Phat Contract to the Consumer Contract for the EVM testnet chain to start testing the request-response model live.", "mimetype": "text/plain", "start_char_idx": 6323, "end_char_idx": 7447, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c9d6a5a0-7a7f-4e10-afda-4b1fbe59319e": {"__data__": {"id_": "c9d6a5a0-7a7f-4e10-afda-4b1fbe59319e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/setup-account-identity.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "b55e1e04-9025-4715-a83a-9cc2abd9175f", "node_type": "4", "metadata": {}, "hash": "179ce277f3aa0d25553504d19321c3399777936701651eff192e3e6114616658", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f8c381fe-cd31-4d5d-b1ce-638da593e9f9", "node_type": "1", "metadata": {}, "hash": "e03c43db9a6e52a03ffed84ddd683a6ce3106ff0e5f018f6bd164aa549f82848", "class_name": "RelatedNodeInfo"}}, "text": "# Setting Up an Account Identity\n\nPhala Network provides a naming system that allows participants to add personal information to their on-chain account and subsequently ask for verification of this information by [registrars](../../../pha-token/governance/broken-reference/).\n\nAfter your identity is added, it can be used in many applications in Phala or Khala ecosystem. For example, in Secure Worker, this will help you attract delegators to trust and vote for you.\n\n## Setting an Identity <a href=\"#setting-an-identity\" id=\"setting-an-identity\"></a>\n\nUsers can set an identity by registering through default fields including:\n\n* legal name\n* display name\n* website\n* Twitter handle\n* Element handle\n\nYou can also add extra custom fields to which you can attest. Personalized fields are elaborated in the [judgements](../../../pha-token/governance/broken-reference/) section.\n\n> Users must reserve funds in a bond to store their information on chain:`identity_reserve_funds`, and `identity_field_funds` per each field beyond the legal name. These funds are _locked_, can not be spent - they will be returned when the identity is cleared.\n>\n> These amounts can also be extracted by querying constants through the \u201c[Chain state constants](https://polkadot.js.org/apps/#/chainstate/constants)\u201d tab on polkadot.js/apps.\n\n### Getting Started <a href=\"#getting-started\" id=\"getting-started\"></a>\n\n1. To get started, head over to your [My Accounts](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkhala-api.phala.network%2Fws#/accounts) tab of Phala/Khala (Switch to \u201cPhala/Khala Network\u201d -> \u201cAccounts\u201d).\n\n> Each field can store up to 32 bytes of information, so the data must be less than that. When inputting the data manually through the [Extrinsics UI](https://polkadot.js.org/apps/#/extrinsics), a [UTF8 to bytes](https://onlineutf8tools.com/convert-utf8-to-bytes) converter can help.\n\n2. Click the gear icon next to your account and select \u201cSet on-chain identity\u201d.\n\nA popup will appear, offering the default fields.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2014, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f8c381fe-cd31-4d5d-b1ce-638da593e9f9": {"__data__": {"id_": "f8c381fe-cd31-4d5d-b1ce-638da593e9f9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/setup-account-identity.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "b55e1e04-9025-4715-a83a-9cc2abd9175f", "node_type": "4", "metadata": {}, "hash": "179ce277f3aa0d25553504d19321c3399777936701651eff192e3e6114616658", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c9d6a5a0-7a7f-4e10-afda-4b1fbe59319e", "node_type": "1", "metadata": {}, "hash": "3908f1c82656aeabe04cb388fd268b2a5b776952fda97498fced0cdbab32a517", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "6dff8296-b7d6-4f2d-8ea7-c30f5da375b8", "node_type": "1", "metadata": {}, "hash": "056adf8e327e8c2a7b907565e1916d9af987a8c48527f4cd076bc8bb106b837f", "class_name": "RelatedNodeInfo"}}, "text": "#### **Adding Custom Fields**\n\nTo add custom fields beyond the default ones, use the Extrinsics UI (\u201cDeveloper\u201d -> \u201cExtrinsics\u201d). Select `submit the following extrinsic` \u201cidentity\u201d and in the field to the immediate right \u201csetidentity(info)\u201d. To submit a raw transaction, first click \u201cAdd Item\u201d and add any field name you like. The display name also must be provided; otherwise, the Identity pallet would consider it wiped if you submitted it with \u201cNone\u201d selected. Every time you change your identity values, you need to re-submit the entire set of fields: the write operation is always \u201coverwrite\u201d and never \u201cappend.\u201d\n\n> Note that custom fields are not shown in the UI by default.\n\nThe rendering of such custom values is, ultimately, up to the UI/dapp makers. In the case of Polkadot{.js} , the team prefers to only show official fields for now. If you want to check that the values are still stored, use the [Chain State UI](https://polkadot.js.org/apps/#/chainstate) to query the active account\u2019s identity info:\n\nIt is up to your own UI or dapp to then do with this data as it pleases. The data will remain available for querying via the Polkadot API, so you don\u2019t have to rely on the PolkadotJS UI.\n\nYou can have a maximum of 100 custom fields.\n\n### Format Caveat <a href=\"#format-caveat\" id=\"format-caveat\"></a>\n\n> Since fields support different formats, from raw bytes to various hashes, a UI has no way of telling how to encode a given field it encounters.\n\nThe Polkadot{.js} UI currently encodes the raw bytes it encounters as UTF8 strings, which makes these values readable on-screen. However, given that there are no restrictions on the values that can be placed into these fields, a different UI may interpret them as, for example, IPFS hashes or encoded bitmaps. This means any field stored as raw bytes will become unreadable by that specific UI. As field standards crystallize, things will become easier to use but for now, every custom implementation of displaying user information will likely have to make a conscious decision on the approach to take, or support multiple formats and then attempt multiple encodings until the output makes sense.", "mimetype": "text/plain", "start_char_idx": 2016, "end_char_idx": 4176, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6dff8296-b7d6-4f2d-8ea7-c30f5da375b8": {"__data__": {"id_": "6dff8296-b7d6-4f2d-8ea7-c30f5da375b8", "embedding": null, "metadata": {"file_path": "phala-docs_dist/setup-account-identity.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "b55e1e04-9025-4715-a83a-9cc2abd9175f", "node_type": "4", "metadata": {}, "hash": "179ce277f3aa0d25553504d19321c3399777936701651eff192e3e6114616658", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f8c381fe-cd31-4d5d-b1ce-638da593e9f9", "node_type": "1", "metadata": {}, "hash": "e03c43db9a6e52a03ffed84ddd683a6ce3106ff0e5f018f6bd164aa549f82848", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b43ab247-3a9c-4561-9863-a29bd46bacb4", "node_type": "1", "metadata": {}, "hash": "bcd88637dcf1a887d5bb910fa1a2469a77fa89702262722275a265dac1268e25", "class_name": "RelatedNodeInfo"}}, "text": "## Judgements <a href=\"#judgements\" id=\"judgements\"></a>\n\nAfter a user injects their information on chain, they can request judgement from a registrar. Users declare a maximum fee that they are willing to pay for judgement, and registrars whose fee is below that amount can provide a judgement.\n\nWhen a registrar provides judgement, they can select up to six levels of confidence in their attestation:\n\n* Unknown: The default value, no judgement made yet.\n* Reasonable: The data appears reasonable, but no in-depth checks (e.g. formal KYC process) were performed.\n* Known Good: The registrar has certified that the information is correct.\n* Out of Date: The information used to be good but is now out of date.\n* Low Quality: The information is low quality or imprecise, but can be fixed with an update.\n* Erroneous: The information is erroneous and may indicate malicious intent.\n\nA seventh state, \u201cfee paid\u201d, is for when a user has requested judgement and it is in progress. Information that is in this state or \u201cerroneous\u201d is \u201csticky\u201d and cannot be modified; it can only be removed by the complete removal of the identity.\n\nRegistrars gain trust by performing proper due diligence and would presumably be replaced for issuing faulty judgements.\n\nTo be judged after submitting your identity information, go to the [\u201cExtrinsics UI\u201d](https://polkadot.js.org/apps/#/extrinsics) and select the `identity` pallet, then `requestJudgement`. For the `reg_index` put the index of the registrar you want to be judged by, and for the `max_fee` put the maximum you\u2019re willing to pay for these confirmations.\n\nIf you don\u2019t know which registrar to pick, first check the available registrars by going to [\u201cChain State UI\u201d](../../../pha-token/governance/broken-reference/) and selecting `identity.registrars()` to get the full list.\n\n### Requesting a Judgement <a href=\"#requesting-a-judgement\" id=\"requesting-a-judgement\"></a>\n\nRequesting judgement follows the same process regardless of whether you\u2019re on the Khala or Phala networks. Select one of the registrars from the query you made above.", "mimetype": "text/plain", "start_char_idx": 4178, "end_char_idx": 6258, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b43ab247-3a9c-4561-9863-a29bd46bacb4": {"__data__": {"id_": "b43ab247-3a9c-4561-9863-a29bd46bacb4", "embedding": null, "metadata": {"file_path": "phala-docs_dist/setup-account-identity.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "b55e1e04-9025-4715-a83a-9cc2abd9175f", "node_type": "4", "metadata": {}, "hash": "179ce277f3aa0d25553504d19321c3399777936701651eff192e3e6114616658", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "6dff8296-b7d6-4f2d-8ea7-c30f5da375b8", "node_type": "1", "metadata": {}, "hash": "056adf8e327e8c2a7b907565e1916d9af987a8c48527f4cd076bc8bb106b837f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "00b375e7-17c1-4913-8983-e6d17124d0e0", "node_type": "1", "metadata": {}, "hash": "f165230103cab4503d52e704b560c81f97fed91a5f5622dd02bb61423dda05d3", "class_name": "RelatedNodeInfo"}}, "text": "This will make your identity go from unjudged to \u201cwaiting\u201d:\n\nAt this point, direct contact with the registrar is required - the contact info is in their identity as shown above. Each registrar will have their own set of procedures to verify your identity and values, and only once you\u2019ve satisfied their requirements will the process continue.\n\nOnce the registrar has confirmed the identity, a green checkmark should appear next to your account name with the appropriate confidence level:\n\n_Note that changing even a single field\u2019s value after you\u2019ve been verified will un-verify your account and you will need to start the judgement process again. However, you can still change fields while the judgement is going on - it\u2019s up to the registrar to keep an eye on the changes._\n\n### Cancelling a Judgement <a href=\"#cancelling-a-judgement\" id=\"cancelling-a-judgement\"></a>\n\nYou may decide that you do not want to be judged by a registrar (for instance, because you realize you entered incorrect data or selected the wrong registrar). In this case, after submitting the request for judgement but before your identity has been judged, you can issue a call to cancel the judgement using an extrinsic.\n\nTo do this, first, go to the [\u201cExtrinsics UI\u201d](https://polkadot.js.org/apps/#/extrinsics) and select the `identity` pallet, then `cancelRequest`. Ensure that you are calling this from the correct account (the one for which you initially requested judgement). For the `reg_index`, put the index of the registrar from which you requested judgement.\n\nSubmit the transaction, and the requested judgement will be canceled.", "mimetype": "text/plain", "start_char_idx": 6260, "end_char_idx": 7875, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "00b375e7-17c1-4913-8983-e6d17124d0e0": {"__data__": {"id_": "00b375e7-17c1-4913-8983-e6d17124d0e0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/setup-account-identity.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "b55e1e04-9025-4715-a83a-9cc2abd9175f", "node_type": "4", "metadata": {}, "hash": "179ce277f3aa0d25553504d19321c3399777936701651eff192e3e6114616658", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b43ab247-3a9c-4561-9863-a29bd46bacb4", "node_type": "1", "metadata": {}, "hash": "bcd88637dcf1a887d5bb910fa1a2469a77fa89702262722275a265dac1268e25", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "dffc8fcc-d650-4b5e-b9b2-2696a94d5cfb", "node_type": "1", "metadata": {}, "hash": "9bdc011a5ee73c298102ccd5d0d27316e2e43cf78cb0dd539f11ee67689a8fc6", "class_name": "RelatedNodeInfo"}}, "text": "### Phala & Khala Registrars <a href=\"#khala-registrars\" id=\"khala-registrars\"></a>\n\n* Registrar 0:\n  * Marvin Tong\n  * Contact: \\[email protected]\n  * Account: 42McARWf3FMrGa2RnhhVansbCHuRktiiyHpjsW5nDkDefwHr\n  * Fee: 5 $PHA\n* Registrar 2:\n  * Doyle Guo\n  * Contact: \\[email protected]\n  * Account: 46E4xojF1Q3kaihagQt8to3pFMXQkNRdQAs8BnpyqVNKWHg6\n  * Fee: 0 $PHA\n\n### Khala Registrars <a href=\"#khala-registrars\" id=\"khala-registrars\"></a>\n\nThere will be multiple registrars on Khala. But at the moment you only have 2 registrar suppliers:\n\n* Registrar 0:\n  * Marvin Tong\n  * Contact: \\[email protected]\n  * Account: 42McARWf3FMrGa2RnhhVansbCHuRktiiyHpjsW5nDkDefwHr\n  * Fee: 5 $PHA\n* Registrar 1:\n  * Doyle Guo\n  * Contact: \\[email protected]\n  * Account: 46E4xojF1Q3kaihagQt8to3pFMXQkNRdQAs8BnpyqVNKWHg6\n  * Fee: 0 $PHA\n\nPlease add the following information to the application:\n\nI am applying for identity verification on Khala, the information is as follows:\n\n```\n{\n  \"account\": \"42McARWf3FMrGa2RnhhVansbCHuRktiiyHpjsW5nDkDefwHr\",\n  \"display\": \"Marvin Tong\",\n  \"web\": \"https://phala.network\",\n  \"email\": \"[email\u00a0protected]\"\n  \"twitter\": \"https://twitter.com/marvin_tong\"\n}\n```\n\nRegistrar 0 will reply with the next steps.", "mimetype": "text/plain", "start_char_idx": 7877, "end_char_idx": 9102, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "dffc8fcc-d650-4b5e-b9b2-2696a94d5cfb": {"__data__": {"id_": "dffc8fcc-d650-4b5e-b9b2-2696a94d5cfb", "embedding": null, "metadata": {"file_path": "phala-docs_dist/setup-account-identity.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "b55e1e04-9025-4715-a83a-9cc2abd9175f", "node_type": "4", "metadata": {}, "hash": "179ce277f3aa0d25553504d19321c3399777936701651eff192e3e6114616658", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "00b375e7-17c1-4913-8983-e6d17124d0e0", "node_type": "1", "metadata": {}, "hash": "f165230103cab4503d52e704b560c81f97fed91a5f5622dd02bb61423dda05d3", "class_name": "RelatedNodeInfo"}}, "text": "## Sub Accounts <a href=\"#sub-accounts\" id=\"sub-accounts\"></a>\n\nUsers can also link accounts by setting \u201csub accounts\u201d, each with its own identity, under a primary account. The system reserves a bond for each sub account. An example of how you might use this would be a validation company running multiple validators. A single entity, \u201cMy Staking Company\u201d, could register multiple sub accounts that represent the [Stash accounts](../../../pha-token/governance/broken-reference/) of each of their validators.\n\nAn account can have a maximum of 100 sub-accounts.\n\nTo register a sub-account on an existing account, you must currently use the [Extrinsics UI](https://polkadot.js.org/apps/#/extrinsics). There, select the identity pallet, then `setSubs` as the function to use. Click \u201cAdd Item\u201d for every child account you want to add to the parent sender account. The value to put into the Data field of each parent is the optional name of the sub-account. If omitted, the sub-account will inherit the parent\u2019s name and be displayed as `parent/parent` instead of `parent/child`.\n\nNote that a deposit of `identity_sub_reserve_funds` is required for every sub-account.\n\nYou can use [polkadot.js/apps](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkhala-api.phala.network%2Fws#/chainstate/constants) again to verify this amount by querying the `identity.subAccountDeposit` constant.\n\n## Clearing and Killing an Identity <a href=\"#clearing-and-killing-an-identity\" id=\"clearing-and-killing-an-identity\"></a>\n\n> Users can clear their identity information and have their deposit returned. Clearing an identity also clears all sub accounts and returns their deposits.\n\nTo clear an identity:\n\n1. Navigate to the [Accounts UI](https://polkadot.js.org/apps/#/accounts).\n2. Click the three dots corresponding to the account you want to clear and select \u2018Set on-chain identity\u2019.\n3. Select \u2018Clear Identity\u2019, and sign and submit the transaction.\n\n**Killing:** The Council can kill an identity that it deems erroneous. This results in a slash in the deposit.", "mimetype": "text/plain", "start_char_idx": 9104, "end_char_idx": 11142, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a0e4d58c-b4d6-474b-81b5-41996a0872c0": {"__data__": {"id_": "a0e4d58c-b4d6-474b-81b5-41996a0872c0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/prbv3-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "35d0b890-0eb6-4a01-97e1-6b4f695108fa", "node_type": "4", "metadata": {}, "hash": "7077330cb1d54d5f2c11a31e3945327004a8ec68191c0c214fabccfd83276c93", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "12777536-ed0f-4c6e-b56f-217c5e392a8d", "node_type": "1", "metadata": {}, "hash": "ca6407a93fec5cc87c377e1101d844d347ef3fdda9216fe9b5433d177907d4c0", "class_name": "RelatedNodeInfo"}}, "text": "# PRBv3 Deployment Guide\n\n## Basic Requirements\n\nTo use PRBv3 (Runtime Bridge) for worker deployment, you need at least 1 additional device as the management server. The device connection is shown in the following diagram:\n\n<figure><img src=\"https://github.com/doyleguo/phala-wiki-next/assets/110812052/5ccdd9d5-a4da-434b-b231-fd8e64800873\" alt=\"\"><figcaption></figcaption></figure>\n\n> The node service and PRB service can be run on the same server as needed (depending on the number of workers and server performance).\n\n### Server Configuration Requirements\n\nThe PRB management server needs to run 2 main components, Node and PRB. The requirements for each component are as follows:\n\n| Components  | RAM Space | Harddisk Space | Remark                                                         |\n| ----------- | --------- | -------------- | -------------------------------------------------------------- |\n| Node        | 4GB+      | 3TB+ NVME      | harddisk requirement increasing, 8TB will be best              |\n| PRB         | 4GB+      | 0              | RAM requirement depends on worker number, 16GB+ will be better |\n| **Totally** | 32GB+     | 4TB            | -                                                              |\n\n> You also need to ensure good network connectivity between the management server and PRB workers, and the network of the PRB management server needs to have more than 10TB of traffic space per month.\n\n### PRB Worker requirements\n\nPRB\u2019s worker only needs to run a pRuntime, so the requirements for running a PRB worker are:\n\n* Support for SGX features\n* Ubuntu 22.04.2 LTS operating system and a system kernel of 5.13 or higher\n* At least 4 CPU cores\n* 8GB of memory\n* 128GB NVME\n\n## PRB Components Deployment\n\n### Preparations\n\nAfter installing the Ubuntu OS, first install the necessary Docker program.\n\n```undefined\nsudo apt update && sudo apt upgrade -y && sudo apt autoremove -y\nsudo apt install docker-compose\n```\n\nThen create a folder locally, and create a docker-compose document and other necessary documents within it.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2064, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "12777536-ed0f-4c6e-b56f-217c5e392a8d": {"__data__": {"id_": "12777536-ed0f-4c6e-b56f-217c5e392a8d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/prbv3-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "35d0b890-0eb6-4a01-97e1-6b4f695108fa", "node_type": "4", "metadata": {}, "hash": "7077330cb1d54d5f2c11a31e3945327004a8ec68191c0c214fabccfd83276c93", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a0e4d58c-b4d6-474b-81b5-41996a0872c0", "node_type": "1", "metadata": {}, "hash": "ea8d034f9c357e71ef65d76e8850c4bbc980a279500894ed88fc5fd95a55e2f5", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a2c3f961-21d6-498f-a411-08701481c3e7", "node_type": "1", "metadata": {}, "hash": "bbc987f04cd60853d84b65105aa216dea1c35ee2b848f85f8d6ba6637f3f73ac", "class_name": "RelatedNodeInfo"}}, "text": "```bash\nmkdir prb-deployment\ncd ./prb-deployment\ntouch docker-compose.yml\ntouch wm.yml\nmkdir prb-wm-data\ncd ./prb-wm-data\ntouch ds.yml\ncd ..\n```\n\nThe relationship of the file path is like\uff1a\n\n* prb-deployment folder\n  * docker-compose.yml\n  * wm.yml\n  * prb-wm-data folder\n    * ds.yml\n\n### Document Editing\n\nYou need to edit a total of 3 documents: the main PRB docker-compose.yml file; the wm.yml file (worker manager); and the ds.yml file (data source).\n\nFirst is the main PRB docker-compose file. In this document, the following code has been added to the configuration of the node-related components. If you don\u2019t need to run the node service and the PRB service on the same server, you can optionally delete the unnecessary parts.\n\nUse the following command to edit the docker-compose.yml document.\n\n```bash\nvim ./docker-compose.yml \n```\n\nAfter entering, you will access the document.\n\nAt this point, enter `a` and you will start editing the document. Paste the following content into the document.", "mimetype": "text/plain", "start_char_idx": 2066, "end_char_idx": 3068, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a2c3f961-21d6-498f-a411-08701481c3e7": {"__data__": {"id_": "a2c3f961-21d6-498f-a411-08701481c3e7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/prbv3-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "35d0b890-0eb6-4a01-97e1-6b4f695108fa", "node_type": "4", "metadata": {}, "hash": "7077330cb1d54d5f2c11a31e3945327004a8ec68191c0c214fabccfd83276c93", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "12777536-ed0f-4c6e-b56f-217c5e392a8d", "node_type": "1", "metadata": {}, "hash": "ca6407a93fec5cc87c377e1101d844d347ef3fdda9216fe9b5433d177907d4c0", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "252ce6b8-4b9f-45f2-9be5-fddcfe8a5a88", "node_type": "1", "metadata": {}, "hash": "9082f7cdcc34327519e8dc6c1e12971ad8ba4ed11f1f6f28d341a052915a0759", "class_name": "RelatedNodeInfo"}}, "text": "(Please note that the file content remains consistent and the indentation alignment of each line is consistent with this document)\n\n```yaml\nversion: \"3\"\nservices:\n  node:\n    image: phalanetwork/khala-node:latest\n    container_name: node\n    hostname: node\n    restart: always\n    ports:\n     - \"9944:9944\"\n     - \"9945:9945\"\n     - \"30333:30333\"\n     - \"30334:30334\"\n    environment:\n     - NODE_NAME=PNODE\n     - NODE_ROLE=MINER\n     - PARACHAIN_EXTRA_ARGS=--max-runtime-instances 32 --runtime-cache-size 8 --rpc-max-response-size 64\n     - RELAYCHAIN_EXTRA_ARGS=--max-runtime-instances 32 --runtime-cache-size 8 --rpc-max-response-size 64\n    volumes:\n     - /var/khala/node-data:/root/data\n\n  wm:\n    image: phalanetwork/prb3:latest\n    hostname: prb-local\n    restart: always\n    network_mode: host\n    logging:\n      options:\n        max-size: \"1g\"\n    environment:\n      - MGMT_LISTEN_ADDRESSES=0.0.0.0:3001\n      - RUST_BACKTRACE=1\n      - RUST_LOG=info,pherry=off,phactory_api=off,prb=info\n    volumes:\n      - ./prb-wm-data:/var/data/prb-wm\n  monitor:\n    image: phalanetwork/prb3-monitor:latest\n    restart: always\n    network_mode: host\n    volumes:\n      - ./wm.yml:/app/public/wm.yml\n```\n\nAfter entering, complete the following steps to finish the text editing and save successfully.\n\n```javascript\n1\u3001Click \"esc\"\n2\u3001Enter \":wq\"\n3\u3001Click \"Enter\"\uff0cquit the editing page\n```\n\nNext is the wm.yml file. Edit the wm.yml document with the following command:\n\n```bash\nvim ./wm.yml \n```\n\nSimilarly, enter `a` to start editing the document and paste the following content into the document.", "mimetype": "text/plain", "start_char_idx": 3069, "end_char_idx": 4660, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "252ce6b8-4b9f-45f2-9be5-fddcfe8a5a88": {"__data__": {"id_": "252ce6b8-4b9f-45f2-9be5-fddcfe8a5a88", "embedding": null, "metadata": {"file_path": "phala-docs_dist/prbv3-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "35d0b890-0eb6-4a01-97e1-6b4f695108fa", "node_type": "4", "metadata": {}, "hash": "7077330cb1d54d5f2c11a31e3945327004a8ec68191c0c214fabccfd83276c93", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a2c3f961-21d6-498f-a411-08701481c3e7", "node_type": "1", "metadata": {}, "hash": "bbc987f04cd60853d84b65105aa216dea1c35ee2b848f85f8d6ba6637f3f73ac", "class_name": "RelatedNodeInfo"}}, "text": "```yaml\n- name: local-prb\n  endpoint: http://127.0.0.1:3001\n  proxied: true\n```\n\nAfter entering the content, save and return to the previous directory.\n\n```javascript\n1\u3001Click \"esc\"\n2\u3001Enter \":wq\"\n3\u3001Click \"Enter\"\uff0cquit the editing page\n```\n\nFinally, edit the ds document.\n\n```bash\nvim ./prb-wm-data/ds.yml \n```\n\nenter `a` to start editing the document and paste the following content into the document.\n\n```yaml\n---\nrelaychain:\n  select_policy: Failover # or Random\n  data_sources:\n    - !SubstrateWebSocketSource\n      endpoint: ws://{node-ip}:9945\n      pruned: false\nparachain:\n  select_policy: Failover\n  data_sources:\n    - !SubstrateWebSocketSource\n      endpoint: ws://{node-ip}:9944\n      pruned: false\n```\n\n> There are 2 parameters here that need to be user-defined: ws://{node-ip}:9945 & ws://{node-ip}:9944;\n>\n> You need to replace {node-ip} with the IP of the server where the node is located. If you are running the node and PRB on the same server, use your own ip there.\n>\n> If you don't need the PRBv3 connect to the headers-cache, delete the part of&#x20;\n>\n> `- !HeadersCacheHttpSource`&#x20;\n>\n> `endpoint: http://`{headerscache-ip}`:21111`\n\nAfter entering the content, save and return to the previous directory.\n\n```javascript\n1\u3001Click \"esc\"\n2\u3001Enter \":wq\"\n3\u3001Click \"Enter\"\uff0cquit the editing page\n```\n\n### Program Execution\n\nInside the newly created folder `prb-deployment`, run the docker-compose, and the essential components for PRB will run successfully.\n\n```undefined\nsudo docker-compose up -d\n```\n\n\\\\", "mimetype": "text/plain", "start_char_idx": 4662, "end_char_idx": 6180, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5fd61517-9a5f-4abc-9b42-f170a931212e": {"__data__": {"id_": "5fd61517-9a5f-4abc-9b42-f170a931212e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/compatibility-matrix.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "5eddd77b-e491-4c34-8131-223fb436a650", "node_type": "4", "metadata": {}, "hash": "5a9fc85a14fd884b13d8bb742a7648bf134631fcec398ae1953db031766081fe", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f7bd4697-0209-4919-9020-bdc069101124", "node_type": "1", "metadata": {}, "hash": "d8093c4140c88ded5ed6175580a92b5111422f9dc10c20f3b2de85e960c39547", "class_name": "RelatedNodeInfo"}}, "text": "# Compatibility Matrix\n\n{% hint style=\"danger\" %}\nNote that the following information relates to the legacy AI Agent Contracts known previously as Phat Contract.\n{% endhint %}\n\nThese are the minimum supported Rust crate versions for the initial release of Phat Contract.\n\n| Rust Crate                                                                                       | Minimum Version | Definition                                                                                                                                                                                                                                                                                                                                                                                    |\n| ------------------------------------------------------------------------------------------------ | --------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| [ink](https://docs.rs/ink/4.2.0/ink/index.html)                                                  | v4.2.0          | ink! is an [eDSL](https://wiki.haskell.org/Embedded\\_domain\\_specific\\_language) to write smart contracts in Rust for blockchains built on the [Substrate](https://github.com/paritytech/substrate) framework. ink! contracts are compiled to WebAssembly.                                                                                                                                    |\n| [pink-extension](https://docs.rs/pink-extension/0.4.3/pink\\_extension/)                          | v0.4.3.         | pink! is based on Parity's ink! language and provide some extra functionality to interact with phala's phat contract runtime.                                                                                                                                                                                                                                                                 |\n| [pink-utils](https://docs.rs/pink-utils/0.4.1/pink\\_utils/)                                      | v0.4.1          | Useful utilities for pink!.                                                                                                                                                                                                                                                                                                                                                                   |\n| [pink-extension-macro](https://docs.rs/pink-extension-macro/0.4.2/pink\\_extension\\_macro/)       | v0.4.2          | Macros for writing phat contract.                                                                                                                                                                                                                                                                                                                                                             |\n| [pink-extension-runtime](https://docs.rs/pink-extension-runtime/0.4.2/pink\\_extension\\_runtime/) | v0.4.2          | Mock pink chain extension for Phala pink contract.                                                                                                                                                                                                                                                                                                                                            |\n| [pink-web3](https://docs.rs/pink-web3/0.20.2/pink\\_web3/)                                        | v0.20.2         | Ethereum JSON-RPC client for pink. Port of [rust-web3](https://github.com/tomusdrw/rust-web3) to Pink contract.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 4023, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f7bd4697-0209-4919-9020-bdc069101124": {"__data__": {"id_": "f7bd4697-0209-4919-9020-bdc069101124", "embedding": null, "metadata": {"file_path": "phala-docs_dist/compatibility-matrix.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "5eddd77b-e491-4c34-8131-223fb436a650", "node_type": "4", "metadata": {}, "hash": "5a9fc85a14fd884b13d8bb742a7648bf134631fcec398ae1953db031766081fe", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5fd61517-9a5f-4abc-9b42-f170a931212e", "node_type": "1", "metadata": {}, "hash": "4798e6954bc7cb920cf0180279ef78d2ccfadcb9a2b246e8857ac184a1361de7", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "52d9b7bc-8724-4dac-8562-23694a40c21a", "node_type": "1", "metadata": {}, "hash": "50cb9ae1a411673dab79b21b1647c36d654bf65ff4620c69f8d641b8539c2348", "class_name": "RelatedNodeInfo"}}, "text": "|\n| [pink-json](https://docs.rs/pink-json/0.4.0/pink\\_json/)                                         | v0.4.0          | `serde_json` for pink programs. The serde-json-core with `alloc::*` types.                                                                                                                                                                                                                                                                                                                    |\n| [pink-ethabi](https://docs.rs/pink-ethabi/17.2.0/pink\\_ethabi/)                                  | v17.2.0         | Easy to use conversion of ethereum contract calls to bytecode. Ethereum ABI encoding decoding library.                                                                                                                                                                                                                                                                                        |\n| [pink-kv-session](https://docs.rs/pink-kv-session/0.2.0/pink\\_kv\\_session/)                      | v0.2.0          | KV session primitives for phat off-chain rollup.                                                                                                                                                                                                                                                                                                                                              |\n| [pink-erased-serde](https://docs.rs/pink-erased-serde/0.3.23/pink\\_erased\\_serde/)               | v0.3.23         | <p>Type-erased Serialize and Serializer traits. This crate provides type-erased versions of Serde's <code>Serialize</code>, <code>Serializer</code> and <code>Deserializer</code> traits that can be used as <a href=\"https://doc.rust-lang.org/book/first-edition/trait-objects.html\">trait objects</a>.<br><br>Note: Floating points operations are removed to run in <code>ink!</code></p> |\n| [pink-s3](https://docs.rs/pink-subrpc/0.4.2/pink\\_subrpc/)                                       | v0.5.0          | A substrate rpc client running in pink. Substrate json RPC module with limited functionalities.                                                                                                                                                                                                                                                                                               |\n| [sidevm](https://docs.rs/sidevm/0.1.10/sidevm/)                                                  | v0.1.10         | Framework to help developing phala sidevm program. This crate provides some instrumentation to write sidevm programs. It is built on top of the Sidevm ocalls.                                                                                                                                                                                                                                |\n| [sidevm-macro](https://docs.rs/sidevm-macro/0.1.1/sidevm\\_macro/)                                | v0.1.1          | Macros for writing fat contract sidevm program.", "mimetype": "text/plain", "start_char_idx": 4294, "end_char_idx": 7480, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "52d9b7bc-8724-4dac-8562-23694a40c21a": {"__data__": {"id_": "52d9b7bc-8724-4dac-8562-23694a40c21a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/compatibility-matrix.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "5eddd77b-e491-4c34-8131-223fb436a650", "node_type": "4", "metadata": {}, "hash": "5a9fc85a14fd884b13d8bb742a7648bf134631fcec398ae1953db031766081fe", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f7bd4697-0209-4919-9020-bdc069101124", "node_type": "1", "metadata": {}, "hash": "d8093c4140c88ded5ed6175580a92b5111422f9dc10c20f3b2de85e960c39547", "class_name": "RelatedNodeInfo"}}, "text": "|\n| [sidevm-env](https://docs.rs/sidevm-env/0.1.7/sidevm\\_env/)                                      | v0.1.7          | The low level protocol between sidevm guest and host.                                                                                                                                                                                                                                                                                                                                         |\n| [sidevm-logger](https://docs.rs/sidevm-logger/0.1.1/sidevm\\_logger/)                             | v0.1.1          | A logger works in sidevm guest program. Enabling a logger for sidevm programs.                                                                                                                                                                                                                                                                                                                |", "mimetype": "text/plain", "start_char_idx": 7815, "end_char_idx": 8822, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "30cc0192-170c-4ed9-8d51-c3f58724c9da": {"__data__": {"id_": "30cc0192-170c-4ed9-8d51-c3f58724c9da", "embedding": null, "metadata": {"file_path": "phala-docs_dist/tutorial.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "499248cd-8d1b-4223-ab15-da5f30c4c088", "node_type": "4", "metadata": {}, "hash": "83b8e057a119529448eed7c55e8f128239f1a0724c1c9b9433d3d1d3c90b7851", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83e\uddd1\u200d\ud83c\udfeb Tutorial\n\n{% embed url=\"https://youtu.be/uSY-0NxEnFY\" %}", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 62, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4d2a3531-2ef3-44e7-86d4-59a68d18419d": {"__data__": {"id_": "4d2a3531-2ef3-44e7-86d4-59a68d18419d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/wapojs-functions.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "b249013c-0cb7-462e-90c4-24d3cb9faf69", "node_type": "4", "metadata": {}, "hash": "feab14da802ffe892cf293f3983866146823da6be1e7e4a44b9d50af691e2f93", "class_name": "RelatedNodeInfo"}}, "text": "# WapoJS Functions\n\nHere is a list of the available functions for developers to utilize when building on the AI Agent Contract.\n\n```typescript\n/**\n* Derives a secret key from a salt. The same app with the same salt on the same worker will always\n* derive the same secret. However, the same app with the same salt on different workers will derive\n* different secrets.\n*/\nderiveSecret(salt: Uint8Array | string): Uint8Array;\n\n/**\n* Hashes a message using the specified algorithm.\n* @param algrithm - The name of the hash algorithm to use.\n*    Supported values are \"blake2b128\", \"blake2b256\", \"blake2b512\", \"sha256\", \"keccak256\"\n* @param message - The message to hash, either as a Uint8Array or a string.\n*/\nhash(algrithm: 'blake2b128' | 'blake2b256' | 'blake2b512' | 'sha256' | 'keccak256', message: Uint8Array | string): Uint8Array;\n\n/**\n* Non-cryptographic hashing, current only supported wyhash64 64-bit hash. Non-cryptographic algorithms\n* are optimized for speed of computation over collision-resistance or seurity.\n*\n* @param algrithm - The name of the hash algorithm to use.\n*    Supported values are \"wyhash64\"\n* @param message - The message to hash, either as a Uint8Array or a string.\n*/\nnonCryptographicHash(algrithm: 'wyhash64', message: Uint8Array | string): Uint8Array;\n\n/**\n* Concatenates multiple Uint8Array objects into a single Uint8Array.\n*\n* @param arrays - The arrays to concatenate.\n*/\nconcatU8a(arrays: Uint8Array[]): Uint8Array;\n```", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1455, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "aa4d5d01-7e28-4aa1-99a9-1f8ddf3f56f8": {"__data__": {"id_": "aa4d5d01-7e28-4aa1-99a9-1f8ddf3f56f8", "embedding": null, "metadata": {"file_path": "phala-docs_dist/define-your-agent.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "1d1d0ff8-6327-42eb-9191-3a9b32c89ea5", "node_type": "4", "metadata": {}, "hash": "070ed1c55bf6863e93b444cf5768fddea8ef18eb27016a015bf8bef1aec8ece6", "class_name": "RelatedNodeInfo"}}, "text": "# Define Your Agent\n\n<figure><img src=\"../../.gitbook/assets/WIP.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 111, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "84b1d7a7-ade2-4fd8-8516-fb2307f7db92": {"__data__": {"id_": "84b1d7a7-ade2-4fd8-8516-fb2307f7db92", "embedding": null, "metadata": {"file_path": "phala-docs_dist/faucet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "b4aa2986-211b-4cca-9b97-989baa3c3ad6", "node_type": "4", "metadata": {}, "hash": "2b7ca7c29b465d0449e7f670b92dcbee8ed467656db5529b311aa0e5feba09c4", "class_name": "RelatedNodeInfo"}}, "text": "# Faucet\n\nVisit the Phala Network Faucet to get testnet tokens.\n\n{% embed url=\"https://phala.network/faucet\" %}", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 111, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f641cc80-beab-48ed-b54b-af58340cbb5c": {"__data__": {"id_": "f641cc80-beab-48ed-b54b-af58340cbb5c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/whats-vault.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "21c4d294-e20e-4923-80c2-b5fb42b52f8b", "node_type": "4", "metadata": {}, "hash": "9e391f18104ad3cedeba4fd5e0f78627fe4790a2ef760ed8069a7582f043ee21", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "612197e1-3572-4462-9010-53eb0f2017fd", "node_type": "1", "metadata": {}, "hash": "037ac1d4b8d8c1ac0ffd46330487e3aa1bc860634dcf36a2d476b6558397a425", "class_name": "RelatedNodeInfo"}}, "text": "# What is Vault\n\nVault is a function designed for delegation proxy. Vaults are pools of funds with an associated strategy that aims to maximize returns on the assets they hold.\n\nDelegators can also skip Vault and delegate to StakePool directly.\n\n## Why do we need Vault? <a href=\"#why-do-we-need-vault\" id=\"why-do-we-need-vault\"></a>\n\n\u2018Delegating\u2019 refers to the process of contributing tokens to a public validator node. In Phala Network, delegating is referred to as \u2018stake to earn\u2019, whereby delegators receive incentives from the rewards of active workers.\n\nStakePools, which are overseen by pool operators, enables users to pool their tokens to increase their chances of earning block rewards. However, for novice delegators, it is often difficult to identify high-quality StakePools, as this process is dependent upon utilizing complex indicators such as creation time, past performance, APR, etc.\n\nThe \u2018quality\u2019 of a StakePool can be determined by its performance in rewarding its delegators consistently. Therefore, if delegators unknowingly select a \u2018bad\u2019 StakePool, they\u2019re at risk of receiving decreased rewards or no rewards. Minimizing the probability of this occurring is crucial to maintaining community confidence and avoiding risks of network instability.\n\nVaults increase the probability of high-performance workers being chosen as experienced agents are incentivized to assist with the process of StakePool selection.\n\n## About Vault <a href=\"#about-vault\" id=\"about-vault\"></a>\n\n> Before you start to understand Vault, please make sure you have a clear understanding of [how StakePool works](delegate-to-stakepool.md#how-it-works)\n\n### How Vault works? <a href=\"#how-vault-works\" id=\"how-vault-works\"></a>\n\n![](https://i.imgur.com/OyI4jab.png)\n\nThe above image illustrates how our delegation system operates with the introduction of Vaults.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1858, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "612197e1-3572-4462-9010-53eb0f2017fd": {"__data__": {"id_": "612197e1-3572-4462-9010-53eb0f2017fd", "embedding": null, "metadata": {"file_path": "phala-docs_dist/whats-vault.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "21c4d294-e20e-4923-80c2-b5fb42b52f8b", "node_type": "4", "metadata": {}, "hash": "9e391f18104ad3cedeba4fd5e0f78627fe4790a2ef760ed8069a7582f043ee21", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f641cc80-beab-48ed-b54b-af58340cbb5c", "node_type": "1", "metadata": {}, "hash": "6f7cba4c86e1e9ad9141bb5d8463621e156c6c1cf8f7aa7f9abd9cc774b29695", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "aac93046-4dfe-4349-8986-2a57dfeb19d3", "node_type": "1", "metadata": {}, "hash": "5d27e5ecb2ed4a4637cf362a8fc79c893b6e9df463c96bc7c9aabdf8f10ce507", "class_name": "RelatedNodeInfo"}}, "text": "PHA holders will be able to delegate into either a StakePool or a Vault, taking into account the following:\n\n* Vault owners select and delegate the Vault\u2019s PHA to \u2018high-quality\u2019 StakePools;\n* A Vault owner\u2019s reward is based upon the commission share (set by the Vault owner) of all delegation rewards accrued by the Vault;\n* To the StakePool, there is no difference between delegations from common delegators or Vaults;\n* A Vault cannot delegate to other Vaults.\n\n### Vault delegation NFTization <a href=\"#vault-delegation-nftization\" id=\"vault-delegation-nftization\"></a>\n\nWith the introduction of Vaults, there will now be two categories of delegation NFTs: a Proof of Delegation NFT (Vault NFT) representing delegation to a Vault, and a Certificate of StakePool Delegation NFT representing delegation directly to a StakePool. Same as delegating to StakePools, when the user delegates to a Vault, the user will also receive a Delegation NFT as proof of your Delegation in the Vault.\n\nThe Vault Delegation NFT has the same function as the StakePool Delegation NFT: it will be transferable and able to be sold in the PhalaWorld marketplace.\n\n> NOTE When your Delegation NFT is transferred or sold to someone else, the delegated PHA will no longer belong to you, because you have lost the certificate to withdraw it back from the corresponding Vault.\n\n### Vault only has \u201cDelegate\u201d and \u201cWithdraw\u201d permissions <a href=\"#vault-only-has-delegate-and-withdraw-permissions\" id=\"vault-only-has-delegate-and-withdraw-permissions\"></a>\n\nVault owners only have permission to move PHA in and out of StakePools. Therefore, **Vault owners can NEVER transfer your tokens to an external account.** This avoids your assets from being permanently locked or tampered with.\n\nFor Vault users, **please ensure that you never transfer your assets to Vault account, only delegate them.**\n\n### Different withdrawal scenarios between Vault and StakePool <a href=\"#different-withdrawal-scenarios-between-vault-and-stakepool\" id=\"different-withdrawal-scenarios-between-vault-and-stakepool\"></a>\n\n![](https://i.imgur.com/LpHll0z.png)\n\nAll tokens delegated by the delegators to Vault will most likely be delegated to the StakePool.", "mimetype": "text/plain", "start_char_idx": 1859, "end_char_idx": 4061, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "aac93046-4dfe-4349-8986-2a57dfeb19d3": {"__data__": {"id_": "aac93046-4dfe-4349-8986-2a57dfeb19d3", "embedding": null, "metadata": {"file_path": "phala-docs_dist/whats-vault.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "21c4d294-e20e-4923-80c2-b5fb42b52f8b", "node_type": "4", "metadata": {}, "hash": "9e391f18104ad3cedeba4fd5e0f78627fe4790a2ef760ed8069a7582f043ee21", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "612197e1-3572-4462-9010-53eb0f2017fd", "node_type": "1", "metadata": {}, "hash": "037ac1d4b8d8c1ac0ffd46330487e3aa1bc860634dcf36a2d476b6558397a425", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "67f5827e-5b01-43ad-a8ae-b55053e34b09", "node_type": "1", "metadata": {}, "hash": "839441c3d942cd8c2cc1b07eab898436778236141101c2da59fb574649d3cca9", "class_name": "RelatedNodeInfo"}}, "text": "When the delegators want to withdraw tokens from the Vault, once there are not enough free delegations in the Vault, the Vault needs to apply to the StakePool for withdrawal.\n\nAs Vaults are derivatives of StakePool delegations, withdrawals from Vaults are already subject to the maximum StakePool withdrawal period of 14 days. For Vaults, we\u2019ve extended this withdrawal period by a week to allow for asset turnover within the Vault, making the maximum withdrawal period 21 days.\n\nWithin seven days after the withdrawal queue of the delegator is created, the Vault owner needs to ensure that the Vault has enough free delegation to eliminate the withdrawal queue, or initiate a withdrawal application to the StakePool within seven days.\n\nSeven days after the withdrawal queue is created, once a delegator initiates a check balance transaction, and at the same time, the total amount of withdrawal requests to the StakePool and the free delegation in Vault is not enough to repay the withdrawal queue, the Vault will be frozen until the withdraw queues in the Vault are all eliminated.\n\nThe Vault being frozen means:\n\n* Vault will initiate the withdrawal application for the entire delegation amount to all StakePools it delegated\n* During the freezing process, the Vault Owner cannot conduct any other transactions except for delegating to the Vault\n\n### All rewards in Vault come from the StakePool <a href=\"#all-rewards-in-vault-come-from-the-stakepool\" id=\"all-rewards-in-vault-come-from-the-stakepool\"></a>\n\nVault does not create additional rewards, all rewards in Vault come from StakePool. The vault owner achieves the highest vault APY by choosing a StakePool with the highest APR.\n\nThe reason why we call StakePool\u2019s rate of return APR, and Vault\u2019s APY is\uff1a\n\n* Individual StakePool rewards can only increase with the addition of new workers. StakePool rewards are derived from workers, and each worker can only earn a finite amount of income regardless of how much the delegation amount in the StakePool increases. Additional rewards can be earned only when the StakePool owner adds new workers.\n* Vault\u2019s delegation rewards come from the StakePool\u2019s delegator rewards.", "mimetype": "text/plain", "start_char_idx": 4062, "end_char_idx": 6237, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "67f5827e-5b01-43ad-a8ae-b55053e34b09": {"__data__": {"id_": "67f5827e-5b01-43ad-a8ae-b55053e34b09", "embedding": null, "metadata": {"file_path": "phala-docs_dist/whats-vault.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "21c4d294-e20e-4923-80c2-b5fb42b52f8b", "node_type": "4", "metadata": {}, "hash": "9e391f18104ad3cedeba4fd5e0f78627fe4790a2ef760ed8069a7582f043ee21", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "aac93046-4dfe-4349-8986-2a57dfeb19d3", "node_type": "1", "metadata": {}, "hash": "5d27e5ecb2ed4a4637cf362a8fc79c893b6e9df463c96bc7c9aabdf8f10ce507", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "726d1005-8160-402e-a83f-eff4b78ee64c", "node_type": "1", "metadata": {}, "hash": "66fc6807a7baf61477b48413acda973da765305ebbf2c060f58e523ea6b66d40", "class_name": "RelatedNodeInfo"}}, "text": "When the StakePool owner cannot add workers in time, the vault owner can transfer funds between different StakePools to realize that each token is effectively earning rewards, not limited to the growth rate of workers\n\n## About Vault Owner <a href=\"#about-vault-owner\" id=\"about-vault-owner\"></a>\n\n### How is the Vault owner\u2019s reward calculated? <a href=\"#how-is-the-vault-owners-reward-calculated\" id=\"how-is-the-vault-owners-reward-calculated\"></a>\n\nThe vault owner will get a commission based on the delegator rewards of the delegation in the vault. This commission value is set by the Vault Owner and it will be manually executed by the Vault owner. After each execution, the rewards earned between the last two executions will be used as the base to draw a commission for the pool owner.\n\nThe Share Price ([Click here to learn what\u2019s Share](whats-share.md)) in the pool will change with each reward or slash. Between the last two commission executions, the number of Share Price changes multiplied by the total value of Shares represents the sum of total rewards and Slash in the pool which was issued accumulatively during this period.\n\nWe extract commissions from the stock delegation by issuing additional Shares for the Vault. The additional Shares will still be stored in the Vault and can be assigned by the Vault owner.", "mimetype": "text/plain", "start_char_idx": 6238, "end_char_idx": 7569, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "726d1005-8160-402e-a83f-eff4b78ee64c": {"__data__": {"id_": "726d1005-8160-402e-a83f-eff4b78ee64c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/whats-vault.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "21c4d294-e20e-4923-80c2-b5fb42b52f8b", "node_type": "4", "metadata": {}, "hash": "9e391f18104ad3cedeba4fd5e0f78627fe4790a2ef760ed8069a7582f043ee21", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "67f5827e-5b01-43ad-a8ae-b55053e34b09", "node_type": "1", "metadata": {}, "hash": "839441c3d942cd8c2cc1b07eab898436778236141101c2da59fb574649d3cca9", "class_name": "RelatedNodeInfo"}}, "text": "Here is an example:\n\n| Action                           | Delegation in Vault | Total Share | Share price | remarks                                             |\n| -------------------------------- | ------------------- | ----------- | ----------- | --------------------------------------------------- |\n| Tom Create the Vault #001        | 0                   | 0           | 1           | The initial price is 1                              |\n| Bob delegates 10000 $PHA in #001 | 10000               | 10000       | 1           | Bob has 1000 Shares                                 |\n| #001 earned 50 $PHA rewards      | 10050               | 10000       | 1.005       | Bob still has 1000 Shares                           |\n| Jack delegates 3000 $PHA in #001 | 13050               | 12985.07    | 1.005       | Jack has 2,985.07 shares because the price is 1.005 |\n| Tom execute the commission(5%)   | 13050               | 12988.3     | 1.00475     | Tom got 3.23 Shares as the Vault owner reward       |\n\n### Recommendations for Vault Owner <a href=\"#recommendations-for-vault-owner\" id=\"recommendations-for-vault-owner\"></a>\n\nSuccessful Vault owners will be experienced members of the Phala community who are very familiar with managing StakePool delegations. Vault owners should be willing to commit significant time and effort to manage their Vault, which includes coordinating with StakePool owners and delegators, developing a delegation strategy, and onboarding newcomers. Vault ownership can be a very profitable activity, and it follows that the more you put into managing your Vault, the more you will get out of it.\n\nFor Delegators, we recommend evaluating Vaults based on their TVL and overall stability, which will be more important in the long run than the APY.", "mimetype": "text/plain", "start_char_idx": 7571, "end_char_idx": 9349, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d53c2ce5-af01-4ef6-934a-d78981d9d717": {"__data__": {"id_": "d53c2ce5-af01-4ef6-934a-d78981d9d717", "embedding": null, "metadata": {"file_path": "phala-docs_dist/technical-details.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "be784468-d046-4670-aef0-486824e83488", "node_type": "4", "metadata": {}, "hash": "1ad19bd430ad4a998f415edc5a6aa9c68fe854d74445c06ba903331a35646b29", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "63f3f431-f5bb-486f-98e6-5cb1d14377ee", "node_type": "1", "metadata": {}, "hash": "b85807d4573359c7b106233ea00b0c2e971087da817d01bf0cf97d622dde7d27", "class_name": "RelatedNodeInfo"}}, "text": "# Technical Details\n\nSubBridge is different from general cross-chain solutions in that they only realize the transfer of assets and data between two chains.\n\nSubBridge is more like a router linking different cross-chain bridges and allows asset transfer from one chain to any other chains which have been registered. For example, we have implemented the transfer of ERC20 assets on Moonriver and Ethereum to other parachains in the Polkadot ecosystem through SubBridge. To accomplish this, it is not necessary for the parachain receiving the asset to have an EVM cross-chain bridge integrated into its runtime. This is done by the SubBridge.\n\n<figure><img src=\"../../.gitbook/assets/subbridge-pallets.png\" alt=\"\"><figcaption><p>SubBridge pallet</p></figcaption></figure>\n\nAs shown in the figure below, SubBridge integrates the implementation of multiple bridges, here we use BridgeA, BridgeB, and BridgeC to represent. When SubBridge receives a cross-chain asset transfer, it will choose whether to forward the transaction to another chain according to the destination address. If the transaction is only transferred to an account in the Khala or Phala network, we will deposit the asset directly into the receiving account; in the case of another chain, usually, this needs to ensure:\n\n* The destination is already supported by a certain bridge, that is, the SubBridge will traverse the list of bridges to check whether the bridge supports transfers to the destination address, and if so, use this bridge for forwarding.\n* Make sure that the format of the path conforms to our specification \\[see next section] and still has enough assets as a fee to pay the cross-chain fee to the other chain.\n\nIt can be seen that we can not only realize the cross-chain transfer of assets through multiple bridges but also try to choose a transfer path with the lowest fee for users\n\n<figure><img src=\"../../.gitbook/assets/subbridge-topology.png\" alt=\"\"><figcaption><p>SubBridge Topology</p></figcaption></figure>\n\n## MultiAsset and MultiLocation <a href=\"#multiasset-and-multilocation\" id=\"multiasset-and-multilocation\"></a>\n\nThe purpose of SubBridge is to connect assets in multiple chains. Therefore, how to unify the definitions of assets and locations in multiple chains is the first problem we need to solve.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2302, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "63f3f431-f5bb-486f-98e6-5cb1d14377ee": {"__data__": {"id_": "63f3f431-f5bb-486f-98e6-5cb1d14377ee", "embedding": null, "metadata": {"file_path": "phala-docs_dist/technical-details.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "be784468-d046-4670-aef0-486824e83488", "node_type": "4", "metadata": {}, "hash": "1ad19bd430ad4a998f415edc5a6aa9c68fe854d74445c06ba903331a35646b29", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d53c2ce5-af01-4ef6-934a-d78981d9d717", "node_type": "1", "metadata": {}, "hash": "9a46abd78fad74b8b1b380b7b09bf9623b07e827a2829a1cd1782ceeffe263cf", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b1ab0de1-16f0-4f0f-b88c-6fcc4d86d6fe", "node_type": "1", "metadata": {}, "hash": "e7e7062c5f6fae713200c45902357f9880adf4320d240bd54bb2f1e8ac9f660d", "class_name": "RelatedNodeInfo"}}, "text": "After research, we thought of MultiAsset and MultiLocation in the Polkadot [XCM protocol](https://github.com/paritytech/xcm-format). MultiAsset is used to represent a certain asset on a certain chain. For example, the asset of PHA can be expressed as:\n\n```\nMultiAsset::new(Fungible(amount), Concrete(pha_location))\n```\n\n> Where `amount` is a certain amount of asset, `pha_location` is the path of PHA under the XCM protocol standard, which is defined by SubBridge and represented by MultiLocation, usually represented as:\n\n```\nMultiLocation::new(1, X1(Parachain(2035)))\n```\n\n> Among them, `2035` is the parachain ID of the Phala network. So how do we use the XCM protocol to represent any non-parachain\u2018s account address? It determines how SubBridge will recognize and forward cross-chain transactions.\n\nWhat we do in practice is that we incorporate other non-parachains into sub-addresses of the Phala network, similar to the local area network specified by TCP/IP. In this way, the account address of an EVM chain can be represented as:\n\n```\nMultiLocation::new(1, X4(Parachain(2035), GeneralKey(bridge), GeneralIndex(chain), GeneralKey(account)))\n```\n\n> Among them, `bridge` represents a specific bridge, for example, SygmaBridge uses sygma to represent; ChainBridge uses `cb` to represent; `chain` represents the ID of the EVM chain under the EVM Bridge system. Currently, Ethereum is 0 under both SygmaBridge and ChainBridge protocol; `account` represents the ID on the EVM chain. An account, usually a 20-byte hexadecimal string.\n\nSimilarly, the assets of any chain also need to be unified. The assets on the parachain are defined by the team of the parachain to define their corresponding MultiAsset; the EVM chain assets based on SubBridge are also defined as the sub-asset of the Khala network like the account address.", "mimetype": "text/plain", "start_char_idx": 2303, "end_char_idx": 4130, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b1ab0de1-16f0-4f0f-b88c-6fcc4d86d6fe": {"__data__": {"id_": "b1ab0de1-16f0-4f0f-b88c-6fcc4d86d6fe", "embedding": null, "metadata": {"file_path": "phala-docs_dist/technical-details.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "be784468-d046-4670-aef0-486824e83488", "node_type": "4", "metadata": {}, "hash": "1ad19bd430ad4a998f415edc5a6aa9c68fe854d74445c06ba903331a35646b29", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "63f3f431-f5bb-486f-98e6-5cb1d14377ee", "node_type": "1", "metadata": {}, "hash": "b85807d4573359c7b106233ea00b0c2e971087da817d01bf0cf97d622dde7d27", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "d1a2ee8b-0eb9-432f-8922-ab8631034fc8", "node_type": "1", "metadata": {}, "hash": "1f1cc50dc6f2b814843dc76ea0445828ccf30f114755120838e8bd45c5b58772", "class_name": "RelatedNodeInfo"}}, "text": "That is, the usual asset location would be represented as:\n\n```\nMultiLocation::new(1, X3(Parachain(2035), GeneralIndex(chain), GeneralKey(token)))\n```\n\n> Among them, `token` represents the contract address of a certain ERC20 or ERC721 of EVM.\n\n## Asset Registration <a href=\"#asset-registration\" id=\"asset-registration\"></a>\n\nThe registration of SubBridge assets is mainly divided into two parts:\n\nThe first part is to register assets into the pallet-assets module. SubBridge uses the pallet-assets module provided by Substrate to manage the registered assets. The registered assets will be assigned an asset id. Each asset has an extra [registry info](https://github.com/Phala-Network/khala-parachain/blob/5ab4f77163c811fb4a02d337791ce669b41481ad/pallets/assets-registry/src/lib.rs#L62) which contains information of location, enabled bridges and properties. Unregistered assets will fail regardless of whether they are transferred via the EVM bridge or the XCM bridge.\n\nThe second part is to enable the corresponding EVM bridge. This part is only for the asset settings that want to carry out the cross-chain requirement from Phala to the EVM chain. In SubBridge, the same asset can enable both SygmaBridge-based bridges and ChainBridge-based bridges. In practice, users are always willing to choose solutions with lower fees.\n\nThe steps to do the registration stuff are as follow:\n\n*   Step1, we schedule a call of `pallet-registry::forceRegisterAsset` with given registration informations. When the council enacted the call, an asset instance will be created by `pallet-assets`, and some extra registration information will be saved in `pallet-registry`.\n\n    There are several things we need to pay attention to. The first one is that each asset has a bunch of metadata defined in `pallet-assets`, like `name`, `symbol`, etc. We have provided an extrinsic called `forceSetMetadata` in `pallet-registry` which can be used to update the metadata of an asset. Another one is that each asset has some privileged accounts used to manage the asset, like `Issuer`, `Admin`, etc. Different account has different permission.", "mimetype": "text/plain", "start_char_idx": 4131, "end_char_idx": 6251, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d1a2ee8b-0eb9-432f-8922-ab8631034fc8": {"__data__": {"id_": "d1a2ee8b-0eb9-432f-8922-ab8631034fc8", "embedding": null, "metadata": {"file_path": "phala-docs_dist/technical-details.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "be784468-d046-4670-aef0-486824e83488", "node_type": "4", "metadata": {}, "hash": "1ad19bd430ad4a998f415edc5a6aa9c68fe854d74445c06ba903331a35646b29", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b1ab0de1-16f0-4f0f-b88c-6fcc4d86d6fe", "node_type": "1", "metadata": {}, "hash": "e7e7062c5f6fae713200c45902357f9880adf4320d240bd54bb2f1e8ac9f660d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b5b37d19-fac6-4ce9-9189-b67266fbe7aa", "node_type": "1", "metadata": {}, "hash": "7cc4baddaa541fc8c03e4ad1aef5b096770c0d015e2ca0497d4da9ba94ff24e9", "class_name": "RelatedNodeInfo"}}, "text": "In `asset-registry`, we set all the privileged accounts of each asset to an account derived by `PalletId(b\"phala/ar\")`. This means no external account has permission to do things beyond authority.\n\n    All registered assets can be found at [here](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkhala.api.onfinality.io%2Fpublic-ws#/assets). The asset registration informations are stored on-chain, head to [polkadot.js.app](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkhala.api.onfinality.io%2Fpublic-ws#/chainstate) and choose RPC `assetsRegistry\u2192registryInfoByIds` to see details. Here is a screenshot of KSM registration information:\n*\n\n    <figure><img src=\"../../.gitbook/assets/subbridge-assetinfo.png\" alt=\"\"><figcaption><p>Registration infomartion of KSM</p></figcaption></figure>\n\n> Note: For assets on Phala, also can be found on `Assets` tab in polkadot.js app\n\n*   Step2\\[optional], after the asset was registered, by default all assets will enable XCM crosschain transfer. If the asset is going to enable SygmaBridge or ChainBridge, another call named `assetRegistry::forceEnabledSygmaBridge` or `assetRegistry::forceEnabledChainbridge` should be enacted by the council. This will enable the crosschain transfer to a specific EVM chain. And `assetRegistry::forceDisableSygmaBridge` or `assetRegistry::forceDisableChainBridge` is used to disable it. When SygmaBridge or ChainBridge was enabled for the asset, you will see we have new data being added to the returned registration information.", "mimetype": "text/plain", "start_char_idx": 6252, "end_char_idx": 7756, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b5b37d19-fac6-4ce9-9189-b67266fbe7aa": {"__data__": {"id_": "b5b37d19-fac6-4ce9-9189-b67266fbe7aa", "embedding": null, "metadata": {"file_path": "phala-docs_dist/technical-details.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "be784468-d046-4670-aef0-486824e83488", "node_type": "4", "metadata": {}, "hash": "1ad19bd430ad4a998f415edc5a6aa9c68fe854d74445c06ba903331a35646b29", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d1a2ee8b-0eb9-432f-8922-ab8631034fc8", "node_type": "1", "metadata": {}, "hash": "1f1cc50dc6f2b814843dc76ea0445828ccf30f114755120838e8bd45c5b58772", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "d7753ba1-84de-477f-b575-e8671552c23c", "node_type": "1", "metadata": {}, "hash": "4e93e8af421c36f5dbc34dc587b3a34232661bac9c05417a3856f0f1ab7ee07c", "class_name": "RelatedNodeInfo"}}, "text": "For example, the enabled-bridges information of ZLK is shown below:\n\n    ```\n    enabledBridges: [\n        {\n            config: Xcmp\n            metadata:\n        }\n        {\n            config: {\n            ChainBridge: {\n                chainId: 2\n                resourceId: 0x028da1efb56e124f659fa6d5d95b3cc541ce207cbfee2f4f066061cc92d37bae\n                reserveAccount: 0xde50ca45c8f7323ea372fd5d7929b9f37946690b0b668985beebe60431badcea\n                isMintable: false\n            }\n            }\n            metadata: 0x00\n        }\n    ]\n    ```\n\n    Looking at the ChainBridge filed, the `chainId` is 2 means it has enabled crosschain transfer between the Khala network and Moonriver EVM. `ResourceId` is used to bind ZLK on the Khala network and ERC20-ZLK on Moonriver EVM. `reserveAccount` is used to save ZLK temporarily when transferring ZLK from the Khala network to Moonriver EVM, and will transfer back to the recipient account when someone transfer ZLK from Moonriver EVM back to Khala network. `isMintable` is `false` tells the client that should aware of the ZLK balance of reserve account.\n\n* Step3\\[If Step2 has been done], we also need to config your asset in our ChainBridge [Bridge contract](https://github.com/Phala-Network/chainbridge-solidity/blob/phala-bridge/contracts/Bridge.sol) before finally launching the crosschain transfer through ChainBridge. It including:\n  * Binding resource id generated during registration with its ERC20 contract address. This essentially is done by executing method [adminSetResource](https://github.com/Phala-Network/chainbridge-solidity/blob/5eef3073ccc75b48e06ce44eee522c2023da974e/contracts/Bridge.sol#L204) of Bridge contract.", "mimetype": "text/plain", "start_char_idx": 7757, "end_char_idx": 9453, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d7753ba1-84de-477f-b575-e8671552c23c": {"__data__": {"id_": "d7753ba1-84de-477f-b575-e8671552c23c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/technical-details.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "be784468-d046-4670-aef0-486824e83488", "node_type": "4", "metadata": {}, "hash": "1ad19bd430ad4a998f415edc5a6aa9c68fe854d74445c06ba903331a35646b29", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b5b37d19-fac6-4ce9-9189-b67266fbe7aa", "node_type": "1", "metadata": {}, "hash": "7cc4baddaa541fc8c03e4ad1aef5b096770c0d015e2ca0497d4da9ba94ff24e9", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "4313eefb-69a2-454f-98c2-50cfe164ecd7", "node_type": "1", "metadata": {}, "hash": "fcb336e44169947fe4a7dd0d61a8aa08a3a9c65bca5ae35ab1bc951f84f91828", "class_name": "RelatedNodeInfo"}}, "text": "* Set decimals of the asset by executing method [adminSetDecimals](https://github.com/Phala-Network/chainbridge-solidity/blob/5eef3073ccc75b48e06ce44eee522c2023da974e/contracts/Bridge.sol#L247). SubBridge is compatible with the scenario that asset has different decimals between substrate side and EVM side.\n  * If your asset is burnable and would like to give the mint/burn permission to our contract, we need to tell the contract to mark your asset as burnable by executing method [adminSetBurnable](https://github.com/Phala-Network/chainbridge-solidity/blob/5eef3073ccc75b48e06ce44eee522c2023da974e/contracts/Bridge.sol#L236). With burnable set, when the user transfers asset from EVM chains, the asset would be burned directly from their account, and mint to the recipient account when someone transfers back to EVM chains.\n\n> Note: For SygmaBridge, asset config need to be done by Sygma team.\n\n### The Lifecycle of Cross-chain Transaction <a href=\"#the-lifecycle-of-cross-chain-transaction\" id=\"the-lifecycle-of-cross-chain-transaction\"></a>\n\n<figure><img src=\"../../.gitbook/assets/subbridge-lifecycle.png\" alt=\"\"><figcaption><p>Lifecycle of SubBridge Cross-chain Transaction</p></figcaption></figure>\n\nThe life cycle of a transfer across three chains can be described in the above figure. In the above picture, assets are transferred between Parachains on the left and EVM Chains on the right, passing through the Phala network in the middle.\n\nTake SygmaBridge as an example, when a cross-chain transfer is initiated from a parachain, after executing the local XCM command (such as burning a certain amount of assets from the sending account) it will be wrapped into a cross-chain XCM message and sent from the parachain to the Phala network, the XCM related modules of the Phala network will be responsible for processing the message. The transmission and instruction processing of XCM cross-chain messages are handled by Polkadot\u2019s XCM-related modules. During the execution of the instruction, when the DepositAsset instruction is executed, SubBridge will parse the payment address.", "mimetype": "text/plain", "start_char_idx": 9456, "end_char_idx": 11547, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4313eefb-69a2-454f-98c2-50cfe164ecd7": {"__data__": {"id_": "4313eefb-69a2-454f-98c2-50cfe164ecd7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/technical-details.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "be784468-d046-4670-aef0-486824e83488", "node_type": "4", "metadata": {}, "hash": "1ad19bd430ad4a998f415edc5a6aa9c68fe854d74445c06ba903331a35646b29", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d7753ba1-84de-477f-b575-e8671552c23c", "node_type": "1", "metadata": {}, "hash": "4e93e8af421c36f5dbc34dc587b3a34232661bac9c05417a3856f0f1ab7ee07c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "e2c19408-4c11-498a-898f-281a76d017b5", "node_type": "1", "metadata": {}, "hash": "dd677102cf33da968bc52226e0f67d32d2c86db4f0484e969716ad4259a9500f", "class_name": "RelatedNodeInfo"}}, "text": "If it points to the address of another EVM Chain, the transaction will be forwarded through the SygmaBridge module.\n\nSimilarly, when a cross-chain transfer is initiated from EVM Chains, the SygmaBridge Relayer will forward the message to the SygmaBridge pallet module of SubBridge. After the SygmaBridge module performs a series of verifications on the transaction, it will process the asset with the same logic. If it is resolved that the receiving address is not an address in the local Phala network but an address on a parachain, SubBridge\u2019s XCM module will be triggered to forward the transaction.\n\n## Other <a href=\"#other\" id=\"other\"></a>\n\nSubBridge's SygmaBridge in mantained by Phala team and Sygma team together. The substrate side is exist on Phala network, the smart contract on EVM side is deployed by Sygma team and the liquidity is maintained by both Phala team and Sygma team through multi-sig account.\n\nSubBridge\u2019s ChainBridge cross-chain bridge module is maintained and developed by the Phala team and is responsible for running three Relayers. The Relayer of the ChainBridge cross-chain bridge constructs the captured origin chain cross-chain transaction into a proposal, and then the three relayers vote on the Proposal. After the vote is passed, the proposal will be executed and the assets will be deposited in the user address.\n\nAbout ChainBridge, you can refer to their [websit](https://github.com/ChainSafe/ChainBridge)[e](https://github.com/ChainSafe/ChainBridge).\n\nFor the Phala Ethereum ChainBridge contract, please refer to the source code on [github](https://github.com/Phala-Network/chainbridge-solidity/tree/phala-bridge).\n\n## Code Auditing <a href=\"#code-auditing\" id=\"code-auditing\"></a>\n\nThe bridges currently integrated by SubBridge include 3 implementations, XCM, SygmaBridge, and ChainBridge.\n\nXCM is a cross-chain message protocol implemented by Parity Tech in the two networks of Polkadot and Kusama. Its code has been audited by a third-party audit firm hired by Parity.", "mimetype": "text/plain", "start_char_idx": 11548, "end_char_idx": 13559, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e2c19408-4c11-498a-898f-281a76d017b5": {"__data__": {"id_": "e2c19408-4c11-498a-898f-281a76d017b5", "embedding": null, "metadata": {"file_path": "phala-docs_dist/technical-details.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "be784468-d046-4670-aef0-486824e83488", "node_type": "4", "metadata": {}, "hash": "1ad19bd430ad4a998f415edc5a6aa9c68fe854d74445c06ba903331a35646b29", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "4313eefb-69a2-454f-98c2-50cfe164ecd7", "node_type": "1", "metadata": {}, "hash": "fcb336e44169947fe4a7dd0d61a8aa08a3a9c65bca5ae35ab1bc951f84f91828", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "1be79d38-ed2d-4dd3-9702-dd3f3d1c24ce", "node_type": "1", "metadata": {}, "hash": "615a9851c6ea32fdfab558258ef9e1468877d7f86f8058593f593ec0fd1a71d7", "class_name": "RelatedNodeInfo"}}, "text": "The audit report on XCM V2 (the current version of XCM used by SubBridge) can be found [here](https://blog.quarkslab.com/resources/2022-02-27-xcmv2-audit/21-12-908-REP.pdf)\n\nAs for SygmaBridge, both the solidity smart contract and substrate pallet are get audited, the audit report can be found [here](https://github.com/sygmaprotocol/sygma-relayer/tree/main/audits)\n\nEarlier 2022, we deployed ChainBridge\u2019s Solidity contract on Ethereum. The contract info can be found [here](https://etherscan.io/address/0x8F92e7353b180937895E0C5937d616E8ea1A2Bb9). Recently we migrated the old contract to the new deploy one `0x8F92e7353b180937895E0C5937d616E8ea1A2Bb9`. Up to now, the contract has been running safely for nearly a year, and the contract has also been audited by Certik, a third-party auditor hired by Phala.", "mimetype": "text/plain", "start_char_idx": 13560, "end_char_idx": 14371, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "1be79d38-ed2d-4dd3-9702-dd3f3d1c24ce": {"__data__": {"id_": "1be79d38-ed2d-4dd3-9702-dd3f3d1c24ce", "embedding": null, "metadata": {"file_path": "phala-docs_dist/technical-details.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "be784468-d046-4670-aef0-486824e83488", "node_type": "4", "metadata": {}, "hash": "1ad19bd430ad4a998f415edc5a6aa9c68fe854d74445c06ba903331a35646b29", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e2c19408-4c11-498a-898f-281a76d017b5", "node_type": "1", "metadata": {}, "hash": "dd677102cf33da968bc52226e0f67d32d2c86db4f0484e969716ad4259a9500f", "class_name": "RelatedNodeInfo"}}, "text": "The detailed audit report can be found [here](https://www.certik.com/projects/phalanetwork)\n\n### Reference <a href=\"#reference\" id=\"reference\"></a>\n\n* XCM format: [https://github.com/paritytech/xcm-format](https://github.com/paritytech/xcm-format)\n* MultiAsset definition: [https://github.com/paritytech/polkadot/blob/master/xcm/src/v1/multiasset.rs](https://github.com/paritytech/polkadot/blob/master/xcm/src/v1/multiasset.rs)\n* MultiLocation definition: [https://github.com/paritytech/polkadot/blob/master/xcm/src/v1/multilocation.rs](https://github.com/paritytech/polkadot/blob/master/xcm/src/v1/multilocation.rs)\n* Phala ChainBridge Solidity contract: [https://github.com/Phala-Network/chainbridge-solidity/tree/phala-bridge](https://github.com/Phala-Network/chainbridge-solidity/tree/phala-bridge)\n* Pallet-assets implementation: [https://github.com/paritytech/substrate/tree/master/frame/assets](https://github.com/paritytech/substrate/tree/master/frame/assets)\n* Introduction to ChainBridge: [https://chainbridge.chainsafe.io/](https://chainbridge.chainsafe.io/)\n* Introduction to CelerBridge: [https://cbridge-docs.celer.network/](https://cbridge-docs.celer.network/)", "mimetype": "text/plain", "start_char_idx": 14372, "end_char_idx": 15547, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ba06d0e3-a7e0-4c28-9201-fc03d5dba085": {"__data__": {"id_": "ba06d0e3-a7e0-4c28-9201-fc03d5dba085", "embedding": null, "metadata": {"file_path": "phala-docs_dist/estimate-your-reward.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "5d80a010-a7b0-43c9-95e0-6172f2fd38e5", "node_type": "4", "metadata": {}, "hash": "0189f6e513974d59c5a1ac10cb3838e8681be5112935697bc95f3d7a7b39dc71", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "2da1f0e3-5f06-47c4-898f-e831c5605eff", "node_type": "1", "metadata": {}, "hash": "cfe7dba2fe7f1f1f991bf1a0b2a471350b165822b2eccb540ba13d99eaf00e21", "class_name": "RelatedNodeInfo"}}, "text": "# Estimate Your Reward\n\n## StakePool\u2019s APR <a href=\"#stakepools-apr\" id=\"stakepools-apr\"></a>\n\n$$\nAPR=\\frac{PoolRewardPerHour \\cdot 24\\cdot 365\\cdot(1-TreasuryRatio)\\cdot(1-Commission)}{Delegated}\n$$\n\n* $$PoolRewardPerHour$$ is the theoretical estimation of the number of tokens mined in the next hour based on the status and attributes of the Workers in StakePool;\n* $$TreasuryRatio$$ is a fixed amount of mining rewards that is handed over to the treasury, which remains at 20%;\n* $$Commission$$ is the management fee left to the StakePool\u2019s owner, which is also set by the owner;\n* $$Delegated$$ is the total delegated amount in this StakePool.\n\n## Pool Owner Reward <a href=\"#pool-owner-reward\" id=\"pool-owner-reward\"></a>\n\n$$\nOwner Reward=PoolMined \\cdot (1-TreasuryRatio) \\cdot Commission\n$$\n\n## Delegator Reward <a href=\"#delegator-reward\" id=\"delegator-reward\"></a>\n\n$$\nDelegator Reward = PoolMined \\cdot (1-TreasuryRatio) \\cdot (1-Commission) \\cdot \\frac{UserDelegation}{Delegated}\n$$\n\n* $$UserDelegation$$ is the delegation amount of a Delegator in the StakePool\n\nVaults act in the same role as delegators when Vaults delegate to StakePool. But the Vault owner will charge an additional commission for the management of funds. Click to learn more about [Vault commission](whats-vault.md#how-is-the-vault-owners-reward-calculated).\n\n## Vault\u2019s APY <a href=\"#vaults-apy\" id=\"vaults-apy\"></a>\n\n$$\nVault\u2019s APR=\\frac{Delegations from Vault to StakePool\\cdot StakePool\u2019s APR}{Total delegation in Vault}\n$$\n\n$$\nVault\u2019s APY={(\\frac{Vault\u2019s APR}{365}+1)}^{365} - 1\n$$\n\nAll rewards earned by Vaults are from StakePool delegations. However, we use \u2018APY\u2019 to evaluate the interest accrual in the Vault rather than \u2018APR\u2019 which is used in StakePools.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1745, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "2da1f0e3-5f06-47c4-898f-e831c5605eff": {"__data__": {"id_": "2da1f0e3-5f06-47c4-898f-e831c5605eff", "embedding": null, "metadata": {"file_path": "phala-docs_dist/estimate-your-reward.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "5d80a010-a7b0-43c9-95e0-6172f2fd38e5", "node_type": "4", "metadata": {}, "hash": "0189f6e513974d59c5a1ac10cb3838e8681be5112935697bc95f3d7a7b39dc71", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ba06d0e3-a7e0-4c28-9201-fc03d5dba085", "node_type": "1", "metadata": {}, "hash": "79477a4cd6214ff589504b99b942aff5b4e26d58c7c83b42f16c4fb6d73c9ec0", "class_name": "RelatedNodeInfo"}}, "text": "This was decided for the following reasons:\n\n* Individual StakePool rewards can only increase with the addition of new workers. StakePool rewards are derived from workers, and each worker can only earn a finite amount of income regardless of how much the delegation amount in the StakePool increases. Additional rewards can be earned only when the StakePool owner adds new workers.\n* Vault owners have the ability to freely transfer delegations among different StakePools. A Vault\u2019s delegation rewards are derived from the StakePools it delegates to. If a certain StakePool is producing its maximum reward and doesn\u2019t add more workers, the Vault owner can begin delegating to a new StakePool to continue increasing the rewards that Vault earns.\n* The interest in the Vault delegation is compounded. All delegation rewards in the Vault will remain in StakePools and will be compounded if they\u2019re not withdrawn.\n\n### How these variables affect reward <a href=\"#how-these-variables-affect-reward\" id=\"how-these-variables-affect-reward\"></a>\n\nHuman factors fall into the following categories:\n\n1. _PoolMined_: The better the performance\u2b06 of the workers in the StakePool, the more rewards\u2b06 mined, and the more rewards\u2b06 the delegators get;\n2. _Commission_: The higher the commission\u2b06, the less reward\u2b07 the delegators get;\n3. _Delegated_: The higher the amount of delegation\u2b06 in the StakePool, the less reward\u2b07 the delegators get.\n\nAmong them, the 1st generally does not fluctuate greatly. The 2nd depends on the credit of the owner of the StakePool, and the 3rd may change steadily.", "mimetype": "text/plain", "start_char_idx": 1747, "end_char_idx": 3323, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "26e3b3d4-e1f8-454b-ac87-37cd468968d6": {"__data__": {"id_": "26e3b3d4-e1f8-454b-ac87-37cd468968d6", "embedding": null, "metadata": {"file_path": "phala-docs_dist/invoke-other-agents.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "358650eb-6a71-42a8-9230-cd099df9d7af", "node_type": "4", "metadata": {}, "hash": "4c9c49723593d414cdb31ba4e6b7680b99f12266514ba9aa6484118069191fb6", "class_name": "RelatedNodeInfo"}}, "text": "# Invoke Other Agents\n\n<figure><img src=\"../../.gitbook/assets/WIP.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 113, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c91edf56-f778-4b5b-b689-4424d6dc44ab": {"__data__": {"id_": "c91edf56-f778-4b5b-b689-4424d6dc44ab", "embedding": null, "metadata": {"file_path": "phala-docs_dist/get-an-api-key-for-the-graph.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d1b08f7e-92c1-45b8-947b-209ee9fe47bc", "node_type": "4", "metadata": {}, "hash": "a3a8b6fe9e6cdb7fab2e7515de794cba85bdaa5c060d04d627da0ddd2280e545", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83d\udddd\ufe0f Get an API Key for The Graph\n\nTo acquire an API Key from the graph, you will need to connect your wallet to [The Graph Studio Web UI](https://bit.ly/subgraph-api-key).\n\nYou'll see a tab named API Keys where you will generate or find your existing API Keys.\n\n<figure><img src=\"../../../../.gitbook/assets/Screenshot 2023-12-12 at 14.57.36.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 389, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "855e6b0c-5963-4237-9068-f365569cb3f9": {"__data__": {"id_": "855e6b0c-5963-4237-9068-f365569cb3f9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/next-step.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a8b7d718-3b44-4dfc-a8a2-c92454050c3c", "node_type": "4", "metadata": {}, "hash": "dcca686287d426e5fb6d58b0b17fff13b883bc3f1ca7c4172e1f7dc3aedfb031", "class_name": "RelatedNodeInfo"}}, "text": "# Next Step\n\nNow you have experienced the deployment of your first Phat Contract and invoked it on the serverless Phala computing cloud.\n\nYour next step can be:\n\n* Begin with [stateless applications](build-on-phat-contract/build-stateless-backend.md) and learn how to use Phat Contract\u2019s unique capabilities like\n  * send HTTP requests;\n  * handle users' requests with no gas fee and low latency;\n* Learn where to [store your contract states](build-on-phat-contract/store-contract-states.md) including\n  * store contract states on-chain;\n  * store your data in decentralized storage;\n  * use local memory to cache the data;\n* Learn about the [infrastructure](../../../developers/getting-started/broken-reference/) to know where your contract is deployed and how your privacy is protected.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 788, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6807b6d7-d907-4460-9b5c-ed9e228bc6cf": {"__data__": {"id_": "6807b6d7-d907-4460-9b5c-ed9e228bc6cf", "embedding": null, "metadata": {"file_path": "phala-docs_dist/configuration-migrate-from-prbv2-to-v3.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "4faed7ad-fe6d-46f6-9866-0b4ad8f459ce", "node_type": "4", "metadata": {}, "hash": "7ee8290f9e1aed257186f0ce8acd30c8ae469613887045cbe2b7a7f00ccdd25d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "e164ed8c-6f54-41a2-8b6a-32bb7340c17d", "node_type": "1", "metadata": {}, "hash": "cb0f77f1fc8bfdbf8d88339061477e250fc9384c9ea1d53ac165a1b7bf4975ca", "class_name": "RelatedNodeInfo"}}, "text": "# Configuration migrate from PRBv2 to v3\n\nThis guide will show you how to migrate a PRBv2 deployment to PRBv3 using Docker Compose.\n\n### Deploy PRBv3\n\nFirst, we should create a clean PRBv3 deployment by referring to this page: [PRBv3 Deployment Guide](../run-workers-on-phala/prbv3-deployment.md)&#x20;\n\nMake sure it's running and the `wm` should be running and listening on port 3001 by default.\n\n### Update PRBv2 docker image\n\nCheck your `.yml` file of PRBv2 and set the docker image of `lifecycle` component to `phalanetwork/prb:git-current-v2` to receive the bundled migration script.\n\nIn the `lifecycle` , the component\u2019s docker-compose configuration file should be like:\n\n```yaml\nlifecycle:\n    network_mode: host\n    image: phalanetwork/prb:git-current-v2\n\t\t# leave other things as is\n```\n\nThen run `sudo docker compose pull`.\n\nYour will see the `lifecycle should pull a new image and restart.`\n\n### Run the migration script\n\nIn the docker-compose folder of PRBv2's `lifecycle` component, run:\n\n```bash\ndocker compose down\n# Change PRB3_API_ENDPOINT to your actual endpoint of prb3-wm\ndocker compose run -e \"PRB3_API_ENDPOINT=http://127.0.0.1:3001\" --entrypoint \"yarn migrate_to_prb3\" lifecycle\n```\n\nTo stop the PRBv2 and to run the migration script.\n\n> There you should use the same endpoint of what you wrote in wm.yml to replace the \\`http://127.0.0.1:3001\\`.\n\nNow the migration is done, click `Restart All`  button on the Worker Status page of the monitor, then wait for 15 seconds for the worker's beginning to start.\n\n<figure><img src=\"../../.gitbook/assets/image (1).png\" alt=\"\"><figcaption></figcaption></figure>\n\n### Limitations of Migration\n\n#### Duplicated worker name\n\nBefore Migration, you must ensure that there can be no duplicate items in the names of the pools and workers. Includes but is not limited to worker names being equal to pool names.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1868, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e164ed8c-6f54-41a2-8b6a-32bb7340c17d": {"__data__": {"id_": "e164ed8c-6f54-41a2-8b6a-32bb7340c17d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/configuration-migrate-from-prbv2-to-v3.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "4faed7ad-fe6d-46f6-9866-0b4ad8f459ce", "node_type": "4", "metadata": {}, "hash": "7ee8290f9e1aed257186f0ce8acd30c8ae469613887045cbe2b7a7f00ccdd25d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "6807b6d7-d907-4460-9b5c-ed9e228bc6cf", "node_type": "1", "metadata": {}, "hash": "4453e0df84495ce7c9d70f6c2a2c9f7021a9beac8a731a4a46fde3e458f6c306", "class_name": "RelatedNodeInfo"}}, "text": "#### PID #0 error\n\nPRBv2 does not support PID #0, but PRBv3 supports it.&#x20;\n\nThis makes the migration fail if you want to migrate PID #0 from PRBv2 to PRBv3.\n\n#### Database conflicts\n\nIf your PRBv3 is running and migration from PRBv2 is also necessary. Before your migration, check it to avoid the 2 limitations above.&#x20;\n\nIf your PRBv3 is brand new but may have some test data or you failed to migrate before, the previous test data or half-imported dirty data will result in poor synchronization results. Therefore, you need to:\n\n* First, stop PRBv3 by `sudo docker compose down`\n* Delete the `inv` and `po` folders.\n* Start the normal synchronization process from the start of this article.", "mimetype": "text/plain", "start_char_idx": 1870, "end_char_idx": 2569, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ea7057f9-c245-4443-bf06-77bee5499f53": {"__data__": {"id_": "ea7057f9-c245-4443-bf06-77bee5499f53", "embedding": null, "metadata": {"file_path": "phala-docs_dist/generate-test-account.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "cf0a0c3a-358b-4362-b6c7-53047073867c", "node_type": "4", "metadata": {}, "hash": "bdcddd6a65bf3dd1c4cfbcfa6cbebfdf2587e84da3cd4540e7e561b482e50353", "class_name": "RelatedNodeInfo"}}, "text": "# Generate Test Account\n\nTo deploy your contract to any testnet, you will first need to\n\n* generate your own test account;\n* transfer some test tokens to it to ensure you can pay for the deployment transaction fee.\n\nIn the following tutorial, we use the [Polkadot.js extension](https://polkadot.js.org/extension/) as the default wallet. Other wallets are available here.\n\n### Creating a Test Account with Polkadot.js <a href=\"#create-test-account-with-polkadotjs\" id=\"create-test-account-with-polkadotjs\"></a>\n\n> Never use your personal accounts for testing in case of unexpected financial losses.\n\n1. Install [Polkadot.js extension](https://polkadot.js.org/extension/);\n2. Click on the Polkadot.js extension;\n3.  Click \u201c+\u201d, and choose \u201cCreate new account\u201d;\\\\\n\n    <figure><img src=\"../../../.gitbook/assets/new-account.png\" alt=\"\"><figcaption></figcaption></figure>\n4. Keep mnemonic seed safe;\n5.  Under Network, select \u201cAllow use on any chain\u201d, submit a name and password, and click \u201cAdd the account with the generated seed\u201d.\\\\\n\n    <figure><img src=\"../../../.gitbook/assets/choose-network.png\" alt=\"\"><figcaption></figcaption></figure>\n\n> You can refer to the Polkadot.js [official tutorial](https://wiki.polkadot.network/docs/learn-account-generation#polkadotjs-browser-extension) for more usages.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1302, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "674cb410-e846-40ed-b2bf-5a02350c1b7b": {"__data__": {"id_": "674cb410-e846-40ed-b2bf-5a02350c1b7b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/README.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "3632f624-7681-461a-9e17-753d767e6c1c", "node_type": "4", "metadata": {}, "hash": "3dfd6668cd5a6cd16eb0938d9d1cdaab5ddb72661b4a22fb0c412e5e4bd570e5", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83d\udc50 Delegation\n\n## Start Delegating <a href=\"#start-delegating\" id=\"start-delegating\"></a>\n\nAs soon as you have:\n\n* [x] PHA Tokens\n* [x] Khala Account\n* [x] [Polkadot{.js}](https://polkadot.js.org/extension/)<img src=\"../../../.gitbook/assets/polkadot-js.svg\" alt=\"\" data-size=\"line\">Extension\n\nYou are ready to over to the <img src=\"../../../.gitbook/assets/phala_logo.png\" alt=\"\" data-size=\"line\">[Phala App](https://app.phala.network/) & start to \ud83d\udc49 [Delegate](https://app.phala.network/delegate/).\n\n> If you have issues Delegating, feel free to check our [detailed guide](delegate-to-stakepool.md).", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 601, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c8872060-3fe0-4340-befb-087fdb93bc94": {"__data__": {"id_": "c8872060-3fe0-4340-befb-087fdb93bc94", "embedding": null, "metadata": {"file_path": "phala-docs_dist/system-contract-and-drivers.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "ee21aa3f-dafd-4ab3-b0fb-31f9021b3efb", "node_type": "4", "metadata": {}, "hash": "97bb1f2063410f70390445c3184ac3b63b24458488083bb4a4c181814b52ab29", "class_name": "RelatedNodeInfo"}}, "text": "# System Contract and Drivers\n\n## Introduction <a href=\"#introduction\" id=\"introduction\"></a>\n\nThe system contract is responsible for the access control of each cluster. Only the cluster owner is able to implement and deploy the system contract during the creation of the cluster.\n\nAlso, the enable the flexible management of the future features of Phat Contract, we refer to the design of the Linux kernel and enable cluster owner to dynamically register drivers to system contract to different things. For example, the Phat Contract tokenomics is implemented as a [driver](https://github.com/Phala-Network/phala-blockchain/tree/master/crates/pink-drivers/tokenomic) so each cluster owner can replace it with his/her own tokenomics in the future.\n\n> This feature is not finalized yet so can be changed any time.\n\n## System Contract Examples <a href=\"#system-contract-examples\" id=\"system-contract-examples\"></a>\n\nCheck our [crates](https://github.com/Phala-Network/phala-blockchain/tree/master/crates/pink-drivers) for the current implementation of the system contract and drivers.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1082, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "40b733a3-a303-40f4-bb9d-3a9873959535": {"__data__": {"id_": "40b733a3-a303-40f4-bb9d-3a9873959535", "embedding": null, "metadata": {"file_path": "phala-docs_dist/handling-secrets.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "ad851f66-0434-428a-bc05-97f97dc7302d", "node_type": "4", "metadata": {}, "hash": "0e4a16deaf7de72175e9c5d92e9bbcb61f14c050209803a88908d6529800db69", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f0bfac17-42ff-4a48-b0e5-828bb9bb4cb7", "node_type": "1", "metadata": {}, "hash": "9084dc7415da38b0d757af2f5369cacb4e56ca230f7dd4d4413c2402b260d3d5", "class_name": "RelatedNodeInfo"}}, "text": "---\ndescription: How to set your secrets in core settings for your Phat Contract.\n---\n\n# \ud83e\udd2b Handling Secrets\n\n## Storing Secrets in Your Application: A Step-by-Step Guide\n\nIn the world of software development, it's crucial to keep certain pieces of information, such as API keys, passwords, and other sensitive data, hidden and secure. This is where the concept of `secrets` comes into play. In this guide, we'll walk you through the process of storing secrets in your Phat Contract using the `secrets` parameter in `main(request: HexString, secrets: string)` function.\n\n> **Note**:\\\n> The example provided is a simple example, but the customization of passing secrets and the variable names is solely up to the developer.\n>\n> The `secrets` are passed via end-to-end encrypted communication between the deployer and a secure off-chain worker in a cluster of workers on Phala Network. Security and privacy of the `secrets` are guaranteed by Intel SGX Trusted Execution Environment. To learn more about Phala's decentralized off-chain computation architecture, read our docs [here](https://docs.phala.network/developers/advanced-topics/blockchain-infrastructure).\n\n### Step 1: Passing a JSON String\n\nThe first step in this process involves using the `secrets` parameter. This parameter is designed to accept a string that is in JSON format. JSON, or JavaScript Object Notation, is a lightweight data-interchange format that is easy for humans to read and write and easy for machines to parse and generate.\n\nHere's how you can pass a JSON string using the `secrets` parameter:\n\n```typescript\nlet secrets = JSON.stringify({\n    apiUrl: \"http://myapi.com\",\n    superSecret: \"mySuperSecret\",\n    secretProof: \"mySecretProof\"\n});\n```\n\nIn this example, we're creating a JSON string that contains three properties: `apiUrl`, `superSecret`, and `secretProof`. If you are setting your `secrets` in the Phat Contract 2.0 UI, you will set the `secrets` like this in the \"Settings\" of your deployed Phat Contract.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1998, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f0bfac17-42ff-4a48-b0e5-828bb9bb4cb7": {"__data__": {"id_": "f0bfac17-42ff-4a48-b0e5-828bb9bb4cb7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/handling-secrets.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "ad851f66-0434-428a-bc05-97f97dc7302d", "node_type": "4", "metadata": {}, "hash": "0e4a16deaf7de72175e9c5d92e9bbcb61f14c050209803a88908d6529800db69", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "40b733a3-a303-40f4-bb9d-3a9873959535", "node_type": "1", "metadata": {}, "hash": "ce2b8d3d31789496f523c44e21372e85d19e342dc5aeafec3f6535c19c4cf14a", "class_name": "RelatedNodeInfo"}}, "text": "<figure><img src=\"../../../../.gitbook/assets/StoreSecrets.png\" alt=\"\"><figcaption></figcaption></figure>\n\n### Step 2: Parsing the JSON String\n\nOnce you've passed the JSON string, the next step is to parse it. Parsing is the process of analyzing a string of symbols, either in natural language, computer languages or data structures. In this case, we're parsing the JSON string to store variables for `apiUrl`, `superSecret`, and `secretProof`.\n\nHere's how you can parse the JSON string:\n\n```typescript\nlet parsedSecrets = JSON.parse(secrets);\n```\n\nIn this example, we're using the `JSON.parse()` method to convert the JSON string back into an object, which allows us to store the variables.\n\n### Step 3: Understanding the Variables\n\nNow that we've parsed the JSON string, let's take a closer look at the variables we've stored:\n\n1. **apiUrl**: This variable is used to store the URL of your API. It's where your application will send requests to retrieve or manipulate data.\n2. **superSecret**: This variable is typically used to store a secret key or password. It's crucial to keep this information secure as it can be used to authenticate your application and protect sensitive data.\n3. **secretProof**: This variable is often used as an additional layer of security. It can be used to verify the authenticity of the 'superSecret' variable.\n\n### The Main Function\n\nThe function that brings all these steps together looks like this:\n\n```javascript\nexport default function main(request: HexString, secrets: string): HexString {\n    let parsedSecrets = JSON.parse(secrets);\n    // use parsedSecrets.apiUrl, parsedSecrets.superSecret, parsedSecrets.secretProof\n}\n```\n\nIn this function, we're accepting two parameters: `request` and `secrets`. The `request` parameter is a hexadecimal string, while the `secrets` parameter is a string that we parse into a JSON object. The function then returns a hexadecimal string.\n\nAnd there you have it! You've successfully stored secrets in your application. Remember, keeping your sensitive data secure is crucial in software development, so always make sure to handle your secrets with care.", "mimetype": "text/plain", "start_char_idx": 2000, "end_char_idx": 4129, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "965778df-b946-40f9-b422-023cc046f091": {"__data__": {"id_": "965778df-b946-40f9-b422-023cc046f091", "embedding": null, "metadata": {"file_path": "phala-docs_dist/lensapi-oracle-agent.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8588b396-96f7-4222-9fc6-7e57fa3d14b6", "node_type": "4", "metadata": {}, "hash": "1fe9597f1c38707b553a9708a94644cfb4af4b27dd5c81e93f716b75d81805d1", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83c\udf31 LensAPI Oracle Agent\n\n<figure><img src=\"../../.gitbook/assets/LensAPIOracle.jpg\" alt=\"\" width=\"563\"><figcaption></figcaption></figure>\n\nThe LensAPI Oracle connects your smart contract to Lens, one of the most popular Web3 social graphs. It supports customized GraphQL queries to Lens API and allows you to easily process the response data to make them digestible to your smart contract.\n\n### Features and Benefits\n\n* Wide support for consumer smart contracts on all mainstream blockchains\n* **Verifiable and decentralized**: your Oracle is running on decentralized infrastructure that require no operations and can be easily verified\n* **Support private data**: your Oracle state is protected by cryptography and hardware\n* **No extra cost**: the only cost is the gas fee of response data which is sent as a transaction\n* **High frequency**: the request is synced to Oracle within one minute, and the latency of response is only limited by blockchain\u2019s block interval\n\n### Resources\n\n* [**LensAPI Oracle AI Agent Template**](https://github.com/Phala-Network/lensapi-oracle-consumer-contract)\n* [**What is an Oracle**](https://bit.ly/3PE6ymF)\n* [**Technical Design Doc**](https://bit.ly/3ZAzdxE)", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1198, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "302de6ad-a664-4f6c-8711-57049a819f9a": {"__data__": {"id_": "302de6ad-a664-4f6c-8711-57049a819f9a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/join-the-council.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "0ef98432-7f00-456b-9133-9729a08167df", "node_type": "4", "metadata": {}, "hash": "bb889e289b2cba9fcad1b04feb1f4648a96f304e78dbea2661fb08b920f1045b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "bd84b296-7bc8-4a46-93ab-98008decdf6a", "node_type": "1", "metadata": {}, "hash": "f3fe99e67217d5b6a793d9f22e5e6d172b17408875c881fce8fb455bf85a84e3", "class_name": "RelatedNodeInfo"}}, "text": "# Join the Council\n\nThe council is an elected body of on-chain accounts that are intended to represent the passive stakeholders of Phala and/or Khala. The council has two major tasks in governance: proposing referenda and vetoing dangerous or malicious referenda. For more information on the council, see the governance page. This guide will walk you through entering your candidacy to the council.\n\n## Submit Candidacy <a href=\"#submit-candidacy\" id=\"submit-candidacy\"></a>\n\nSubmitting your candidacy for the council requires a small bond of PHA / K-PHA. Unless your candidacy wins, the bond will be forfeited. You can receive your bond back if you manually renounce your candidacy before losing. Runners-up are selected after every round and are reserved members in case one of the winners gets forcefully removed.\n\n> Currently the bond for submitting a council candidacy on Phala/Khala is 10 PHA/K-PHA.\n\nIt is a good idea to announce your council intention before submitting your candidacy so that your supporters will know when they can start to vote for you. You can also vote for yourself in case no one else does.\n\nGo to Khala Dashboard and navigate to the \u201cCouncil\u201d tab. Click the button on the right that says \u201cSubmit Candidacy.\u201d\n\n![](https://i.imgur.com/H6UFk1Z.png)\n\nAfter making the transaction, you will see your account appear underneath the row \u201cCandidates.\u201d\n\n![](https://i.imgur.com/wEBQitI.png)\n\nIt is a good idea now to lead by example and give yourself a vote.\n\n## Voting on Candidates <a href=\"#voting-on-candidates\" id=\"voting-on-candidates\"></a>\n\nNext to the button to submit candidacy is another button titled \u201cVote.\u201d You will click this button to make a vote for yourself (optional).\n\n![](https://i.imgur.com/3VT6sK2.png)\n\nThe council uses Phragm\u00e9n approval voting, which is also used in the validator elections. This means that you can choose up to 5 distinct candidates to vote for and your stake will equalize between them. For this guide, choose to approve your own candidacy by clicking on the switch next to your account and changing it to say \u201cAye.\u201d\n\n!", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2083, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "bd84b296-7bc8-4a46-93ab-98008decdf6a": {"__data__": {"id_": "bd84b296-7bc8-4a46-93ab-98008decdf6a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/join-the-council.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "0ef98432-7f00-456b-9133-9729a08167df", "node_type": "4", "metadata": {}, "hash": "bb889e289b2cba9fcad1b04feb1f4648a96f304e78dbea2661fb08b920f1045b", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "302de6ad-a664-4f6c-8711-57049a819f9a", "node_type": "1", "metadata": {}, "hash": "e7dbc1b86d5e79621c7bc95b13de7c76cf87aa8df43ff5d2f6d017cb1047a81f", "class_name": "RelatedNodeInfo"}}, "text": "[](https://i.imgur.com/mBT7jb1.png)\n\n## Winning <a href=\"#winning\" id=\"winning\"></a>\n\nIf you are one of the lucky ones to win a council election you will see your account move underneath the row \u201cMembers\u201d.\n\n![](https://i.imgur.com/Wp2Zxqn.png)\n\nNow you are able to participate on the council by making motions or voting proposals. To join in on the active discussions, join the [Phala Direction channel](https://forum.phala.network/).", "mimetype": "text/plain", "start_char_idx": 2083, "end_char_idx": 2517, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ac27581f-25f9-498c-82e5-c566904c5f48": {"__data__": {"id_": "ac27581f-25f9-498c-82e5-c566904c5f48", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deploy-the-worker.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "0d011c27-6352-49c2-8af2-23928ed39ed9", "node_type": "4", "metadata": {}, "hash": "5c9256b562a0c8f881a439280b1d787a3de49387565b973c7e88262dc34c101e", "class_name": "RelatedNodeInfo"}}, "text": "# Deploy the Worker\n\n## Start Mining\n\n```\nsudo phala start\n```", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 62, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8b619a26-5d05-4982-8998-6e864cfd3439": {"__data__": {"id_": "8b619a26-5d05-4982-8998-6e864cfd3439", "embedding": null, "metadata": {"file_path": "phala-docs_dist/tanssi-dancebox-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "429fbba6-81f6-4391-9bf1-c798887e1c18", "node_type": "4", "metadata": {}, "hash": "dd3ec3373c0089bc206f53c3fd3c0f14769ca5b25f32da2c3edeb11acdc321e6", "class_name": "RelatedNodeInfo"}}, "text": "# Tanssi Dancebox Testnet\n\nTanssi is an appchain infrastructure protocol that equips developers with a broad set of infrastructure tools and services specifically designed to make appchain deployment swift and effortless.\n\nFind out more about Tanssi Appchains by reading their docs [here](https://docs.tanssi.network/learn/tanssi/overview/).\n\n| Asset Pair  | Contract Address                           |\n| ----------- | ------------------------------------------ |\n| AAVE to USD | 0x2E1640853bB2dD9f47831582665477865F9240DB |\n| BTC to USD  | 0x89BC5048d634859aef743fF2152363c0e83a6a49 |\n| CRV to USD  | 0xf38b25b79A72393Fca2Af88cf948D98c64726273 |\n| DAI to USD  | 0x1f56d8c7D72CE2210Ef340E00119CDac2b05449B |\n| ETH to USD  | 0x739d71fC66397a28B3A3b7d40eeB865CA05f0185 |\n| USDC to USD | 0x4b8331Ce5Ae6cd33bE669c10Ded9AeBA774Bf252 |\n| USDT to USD | 0x5018c16707500D2C89a0446C08f347A024f55AE3 |", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 891, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f6e878ae-75f4-4932-91cd-ec44f27ba69f": {"__data__": {"id_": "f6e878ae-75f4-4932-91cd-ec44f27ba69f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/khala-treasury.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd", "node_type": "4", "metadata": {}, "hash": "7324c47fd5a1857ad21910b64a3a3c7e714645cfaf80b10c1770eca2d955f9a8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a309979a-85c2-4ce1-8bc1-7c8b7190fe6d", "node_type": "1", "metadata": {}, "hash": "438946cbbba1f32423a32dd4900536272f7a8abd66fe74a9a7368a67c9d7bcc4", "class_name": "RelatedNodeInfo"}}, "text": "# Khala Treasury\n\n## Current mechanisms <a href=\"#current-mechanisms\" id=\"current-mechanisms\"></a>\n\n### Spending Proposals <a href=\"#spending-proposals\" id=\"spending-proposals\"></a>\n\nThe Treasury is also used to fund spending proposals submitted by community members. These need to be approved by the Council and have the goal of developing ideas that give traction to the network, maintaining infrastructure deployment, security operations, and marketing activities, among others.\n\n### Tipping <a href=\"#tipping\" id=\"tipping\"></a>\n\nTips can be suggested by anyone holding PHA and are endorsed by Council members. Tips do not have any fixed value: The final value is decided based on the median of all tips issued by the councilors.\n\n### Bounty Spending <a href=\"#bounty-spending\" id=\"bounty-spending\"></a>\n\nBounties Spending proposals aim to delegate the curation activity of spending proposals to experts called Curators\n\n## Treasury <a href=\"#treasury\" id=\"treasury\"></a>\n\nThe Treasury is a pot of funds collected through transaction fees, slashing, Secure Worker mining rate (20%) , etc. The funds held in the Treasury can be spent by making a spending proposal that, if approved by the Council, will enter a waiting period before distribution. This waiting period is known as the budget period, and its duration is subject to governance, with the current default set to 1 day. The Treasury attempts to spend as many proposals in the queue as it can without running out of funds.\n\nIf the Treasury ends a budget period without spending all of its funds, it suffers a burn of a percentage of its funds \u2013 thereby causing deflationary pressure. This percentage is currently at 0% on Phala.\n\nWhen a stakeholder wishes to propose a spend from the Treasury, they must reserve a deposit of at least 5% of the proposed spend (see below for variations). This deposit will be slashed if the proposal is rejected, and returned if it is accepted.\n\nProposals may consist of (but are not limited to):\n\n* Infrastructure deployment and continued operation.\n* Network security operations (monitoring services, continuous auditing).\n* Ecosystem provisions (collaborations with friendly chains).\n* Marketing activities (advertising, paid features, collaborations).\n* Community events and outreach (meetups, pizza parties, hackerspaces).", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2320, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a309979a-85c2-4ce1-8bc1-7c8b7190fe6d": {"__data__": {"id_": "a309979a-85c2-4ce1-8bc1-7c8b7190fe6d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/khala-treasury.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd", "node_type": "4", "metadata": {}, "hash": "7324c47fd5a1857ad21910b64a3a3c7e714645cfaf80b10c1770eca2d955f9a8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f6e878ae-75f4-4932-91cd-ec44f27ba69f", "node_type": "1", "metadata": {}, "hash": "22eb683f1bb363e4f246d6de66eb9a94d2967768703729f1b2c424e48f19b2ae", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "beb015b7-2e06-4129-88f4-3b0acb297a22", "node_type": "1", "metadata": {}, "hash": "6c18374bdaa556d61b1dd95b55094f9cc4cbe5c5a61b905557204b17d6cf0cb7", "class_name": "RelatedNodeInfo"}}, "text": "* Software development (wallets and wallet integration, clients and client upgrades).\n\nThe Treasury is ultimately controlled by the Council, and how the funds will be spent is up to their judgment.\n\nThe Treasury is funded from different sources:\n\n1. Slashing: When a Secure Worker or Gatekeepers is slashed for any reason, the slashed amount is sent to the Treasury with a reward going to the entity that reported the validator (another validator). The reward is taken from the slash amount and varies per offense and number of reporters.\n2. Transaction fees: A portion of each block\u2019s transaction fees goes to the Treasury, with the remainder going to the block author.\n3. 70% of the PHA will be used for Secure Worker Mining, and following the progress of the Khala and Phala networks, 20% of the mining rewards generated by each block will be used to fund treasury.\n\n### Creating a Treasury Proposal <a href=\"#creating-a-treasury-proposal\" id=\"creating-a-treasury-proposal\"></a>\n\nThe proposer has to deposit 5% of the requested amount or 1 PHA (whichever is higher) as an anti-spam measure. This amount is burned if the proposal is rejected, or refunded otherwise. These values are subject to governance so they may change in the future.\n\nPlease note that there is no way for a user to revoke a treasury proposal after it has been submitted. The Council will either accept or reject the proposal, and if the proposal is rejected, the bonded funds are burned.\n\n### Announcing the Proposal <a href=\"#announcing-the-proposal\" id=\"announcing-the-proposal\"></a>\n\nTo minimize storage on chain, proposals don\u2019t contain contextual information. When a user submits a proposal, they will probably need to find an off-chain way to explain the proposal. Most discussion takes place on the following platforms:\n\n* It is recommended that post the contextual information in Phala forum first to explain the details. Those who do not publish the contextual information will not be discussed as serious proposals.\n* Many community members participate in discussion in the [Phala Discord #Proposal channel](https://discord.gg/YsRUMpvvxs) or [Phala Forum](https://forum.phala.network/c/51-category/51).", "mimetype": "text/plain", "start_char_idx": 2321, "end_char_idx": 4507, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "beb015b7-2e06-4129-88f4-3b0acb297a22": {"__data__": {"id_": "beb015b7-2e06-4129-88f4-3b0acb297a22", "embedding": null, "metadata": {"file_path": "phala-docs_dist/khala-treasury.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd", "node_type": "4", "metadata": {}, "hash": "7324c47fd5a1857ad21910b64a3a3c7e714645cfaf80b10c1770eca2d955f9a8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a309979a-85c2-4ce1-8bc1-7c8b7190fe6d", "node_type": "1", "metadata": {}, "hash": "438946cbbba1f32423a32dd4900536272f7a8abd66fe74a9a7368a67c9d7bcc4", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "608f4b92-5e13-4206-8bdf-4d8321e3025e", "node_type": "1", "metadata": {}, "hash": "584dab8f90de3fdc72c02ff7ee2eba2908b48c21b8fb66eb0ee53a59b35bb940", "class_name": "RelatedNodeInfo"}}, "text": "Spreading the word about the proposal\u2019s explanation is ultimately up to the proposer - the recommended way is using official Discord channels like the [Phala Discord #Proposal channel](https://discord.gg/YsRUMpvvxs) .\n\n### Creating the Proposal <a href=\"#creating-the-proposal\" id=\"creating-the-proposal\"></a>\n\nOne way to create the proposal is to use the Polkadot-JS Apps [website](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkhala.api.onfinality.io%2Fpublic-ws#/explorer). From the website, use either the [extrinsics tab](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkhala.api.onfinality.io%2Fpublic-ws#/extrinsics) and select the Treasury pallet, then `proposeSpend` and enter the desired amount and recipient:\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/e93580b2-3f2b-461d-b965-5052b3c289ec/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\\&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20211012%2Fus-west-2%2Fs3%2Faws4\\_request\\&X-Amz-Date=20211012T151146Z\\&X-Amz-Expires=86400\\&X-Amz-Signature=b45aa607091a5bdc703bd9e282edaf983fcc7134f9db7b4bb0dc7fbaba7d8b55\\&X-Amz-SignedHeaders=host\\&response-content-disposition=filename%20%3D%22Untitled.png%22)\n\nor use the [Treasury tab](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkhala.api.onfinality.io%2Fpublic-ws#/treasury) and its dedicated Submit Proposal button:\n\n!", "mimetype": "text/plain", "start_char_idx": 4509, "end_char_idx": 5844, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "608f4b92-5e13-4206-8bdf-4d8321e3025e": {"__data__": {"id_": "608f4b92-5e13-4206-8bdf-4d8321e3025e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/khala-treasury.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd", "node_type": "4", "metadata": {}, "hash": "7324c47fd5a1857ad21910b64a3a3c7e714645cfaf80b10c1770eca2d955f9a8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "beb015b7-2e06-4129-88f4-3b0acb297a22", "node_type": "1", "metadata": {}, "hash": "6c18374bdaa556d61b1dd95b55094f9cc4cbe5c5a61b905557204b17d6cf0cb7", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "87cd70a4-ba8d-449b-9db5-7c3f4e686d75", "node_type": "1", "metadata": {}, "hash": "f9a5c2ff4dee6a72f3d41dfe986ae4e9e2086aa065cd9ccc1ad46652b00bf822", "class_name": "RelatedNodeInfo"}}, "text": "[](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/7f02ba48-6e65-40df-9b3a-49e0bb916c58/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\\&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20211012%2Fus-west-2%2Fs3%2Faws4\\_request\\&X-Amz-Date=20211012T151120Z\\&X-Amz-Expires=86400\\&X-Amz-Signature=ac29c0129134152af20b1bec4cd59012663d9e10b796e00cc63fa9b9d7b32e91\\&X-Amz-SignedHeaders=host\\&response-content-disposition=filename%20%3D%22Untitled.png%22)\n\nThe system will automatically take the required deposit, picking the higher of the two values mentioned [above](../../../pha-token/governance/broken-reference/).\n\nOnce created, your proposal will become visible in the Treasury screen and the Council can start voting on it.\n\nRemember that the proposal has no metadata, so it\u2019s up to the proposer to create a description and purpose that the Council could study and base their votes on.\n\nAt this point, a Council member can create a motion to accept or to reject the treasury proposal. It is possible that one motion to accept and another motion to reject are both created. The proportions to accept and reject Council proposals vary between accept or reject, and possibly depend on which network the Treasury is implemented.\n\nThe threshold for accepting a treasury proposal is at least three-fifths of the Council. On the other hand, the threshold for rejecting a proposal is at least one-half of the Council.\n\n!", "mimetype": "text/plain", "start_char_idx": 5844, "end_char_idx": 7258, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "87cd70a4-ba8d-449b-9db5-7c3f4e686d75": {"__data__": {"id_": "87cd70a4-ba8d-449b-9db5-7c3f4e686d75", "embedding": null, "metadata": {"file_path": "phala-docs_dist/khala-treasury.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd", "node_type": "4", "metadata": {}, "hash": "7324c47fd5a1857ad21910b64a3a3c7e714645cfaf80b10c1770eca2d955f9a8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "608f4b92-5e13-4206-8bdf-4d8321e3025e", "node_type": "1", "metadata": {}, "hash": "584dab8f90de3fdc72c02ff7ee2eba2908b48c21b8fb66eb0ee53a59b35bb940", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b5436dfc-ce2b-48a0-a662-292f528f72ca", "node_type": "1", "metadata": {}, "hash": "e65726d7630f7444a49443087704d316086ff139635247f193157294f43ac958", "class_name": "RelatedNodeInfo"}}, "text": "[https://wiki.polkadot.network/assets/images/motion-f2fc13da7c5579a8d07062ea229791f6.png](https://wiki.polkadot.network/assets/images/motion-f2fc13da7c5579a8d07062ea229791f6.png)\n\n## Tipping <a href=\"#tipping-1\" id=\"tipping-1\"></a>\n\nNext to the proposals process, a separate system for making tips exists for the Treasury. Tips can be suggested by anyone and are supported by members of the Council. Tips do not have any definite value; the final value of the tip is decided based on the median of all tips issued by the tippers.\n\nCurrently, the tippers are the same as the members of the Council. However, being a tipper is not the direct responsibility of the Council, and at some point the Council and the tippers may be different groups of accounts.\n\nA tip will enter a closing phase when more than a half plus one of the tipping group have endorsed a tip. During that timeframe, the other members of the tipping group can still issue their tips, but do not have to. Once the window closes, anyone can call the `close_tip` extrinsic, and the tip will be paid out.\n\nThere are two types of tips: public and tipper-initiated. With public tips, a small bond is required to place them. This bond depends on the tip message length, and a fixed bond constant defined on chain, currently 1. Public tips carry a finder\u2019s fee of 20% which is paid out from the total amount. Tipper-initiated tips, i.e. tips that a Council member published, do not have a finder\u2019s fee or a bond.\n\nTo better understand the process a tip goes through until it is paid out, let\u2019s consider an example.\n\n### Example <a href=\"#example\" id=\"example\"></a>\n\nBob has done something great for Phala . Alice has noticed this and decides to report Bob as deserving a tip from the Treasury. The Council is composed of three members Charlie, Dave, and Eve.\n\nAlice begins the process by issuing the `report_awesome` extrinsic. This extrinsic requires two arguments, a reason and the address to tip.", "mimetype": "text/plain", "start_char_idx": 7258, "end_char_idx": 9216, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b5436dfc-ce2b-48a0-a662-292f528f72ca": {"__data__": {"id_": "b5436dfc-ce2b-48a0-a662-292f528f72ca", "embedding": null, "metadata": {"file_path": "phala-docs_dist/khala-treasury.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd", "node_type": "4", "metadata": {}, "hash": "7324c47fd5a1857ad21910b64a3a3c7e714645cfaf80b10c1770eca2d955f9a8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "87cd70a4-ba8d-449b-9db5-7c3f4e686d75", "node_type": "1", "metadata": {}, "hash": "f9a5c2ff4dee6a72f3d41dfe986ae4e9e2086aa065cd9ccc1ad46652b00bf822", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a4680770-5dcf-4059-9848-7a02ab63b011", "node_type": "1", "metadata": {}, "hash": "513617fc0f1a33c6fb964f9500c3abc023a8fac4cfdcd6cb089ff53289a681b1", "class_name": "RelatedNodeInfo"}}, "text": "Alice submits Bob\u2019s address with the reason being a UTF-8 encoded URL to a post on [Phala forum](https://forum.phala.network/c/51-category/51) that explains her reasoning for why Bob deserves the tip.\n\nAs mentioned above, Alice must also lock up a deposit for making this report. The deposit is the base deposit as set in the chain\u2019s parameter list plus the additional deposit per byte contained in the reason. This is why Alice submitted a URL as the reason instead of the explanation directly, it was cheaper for her to do so.\n\nFor her trouble, Alice is able to claim the eventual finder\u2019s fee if the tip is approved by the tippers.\n\nSince the tipper group is the same as the Council, the Council must now collectively (but also independently) decide on the value of the tip that Bob deserves.\n\nCharlie, Dave, and Eve all review the report and make tips according to their personal valuation of the benefit Bob has provided for Phala.\n\nCharlie tips 10 PHA . Dave tips 30 PHA . Eve tips 100 PHA.\n\nThe tip could have been closed out with only two of the three tippers. Once more than half of the tippers group have issued tip valuations, the countdown to close the tip will begin. In this case, the third tipper issued their tip before the end of the closing period, so all three were able to make their tip valuations known.\n\nNow the actual tip that will be paid out to Bob is the median of these tips, so Bob will be paid out 30 PHA from the Treasury.\n\nIn order for Bob to be paid his tip, some account must call the `close_tip` extrinsic at the end of the closing period for the tip. This extrinsic may be called by anyone.\n\n## Bounties Spending <a href=\"#bounties-spending\" id=\"bounties-spending\"></a>\n\nThere are practical limits to Council Members curation capabilities when it comes to treasury proposals: Council members likely do not have the expertise to make a proper assessment of the activities described in all proposals. Even if individual Councilors have that expertise, it is highly unlikely that a majority of members are capable in such diverse topics.", "mimetype": "text/plain", "start_char_idx": 9217, "end_char_idx": 11287, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a4680770-5dcf-4059-9848-7a02ab63b011": {"__data__": {"id_": "a4680770-5dcf-4059-9848-7a02ab63b011", "embedding": null, "metadata": {"file_path": "phala-docs_dist/khala-treasury.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd", "node_type": "4", "metadata": {}, "hash": "7324c47fd5a1857ad21910b64a3a3c7e714645cfaf80b10c1770eca2d955f9a8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b5436dfc-ce2b-48a0-a662-292f528f72ca", "node_type": "1", "metadata": {}, "hash": "e65726d7630f7444a49443087704d316086ff139635247f193157294f43ac958", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ec94c439-fada-4010-bb19-05b34a5e48f6", "node_type": "1", "metadata": {}, "hash": "732e54cb6e3b39cbedd3d3c7ec65056cf45e710385848aac91adb3db4e3c8659", "class_name": "RelatedNodeInfo"}}, "text": "Bounties Spending proposals aim to delegate the curation activity of spending proposals to experts called Curators: They can be defined as addresses with agency over a portion of the Treasury with the goal of fixing a bug or vulnerability, developing a strategy, or monitoring a set of tasks related to a specific topic: all for the benefit of the Phala ecosystem.\n\nA proposer can submit a bounty proposal for the Council to pass, with a curator to be defined later, whose background and expertise is such that they are capable of determining when the task is complete. Curators are selected by the Council after the bounty proposal passes, and need to add an upfront payment to take the position. This deposit can be used to punish them if they act maliciously. However, if they are successful in their task of getting someone to complete the bounty work, they will receive their deposit back and part of the bounty reward.\n\nWhen submitting the value of the bounty, the proposer includes a reward for curators willing to invest their time and expertise in the task: this amount is included in the total value of the bounty. In this sense, the curator\u2019s fee can be defined as the result of subtracting the value paid to the bounty reward from the total value of the bounty.\n\nIn general terms, curators are expected to have a well-balanced track record related to the issues the bounty tries to resolve: they should be at least knowledgeable on the topics the bounty touches, and show project management skills or experience. These recommendations ensure an effective use of the mechanism. A Bounty Spending is a reward for a specified body of work - or specified set of objectives - that needs to be executed for a predefined treasury amount to be paid out. The responsibility of assigning a payout address once the specified set of objectives is completed is delegated to the curator.\n\nAfter the Council has activated a bounty, it delegates the work that requires expertise to the curator who gets to close the active bounty. Closing the active bounty enacts a delayed payout to the payout address and a payout of the curator fee. The delay phase allows the Council to act if any issues arise.\n\nTo minimize storage on chain in the same way as any proposal, bounties don\u2019t contain contextual information. When a user submits a bounty spending proposal, they will probably need to find an off-chain way to explain the proposal (any of the available community forums serve this purpose).", "mimetype": "text/plain", "start_char_idx": 11289, "end_char_idx": 13774, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ec94c439-fada-4010-bb19-05b34a5e48f6": {"__data__": {"id_": "ec94c439-fada-4010-bb19-05b34a5e48f6", "embedding": null, "metadata": {"file_path": "phala-docs_dist/khala-treasury.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd", "node_type": "4", "metadata": {}, "hash": "7324c47fd5a1857ad21910b64a3a3c7e714645cfaf80b10c1770eca2d955f9a8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a4680770-5dcf-4059-9848-7a02ab63b011", "node_type": "1", "metadata": {}, "hash": "513617fc0f1a33c6fb964f9500c3abc023a8fac4cfdcd6cb089ff53289a681b1", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a9cb8fa0-d8eb-45f6-9d2c-05d68669fd13", "node_type": "1", "metadata": {}, "hash": "1b3b071b32208563c641a44f0a91e30415ed736e0ef860f4241cbb6b5ad77a95", "class_name": "RelatedNodeInfo"}}, "text": "[This template](https://docs.google.com/document/d/1dQtjfFTkOcTXTt8pIpH2GYLNc9vc03teYfR1r8NfGO0/edit?usp=sharing) can help as a checklist of all needed information for the Council to make an informed decision.\n\nThe bounty has a predetermined duration of 90 days with the possibility of being extended by the curator. Aiming to maintain flexibility on the tasks\u2019 curation, the curator will be able to create sub-bounties for more granularity and allocation in the next iteration of the mechanism.\n\n### Creating a Bounty Proposal <a href=\"#creating-a-bounty-proposal\" id=\"creating-a-bounty-proposal\"></a>\n\nAnyone can create a Bounty proposal using Polkadot JS Apps: Users are able to submit a proposal on the dedicated Bounty section under Governance. The development of a robust user interface to view and manage bounties in the Phala Apps is still under development and it will serve Council members, Curators and Beneficiaries of the bounties, as well as all users observing the on-chain treasury governance. For now, the help of a Councillor is needed to open a bounty proposal as a motion to be voted.\n\nTo submit a bounty, please visit [Polkadot JS Apps](https://polkadot.js.org/apps) and click on the Governance tab in the options bar on the top of the site. After, click on \u2018Bounties\u2019 and find the button \u2018+ Add Bounty\u2019 on the upper-right side of the interface. Complete the bounty title, the requested allocation (including curator\u2019s fee) and confirm the call.\n\nAfter this, a Council member will need to assist you to pass the bounty proposal for vote as a motion. You can contact the Council by joining the #Khala-Direction [channel](https://discord.gg/MsqTGfu5Uy) in Discord server and publishing a short description of your bounty, with a link to one of the [forums](https://forum.phala.network/c/51-category/51) for contextual information.\n\nA bounty can be cancelled by deleting the earmark for a specific treasury amount or be closed if the tasks have been completed. On the opposite side, the 90 days life of a bounty can be extended by amending the expiry block number of the bounty to stay active.", "mimetype": "text/plain", "start_char_idx": 13775, "end_char_idx": 15886, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a9cb8fa0-d8eb-45f6-9d2c-05d68669fd13": {"__data__": {"id_": "a9cb8fa0-d8eb-45f6-9d2c-05d68669fd13", "embedding": null, "metadata": {"file_path": "phala-docs_dist/khala-treasury.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd", "node_type": "4", "metadata": {}, "hash": "7324c47fd5a1857ad21910b64a3a3c7e714645cfaf80b10c1770eca2d955f9a8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ec94c439-fada-4010-bb19-05b34a5e48f6", "node_type": "1", "metadata": {}, "hash": "732e54cb6e3b39cbedd3d3c7ec65056cf45e710385848aac91adb3db4e3c8659", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "3121841c-374f-4c34-b638-be72aede595b", "node_type": "1", "metadata": {}, "hash": "8e86e56b5a25e57f24927747b63b9beb4a61fd8c854a99207edd7cfd357da7ce", "class_name": "RelatedNodeInfo"}}, "text": "### Closing a bounty <a href=\"#closing-a-bounty\" id=\"closing-a-bounty\"></a>\n\nThe curator can close the bounty once they approve the completion of its tasks. The curator should make sure to set up the payout address on the active bounty beforehand. Closing the Active bounty enacts a delayed payout to the payout address and a payout of the curator fee.\n\nA bounty can be closed by using the extrinsics tab and selecting the Treasury pallet, then `Award_bounty`, making sure the right bounty is to be closed and finally sign the transaction. It is important to note that those who received a reward after the bounty is completed, must claim the specific amount of the payout from the payout address, by calling `Claim_bounty` after the curator closed the allocation.\n\n## FAQ <a href=\"#faq\" id=\"faq\"></a>\n\n### What prevents the Treasury from being captured by a majority of the Council? <a href=\"#what-prevents-the-treasury-from-being-captured-by-a-majority-of-the-council\" id=\"what-prevents-the-treasury-from-being-captured-by-a-majority-of-the-council\"></a>\n\nThe majority of the Council can decide the outcome of a treasury spend proposal. In an adversarial mindset, we may consider the possibility that the Council may at some point go rogue and attempt to steal all of the treasury funds. It is a possibility that the treasury pot becomes so great, that a large financial incentive would present itself.\n\nIt is the case on Phala that the Council is composed of mainly well-known members of the community. Remember, the Council is voted in by the token holders, so they must do some campaigning or otherwise be recognized to earn votes. In the scenario of an attack, the Council members would lose their social credibility. Furthermore, members of the Council are usually externally motivated by the proper operation of the chain. This external motivation is either because they run businesses that depend on the chain, or they have direct financial gain (through their holdings) of the token value remaining steady.\n\nConcretely, there are a couple on-chain methods that resist this kind of attack. One, the Council majority may not be the token majority of the chain. This means that the token majority could vote to replace the Council if they attempted this attack - or even reverse the treasury spend. They would do this through a normal referendum.", "mimetype": "text/plain", "start_char_idx": 15888, "end_char_idx": 18241, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "3121841c-374f-4c34-b638-be72aede595b": {"__data__": {"id_": "3121841c-374f-4c34-b638-be72aede595b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/khala-treasury.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd", "node_type": "4", "metadata": {}, "hash": "7324c47fd5a1857ad21910b64a3a3c7e714645cfaf80b10c1770eca2d955f9a8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a9cb8fa0-d8eb-45f6-9d2c-05d68669fd13", "node_type": "1", "metadata": {}, "hash": "1b3b071b32208563c641a44f0a91e30415ed736e0ef860f4241cbb6b5ad77a95", "class_name": "RelatedNodeInfo"}}, "text": "Two, there are time delays to treasury spends. They are only enacted every spend period. This means that there will be some time to observe this attack is taking place. The time delay then allows chain participants time to respond. The response may take the form of governance measures or - in the most extreme cases a liquidation of their holdings and a migration to a minority fork. However, the possibility of this scenario is quite low.", "mimetype": "text/plain", "start_char_idx": 18242, "end_char_idx": 18682, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6e3144ea-aeb2-401a-92ef-20f997ab9882": {"__data__": {"id_": "6e3144ea-aeb2-401a-92ef-20f997ab9882", "embedding": null, "metadata": {"file_path": "phala-docs_dist/voting-for-councillors.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b4b34c1-8ff4-44fc-8927-bbc5c693128c", "node_type": "4", "metadata": {}, "hash": "f674e808bacd15371c33ab94a2b31771f793159868c8c359168d4441e630730d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "4d0f1828-87be-4540-84c6-920d77015745", "node_type": "1", "metadata": {}, "hash": "3bc3f1b304dce787a5bee3519b0d091ad71ac5966eb73fc2c57f1a9518e3f887", "class_name": "RelatedNodeInfo"}}, "text": "# Voting for Councillors\n\nThe council is an elected body of on-chain accounts that are intended to represent the passive stakeholders of Phala and/or Khala. The council has two major tasks in governance: proposing referenda and vetoing dangerous or malicious referenda. For more information on the council, see the Governance page. This guide will walk you through voting for councillors in the elections.\n\n## Voting for Councillors <a href=\"#voting-for-councillors\" id=\"voting-for-councillors\"></a>\n\nVoting for councillors requires you to lock 5 PHA on Phala or **5** K-PHA on Khala for the duration of your vote.\n\n> NOTE: Voting and staking locks **can overlap** A user can use staked funds to vote for Councillors and/or use those funds in referenda). A user is only prohibited from transferring these funds to another account.\n\n> Warning: If your balance is vesting, you cannot use unvested tokens for this lock. You will have to wait until you have at least that many **free** tokens to vote.\n\nLike the validator elections, you can approve up to **5** different councillors and your vote will be equalized among the chosen group. Unlike validator elections, there is no unbonding period for your reserved tokens. Once you remove your vote, your tokens will be liquid again.\n\n> Warning: It is your responsibility not to put your entire balance into the reserved value when you make a vote for councillors. It\u2019s best to keep at least enough PHA/K-PHA to pay for transaction fees.\n\nGo to the Khala Dashboard and click on the \u201cCouncil\u201d tab. On the right side of the window there are two blue buttons, click on the one that says \u201cVote.\u201d\n\nSince the council uses approval voting, when you vote you signal which of the candidates you approve of and your voted tokens will be equalized among the selected candidates. Select up to **5** council candidates by moving the slider to \u201cAye\u201d for each one that you want to be elected. When you\u2019ve made the proper configuration submit your transaction.\n\nYou should see your vote appear in the interface immediately after your transaction is included.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2087, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4d0f1828-87be-4540-84c6-920d77015745": {"__data__": {"id_": "4d0f1828-87be-4540-84c6-920d77015745", "embedding": null, "metadata": {"file_path": "phala-docs_dist/voting-for-councillors.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b4b34c1-8ff4-44fc-8927-bbc5c693128c", "node_type": "4", "metadata": {}, "hash": "f674e808bacd15371c33ab94a2b31771f793159868c8c359168d4441e630730d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "6e3144ea-aeb2-401a-92ef-20f997ab9882", "node_type": "1", "metadata": {}, "hash": "07eba782db34a6eb6425c40b0f4cb2a912ce76d9df5511d0351e7b7ea7495650", "class_name": "RelatedNodeInfo"}}, "text": "## Removing your Vote <a href=\"#removing-your-vote\" id=\"removing-your-vote\"></a>\n\nIn order to get your reserved tokens back, you will need to remove your vote. Only remove your vote when you\u2019re done participating in elections and you no longer want your reserved tokens to count for the councillors that you approve.\n\nGo to the \u201cGovernance\u201d > \u201cCouncil\u201d tab on the Polkadot-JS Apps Dashboard.\n\nUnder the \u201cOverview\u201d tab, click on \u201cVote\u201d.issue the \u201cunvote all\u201d option.\n\n![](https://i.imgur.com/Uln8z8p.png)\n\nWhen the transaction is included in a block you should have your reserved tokens made liquid again and your vote will no longer be counting for any councillors in the elections starting in the next term.", "mimetype": "text/plain", "start_char_idx": 2089, "end_char_idx": 2797, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e80d4a95-4b78-4b83-b912-a95a2d772edf": {"__data__": {"id_": "e80d4a95-4b78-4b83-b912-a95a2d772edf", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "226a033f-7fb0-4563-a8a3-5fda9b552751", "node_type": "1", "metadata": {}, "hash": "59cad867b1ac86e6c1f2875c64eadc105a49dc0c74397cfa8d0a2ed53a4a328a", "class_name": "RelatedNodeInfo"}}, "text": "# \u2694\ufe0f Connect Phat Contract to EVM Consumer Contract\n\n## Overview <a href=\"#user-content-overview\" id=\"user-content-overview\"></a>\n\nThis project represents a basic EVM Consumer Contract that is compatible with a deployed Oracle written in TypeScript on Phala Network.\n\n> **Note**: For simplicity, we will utilize Polygon Mumbai and Polygon Mainnet for the following examples.\n\n## Prerequisites <a href=\"#user-content-prerequisites\" id=\"user-content-prerequisites\"></a>\n\n* Active Phala Profile with version `>= 1.0.1` via [Phala Dashboard](https://bit.ly/3LHccmR)\n* [Hardhat](https://bit.ly/469uyW5)\n* For EVM Mainnet deployments:\n  * Ex: Polygonscan API Key that can be generated on [polygonscan](https://bit.ly/3rBkypp)\n* RPC Endpoint for EVM Chain Mainnet & EVM Chain Testnet\n  * [Alchemy](https://bit.ly/46uObaH) - This repo example uses Alchemy's API Key.\n  * [Infura](https://bit.ly/3PXXCtN)\n  * Personal RPC Node (Ex. [ProjectPi](https://bit.ly/3RGf7QS))\n* Polkadot Account for Phala PoC6 Testnet and Mainnet deployment\n  * [Phala Faucet](https://bit.ly/3Tomopi)\n* Node >= 18.x\n\n### Environment Variables: <a href=\"#user-content-environment-variables\" id=\"user-content-environment-variables\"></a>\n\nCheck out the environment variables here in [.env.local](https://bit.ly/3ZAA814) file.\n\n## Getting Started <a href=\"#user-content-getting-started\" id=\"user-content-getting-started\"></a>\n\n> \ud83d\udea8 **Note** \ud83d\udea8:\n>\n> If you cloned this repo or created a template, skip to [Create a Phala Profile](connect-phat-contract-to-evm-consumer-contract.md#user-content-create-a-phala-profile).\n\nFirst you will need to install the `@phala/fn` CLI tool using your node package manager (`npm`) or use node package execute (`npx`). In this tutorial we use `npx`.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1742, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "226a033f-7fb0-4563-a8a3-5fda9b552751": {"__data__": {"id_": "226a033f-7fb0-4563-a8a3-5fda9b552751", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e80d4a95-4b78-4b83-b912-a95a2d772edf", "node_type": "1", "metadata": {}, "hash": "9520ccb995efb674b6e35f230506f350c015fed13c8fce9f52602c81b580f655", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "aa989ec9-c72b-4fe3-a42e-e1c2ed50d9bc", "node_type": "1", "metadata": {}, "hash": "5f9f0016f89499e8b0003a02573f857b8901d7659bbc5c3b5c34a561c27e34fa", "class_name": "RelatedNodeInfo"}}, "text": "Now create your first template with the CLI tool command:\n\n```sh\nnpx @phala/fn@latest init userJourney\n```\n\nSelect one of the template and press enter to see something similar to the example below:\n\n```sh\nnpx @phala/fn@latest init userJourney\n? Please select one of the templates for your \"userJourney\" project: \n\u276f phat-contract-starter-kit: Send data from any API to your smart contract with Javascript. \n  lensapi-oracle-consumer-contract: Send data from Lens API to your smart contract to empower your Web3 Social dApp. \n  vrf-oracle: TEE-guarded Verifiable Random Function template to bring randomness to your smart contract. \n  airstack-phat-contract: Request an account\u2019s data from Airstack\u2019s API to compute trust score and send to your Web3 dApp on-chain. \n  thegraph-phat-contract: Connect your subgraphs from The Graph to your on-chain dApps via Phat Contract.  \n```\n\n`cd` into the newly created template and `ls` the directory which will look similar to below.\n\n```sh\ncd userJourney\nls\n# total 736\n# drwxr-xr-x  18 hashwarlock  staff   576B Sep  6 15:32 .\n# drwxr-xr-x  35 hashwarlock  staff   1.1K Sep  6 15:32 .\n# -rw-r--r--   1 hashwarlock  staff   2.1K Sep  6 15:32 .env.local\n# -rw-r--r--   1 hashwarlock  staff   227B Sep  6 15:32 .gitignore\n# -rw-r--r--   1 hashwarlock  staff    34K Sep  6 15:32 LICENSE\n# -rw-r--r--   1 hashwarlock  staff   8.9K Sep  6 15:32 README.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "aa989ec9-c72b-4fe3-a42e-e1c2ed50d9bc": {"__data__": {"id_": "aa989ec9-c72b-4fe3-a42e-e1c2ed50d9bc", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "226a033f-7fb0-4563-a8a3-5fda9b552751", "node_type": "1", "metadata": {}, "hash": "59cad867b1ac86e6c1f2875c64eadc105a49dc0c74397cfa8d0a2ed53a4a328a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "9041d467-b366-42ba-a3bc-7ccd88fd4b40", "node_type": "1", "metadata": {}, "hash": "af3a34ad39d29eaad58b3d5d26788eec70ca5c0e5257436066a9651ffaeeb86c", "class_name": "RelatedNodeInfo"}}, "text": "md\n# drwxr-xr-x   5 hashwarlock  staff   160B Sep  6 15:32 abis\n# drwxr-xr-x   4 hashwarlock  staff   128B Sep  6 15:32 assets\n# drwxr-xr-x   5 hashwarlock  staff   160B Sep  6 15:32 contracts\n# -rw-r--r--   1 hashwarlock  staff   1.3K Sep  6 15:32 hardhat.config.ts\n# -rw-r--r--   1 hashwarlock  staff    95B Sep  6 15:32 mumbai.arguments.ts\n# -rw-r--r--   1 hashwarlock  staff   2.6K Sep  6 15:32 package.json\n# -rw-r--r--   1 hashwarlock  staff    96B Sep  6 15:32 polygon.arguments.ts\n# drwxr-xr-x   5 hashwarlock  staff   160B Sep  6 15:32 scripts\n# drwxr-xr-x   3 hashwarlock  staff    96B Sep  6 15:32 src\n# drwxr-xr-x   3 hashwarlock  staff    96B Sep  6 15:32 test\n# -rw-r--r--   1 hashwarlock  staff   201B Sep  6 15:32 tsconfig.json\n# -rw-r--r--   1 hashwarlock  staff   290K Sep  6 15:32 package-lock.json\n```\n\n## Create a Phala Profile <a href=\"#user-content-create-a-phala-profile\" id=\"user-content-create-a-phala-profile\"></a>\n\nThis step requires you to have a Polkadot account.", "mimetype": "text/plain", "start_char_idx": 3130, "end_char_idx": 4123, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "9041d467-b366-42ba-a3bc-7ccd88fd4b40": {"__data__": {"id_": "9041d467-b366-42ba-a3bc-7ccd88fd4b40", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "aa989ec9-c72b-4fe3-a42e-e1c2ed50d9bc", "node_type": "1", "metadata": {}, "hash": "5f9f0016f89499e8b0003a02573f857b8901d7659bbc5c3b5c34a561c27e34fa", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "54690056-116c-4553-86e4-068540bbcbfb", "node_type": "1", "metadata": {}, "hash": "aeaa01fe673895d56e9d6393740f08c4926c71f36c4958d4c5ae34cfebd723bf", "class_name": "RelatedNodeInfo"}}, "text": "You can get an account from one of the following:\n\n* [Polkadot.js Wallet Extension](https://bit.ly/3RMUjqy)\n* [Talisman Wallet](https://bit.ly/3ZzAPYD)\n* [SubWallet](https://bit.ly/3tjS8R7) (**Support for iOS/Android**)\n\nFirst, create your Phala Profile account on the [Phala Dashboard](https://bit.ly/3LHccmR). Here is a quick 1 minute [YouTube video](https://bit.ly/46clfo4) on setting up from scratch. Here is what your Phala Profile account overview should look like:\n\n<figure><img src=\"https://github.com/Phala-Network/phat-contract-starter-kit/raw/main/assets/BricksProfileCheck.png\" alt=\"\"><figcaption></figcaption></figure>\n\n**Option 1: Export Polkadot account as json file**\n\nGo to your browser and click on the polkadot.js extension. Select your account and click \"Export Account\". Next, you will be prompted for your password before saving the file to your project directory. **Note** this is what will be set to `POLKADOT_WALLET_ACCOUNT_PASSPHRASE`. Make sure to save the file as `polkadot-account.json` in the root of your project directory.\n\n<figure><img src=\"https://github.com/Phala-Network/phat-contract-starter-kit/raw/main/assets/ExportAccount.png\" alt=\"\"><figcaption></figcaption></figure>\n\n<figure><img src=\"https://github.com/Phala-Network/phat-contract-starter-kit/raw/main/assets/ExportTypePass.png\" alt=\"\"><figcaption></figcaption></figure>\n\n<figure><img src=\"https://github.com/Phala-Network/phat-contract-starter-kit/raw/main/assets/SaveAccount.png\" alt=\"\"><figcaption></figcaption></figure>\n\n**Option 2: Set mnemonic phrase to `POLKADOT_WALLET_SURI`**\n\nAfter creating your Phala Profile, set your `.env` variable `POLKADOT_WALLET_SURI` to the mnemonic phrase from generating the new Polkadot Account.", "mimetype": "text/plain", "start_char_idx": 4124, "end_char_idx": 5852, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "54690056-116c-4553-86e4-068540bbcbfb": {"__data__": {"id_": "54690056-116c-4553-86e4-068540bbcbfb", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "9041d467-b366-42ba-a3bc-7ccd88fd4b40", "node_type": "1", "metadata": {}, "hash": "af3a34ad39d29eaad58b3d5d26788eec70ca5c0e5257436066a9651ffaeeb86c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "85f0a004-b576-4100-a4d1-8bd8b7b8e588", "node_type": "1", "metadata": {}, "hash": "82c566e5cd60127c06a6665be1b56908ee3dafd97ba37a24eddaad6871c18435", "class_name": "RelatedNodeInfo"}}, "text": "Here is a screenshot of how to set `POLKADOT_WALLET_SURI`:\n\n<figure><img src=\"https://github.com/Phala-Network/phat-contract-starter-kit/raw/main/assets/PolkadotAccountSuri.png\" alt=\"\"><figcaption></figcaption></figure>\n\n## Testing Locally <a href=\"#user-content-testing-locally\" id=\"user-content-testing-locally\"></a>\n\n#### Test Default Phat Contract Locally <a href=\"#user-content-test-default-phat-contract-locally\" id=\"user-content-test-default-phat-contract-locally\"></a>\n\nWith a template created and a basic default Phat Contract example ready to test, let\u2019s step through the process of preparing your repo to execute the test locally.\n\nFirst step is to install the package dependencies with the following command:\n\n```sh\nnpm install\n```\n\nEverything should go smoothly and produce similar output below:\n\n```\nnpm install\n# [1/4] \ud83d\udd0d  Resolving packages...\n# [2/4] \ud83d\ude9a  Fetching packages...\n# [3/4] \ud83d\udd17  Linking dependencies...\n# warning \" > @typechain/ethers-v5@10.1.0\" has unmet peer dependency \"@ethersproject/bytes@^5.0.0\".\n# [4/4] \ud83d\udd28  Building fresh packages...\n# \u2728  Done in 4.95s.\n```\n\nNow that the package dependencies are installed, lets build the default Phat Contract which is located in [`./src/index.ts`](https://bit.ly/3PBnP02).\n\nFor those want to understand what the contents of `./src/index.ts` mean, go [here](customizing-your-phat-contract.md) read more. If you are already familiar with the concepts then you can proceed to with the deployment process.\n\nBuild the default Phat Contract with this command:\n\n```bash\nnpx @phala/fn build\n```\n\nYou will see output similar to the example below. and a file in `./dist/index.js` will be generated.\n\n```bash\nnpx @phala/fn build\n# \u2713 Compiled successfully.\n#   17.66 KB  dist/index.js\n```\n\nWith our default Phat Contract built, we can run some initial tests. First test will be simple.", "mimetype": "text/plain", "start_char_idx": 5854, "end_char_idx": 7693, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "85f0a004-b576-4100-a4d1-8bd8b7b8e588": {"__data__": {"id_": "85f0a004-b576-4100-a4d1-8bd8b7b8e588", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "54690056-116c-4553-86e4-068540bbcbfb", "node_type": "1", "metadata": {}, "hash": "aeaa01fe673895d56e9d6393740f08c4926c71f36c4958d4c5ae34cfebd723bf", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "cbb146b3-d351-4f60-8f45-7d51c56ec85a", "node_type": "1", "metadata": {}, "hash": "9af974acc53c76eec44aa0175eecb211c33436468bcd92ba6f4d51b680275f90", "class_name": "RelatedNodeInfo"}}, "text": "```bash\nnpx @phala/fn run dist/index.js\n```\n\nIt was expected for it to fail like this:\n\n```bash\nnpx @phala/fn run dist/index.js\n# handle req: undefined\n# Malformed request received\n# {\"output\":\"0x000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\"}\n# \u2728  Done in 0.96s.\n```\n\nNotice that the test fails and reports that a `Malformed request received` was emitted and the request was `undefined`. This is expected as you will need to define the parameters by adding a `-a abi.encode(requestId, profileId) https://api-v2-mumbai-live.lens.dev` to your command.\n\nTo simulate the expected result locally, run the Phala Oracle function now with this command:\n\n```bash\nnpx @phala/fn run dist/index.js -a 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000 https://api-v2-mumbai-live.lens.dev\n```\n\n> **What are the ingredients for the `npx @phala/fn run` command?**\n>\n> Our Phat Contract script, now fully constructed, is ready for a trial run. This simulation mirrors the live script's operation when deployed on the Phala Network.\n>\n> The command's first parameter is a HexString, representing a tuple of types `[uint, bytes]`. This serves as the entry function. The second parameter is a `string`, embodying the configurable secrets fed into the main function.\n>\n> The `Coders.decode` function deciphers these parameters, yielding the decoded `requestId` and `encodedReqStr`. These decoded elements then become the raw material for the rest of the custom logic within the script.", "mimetype": "text/plain", "start_char_idx": 7695, "end_char_idx": 9516, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "cbb146b3-d351-4f60-8f45-7d51c56ec85a": {"__data__": {"id_": "cbb146b3-d351-4f60-8f45-7d51c56ec85a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "85f0a004-b576-4100-a4d1-8bd8b7b8e588", "node_type": "1", "metadata": {}, "hash": "82c566e5cd60127c06a6665be1b56908ee3dafd97ba37a24eddaad6871c18435", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "05ede7ca-c2e7-4b90-b586-4489b6d23799", "node_type": "1", "metadata": {}, "hash": "4d8e7548d803962695deb63e465bdb11f84429873d731eeef04910895b2b38a1", "class_name": "RelatedNodeInfo"}}, "text": ">\n> ```typescript\n> export default function main(request: HexString, settings: string): HexString {\n>   console.log(`handle req: ${request}`);\n>   let requestId, encodedReqStr;\n>   try {\n>     [requestId, encodedReqStr] = decodeRequest(decodeRequestAbiParams, request);\n>   } catch (error) {\n>     console.info(\"Malformed request received\");\n>   }\n> // .\n> } \n> ```\n\n<details>\n\n<summary>How the query looks under the hood</summary>\n\n* HTTP Endpoint: [https://api-v2-mumbai-live.lens.dev](https://api-mumbai.lens.dev/)\n* Profile ID: `0x01`\n* Expected Graphql Query:\n\n```graphql\nquery Profile {\n    profile(request: { forProfileId: \"0x01\" }) {\n      stats {\n          followers\n          following\n          comments\n          countOpenActions\n          posts\n          quotes\n          mirrors\n          publications\n          reacted\n          reactions\n      }\n    }\n}\n```\n\n* Expected Output:\n\n```graphql\n{\n  \"data\": {\n    \"profile\": {\n      \"stats\": {\n        \"followers\": 2,\n        \"following\": 0,\n        \"comments\": 0,\n        \"countOpenActions\": 1,\n        \"posts\": 14,\n        \"quotes\": 0,\n        \"mirrors\": 0,\n        \"publications\": 14,\n        \"reacted\": 0,\n        \"reactions\": 0\n    }\n  }\n}\n```\n\n</details>\n\nYou will see:\n\n```bash\nnpx @phala/fn run dist/index.js -a 0x00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000040000000\n00000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000 https://api-mumbai.lens.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "05ede7ca-c2e7-4b90-b586-4489b6d23799": {"__data__": {"id_": "05ede7ca-c2e7-4b90-b586-4489b6d23799", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "cbb146b3-d351-4f60-8f45-7d51c56ec85a", "node_type": "1", "metadata": {}, "hash": "9af974acc53c76eec44aa0175eecb211c33436468bcd92ba6f4d51b680275f90", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "039ad2a0-598b-4c50-9a01-e0169c74e388", "node_type": "1", "metadata": {}, "hash": "87b4c5060fb6a729d95626739af4cda91a98397a01e08f11d0d2bf24f2ff666c", "class_name": "RelatedNodeInfo"}}, "text": "dev\n# handle req: 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000\n# Request received for profile 0x01\n# response: 0,1,201\n# {\"output\":\"0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c9\"}\n# \u2728  Done in 1.42s.\n```\n\nWe have now successfully tested the default Phat Contract and ran a test to verify the function returns a response as expected.\n\n### Testing Default Phat Contract with Local Hardhat Node <a href=\"#user-content-testing-default-phat-contract-with-local-hardhat-node\" id=\"user-content-testing-default-phat-contract-with-local-hardhat-node\"></a>\n\nPreviously we showed how to test the default Phat Contract locally without a running node, but we can also run two other tests.\n\n1. Run the default mocha e2e tests.\n2. Run local hardhat node and watch the requests that are pushed and see how the Phat Contract transforms the data.\n\n**Run the default mocha e2e tests**\n\nLets\u2019s start with the first test case.\n\n> Note: You will need to ensure you configure your local vars `POLYGON_RPC_URL` and `MUMBAI_RPC_URL` `.env` file. You can do this with `cp .env.local .env` then edit the `.env` with your information.\n\n```sh\nnpm run localhost-test\n```\n\nYou will now see that all test cases have passed.\n\n```sh\nnpm run localhost-test\n# Compiled 14 Solidity files successfully\n#\n#  OracleConsumerContract.sol\n#    \u2714 Push and receive message (1664ms)\n#\n#  1 passing (2s)\n#\n# \u2728  Done in 3.29s.", "mimetype": "text/plain", "start_char_idx": 11083, "end_char_idx": 12824, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "039ad2a0-598b-4c50-9a01-e0169c74e388": {"__data__": {"id_": "039ad2a0-598b-4c50-9a01-e0169c74e388", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "05ede7ca-c2e7-4b90-b586-4489b6d23799", "node_type": "1", "metadata": {}, "hash": "4d8e7548d803962695deb63e465bdb11f84429873d731eeef04910895b2b38a1", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f0dddd6e-2a9f-44a8-baa6-7d47b88fa97c", "node_type": "1", "metadata": {}, "hash": "3c29e396e52ace39e971aecec6b93eaf987a865b55b9649f583123e6fa3c600d", "class_name": "RelatedNodeInfo"}}, "text": "```\n\nThis is how the e2e mocha test will look like. You can customize this file at `OracleConsumerContract.ts`.\n\n**Run local hardhat node and watch the requests that are pushed and see how the Phat Contract transforms the data**\n\nFirst we will start a local hardhat node.\n\n```sh\nnpm run localhost-node\n```\n\nWith our hardhat node running locally, we can now deploy the `OracleConsumerContract.sol` contract to the local hardhat network.\n\n<pre class=\"language-sh\"><code class=\"lang-sh\"><strong>npm run localhost-deploy \n</strong></code></pre>\n\n```sh\nnpm run localhost-deploy\n# Deploying...\n# Deployed { consumer: '0x0165878A594ca255338adfa4d48449f69242Eb8F' }\n# \u2728  Done in 0.94s.\n```\n\nMake sure to copy the deployed contract address when you deploy your own contract locally. Note you contract address will be different than `0x0165878A594ca255338adfa4d48449f69242Eb8F`. We will now start watching the hardhat node deployed contract for any new requests.\n\n```sh\nnpx @phala/fn watch 0x0165878A594ca255338adfa4d48449f69242Eb8F artifacts/contracts/OracleConsumerContract.sol/OracleConsumerContract.json dist/index.js -a https://api-mumbai.lens.dev/\n```\n\n```sh\nnpx @phala/fn watch 0x0165878A594ca255338adfa4d48449f69242Eb8F artifacts/contracts/OracleConsumerContract.sol/OracleConsumerContract.json dist/index.js -a https://api-mumbai.lens.dev/\n# Listening for OracleConsumerContract.sol MessageQueued events...\n```\n\nLet\u2019s now make a new request and see what happens with the listener\u2019s output. In separate tab, you will push a request with the following.", "mimetype": "text/plain", "start_char_idx": 12825, "end_char_idx": 14374, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f0dddd6e-2a9f-44a8-baa6-7d47b88fa97c": {"__data__": {"id_": "f0dddd6e-2a9f-44a8-baa6-7d47b88fa97c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "039ad2a0-598b-4c50-9a01-e0169c74e388", "node_type": "1", "metadata": {}, "hash": "87b4c5060fb6a729d95626739af4cda91a98397a01e08f11d0d2bf24f2ff666c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "deffc310-9a50-4f45-9292-12f91e002625", "node_type": "1", "metadata": {}, "hash": "4636291467e601742054e8dcc4a2c7137f556e2bfc16c794d92bd075ee0b2b78", "class_name": "RelatedNodeInfo"}}, "text": "```sh\nLOCALHOST_CONSUMER_CONTRACT_ADDRESS=0x0165878A594ca255338adfa4d48449f69242Eb8F npm run localhost-push-request\n```\n\n```sh\nLOCALHOST_CONSUMER_CONTRACT_ADDRESS=0x0165878A594ca255338adfa4d48449f69242Eb8F npm run localhost-push-request\n# Pushing a request...\n# Received event [ResponseReceived]: {\n#  reqId: BigNumber { value: \"1\" },\n#  input: '0x01',\n#  value: BigNumber { value: \"1597\" }\n# }\n# \u2728  Done in 4.99s.\n```\n\nIf we look back at the listener tab, we will see output has been appended.", "mimetype": "text/plain", "start_char_idx": 14376, "end_char_idx": 14870, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "deffc310-9a50-4f45-9292-12f91e002625": {"__data__": {"id_": "deffc310-9a50-4f45-9292-12f91e002625", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f0dddd6e-2a9f-44a8-baa6-7d47b88fa97c", "node_type": "1", "metadata": {}, "hash": "3c29e396e52ace39e971aecec6b93eaf987a865b55b9649f583123e6fa3c600d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "d6aef0db-9972-425c-b292-909c9ec528da", "node_type": "1", "metadata": {}, "hash": "9ba79ab6d9a561f3a396437cd2dbee8557e36c9e43ba3cc76d2858b52a34c9f1", "class_name": "RelatedNodeInfo"}}, "text": "```sh\nListening for OracleConsumerContract MessageQueued events...\nReceived event [MessageQueued]: {\n  tail: 0n,\n  data: '0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000'\n}\nhandle req: 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000\nRequest received for profile 0x01\nresponse: 201\nJS Execution output: 0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c9\n```\n\n## Deployment <a href=\"#user-content-deployment\" id=\"user-content-deployment\"></a>\n\nNow that you have the prerequisites to deploy a Polygon Consumer Contract on Polygon, lets begin with some initials tasks.", "mimetype": "text/plain", "start_char_idx": 14872, "end_char_idx": 16002, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d6aef0db-9972-425c-b292-909c9ec528da": {"__data__": {"id_": "d6aef0db-9972-425c-b292-909c9ec528da", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "deffc310-9a50-4f45-9292-12f91e002625", "node_type": "1", "metadata": {}, "hash": "4636291467e601742054e8dcc4a2c7137f556e2bfc16c794d92bd075ee0b2b78", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "2f1e1287-3f88-4aa5-a7ce-1e0c89384842", "node_type": "1", "metadata": {}, "hash": "66378a3c2c028c4b6b1171972558f8be829d69b3c0ac9168169dce38b143b27e", "class_name": "RelatedNodeInfo"}}, "text": "### Install Dependencies & Compile Contracts <a href=\"#user-content-install-dependencies--compile-contracts\" id=\"user-content-install-dependencies--compile-contracts\"></a>\n\n```sh\n# install dependencies\n$ npm install\n\n# compile contracts\n$ npm run compile\n```\n\n### Deploy to Polygon Mumbai Testnet <a href=\"#user-content-deploy-to-polygon-mumbai-testnet\" id=\"user-content-deploy-to-polygon-mumbai-testnet\"></a>\n\n{% hint style=\"danger\" %}\n**Important**\n\nThis guide references the `mumbai` testnet chain.&#x20;\n\nThe`mumbai` testnet is [deprecated since 2024/04/08](https://polygon.technology/blog/introducing-the-amoy-testnet-for-polygon-pos), meaning the steps to deploy to a testnet will no longer work out of the box.\n\nYou can opt to use the [`amoy`](https://polygon.technology/blog/introducing-the-amoy-testnet-for-polygon-pos) testnet or any other EVM testnet instead.\n{% endhint %}\n\nWith the contracts successfully compiled, now we can begin deploying first to Polygon Mumbai Testnet. If you have not gotten `MATIC` for Mumbai Testnet then get `MATIC` from a [faucet](https://bit.ly/3ZyFoT3). Ensure to save the address after deploying the Consumer Contract because this address will be use in the \"Configure Client\" section of Phat Bricks UI. The deployed address will also be set to the environment variable `MUMBAI_CONSUMER_CONTRACT_ADDRESS`.", "mimetype": "text/plain", "start_char_idx": 16004, "end_char_idx": 17352, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "2f1e1287-3f88-4aa5-a7ce-1e0c89384842": {"__data__": {"id_": "2f1e1287-3f88-4aa5-a7ce-1e0c89384842", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d6aef0db-9972-425c-b292-909c9ec528da", "node_type": "1", "metadata": {}, "hash": "9ba79ab6d9a561f3a396437cd2dbee8557e36c9e43ba3cc76d2858b52a34c9f1", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "cc991195-6664-4135-8a38-50d703ceb056", "node_type": "1", "metadata": {}, "hash": "1c30512ba8c9a7077eab3aeccba36ae6504296a65c787aa1549ad3a58f7b6f06", "class_name": "RelatedNodeInfo"}}, "text": "<pre class=\"language-sh\"><code class=\"lang-sh\"><strong>npm run test-deploy\n</strong></code></pre>\n\n```sh\n# deploy contracts to testnet mumbai\nnpm run test-deploy\n# Deploying...\n#\n# \ud83c\udf89 Your Consumer Contract has been deployed, check it out here: https://mumbai.polygonscan.com/address/0x10FA409109E073C15b77A8352cB6A89C12CD1605\n#\n# You also need to set up the consumer contract address in your .env file:\n#\n# MUMBAI_CONSUMER_CONTRACT_ADDRESS=0x10FA409109E073C15b77A8352cB6A89C12CD1605\n#\n# Configuring...\n# Done\n# \u2728  Done in 8.20s.\n```\n\n### **(Optional) Verify Contract on Polygon Mumbai Testnet**\n\nEnsure to update the `mumbai.arguments.ts` file with the constructor arguments used to instantiate the Consumer Contract. If you add additional parameters to the constructor function then make sure to update the `mumbai.arguments.ts` file.\n\n> **Note**: Your contract address will be different than `0x090E8fDC571d65459569BC87992C1026121DB955` when verifying your contract. Make sure to get your actual contract address from the console log output after executing `npm run test-deploy`.\n\n```sh\nnpm run test-verify -- <MUMBAI_CONSUMER_CONTRACT_ADDRESS>\n```\n\n```sh\nnpm run test-verify -- 0x090E8fDC571d65459569BC87992C1026121DB955\n# $ hardhat verify --network mumbai --constructor-args mumbai.arguments.ts 0x090E8fDC571d65459569BC87992C1026121DB955\n# Nothing to compile\n# No need to generate any newer typings.\n# Successfully submitted source code for contract\n# contracts/OracleConsumerContract.sol:OracleConsumerContract.sol at 0x090E8fDC571d65459569BC87992C1026121DB955\n# for verification on the block explorer. Waiting for verification result...\n#\n# Successfully verified contract OracleConsumerContract.sol on Etherscan.", "mimetype": "text/plain", "start_char_idx": 17354, "end_char_idx": 19072, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "cc991195-6664-4135-8a38-50d703ceb056": {"__data__": {"id_": "cc991195-6664-4135-8a38-50d703ceb056", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "2f1e1287-3f88-4aa5-a7ce-1e0c89384842", "node_type": "1", "metadata": {}, "hash": "66378a3c2c028c4b6b1171972558f8be829d69b3c0ac9168169dce38b143b27e", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "8709ed23-b210-496e-87c3-e32cada758c3", "node_type": "1", "metadata": {}, "hash": "50e3ba82b35ad6366acbeeae0589243ea08a0d06ca222f93802706bc9a24033d", "class_name": "RelatedNodeInfo"}}, "text": "# https://mumbai.polygonscan.com/address/0x090E8fDC571d65459569BC87992C1026121DB955#code\n# \u2728  Done in 5.91s.\n```\n\n### Deploy Phat Contract to PoC6 Testnet <a href=\"#user-content-deploy-phat-contract-to-poc5-testnet\" id=\"user-content-deploy-phat-contract-to-poc5-testnet\"></a>\n\nFor customizing your Phat Contract, checkout Phat Contract custom configurations in [Customizing Your Phat Contract](customizing-your-phat-contract.md) to learn more before deploying to PoC6 testnet.\n\nNow that are Phat Contract has built successfully, let's deploy to Phala PoC6 Testnet with the following command:\n\n```shell\n# If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn upload --coreSettings=https://api-v2-mumbai-live.lens.dev/\n# If polkadot-account.json is in the root of project\nnpx @phala/fn upload -a ./polkadot-account.json --coreSettings=https://api-v2-mumbai-live.lens.dev/\n```\n\nHere is the expected output:\n\n> Note: your contract IDs will vary and not be the same as the IDs below.\n\n```shell\nnpx @phala/fn upload -a ./polkadot-account.json --coreSettings=https://api-v2-mumbai-live.lens.dev/\n# ? Please enter your client RPC URL https://polygon-mumbai.g.alchemy.com/v2/JLjOfWJycWFOA0kK_SJ4jLGjtXkMN1wc\n# ? Please enter your consumer address 0xA4Be456Fd0d41968a52b34Cdb8Ba875F2281134a\n# ? Please Enter hahaha account password [hidden]\n# Creating an optimized build... done\n# Compiled successfully.", "mimetype": "text/plain", "start_char_idx": 19073, "end_char_idx": 20528, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8709ed23-b210-496e-87c3-e32cada758c3": {"__data__": {"id_": "8709ed23-b210-496e-87c3-e32cada758c3", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "cc991195-6664-4135-8a38-50d703ceb056", "node_type": "1", "metadata": {}, "hash": "1c30512ba8c9a7077eab3aeccba36ae6504296a65c787aa1549ad3a58f7b6f06", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "7c098cf3-50ba-415b-8bfd-6ee7939090ab", "node_type": "1", "metadata": {}, "hash": "5c361685366177631ddac3f443dcd17b02eea0119e341b2c8480b8b7784d152a", "class_name": "RelatedNodeInfo"}}, "text": "#\n#  17.64 KB  dist/index.js\n# Connecting to the endpoint: wss://poc6.phala.network/ws... done\n# Querying your Brick Profile contract ID... done\n# Your Brick Profile contract ID: 0x4071788a8ce6fbab0cacea0cb1aa52853b5537db7955643e5010c22913c2b1dd\n# Instantiating the ActionOffchainRollup contract... done\n# The ActionOffchainRollup contract has been instantiated: 0x9c777c16b0a185caa895835b8f3b9e8d67be9f5e30197f71b4d32d2b8fde4b3b\n# Setting up the actions... done\n# \ud83c\udf89 Your workflow has been added, you can check it out here: https://bricks-poc6.phala.network/workflows/0x4071788a8ce6fbab0cacea0cb1aa52853b5537db7955643e5010c22913c2b1dd/3\n# Your Attestor address: 0x2b5fe2920cce2f522d69613adaa9378ba43b687d\n# Your WORKFLOW_ID: 3\n# \u2728  Done in 73.22s.\n```\n\nGo to the [Phala Dashboard](https://dashboard.phala.network) and you can see your newly deployed Phat Contract.\n\n<figure><img src=\"https://github.com/Phala-Network/phat-contract-starter-kit/raw/main/assets/Function-added.png\" alt=\"\"><figcaption></figcaption></figure>\n\n### **Interact with Consumer Contract on Polygon Mumbai**\n\nTest Consumer Contract on Mumbai with a few tests to check for malformed requests failures, successful requests, and set the attestor.", "mimetype": "text/plain", "start_char_idx": 20529, "end_char_idx": 21744, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7c098cf3-50ba-415b-8bfd-6ee7939090ab": {"__data__": {"id_": "7c098cf3-50ba-415b-8bfd-6ee7939090ab", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "8709ed23-b210-496e-87c3-e32cada758c3", "node_type": "1", "metadata": {}, "hash": "50e3ba82b35ad6366acbeeae0589243ea08a0d06ca222f93802706bc9a24033d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "66b0c14f-b2db-4533-a6dc-8fcef8decdf8", "node_type": "1", "metadata": {}, "hash": "d0189e7ffc69a79ae82d2988bd73bdd31f26f23725a8b2a761c2019447aa7fd2", "class_name": "RelatedNodeInfo"}}, "text": "```sh\nnpm run test-set-attestor\n```\n\n```sh\nnpm run test-set-attestor\n# $ hardhat run --network mumbai ./scripts/mumbai/set-attestor.ts\n# Setting attestor...\n# \ud83d\udea8NOTE\ud83d\udea8\n# Make sure to set the Consumer Contract Address in your Phat Bricks \ud83e\uddf1 UI dashboard (https://bricks-poc6.phala.network)\n# - Go to 'Configure Client' section where a text box reads 'Add Consumer Smart Contract'\n# - Set value to 0x090E8fDC571d65459569BC87992C1026121DB955\n# Done\n# \u2728  Done in 2.69s.\n```\n\nTest pushing a malform request.\n\n```sh\nnpm run test-push-malformed-request\n```\n\n```sh\nnpm run test-push-malformed-request\n# $ hardhat run --network mumbai ./scripts/mumbai/push-malformed-request.ts\n# Pushing a malformed request...\n# Done\n# \u2728  Done in 2.48s.\n```\n\nTest pushing a valid request.\n\n```sh\nnpm run test-push-request\n```\n\n```sh\nnpm run test-push-request\n# Pushing a request...\n# Done\n# \u2728  Done in 2.97s.\n```\n\n### Update Phat Contract on Phala PoC6 Testnet <a href=\"#user-content-update-phat-contract-on-phala-poc5-testnet\" id=\"user-content-update-phat-contract-on-phala-poc5-testnet\"></a>\n\nSometimes you may have had a bug in your script or you want to test things out on the fly without deploying a whole new Phat Contract. We now allow you to update your Phat Contract easily in the commandline. Now let's update the Phat Contract with the following command:\n\n```shell\n# If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn update\n# If polkadot-account.json is in the root of project\nnpx @phala/fn update -a ./polkadot-account.json\n```\n\n```shell\nnpx @phala/fn update -a ./polkadot-account.json\n# ?", "mimetype": "text/plain", "start_char_idx": 21746, "end_char_idx": 23385, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "66b0c14f-b2db-4533-a6dc-8fcef8decdf8": {"__data__": {"id_": "66b0c14f-b2db-4533-a6dc-8fcef8decdf8", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "7c098cf3-50ba-415b-8bfd-6ee7939090ab", "node_type": "1", "metadata": {}, "hash": "5c361685366177631ddac3f443dcd17b02eea0119e341b2c8480b8b7784d152a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "489766c0-9f72-4846-8b73-65ddfd3b5c84", "node_type": "1", "metadata": {}, "hash": "1b4435a603040803f9f18aee04626c5c3c37dc8da06190b8476802bd843f700d", "class_name": "RelatedNodeInfo"}}, "text": "Please Enter hahaha account password [hidden]\n# Creating an optimized build... done\n# Compiled successfully.\n#\n#   17.64 KB  dist/index.js\n# Connecting to the endpoint: wss://poc6.phala.network/ws... done\n# Querying your Brick Profile contract ID... done\n# Your Brick Profile contract ID: 0x4071788a8ce6fbab0cacea0cb1aa52853b5537db7955643e5010c22913c2b1dd\n# Checking your workflow settings... done\n# Updating... done\n# The Phat Function for workflow 1 has been updated.\n# \u2728  Done in 10.82s.\n```\n\nCongrats! You've now successfully updated your Phat Contract!\n\n### Deploy to Polygon Mainnet <a href=\"#user-content-deploy-to-polygon-mainnet\" id=\"user-content-deploy-to-polygon-mainnet\"></a>\n\nEnsure to save the address after deploying the Consumer Contract because this address will be used in the \"[Configure Client](https://docs.phala.network/developers/bricks-and-blueprints/featured-blueprints/lensapi-oracle#step-4-configure-the-client-address)\" section of Phat Bricks UI. The deployed address will also be set to the environment variable `POLYGON_CONSUMER_CONTRACT_ADDRESS`.\n\n> **Note**: Your contract address will be different than `0xbb0d733BDBe151dae3cEf8D7D63cBF74cCbf04C4` when verifying your contract. Make sure to get your actual contract address from the console log output after executing `npm run main-deploy`.\n\n```sh\nnpm run main-deploy\n# Deploying...\n#\n# \ud83c\udf89 Your Consumer Contract has been deployed, check it out here: https://polygonscan.com/address/0xbb0d733BDBe151dae3cEf8D7D63cBF74cCbf04C4\n#\n# You also need to set up the consumer contract address in your .env file:\n#\n# POLYGON_CONSUMER_CONTRACT_ADDRESS=0xbb0d733BDBe151dae3cEf8D7D63cBF74cCbf04C4\n#\n# Configuring...\n# Done\n# \u2728  Done in 8.20s.", "mimetype": "text/plain", "start_char_idx": 23386, "end_char_idx": 25097, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "489766c0-9f72-4846-8b73-65ddfd3b5c84": {"__data__": {"id_": "489766c0-9f72-4846-8b73-65ddfd3b5c84", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "66b0c14f-b2db-4533-a6dc-8fcef8decdf8", "node_type": "1", "metadata": {}, "hash": "d0189e7ffc69a79ae82d2988bd73bdd31f26f23725a8b2a761c2019447aa7fd2", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "3ed20fa7-ce9e-4f51-95eb-1f439b46e155", "node_type": "1", "metadata": {}, "hash": "40995b1425da1ea83f4d29998d7f69f2ad093b96cd1bd8f99a479f981d7ca707", "class_name": "RelatedNodeInfo"}}, "text": "```\n\n### **(Optional) Verify Contract on Polygon Mainnet**\n\nEnsure to update the `polygon.arguments.ts` file with the constructor arguments used to instantiate the Consumer Contract. If you add additional parameters to the constructor function then make sure to update the `polygon.arguments.ts` file.\n\n```sh\nnpm run main-verify -- 0xbb0d733BDBe151dae3cEf8D7D63cBF74cCbf04C4\n# Nothing to compile\n# No need to generate any newer typings.\n# Successfully submitted source code for contract\n# contracts/OracleConsumerContract.sol.sol:OracleConsumerContract.sol.sol.sol at 0xbb0d733BDBe151dae3cEf8D7D63cBF74cCbf04C4\n# for verification on the block explorer. Waiting for verification result...\n#\n# Successfully verified contract OracleConsumerContract.sol on Etherscan.\n# https://polygonscan.com/address/0xbb0d733BDBe151dae3cEf8D7D63cBF74cCbf04C4#code\n# Done in 8.88s.\n```\n\n### Deploy Phat Contract to Phala Mainnet <a href=\"#user-content-deploy-phat-contract-to-phala-mainnet\" id=\"user-content-deploy-phat-contract-to-phala-mainnet\"></a>\n\nFor customizing your Phat Contract, Phat Contract custom configurations can be found here in [Customizing Your Phat Contract](customizing-your-phat-contract.md) to learn more before deploying to Phala Mainnet.\n\nNow that are Phat Contract has built successfully, let's deploy to Phala Mainnet with the following command:\n\n```shell\n# If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn upload --mode=production --coreSettings=https://api-v2.lens.dev/\n# If polkadot-account.json is in the root of project\nnpx @phala/fn upload --mode=production -a ./polkadot-account.json --coreSettings=https://api-v2.lens.dev/\n```\n\nHere is the expected output:\n\n> Note: your contract IDs will vary and not be the same as the IDs below.", "mimetype": "text/plain", "start_char_idx": 25098, "end_char_idx": 26912, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "3ed20fa7-ce9e-4f51-95eb-1f439b46e155": {"__data__": {"id_": "3ed20fa7-ce9e-4f51-95eb-1f439b46e155", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "489766c0-9f72-4846-8b73-65ddfd3b5c84", "node_type": "1", "metadata": {}, "hash": "1b4435a603040803f9f18aee04626c5c3c37dc8da06190b8476802bd843f700d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ae6a704c-e678-4945-898c-2afc2ff64f26", "node_type": "1", "metadata": {}, "hash": "7829e681b52830b1bdf26ea62aced9c6c62caf74d2ba706263cf30165b046962", "class_name": "RelatedNodeInfo"}}, "text": "```shell\nnpx @phala/fn upload --mode=production -a ./polkadot-account.json --coreSettings=https://api-v2.lens.dev/\n# ? Please enter your client RPC URL https://polygon.g.alchemy.com/v2/JLjOfWJycWFOA0kK_SJ4jLGjtXkMN1wc\n# ? Please enter your consumer address 0xA4Be456Fd0d41968a52b34Cdb8Ba875F2281134a\n# ? Please Enter hahaha account password [hidden]\n# Creating an optimized build... done\n# Compiled successfully.\n#\n#  17.64 KB  dist/index.js\n# Connecting to the endpoint: wss://api.phala.network/ws... done\n# Querying your Brick Profile contract ID... done\n# Your Brick Profile contract ID: 0x4071788a8ce6fbab0cacea0cb1aa52853b5537db7955643e5010c22913c2b1dd\n# Instantiating the ActionOffchainRollup contract... done\n# The ActionOffchainRollup contract has been instantiated: 0x9c777c16b0a185caa895835b8f3b9e8d67be9f5e30197f71b4d32d2b8fde4b3b\n# Setting up the actions... done\n# \ud83c\udf89 Your workflow has been added, you can check it out here: https://bricks-poc6.phala.network/workflows/0x4071788a8ce6fbab0cacea0cb1aa52853b5537db7955643e5010c22913c2b1dd/3\n# Your Attestor address: 0x2b5fe2920cce2f522d69613adaa9378ba43b687d\n# Your WORKFLOW_ID: 2\n# \u2728  Done in 73.22s.\n```\n\n### **Interact with Consumer Contract on Polygon Mainnet**\n\nExecute Scripts to Consumer Contract on Polygon Mainnet. The Consumer Contract on Polygon Mainnet with a few actions to mimic a malformed request, successful requests, and set the attestor.", "mimetype": "text/plain", "start_char_idx": 26914, "end_char_idx": 28328, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ae6a704c-e678-4945-898c-2afc2ff64f26": {"__data__": {"id_": "ae6a704c-e678-4945-898c-2afc2ff64f26", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "3ed20fa7-ce9e-4f51-95eb-1f439b46e155", "node_type": "1", "metadata": {}, "hash": "40995b1425da1ea83f4d29998d7f69f2ad093b96cd1bd8f99a479f981d7ca707", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "eee49905-628a-40c4-8635-792393872d2f", "node_type": "1", "metadata": {}, "hash": "d2ec4ac5af20ff2aacb240db35fa2b1c9c81bc7d29af45961b6a6dfe0c6fd058", "class_name": "RelatedNodeInfo"}}, "text": "```sh\nnpm run main-set-attestor\n# Setting attestor...\n# \ud83d\udea8NOTE\ud83d\udea8\n# Make sure to set the Consumer Contract Address in your Phat Bricks \ud83e\uddf1 UI dashboard (https://bricks-poc6.phala.network)\n# - Go to 'Configure Client' section where a text box reads 'Add Consumer Smart Contract'\n# - Set value to 0xbb0d733BDBe151dae3cEf8D7D63cBF74cCbf04C4\n# Done\n# \u2728  Done in 1.56s.\n# execute push-malformed-request\nnpm run main-push-malformed-request\n# Pushing a malformed request...\n# Done\n# execute push-request\nnpm run main-push-request\n# Pushing a request...\n# Done\n```\n\n### Update Phat Contract on Phala Mainnet <a href=\"#user-content-update-phat-contract-on-phala-mainnet\" id=\"user-content-update-phat-contract-on-phala-mainnet\"></a>\n\nSometimes you may have had a bug in your script or you want to test things out on the fly without deploying a whole new Phat Contract. We now allow you to update your Phat Contract easily in the command line. Now let's update the Phat Contract with the following command:\n\n```shell\n# If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn update --mode=production\n# If polkadot-account.json is in the root of project\nnpx @phala/fn update --mode=production -a ./polkadot-account.json\n```\n\n```shell\nnpx @phala/fn update --mode=production -a ./polkadot-account.json\n# ? Please Enter hahaha account password [hidden]\n# Creating an optimized build... done\n# Compiled successfully.", "mimetype": "text/plain", "start_char_idx": 28330, "end_char_idx": 29785, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "eee49905-628a-40c4-8635-792393872d2f": {"__data__": {"id_": "eee49905-628a-40c4-8635-792393872d2f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "030e9228-69b5-4088-852a-bc31e3cebb8f", "node_type": "4", "metadata": {}, "hash": "d6c52e6918e4efa036800710048b7298616e38c28a6a29a243ccf1a24c68e41f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ae6a704c-e678-4945-898c-2afc2ff64f26", "node_type": "1", "metadata": {}, "hash": "7829e681b52830b1bdf26ea62aced9c6c62caf74d2ba706263cf30165b046962", "class_name": "RelatedNodeInfo"}}, "text": "#\n#   17.64 KB  dist/index.js\n# Connecting to the endpoint: wss://api.phala.network/ws... done\n# Querying your Brick Profile contract ID... done\n# Your Brick Profile contract ID: 0x4071788a8ce6fbab0cacea0cb1aa52853b5537db7955643e5010c22913c2b1dd\n# Checking your workflow settings... done\n# Updating... done\n# The Phat Function for workflow 1 has been updated.\n# \u2728  Done in 10.82s.\n```\n\n:tada: Congrats! You've now successfully updated your Phat Contract!\n\n## Closing <a href=\"#user-content-closing\" id=\"user-content-closing\"></a>\n\nOnce you have stored, the deployed address of the Consumer Contract and set the value in the \"Configure Client\" section of the deployed Phala Oracle, you will now have a basic boilerplate example of how to connect your Polygon dApp to a LensAPI Oracle Blueprint. Execute a new requests and check if your configuration is correct like below:\n\n<figure><img src=\"https://github.com/Phala-Network/phat-contract-starter-kit/raw/main/assets/polygonscan-ex.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 29786, "end_char_idx": 30813, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "296369bb-bb42-4e8a-831e-77b5456293e0": {"__data__": {"id_": "296369bb-bb42-4e8a-831e-77b5456293e0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/installing-phala-mining-tools.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8731218c-3bf6-40b8-a1de-d97dcce7fc63", "node_type": "4", "metadata": {}, "hash": "32b4ad302017feea4b1370276bf6feb7277edd724fc5adc02d791277662bfc56", "class_name": "RelatedNodeInfo"}}, "text": "# Installing Khala Solo Scripts\n\n## Prerequisites <a href=\"#prerequisites\" id=\"prerequisites\"></a>\n\nBefore you go further, please ensure that your have correct setup your hardware, BIOS and operating system according to the previous section.\n\n## Download the Khala Scripts <a href=\"#download-the-phala-scripts\" id=\"download-the-phala-scripts\"></a>\n\nThe Khala Solo Scripts are available on our [Phala Mining Script](https://github.com/Phala-Network/solo-mining-scripts/) repository on GitHub, it can be downloaded with `wget` by executing the following commands in the terminal:\n\n```\nsudo apt update && sudo apt upgrade -y && sudo apt autoremove -y\nsudo apt install wget unzip\ncd ~\nwget https://github.com/Phala-Network/solo-mining-scripts/archive/refs/heads/main.zip\nunzip main.zip\n```\n\n## Activate the Intel\u00ae SGX Software <a href=\"#activate-the-intel-sgx-software\" id=\"activate-the-intel-sgx-software\"></a>\n\n> \u2139 You may have already enabled the Intel\u00ae SGX Extensions during your hardware setup in the [previous section](broken-reference). Skip and proceed to \ud83d\udc49[Install Phala Tools](installing-phala-mining-tools.md#install-phala-tools) if already activated.\n\nExecute the following commands in the terminal, the computer should reboot after execution.\n\n```\ncd ~/solo-mining-scripts-main/tools\nsudo ./sgx_enable\nsudo reboot\n```\n\n## Install Phala Tools\n\nExecute the following commands in your terminal:\n\n```\ncd ~/solo-mining-scripts-main\nsudo ./phala.sh install\n```\n\n> This will install the Phala CLI\n\n\\\n\ud83c\udf89 Congratulations! You have successfully installed the required Phala tools.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1578, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a223f9c0-9e8a-491b-ba07-aa8fac336435": {"__data__": {"id_": "a223f9c0-9e8a-491b-ba07-aa8fac336435", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "bf1b1077-9c6f-4743-a380-94d5fcfd75e5", "node_type": "1", "metadata": {}, "hash": "1bbc3da6dbdc8a1cd577ce0fbb2b34ad9847a9c262f2720e0493f166a6c7f499", "class_name": "RelatedNodeInfo"}}, "text": "# Swanky Phala CLI Tool\n\n> **Note:** Feedback and contributions are welcome. Please add issues for any features or bugs found. Join our [discord](https://discord.gg/phala-network) and jump in our `#dev` channel to speak with our devs.\n\n## Contract Build Requirements\n\nEnsure your rust toolchain requirements are installed correctly to ensure your contracts can be built correctly.\n\n| Rust Toolchain | Requirement                                 |\n| -------------- | ------------------------------------------- |\n| cargo          | <= `cargo 1.72.0`                           |\n| cargo-contract | <= `3.2.0-unknown-x86_64-unknown-linux-gnu` |\n| target         | `wasm32-unknown-unknown`                    |\n| component      | `rust-src`                                  |\n\n## Swanky Suite\n\n[Swanky Suite](https://docs.astar.network/docs/build/wasm/swanky-suite/) aims to be an \"all-in-one\" tool for Wasm smart contract developers. It is modeled on existing tools like `cargo contract CLI` and `polkadot.js`. The `swanky-cli` tool is built with the `oclif` (Open CLI Framework [repo](https://oclif.io/docs/introduction)).\n\nBuilding with `oclif` allows for the `swanky-cli` to be extended through the [plugin-plugin](https://github.com/oclif/plugin-plugins) feature. Now the `swanky-plugin-phala` plugin can be added to the `swanky-cli` (note: must install `swanky-cli`first) with the command `swanky plugins:link [PATH_TO_REPO]`. Specific installation instructions and examples will be displayed later, so do not worry about getting this set up now.\n\n## DevPHAse\n\n[DevPHAse](https://github.com/l00k/devphase) is a developer tool built and maintained by Phala community member 100k. DevPhase is a command line utility that enables a developer building Phat Contracts to:\n\n* Install binaries for phala-node, pherry and pruntime.\n* Install local testnet configuration files to allow for Phat Contracts to be deployed into a cluster with a systems contract to enable SideVM for logging.\n* Create testnet accounts.\n* Start the local testnet.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2035, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "bf1b1077-9c6f-4743-a380-94d5fcfd75e5": {"__data__": {"id_": "bf1b1077-9c6f-4743-a380-94d5fcfd75e5", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a223f9c0-9e8a-491b-ba07-aa8fac336435", "node_type": "1", "metadata": {}, "hash": "ef18232cbdc24edf7dc4ec634bf8ed1c9cc7dca5b16f5e626adbdfb3124a5017", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "45a32a1f-ec48-4b1d-b65c-278ad4b8ed7a", "node_type": "1", "metadata": {}, "hash": "ef33e9749a162fcacfaa65ec67f62adec4bdee95650d8723811899f2a14d9a8d", "class_name": "RelatedNodeInfo"}}, "text": "* Configure the local testnet by:\n  * Registering Workers and their endpoints\n  * Register Gatekeeper\n  * Upload systems contract code\n  * Deploy a Cluster with the `su` account (Default: Alice)\n  * Deploy driver contract code\n    * Phat Contract Tokenomics\n    * SideVm Deployer\n  * Authorize Logger SideVM Contract\n  * Upload SideVM Logger to cluster and Deploy SideVM Logger\n* Compile Phat contracts into a `.wasm`, `metadata.json` and `.contract` file(combines the `.wasm` and `metadata.json` file into one `.contract` file).\n* Upload and Instantiate a compiled Phat Contract to a cluster on the local testnet.\n* Call (queries and transactions) instantiated Phat Contracts directly.\n* Check local dev environment setup.\n\n## Getting Started\n\n### Installation\n\n> _Currently `swanky phala` will only support Ubuntu Linux. Other Linux operating systems are support, but this requires downloading and compiling `phala-node`, `pherry` and `pruntime` binaries locally. Then copy the binaries to the `stacks/` folder._\n\n#### Install Swanky CLI\n\nFollow the instructions from Astar Network wiki [here](https://docs.astar.network/docs/build/wasm/swanky-suite/cli/#installing).\n\n#### Install Swanky Phala Plugin\n\n**npm**\n\n```bash\nnpm install @phala/swanky-plugin-phala\n```\n\nor\n\n```bash\nnpx @phala/swanky-plugin-phala\n```\n\n**locally**\n\nClone the `swanky-plugin-phala` GitHub repository.", "mimetype": "text/plain", "start_char_idx": 2036, "end_char_idx": 3413, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "45a32a1f-ec48-4b1d-b65c-278ad4b8ed7a": {"__data__": {"id_": "45a32a1f-ec48-4b1d-b65c-278ad4b8ed7a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "bf1b1077-9c6f-4743-a380-94d5fcfd75e5", "node_type": "1", "metadata": {}, "hash": "1bbc3da6dbdc8a1cd577ce0fbb2b34ad9847a9c262f2720e0493f166a6c7f499", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "8e04e776-5e73-4854-8658-030c16172ca9", "node_type": "1", "metadata": {}, "hash": "be76bd650bfde980bc2d7c9c5501329b49b7c842b4c2f344851b45f8d25f5929", "class_name": "RelatedNodeInfo"}}, "text": "```bash\ngit clone git@github.com:Phala-Network/swanky-plugin-phala.git\ncd swanky-plugin-phala\nyarn install\nyarn build\n```\n\n#### Add `swanky-plugin-phala` to `swanky` CLI\n\nUse `plugins:install` for **npm**\n\n```bash\nswanky plugins:install @phala/swanky-plugin-phala\n```\n\nor **GitHub URL**\n\n```bash\nswanky plugins:install https://github.com/Phala-Network/swanky-plugin-phala.git\n```\n\nIf installed and built **locally** then use `plugins:link` to link `swanky` to the local path to `swanky-plugin-phala`\n\n```bash\nswanky plugins:link [PATH_TO_REPO]\n```\n\nexample:\n\n```bash\nswanky plugins:link ~/Projects/swanky-plugin-phala\n\n@astar-network/swanky-cli: linking plugin @phala/swanky-plugin-phala... done\n```\n\n### Commands\n\nNow there should be a `swanky phala` CLI available. Execute the `swanky phala --help` command to check available commands.\n\n```bash\nswanky phala --help\n```\n\nExpected output:\n\n```bash\nSwanky plugin to setup Phala developer environment for Phat Contracts.\n\nUSAGE\n  $ swanky phala COMMAND\n\nTOPICS\n  phala account   Create or list accounts.\n  phala contract  Create, compile, deploy, test or call Phat Contracts.\n  phala node      Download binaries to start local testnet and configure for Phat Contract development.\n\nCOMMANDS\n  phala check  Not Available\n  phala init   Generate a new Phat Contract environment\n```\n\n### Initialize a Project\n\nEasily get started with a new Phat Contract project by executing `swanky phala init [PROJECT_NAME]`\n\n```bash\nswanky phala init test-swanky-phala\n```\n\nThis will initiate a round of questions to get your Phat Contract template configured. First question will ask:\n\n```bash\n? Which contract language should we use? (Use arrow keys)\n\u276f pink\n```\n\nAt this moment, `pink` is the only contract language option at this time. `pink` is the Phala `ink` library to support rust-based [ink!", "mimetype": "text/plain", "start_char_idx": 3415, "end_char_idx": 5245, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8e04e776-5e73-4854-8658-030c16172ca9": {"__data__": {"id_": "8e04e776-5e73-4854-8658-030c16172ca9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "45a32a1f-ec48-4b1d-b65c-278ad4b8ed7a", "node_type": "1", "metadata": {}, "hash": "ef33e9749a162fcacfaa65ec67f62adec4bdee95650d8723811899f2a14d9a8d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f51ae8ab-c1f7-4bec-89be-b64c646271f0", "node_type": "1", "metadata": {}, "hash": "e700f135905195480f977140025cb18cf1e6f979f00647f2cdccb626a44fae45", "class_name": "RelatedNodeInfo"}}, "text": "language](https://paritytech.github.io/ink/) in Phala\u2019s `pRuntime` workers.\n\nNext you\u2019ll be asked the what contract template to use (`blank`, `http_client`, or `phat_hello` more to come!).\n\n```bash\n? Which contract template should we use? (Use arrow keys)\n  blank \n\u276f http_client \n  phat_hello\n```\n\nNow that you have a Phat Contract language and template picked, you will be asked to create a name for the PC. (_**default is the template name**_)\n\n```bash\n? What should we name your contract? (http_client)\n```\n\nAfter you select a name, you\u2019ll be asked for your `git` username (default is `git config --get user.name`) and email.\n\n```bash\n? What is your name? (HashWarlock)\n? What is your email?\n```\n\nAn expected final output will display when the template files and project directory is created.\n\n```bash\n? Which contract language should we use? pink\n? Which contract template should we use? phat_hello\n? What should we name your contract? phat_hello\n? What is your name? hashwarlock\n? What is your email? \n\u2714 Checking dependencies OK\nInitializing\n\u2714 Copying template files OK\n\u2714 Processing templates OK\n\u2714 Initializing git OK\n\u2714 Installing dependencies OK\n\u280b Copying devphase config files[Initializer] Creating directories\n[Initializer] Creating files\n[Initializer] devphase.config.ts\n[Initializer] accounts.json\n[Initializer] scripts\n[Initializer] Creating sample contract\n[ContractManager] Contract created in:\n[ContractManager] /home/hashwarlock/Projects/Phala/Swanky/demo/swanky-plugin-phala/test-swanky-phala/contracts/flipper\n\u2714 Copying devphase config files OK\n\u280b Installing phala node, pruntime and pherry binaries[StackBinaryDownloader] Preparing Phala stack release\n[StackBinaryDownloader] Creating stack directory\n  \u2714 Checking releases directory\n  \u2714 Checking target release binaries\n\u2714 Installing phala node, pruntime and pherry binaries OK\n\ud83d\ude0e Phat Contract project successfully initialised! \ud83d\ude0e\n```\n\nExecute `ls` to list the new project directory called `test-swanky-phala` in the current working directory.", "mimetype": "text/plain", "start_char_idx": 5246, "end_char_idx": 7254, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f51ae8ab-c1f7-4bec-89be-b64c646271f0": {"__data__": {"id_": "f51ae8ab-c1f7-4bec-89be-b64c646271f0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "8e04e776-5e73-4854-8658-030c16172ca9", "node_type": "1", "metadata": {}, "hash": "be76bd650bfde980bc2d7c9c5501329b49b7c842b4c2f344851b45f8d25f5929", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "2f2a8c68-ccc5-4f17-b99f-7c37e37d4888", "node_type": "1", "metadata": {}, "hash": "2936b2d55907a640f84bda61728e6a2a9ad1b515e9ce7bfbefd0e2e30756d1c1", "class_name": "RelatedNodeInfo"}}, "text": "```bash\nls\n```\n\nExpected output:\n\n```bash\ntotal 0\ndrwxr-xr-x   3 hashwarlock  staff    96B Jan 19 20:45 .\ndrwxr-xr-x   5 hashwarlock  staff   160B Jan 19 18:37 ..\ndrwxr-xr-x  15 hashwarlock  staff   480B Jan 19 20:46 test-swanky-phala\n```\n\n`cd` into `test-swanky-phala` and execute `ls`.\n\n```bash\ncd test-swanky-phala\nls\n```\n\nExpected output:\n\n```bash\ntotal 152\ndrwxr-xr-x. 1 hashwarlock hashwarlock    254 Apr  4 16:27 .\ndrwxr-xr-x. 1 hashwarlock hashwarlock    468 Apr  4 16:27 ..\n-rw-r--r--. 1 hashwarlock hashwarlock    143 Apr  4 16:27 accounts.json\ndrwxr-xr-x. 1 hashwarlock hashwarlock     34 Apr  4 16:27 contracts\ndrwxr-xr-x. 1 hashwarlock hashwarlock     26 Apr  4 16:27 .devphase\n-rw-r--r--. 1 hashwarlock hashwarlock   4582 Apr  4 16:27 devphase.config.json\ndrwxr-xr-x. 1 hashwarlock hashwarlock     98 Apr  4 16:26 .git\n-rw-r--r--. 1 hashwarlock hashwarlock   3595 Apr  4 16:26 .gitignore\ndrwxr-xr-x. 1 hashwarlock hashwarlock   6116 Apr  4 16:27 node_modules\n-rw-r--r--. 1 hashwarlock hashwarlock    255 Apr  4 16:26 package.json\ndrwxr-xr-x. 1 hashwarlock hashwarlock     18 Apr  4 16:27 scripts\ndrwxr-xr-x. 1 hashwarlock hashwarlock     36 Apr  4 16:27 stacks\ndrwxr-xr-x.", "mimetype": "text/plain", "start_char_idx": 7256, "end_char_idx": 8442, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "2f2a8c68-ccc5-4f17-b99f-7c37e37d4888": {"__data__": {"id_": "2f2a8c68-ccc5-4f17-b99f-7c37e37d4888", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f51ae8ab-c1f7-4bec-89be-b64c646271f0", "node_type": "1", "metadata": {}, "hash": "e700f135905195480f977140025cb18cf1e6f979f00647f2cdccb626a44fae45", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f6531208-fa4d-43fe-9855-11c98628dbfc", "node_type": "1", "metadata": {}, "hash": "9e912cf7c60dee4d0ca0173da5a3099284bdd7762fd6472890aaaa0e8d3a46ac", "class_name": "RelatedNodeInfo"}}, "text": "1 hashwarlock hashwarlock     20 Apr  4 16:26 tests\n-rw-r--r--. 1 hashwarlock hashwarlock    520 Apr  4 16:26 tsconfig.json\n-rw-r--r--. 1 hashwarlock hashwarlock 130190 Apr  4 16:27 yarn.lock\n```\n\nHere is an example of how the directory structure looks like:\n\n```bash\nls stacks/nightly*\n```\n\nExpected output:\n\n```bash\ntotal 116256\ndrwxr-xr-x. 1 hashwarlock hashwarlock      272 Apr  4 16:27 .\ndrwxr-xr-x. 1 hashwarlock hashwarlock       36 Apr  4 16:27 ..\n-rw-r--r--. 1 hashwarlock hashwarlock  6411768 Apr  4 16:27 libpink.so.1.0\n-rw-r--r--. 1 hashwarlock hashwarlock    59475 Apr  4 16:27 log_server.contract\n-rw-r--r--. 1 hashwarlock hashwarlock  2278251 Apr  4 16:27 log_server.sidevm.wasm\n-rwxr-xr-x. 1 hashwarlock hashwarlock 68365760 Apr  4 16:27 phala-node\n-rwxr-xr-x. 1 hashwarlock hashwarlock 14814056 Apr  4 16:27 pherry\n-rwxr-xr-x. 1 hashwarlock hashwarlock 26937712 Apr  4 16:27 pruntime\n-rw-r--r--. 1 hashwarlock hashwarlock    41568 Apr  4 16:27 sidevm_deployer.contract\n-rw-r--r--. 1 hashwarlock hashwarlock    79326 Apr  4 16:27 system.contract\n-rw-r--r--.", "mimetype": "text/plain", "start_char_idx": 8443, "end_char_idx": 9516, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f6531208-fa4d-43fe-9855-11c98628dbfc": {"__data__": {"id_": "f6531208-fa4d-43fe-9855-11c98628dbfc", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "2f2a8c68-ccc5-4f17-b99f-7c37e37d4888", "node_type": "1", "metadata": {}, "hash": "2936b2d55907a640f84bda61728e6a2a9ad1b515e9ce7bfbefd0e2e30756d1c1", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5053e5cf-d83b-498b-9636-a0da1b73ea3b", "node_type": "1", "metadata": {}, "hash": "279b5a79e8570cbec498c8e45495df1c96284004a058440a8437a256238bdb23", "class_name": "RelatedNodeInfo"}}, "text": "1 hashwarlock hashwarlock    39543 Apr  4 16:27 tokenomic.contract\n```\n\n### Start a Phala Local Testnet\n\n`swanky phala node start` will check if the following exists in the current directory or up:\n\n* `devphase.config.json`\n* `stack/`\n  * `phala-node`\n  * `pruntime`\n  * `pherry`\n\nOnce verified file are downloaded and there is not an instance running currently, the local testnet will start.\n\n```bash\nswanky phala node start\n```\n\nExpected output:\n\n```bash\nStarting local tesnet stack\n[StackBinaryDownloader] Preparing Phala stack release\n  \u2714 Checking releases directory\n  \u2714 Checking target release binaries\n[StackManager] Starting stack\n  \u2714 Start node component\n  \u2714 Start pRuntime component\n  \u2714 Start pherry component\n```\n\n### Configure the Running Local Testnet for Phat Contract Deployment\n\nA Phala local testnet needs the following for Phat Contracts to be deployed and instantiated to a cluster:\n\n* Register the Workers and setup their endpoints;\n* Register the Gatekeepers;\n* Create Cluster `0x01` with`Alice`as the owner and the System contract above;\n* Register two Drivers to the System contract\n  * the log server printing all the Phat contracts' log;\n  * the SideVM deployer controlling which contracts can start the SideVM;\n\nThis is accomplished by executing `swanky phala node setup`.", "mimetype": "text/plain", "start_char_idx": 9517, "end_char_idx": 10814, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5053e5cf-d83b-498b-9636-a0da1b73ea3b": {"__data__": {"id_": "5053e5cf-d83b-498b-9636-a0da1b73ea3b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f6531208-fa4d-43fe-9855-11c98628dbfc", "node_type": "1", "metadata": {}, "hash": "9e912cf7c60dee4d0ca0173da5a3099284bdd7762fd6472890aaaa0e8d3a46ac", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ab3097db-7c26-4895-be56-a4831e6a9d02", "node_type": "1", "metadata": {}, "hash": "22cd490f7f25cef63b571e4b1cdd7b0514ede6adfb3c739cc8974edb48509f96", "class_name": "RelatedNodeInfo"}}, "text": "```bash\nswanky phala node setup\n```\n\nExpected output:\n\n```bash\nSetting up Phala local testnet stack\n\u280b Setting up local testnet stack[StackSetupService] Starting stack setup with default version\n  \u2714 Fetch worker info\n  \u2714 Load system contracts\n  \u2193 Register worker [skipped]\n  \u2193 Register gatekeeper [skipped]\n  \u2193 Upload Pink system code [skipped]\n  \u2714 Verify cluster\n  \u2193 Create cluster [skipped]\n  \u2714 Wait for cluster to be ready\n  \u2714 Create system contract API\n  \u2714 Deploy tokenomic driver\n  \u2714 Deploy SideVM driver\n  \u2714 Calculate logger server contract ID\n  \u2714 Prepare chain for logger server\n  \u2714 Deploy logger server\nStack is ready\nCluster Id\n0x0000000000000000000000000000000000000000000000000000000000000001\n\u2714 Setting up local testnet stack OK\n\u2714 Cleanup OK\n\ud83d\ude0e Phala local testnet configured successfully! \ud83d\ude0e\n```\n\n### Compile Your Contract\n\nWe have accomplished the following:\n\n* Created a project directory with a configured template Phat Contract.\n* Downloaded Phala binaries, drivers, system contracts and sideVM programs.\n* Started and set up a local testnet to start deploying Phat Contracts to a worker node in the deployed `0x01` cluster.\n\nLet\u2019s begin the process of deploying the Phat Contract, but first the PC must be compiled to get the `contract.wasm`, `metadata.json` and `contract.contract` files that will be used to upload and instantiate the PC to the local testnet cluster.\n\n> **Note:** Follow these [installation steps](https://wiki.phala.network/en-us/build/stateless/setup/) before continuing to ensure you can compile your Phat Contract.", "mimetype": "text/plain", "start_char_idx": 10816, "end_char_idx": 12367, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ab3097db-7c26-4895-be56-a4831e6a9d02": {"__data__": {"id_": "ab3097db-7c26-4895-be56-a4831e6a9d02", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5053e5cf-d83b-498b-9636-a0da1b73ea3b", "node_type": "1", "metadata": {}, "hash": "279b5a79e8570cbec498c8e45495df1c96284004a058440a8437a256238bdb23", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "27a66b91-f02a-488d-8f0b-b26b1db768f6", "node_type": "1", "metadata": {}, "hash": "a8a1ce0071322d4f2a721f78b31e755dd60c99da8f1dc60ce0ba6bc704abe46d", "class_name": "RelatedNodeInfo"}}, "text": "We can compile the PC with `swanky phala contract compile -c [CONTRACT_NAME]` and will look like the follow:\n\n```bash\nswanky phala contract compile -c phat_hello\n```\n\nExpected output:\n\n```bash\nCompile contract(s)\n\u280b Compiling Phat Contract phat_hello[MultiContractExecutor] Criteria: phat_hello\n[MultiContractExecutor] Matched contracts:\n[MultiContractExecutor] phat_hello\n[MultiContractExecutor] \n  \u276f phat_hello\n  \u2714 phat_hello\n\u2714 Compiling Phat Contract phat_hello OK\n\ud83d\ude0e Phat Contract compiled successfully! \ud83d\ude0e\n```\n\n### Generate Types for Contract\n\nIf you have compiled your contract already, the types will be auto-generated at the end of a successful compilation. In the case that the types were not generated for the contract, execute the `swanky phala contract typegen [CONTRACT_NAME]`.\n\nAn example of the output will create `typings/` folder with a TypeScript file of the contract's generated types.\n\n```bash\nswanky phala contract typegen phat_hello\n```\n\nExpected output:\n\n```bash\nCreate type bindings for contracts\n\u280b Creating type bindings for Phat Contract phat_hello[TypeBinder] Generating type bindings for: phat_hello\n\u2714 Creating type bindings for Phat Contract phat_hello OK\n\ud83d\ude0e Phat Contract types generated successfully! \ud83d\ude0e\n```\n\n### Validate Your Compiled WASM Contract\n\nSometimes there are difficult to find errors that lie within a succesfully compiled wasm blob. The command `swanky phala contract validate -c [CONTRACT_NAME]` will do a preliminary check to verify if the compiled contract is valid for deployment.\n\n```bash\nswanky phala contract validate -c phat_hello\n```\n\nExpected output:\n\n```\nValidating compiled WASM of phat_hello contract...\nphat_hello.wasm validated successfully!\n\ud83d\ude0e Phat Contract validated successfully!", "mimetype": "text/plain", "start_char_idx": 12369, "end_char_idx": 14104, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "27a66b91-f02a-488d-8f0b-b26b1db768f6": {"__data__": {"id_": "27a66b91-f02a-488d-8f0b-b26b1db768f6", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ab3097db-7c26-4895-be56-a4831e6a9d02", "node_type": "1", "metadata": {}, "hash": "22cd490f7f25cef63b571e4b1cdd7b0514ede6adfb3c739cc8974edb48509f96", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "cffdbfc1-c554-4da5-99c5-c4afff5499b5", "node_type": "1", "metadata": {}, "hash": "19c6c5ff7bc200ce2f36297f99e77dec15152588338af7c20281c847c3a05330", "class_name": "RelatedNodeInfo"}}, "text": "\ud83d\ude0e\n```\n\n### Deploy and Instantiate Contract\n\n```bash\nswanky phala contract deploy --help\n```\n\nExpected output:\n\n```bash\nDeploy contract\n\nUSAGE\n  $ swanky phala contract deploy -c <value> -o <value> [-t InkCode|SidevmCode|IndeterministicInkCode] [-n <value>] [-l <value>] [-a <value>] [-p <value>]\n\nFLAGS\n  -a, --account=<value>      [default: alice] Account used to deploy (managed account key)\n  -c, --contract=<value>     (required) Contract name\n  -l, --cluster=<value>      Target cluster Id\n  -n, --network=<value>      [default: local] Target network to deploy (local default)\n  -o, --constructor=<value>  (required) Contract constructor to call (name)\n  -p, --params=<value>...    [default: ] Arguments supplied to the message\n  -t, --type=<option>        [default: InkCode]\n                             <options: InkCode|SidevmCode|IndeterministicInkCode>\n\nDESCRIPTION\n  Deploy contract\n\nEXAMPLES\n  $ swanky phala contract deploy -c [CONTRACT_NAME] -t [CONTRACT_TYPE] -o [CONSTRUCTOR] -n [NETWORK] -l [CLUSTER_ID] -a [ACCOUNT] -p [..Args]\n```\n\nLet's deploy the `phat_hello` contract to the local testnet in cluster `0x0000000000000000000000000000000000000000000000000000000000000001`. Note if there is no account defined then `alice` will deploy the Phat Contract by default.", "mimetype": "text/plain", "start_char_idx": 14105, "end_char_idx": 15387, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "cffdbfc1-c554-4da5-99c5-c4afff5499b5": {"__data__": {"id_": "cffdbfc1-c554-4da5-99c5-c4afff5499b5", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "27a66b91-f02a-488d-8f0b-b26b1db768f6", "node_type": "1", "metadata": {}, "hash": "a8a1ce0071322d4f2a721f78b31e755dd60c99da8f1dc60ce0ba6bc704abe46d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "4dc8065b-6df4-4508-b07d-ad4cbdf05e2b", "node_type": "1", "metadata": {}, "hash": "144a66c4c05dd98eb0ec521601bec3fbf5c1383846942a8199406a41010c5847", "class_name": "RelatedNodeInfo"}}, "text": "```bash\nswanky phala contract deploy -c phat_hello -o new -l 0x0000000000000000000000000000000000000000000000000000000000000001\n```\n\nExpected output:\n\n```bash\nDeploy contract\n\u2827 Deploying contract phat_helloContract deployed\nContract Id: 0x2e11166f9a623f7536434b5f4456b2311d3bb06717dd91a376380a61b8f9b0a8\nCluster Id:  0x0000000000000000000000000000000000000000000000000000000000000001\n\u2714 Deploying contract phat_hello OK\n\ud83d\ude0e Phat Contract deployed successfully! \ud83d\ude0e\n```\n\n### Interact with Deployed Contract\n\nThere are 2 ways to interact with a contract.\n\n* **Query**: if flag `-r` is not defined then `query` is default contract call.\n* **Transaction**: must define `-r` with the value `tx` to ensure the call is a transaction.", "mimetype": "text/plain", "start_char_idx": 15389, "end_char_idx": 16110, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4dc8065b-6df4-4508-b07d-ad4cbdf05e2b": {"__data__": {"id_": "4dc8065b-6df4-4508-b07d-ad4cbdf05e2b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "cffdbfc1-c554-4da5-99c5-c4afff5499b5", "node_type": "1", "metadata": {}, "hash": "19c6c5ff7bc200ce2f36297f99e77dec15152588338af7c20281c847c3a05330", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "95801549-91d2-491c-b2d2-fdc5e36c2dfd", "node_type": "1", "metadata": {}, "hash": "41234bcac8b1190e96ca1c5699bd7eb722dcf70879d82d65e3773a1258258977", "class_name": "RelatedNodeInfo"}}, "text": "```bash\nswanky phala contract call --help\n```\n\nExpected output:\n\n```bash\nCall a Phat Contract\n\nUSAGE\n  $ swanky phala contract call -c <value> -i <value> -m <value> [-t InkCode|SidevmCode|IndeterministicInkCode] [-r query|tx] [-n <value>] [-l <value>] [-a <value>] [-p <value>]\n\nFLAGS\n  -a, --account=<value>    [default: alice] Account used to call (managed account key)\n  -c, --contract=<value>   (required) Contract name\n  -i, --id=<value>         (required) Contract ID\n  -l, --cluster=<value>    Target cluster Id\n  -m, --method=<value>     (required) Contract method to call (name)\n  -n, --network=<value>    [default: local] Target network to deploy (local default)\n  -p, --params=<value>...  [default: ] Arguments supplied to the message\n  -r, --request=<option>   [default: query] Request type: transaction or query\n                           <options: query|tx>\n  -t, --type=<option>      [default: InkCode]\n                           <options: InkCode|SidevmCode|IndeterministicInkCode>\n\nDESCRIPTION\n  Call a Phat Contract\n\nEXAMPLES\n  $ swanky phala contract call -c [CONTRACT_NAME] -t [CONTRACT_TYPE] -i [CONTRACT_ID] -r [REQUEST_TYPE] -m [METHOD] -n [NETWORK] -l [CLUSTER_ID] -a [ACCOUNT] -p [..ARGS]\n```\n\nNow we can interact with our deployed contract by taking the `Contract Id: 0x2e11166f9a623f7536434b5f4456b2311d3bb06717dd91a376380a61b8f9b0a8` returned from deploying `phat_hello` successfully. There is a function called `get_eth_balance` that takes a hex string of the account address. This is how the composed call would look like.", "mimetype": "text/plain", "start_char_idx": 16112, "end_char_idx": 17664, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "95801549-91d2-491c-b2d2-fdc5e36c2dfd": {"__data__": {"id_": "95801549-91d2-491c-b2d2-fdc5e36c2dfd", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "4dc8065b-6df4-4508-b07d-ad4cbdf05e2b", "node_type": "1", "metadata": {}, "hash": "144a66c4c05dd98eb0ec521601bec3fbf5c1383846942a8199406a41010c5847", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "d29b916b-c20a-4e66-b6cf-d346de5fb9ee", "node_type": "1", "metadata": {}, "hash": "27f2b9b64b8fea03f086638f4493ec55f1e73ab850b861911ab5bd51d0682f91", "class_name": "RelatedNodeInfo"}}, "text": "> **Note:**&#x20;\n>\n> ETH address has to be converted to the Hex representation `0x307844306645333136423966303141336235666436373930463838433244353337333946383042343634` of the account opposed to using the Account ID `0xD0fE316B9f01A3b5fd6790F88C2D53739F80B464`. This can be retrieved through the `@polkadot/util` method `stringToHex(0xD0fE316B9f01A3b5fd6790F88C2D53739F80B464)`. Check the phat\\_hello.test.ts for the example.\n\n```bash\nswanky phala contract call -c phat_hello -l 0x0000000000000000000000000000000000000000000000000000000000000001 -i 0x2e11166f9a623f7536434b5f4456b2311d3bb06717dd91a376380a61b8f9b0a8 -m getEthBalance -p 0x307844306645333136423966303141336235666436373930463838433244353337333946383042343634\n```\n\nExpected output:\n\n```bash\nExecuting call to Phat Contract\nCall result:\n{\n  output: { ok: { ok: '20950198739626844' } },\n  debugMessage: '',\n  result: {\n    ok: { flags: [], data: '0x0000443230393530313938373339363236383434' }\n  },\n  gasConsumed: { refTime: 1342177279, proofSize: 0 },\n  gasRequired: { refTime: 65766686719, proofSize: 0 },\n  storageDeposit: { charge: 2047 }\n}\n```\n\n### Create a New Contract\n\nTo add a new contract there is the `swanky phala contract new [CONTRACT_NAME]` command. This can be done at the root of your new project folder and would look like the following.\n\n```bash\nswanky phala contract new new_contract\n```\n\nExpected output:\n\n```bash\nCreating new Phat Contract\n? Which contract language should we use? pink\n?", "mimetype": "text/plain", "start_char_idx": 17666, "end_char_idx": 19135, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d29b916b-c20a-4e66-b6cf-d346de5fb9ee": {"__data__": {"id_": "d29b916b-c20a-4e66-b6cf-d346de5fb9ee", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "95801549-91d2-491c-b2d2-fdc5e36c2dfd", "node_type": "1", "metadata": {}, "hash": "41234bcac8b1190e96ca1c5699bd7eb722dcf70879d82d65e3773a1258258977", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ac30b6de-450e-49a1-a792-af3100e4e4be", "node_type": "1", "metadata": {}, "hash": "2792c3193705df7703b3566d6a5ba8856700d741af95a09ed4a931b3ed68b211", "class_name": "RelatedNodeInfo"}}, "text": "Which contract template should we use? flipper\n? What should we name your contract? new_contract\n? What is your name? hashwarlock\n? What is your email? \n\u2714 Checking dependencies OK\nInitializing\n\u2714 Copying template files OK\n\u2714 Processing templates OK\n\ud83d\ude0e Successfully created new Phat Contract! \ud83d\ude0e\n\u2514\u2500[$]> ls contracts\ntotal 0\ndrwxr-xr-x. 1 hashwarlock hashwarlock  58 Apr  4 17:16 .\ndrwxr-xr-x. 1 hashwarlock hashwarlock 362 Apr  4 17:16 ..\ndrwxr-xr-x. 1 hashwarlock hashwarlock  26 Apr  4 17:16 new_contract\ndrwxr-xr-x. 1 hashwarlock hashwarlock  58 Apr  4 16:45 phat_hello\n```\n\n### Create/List Accounts\n\nThere is a basic dev account generation that can be protected by a configured password if desired. By default, the list of accounts can be seen with `swanky phala account list`.", "mimetype": "text/plain", "start_char_idx": 19136, "end_char_idx": 19912, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ac30b6de-450e-49a1-a792-af3100e4e4be": {"__data__": {"id_": "ac30b6de-450e-49a1-a792-af3100e4e4be", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d29b916b-c20a-4e66-b6cf-d346de5fb9ee", "node_type": "1", "metadata": {}, "hash": "27f2b9b64b8fea03f086638f4493ec55f1e73ab850b861911ab5bd51d0682f91", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "45aa3e85-42e5-4888-9be5-bf888c700da1", "node_type": "1", "metadata": {}, "hash": "c1b2a595da77fbae69cfb8f52b34f4ab9ceab97c4d539b97016af43d3ef925a4", "class_name": "RelatedNodeInfo"}}, "text": "```bash\nswanky phala account list\n```\n\nExpected output:\n\n```bash\n\u2714 Stored dev accounts:\n Alias   Address                                          Protected \n \u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \n alice   45R2pfjQUW2s9PQRHU48HQKLKHVMaDja7N3wpBtmF28UYDs2 false     \n bob     43qsYbZGLn2xzNuurY6BY4QNDSUU7gLEcXuckpm6B3DEmEx9 false     \n charlie 43tXcmhJfmvbczKaPKgWXirf3a9r6zD63KAxHq4CTSPm4DRf false     \n dave    41iFgxEGsnyGv5Abdo6Uq6n6BjoLS3p1UMKv9GvwMVuY5er7 false     \n eve     45ppQG9QcAkUdh2AP25CxDAnBAK1EACefQA2rMtbApzu6UXa false     \n ferdie  41GUHy9gmjhst2edhhoWCZcf6rqCheD5XMGTUF53CWJTePuc false  \n```\n\nCreating a new account is simple and can be done with `swanky phala account create -a [ALIAS]`.\n\n```bash\nswanky phala account create -a hash\n```\n\nExpected output:\n\n```bash\n? Account passphrase (leave empty if to save as plain text)\nAccount created\n\n Alias Address                                          Islocked \n \u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \n hash  41b5ANRroHu44tKDoF3rtJnHFtdQnyTt72uXhad1vhja2oNQ          \n\ud83d\ude0e Account created successfully!", "mimetype": "text/plain", "start_char_idx": 19914, "end_char_idx": 21034, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "45aa3e85-42e5-4888-9be5-bf888c700da1": {"__data__": {"id_": "45aa3e85-42e5-4888-9be5-bf888c700da1", "embedding": null, "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc480f60-aa20-422f-95d1-50126b6c2a34", "node_type": "4", "metadata": {}, "hash": "c12ab28f6fa09dd854e5281550b12cabd4fe43f0a6d6c5719ce07eb8efff7595", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ac30b6de-450e-49a1-a792-af3100e4e4be", "node_type": "1", "metadata": {}, "hash": "2792c3193705df7703b3566d6a5ba8856700d741af95a09ed4a931b3ed68b211", "class_name": "RelatedNodeInfo"}}, "text": "\ud83d\ude0e\n\u2514\u2500[$]> swanky phala account list\n\u2714 Stored dev accounts:\n Alias   Address                                          Protected \n \u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \n alice   45R2pfjQUW2s9PQRHU48HQKLKHVMaDja7N3wpBtmF28UYDs2 false     \n bob     43qsYbZGLn2xzNuurY6BY4QNDSUU7gLEcXuckpm6B3DEmEx9 false     \n charlie 43tXcmhJfmvbczKaPKgWXirf3a9r6zD63KAxHq4CTSPm4DRf false     \n dave    41iFgxEGsnyGv5Abdo6Uq6n6BjoLS3p1UMKv9GvwMVuY5er7 false     \n eve     45ppQG9QcAkUdh2AP25CxDAnBAK1EACefQA2rMtbApzu6UXa false     \n ferdie  41GUHy9gmjhst2edhhoWCZcf6rqCheD5XMGTUF53CWJTePuc false     \n hash    41b5ANRroHu44tKDoF3rtJnHFtdQnyTt72uXhad1vhja2oNQ false \n```", "mimetype": "text/plain", "start_char_idx": 21035, "end_char_idx": 21713, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a40e26c4-7d5c-4f4a-b480-6722e7220980": {"__data__": {"id_": "a40e26c4-7d5c-4f4a-b480-6722e7220980", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-langchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "129cdf80-ca1b-48f6-83bc-088bede33a02", "node_type": "4", "metadata": {}, "hash": "73bb1982411e25e4d845b3614146731179c5a153abd0de2131747e1dc9b9709f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "27515e30-e5e7-4bc3-9450-de5b7e6e445c", "node_type": "1", "metadata": {}, "hash": "add8d95ed30d369caa63a34e03568149b31e3eb0c48bb3d63032a5933fbb7e30", "class_name": "RelatedNodeInfo"}}, "text": "---\ndescription: Host your AI Agent Contract on Phala's decentralized serverless cloud.\n---\n\n# Build Your AI Agent Contract with LangChain\n\n## [AI Agent Contract Template with LangChain](https://github.com/Phala-Network/ai-agent-template-langchain)\n\n### Architecture Overview\n\n<figure><img src=\"../../.gitbook/assets/Screenshot 2024-04-04 at 11.02.11.png\" alt=\"\"><figcaption></figcaption></figure>\n\n## \ud83e\udd16 What Is This?!\n\n***\n\n<div align=\"center\">\n\n<img src=\"https://www.jlwranglerforums.com/forum/attachments/zoolander-gif.325299/\" alt=\"\" height=\"240\">\n\n</div>\n\nThe LangChain AI Agent template is a **MINIMAL** template to build an AI Agent that can be hosted on Phala Network's decentralized hosting protocol. Unlike Vercel or other FaaS, it allows you to publish your AI Agent compiled code to IPFS and hosts it on a fully decentralized FaaS cloud with the following benefits:\n\n* \ud83d\udca8 **Ship Fast**: Build and ship with familiar toolchain in minutes\n* \u26d1\ufe0f **Secure**: Execution guarded by rock solid TEE / Intel SGX\n* \ud83d\udd12 **Private**: Host API keys and user privacy at ease\n* \ud83d\udc8e **Unstoppable**: Powered by IPFS and Phala's 35k+ decentralized TEE workers\n\n## Getting Started\n\n{% hint style=\"info\" %}\nFor this template to work, you will need to signup for a developer account on OpenAI and get and [OpenAI API Key](https://platform.openai.com/account/api-keys).\n{% endhint %}\n\n### Prepare\n\nClone git repo or use [degit](https://www.npmjs.com/package/degit) to get the source code.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1473, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "27515e30-e5e7-4bc3-9450-de5b7e6e445c": {"__data__": {"id_": "27515e30-e5e7-4bc3-9450-de5b7e6e445c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-langchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "129cdf80-ca1b-48f6-83bc-088bede33a02", "node_type": "4", "metadata": {}, "hash": "73bb1982411e25e4d845b3614146731179c5a153abd0de2131747e1dc9b9709f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a40e26c4-7d5c-4f4a-b480-6722e7220980", "node_type": "1", "metadata": {}, "hash": "b4c520370c4d95bd2bb155c079a56bb76b212a0932dd5f6c25659956759ea91a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "fc9e69b0-5199-490b-8a2a-4ce2402902f2", "node_type": "1", "metadata": {}, "hash": "f2a89f61184a80eeaa9ca8ef608aeea9ddc8db583a5094e5c98f464d5ad54413", "class_name": "RelatedNodeInfo"}}, "text": "{% tabs %}\n{% tab title=\"git\" %}\n```sh\ngit clone https://github.com/Phala-Network/ai-agent-template-langchain.git\n```\n{% endtab %}\n\n{% tab title=\"degit\" %}\n```bash\nnpx degit github:Phala-Network/ai-agent-template-langchain#main ai-agent-template-langchain\n```\n{% endtab %}\n{% endtabs %}\n\nInstall dependencies\n\n```shell\nnpm install\n```\n\n### Testing Locally\n\nCreate `.env` file with the default ThirdWeb API key for publishing your Agent Contract to IPFS\n\n```sh\ncp .env.example .env\n```\n\nBuild your Agent\n\n```sh\nnpm run build\n```\n\nTest your Agent locally\n\n```sh\nnpm run test\n```\n\nExpected Test Results\n\n```sh\nINPUT: {\"method\":\"GET\",\"path\":\"/ipfs/CID\",\"queries\":{\"chatQuery\":[\"Who are you?\"]},\"secret\":{\"openaiApiKey\":\"OPENAI_API_KEY\"},\"headers\":{}}\nGET RESULT: {\n  status: 200,\n  body: '{\"message\":\"I am Marvin Tong, a thought leader and innovator specializing in blockchain, AI, and decentralized technologies. I often share insights and groundbreaking ideas about these fields on platforms like Twitter, collaborating with prominent names and organizations to advance the multi-agent world and decentralized ecosystems. My proposals aim to integrate AI agents into environments like Phala Network and future scenarios, leveraging technologies such as Zero-Knowledge Proofs (ZKP) and Trusted Execution Environments (TEE). My vision includes creating practical and impactful advancements that shape the future of technology, exemplified through my work and presentations at prominent events such as ETHDenver.\"}',\n  headers: {\n    'Content-Type': 'application/json',\n    'Access-Control-Allow-Origin': '*'\n  }\n}\nINPUT: {\"method\":\"GET\",\"path\":\"/ipfs/CID\",\"queries\":{\"chatQuery\":[\"What the latest direction of Phala?\"]},\"secret\":{\"openaiApiKey\":\"OPENAI_API_KEY\"},\"headers\":{}}\nGET RESULT: {\n  status: 200,\n  body: `{\"message\":\"The latest direction of Phala Network primarily revolves around enhancing and integrating secure, decentralized computation with privacy-preserving technologies. Here are some of the key pillars of their current focus:\\\\n\\\\n1.", "mimetype": "text/plain", "start_char_idx": 1475, "end_char_idx": 3524, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "fc9e69b0-5199-490b-8a2a-4ce2402902f2": {"__data__": {"id_": "fc9e69b0-5199-490b-8a2a-4ce2402902f2", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-langchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "129cdf80-ca1b-48f6-83bc-088bede33a02", "node_type": "4", "metadata": {}, "hash": "73bb1982411e25e4d845b3614146731179c5a153abd0de2131747e1dc9b9709f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "27515e30-e5e7-4bc3-9450-de5b7e6e445c", "node_type": "1", "metadata": {}, "hash": "add8d95ed30d369caa63a34e03568149b31e3eb0c48bb3d63032a5933fbb7e30", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "2693cc99-de21-49a8-b49a-aea3a3733676", "node_type": "1", "metadata": {}, "hash": "ca962012869222167dd4bea16922a71ad82c750c2d1fba155a2f0f96c88ef544", "class_name": "RelatedNodeInfo"}}, "text": "**Multi-Agent AI Integration**: Phala Network is pushing towards creating and hosting AI agents using secure smart contracts, fostering a Multi-Agent world where different agents can operate and interact in a decentralized, privacy-preserving manner.\\\\n\\\\n2. **TEE and ZK Proofs Combination**: Recently, Phala has made strides in integrating Trusted Execution Environments (TEE) with Zero-Knowledge Proofs (ZKP). This combination aims to fortify the privacy and security guarantees of decentralized computations, offering a robust multi-prover strategy.\\\\n\\\\n3. **Expansion into Financial Markets**: There is a community-driven effort to get $PHA listed on the Binance futures market, indicating Phala Network's ambition to capture a larger slice of the cryptocurrency financial market and increase token utility.\\\\n\\\\n4. **Bug Bounty Programs**: Security remains a top priority, with substantial bounties being offered (totaling $60,500) for identifying and resolving runtime bugs within Phala's network, ensuring the platform's resilience and reliability.\\\\n\\\\n5. **AI and Decentralized Services**: Phala Network is actively involved in the decentralized AI space. Their work at events like ETHDenver highlights their commitment to developing practical, real-world AI solutions that leverage decentralization for enhanced security and privacy.\\\\n\\\\n6. **Community Engagement and Development**: Phala Network continues to invest in its community, promoting collaborative projects, hackathons, and educational events to foster innovation and collective growth.\\\\n\\\\nThese directions underscore Phala Network's commitment to creating a secure, scalable, and user-friendly platform that integrates advanced privacy technologies into the heart of decentralized applications.\"}`,\n  headers: {\n    'Content-Type': 'application/json',\n    'Access-Control-Allow-Origin': '*'\n  }\n}\nNow you are ready to publish your agent, add secrets, and interact with your agent in the following steps:\n- Execute: 'npm run publish-agent'\n- Set secrets: 'npm run set-secrets'\n- Go to the url produced by setting the secrets (e.g.", "mimetype": "text/plain", "start_char_idx": 3525, "end_char_idx": 5631, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "2693cc99-de21-49a8-b49a-aea3a3733676": {"__data__": {"id_": "2693cc99-de21-49a8-b49a-aea3a3733676", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-langchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "129cdf80-ca1b-48f6-83bc-088bede33a02", "node_type": "4", "metadata": {}, "hash": "73bb1982411e25e4d845b3614146731179c5a153abd0de2131747e1dc9b9709f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "fc9e69b0-5199-490b-8a2a-4ce2402902f2", "node_type": "1", "metadata": {}, "hash": "f2a89f61184a80eeaa9ca8ef608aeea9ddc8db583a5094e5c98f464d5ad54413", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "e2366d02-3fbd-4a5d-8c2f-e312c8acda19", "node_type": "1", "metadata": {}, "hash": "4f783e2ec4d8c858c76d171ef50eca66a3f09f6264fa938b5fd2441210c6662c", "class_name": "RelatedNodeInfo"}}, "text": "https://wapo-testnet.phala.network/ipfs/QmPQJD5zv3cYDRM25uGAVjLvXGNyQf9Vonz7rqkQB52Jae?key=b092532592cbd0cf)\n```\n\n### Publishing Your Agent\n\nUpload your compiled AI Agent code to IPFS.\n\n```sh\nnpm run publish-agent\n```\n\nUpon a successful upload, the command should show the URL to access your AI Agent.\n\n```sh\nRunning command: npx thirdweb upload dist/index.js\nThis may require you to log into thirdweb and will take some time to publish to IPFS...\n\n    $$\\     $$\\       $$\\                 $$\\                         $$\\       \n    $$ |    $$ |      \\__|                $$ |                        $$ |      \n  $$$$$$\\   $$$$$$$\\  $$\\  $$$$$$\\   $$$$$$$ |$$\\  $$\\  $$\\  $$$$$$\\  $$$$$$$\\  \n  \\_$$  _|  $$  __$$\\ $$ |$$  __$$\\ $$  __$$ |$$ | $$ | $$ |$$  __$$\\ $$  __$$\\ \n    $$ |    $$ |  $$ |$$ |$$ |  \\__|$$ /  $$ |$$ | $$ | $$ |$$$$$$$$ |$$ |  $$ |\n    $$ |$$\\ $$ |  $$ |$$ |$$ |      $$ |  $$ |$$ | $$ | $$ |$$   ____|$$ |  $$ |\n    \\$$$$  |$$ |  $$ |$$ |$$ |      \\$$$$$$$ |\\$$$$$\\$$$$  |\\$$$$$$$\\ $$$$$$$  |\n     \\____/ \\__|  \\__|\\__|\\__|       \\_______| \\_____\\____/  \\_______|\\_______/ \n\n \ud83d\udc8e thirdweb v0.14.12 \ud83d\udc8e\n\n- Uploading file to IPFS. This may take a while depending on file sizes.\n\n\u2714 Successfully uploaded file to IPFS.", "mimetype": "text/plain", "start_char_idx": 5632, "end_char_idx": 6865, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e2366d02-3fbd-4a5d-8c2f-e312c8acda19": {"__data__": {"id_": "e2366d02-3fbd-4a5d-8c2f-e312c8acda19", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-langchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "129cdf80-ca1b-48f6-83bc-088bede33a02", "node_type": "4", "metadata": {}, "hash": "73bb1982411e25e4d845b3614146731179c5a153abd0de2131747e1dc9b9709f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "2693cc99-de21-49a8-b49a-aea3a3733676", "node_type": "1", "metadata": {}, "hash": "ca962012869222167dd4bea16922a71ad82c750c2d1fba155a2f0f96c88ef544", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "558e63f0-3196-4b15-a0ac-ebf0cf1ed094", "node_type": "1", "metadata": {}, "hash": "99826a017f605efa928e24866cda37cca329bb2c18b129d847ae417bc4ced139", "class_name": "RelatedNodeInfo"}}, "text": "\u2714 Files stored at the following IPFS URI: ipfs://QmYzBTdQNPewdhD9GdBJ9TdV7LVhrh9YVRiV8aBup7qZGu\n\u2714 Open this link to view your upload: https://b805a9b72767504353244e0422c2b5f9.ipfscdn.io/ipfs/bafybeie6giqpm4fmxt4vzdfi6jlbxxlvjlal3cm57auubgcmuvm7xcqtli/\n\nAgent Contract deployed at: https://wapo-testnet.phala.network/ipfs/QmYzBTdQNPewdhD9GdBJ9TdV7LVhrh9YVRiV8aBup7qZGu\n\nIf your agent requires secrets, ensure to do the following:\n1) Edit the ./secrets/default.json file or create a new JSON file in the ./secrets folder and add your secrets to it.\n2) Run command: 'npm run set-secrets' or 'npm run set-secrets [path-to-json-file]'\nLogs folder created.\nDeployment information updated in ./logs/latestDeployment.json\n```\n\n{% hint style=\"info\" %}\n\n\n**Note** that your latest deployment information will be logged to in file [`./logs/latestDeployment.json`](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/logs/latestDeployment.json). This file is updated every time you publish a new Agent Contract to IPFS. This file is also used to get the IPFS CID of your Agent Contract when setting secrets for your Agent Contract.\n\nHere is an example:\n\n```\n{\n  \"date\": \"2024-08-29T18:47:55.108Z\",\n  \"cid\": \"QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc\",\n  \"url\": \"https://wapo-testnet.phala.network/ipfs/QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc\"\n}\n```\n{% endhint %}\n\n{% hint style=\"warning\" %}\n\n\n**Did Thirdweb fail to publish?", "mimetype": "text/plain", "start_char_idx": 6866, "end_char_idx": 8307, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "558e63f0-3196-4b15-a0ac-ebf0cf1ed094": {"__data__": {"id_": "558e63f0-3196-4b15-a0ac-ebf0cf1ed094", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-langchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "129cdf80-ca1b-48f6-83bc-088bede33a02", "node_type": "4", "metadata": {}, "hash": "73bb1982411e25e4d845b3614146731179c5a153abd0de2131747e1dc9b9709f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e2366d02-3fbd-4a5d-8c2f-e312c8acda19", "node_type": "1", "metadata": {}, "hash": "4f783e2ec4d8c858c76d171ef50eca66a3f09f6264fa938b5fd2441210c6662c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "df2e76c4-968c-4294-851c-04a433cd5eef", "node_type": "1", "metadata": {}, "hash": "b6b187b8f1941f1dcbe21e0659eeb6f0b5958d92b1c5a609c2b26edb32dce9e6", "class_name": "RelatedNodeInfo"}}, "text": "**\n\nIf ThirdWeb fails to publish, please signup for your own ThirdWeb account to publish your Agent Contract to IPFS. Signup or login at [https://thirdweb.com/dashboard/](https://thirdweb.com/dashboard/)\n\nWhenever you log into ThirdWeb, create a new API key and replace the default API Key with yours in the [.env](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/.env) file.\n\n```\nTHIRDWEB_API_KEY=\"YOUR_THIRDWEB_API_KEY\"\n```\n{% endhint %}\n\n### Accessing The Published Agent\n\nOnce published, your AI Agent is available at the URL: `https://wapo-testnet.phala.network/ipfs/<your-cid>`. You can get it from the \"Publish to IPFS\" step.\n\nYou can test it with `curl`.\n\n```sh\ncurl https://wapo-testnet.phala.network/ipfs/<your-cid>\n```\n\n### Adding Secrets\n\nBy default, all the compiled JS code is visible for anyone to view if they look at IPFS CID. This makes private info like API keys, signer keys, etc. vulnerable to be stolen. To protect devs from leaking keys, we have added a field called `secret` in the `Request` object. It allows you to store secrets in a vault for your AI Agent to access.\n\nTo add your secrets,\n\n1. Edit the [default.json](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/secrets/default.json) file or create a new JSON file in the `./secrets` folder and add your secrets to it.\n\n```sh\n{\n  \"apiKey\": \"YOUR_OPENAI_API_KEY\"\n}\n```\n\n2.", "mimetype": "text/plain", "start_char_idx": 8307, "end_char_idx": 9700, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "df2e76c4-968c-4294-851c-04a433cd5eef": {"__data__": {"id_": "df2e76c4-968c-4294-851c-04a433cd5eef", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-langchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "129cdf80-ca1b-48f6-83bc-088bede33a02", "node_type": "4", "metadata": {}, "hash": "73bb1982411e25e4d845b3614146731179c5a153abd0de2131747e1dc9b9709f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "558e63f0-3196-4b15-a0ac-ebf0cf1ed094", "node_type": "1", "metadata": {}, "hash": "99826a017f605efa928e24866cda37cca329bb2c18b129d847ae417bc4ced139", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "92e84378-47b3-4f6c-b98a-ee8e6c731f2a", "node_type": "1", "metadata": {}, "hash": "14a5a66f01372ed775dd6c82d8633a6baad70225055bdaa8138d8830565b4156", "class_name": "RelatedNodeInfo"}}, "text": "Run command to set the secrets\n\n```sh\nnpm run set-secrets\n# or if you have a custom JSON file\nnpm run set-secrets <path-to-json-file>\n```\n\nExpected output:\n\n```sh\nUse default secrets...\nStoring secrets...\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   199    0    68  100   131    121    234 --:--:-- --:--:-- --:--:--   356\n{\"token\":\"5d9faaed6be5414a\",\"key\":\"a3a8a4ef2c057d5c\",\"succeed\":true}\n\nSecrets set successfully. Go to the URL below to interact with your agent:\nhttps://wapo-testnet.phala.network/ipfs/QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc?key=a3a8a4ef2c057d5c\nLog entry added to secrets.log\n```\n\n{% hint style=\"info\" %}\n**Note** that all your secrets will be logged in file [`./logs/secrets.log`](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/logs/secrets.log). This file is updated every time you add new secrets to your Agent Contract. If you have not published an Agent Contract, yet, this command will fail since there is not a CID to map the secrets to.", "mimetype": "text/plain", "start_char_idx": 9701, "end_char_idx": 10817, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "92e84378-47b3-4f6c-b98a-ee8e6c731f2a": {"__data__": {"id_": "92e84378-47b3-4f6c-b98a-ee8e6c731f2a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-langchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "129cdf80-ca1b-48f6-83bc-088bede33a02", "node_type": "4", "metadata": {}, "hash": "73bb1982411e25e4d845b3614146731179c5a153abd0de2131747e1dc9b9709f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "df2e76c4-968c-4294-851c-04a433cd5eef", "node_type": "1", "metadata": {}, "hash": "b6b187b8f1941f1dcbe21e0659eeb6f0b5958d92b1c5a609c2b26edb32dce9e6", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "e22870bf-d107-4895-a9d8-88eabd1305fc", "node_type": "1", "metadata": {}, "hash": "3e49c90212a201f94bde82164a8c4dcf110492e4955ad340104868bbe25f3ac3", "class_name": "RelatedNodeInfo"}}, "text": "Here is an example:\n\n```sh\n2024-08-29T18:54:16.643Z, CID: [QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc], Token: [5d9faaed6be5414a], Key: [a3a8a4ef2c057d5c], URL: [https://wapo-testnet.phala.network/ipfs/QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc?key=a3a8a4ef2c057d5c]\n```\n{% endhint %}\n\nThe API returns a `token` and a `key`. The `key` is the id of your secret. It can be used to specify which secret you are going to pass to your frame. The `token` can be used by the developer to access the raw secret. You should never leak the `token`.\n\nTo verify the secret, run the following command where `key` and `token` are replaced with the values from adding your `secret` to the vault.\n\n```sh\ncurl https://wapo-testnet.phala.network/vaults/<key>/<token>\n```\n\nExpected output:\n\n```sh\n{\"data\":{\"openaiApiKey\":\"<OPENAI_API_KEY>\"},\"succeed\":true}\n```\n\n### Accessing Queries\n\nTo help create custom logic, we have an array variable named `queries` that can be accessed in the `Request` class. To access the `queries` array variable `chatQuery` value at index `0`, the syntax will look as follows:\n\n```sh\nconst query = req.queries.chatQuery[0] as string;\n```\n\nHere is an example of adding a URL query named `chatQuery` with a value of `Who are you`. `queries` can have any field name, so `chatQuery` is just an example of a field name and not a mandatory name, but remember to update your `index.ts` file logic to use your expected field name.", "mimetype": "text/plain", "start_char_idx": 10819, "end_char_idx": 12258, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e22870bf-d107-4895-a9d8-88eabd1305fc": {"__data__": {"id_": "e22870bf-d107-4895-a9d8-88eabd1305fc", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-langchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "129cdf80-ca1b-48f6-83bc-088bede33a02", "node_type": "4", "metadata": {}, "hash": "73bb1982411e25e4d845b3614146731179c5a153abd0de2131747e1dc9b9709f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "92e84378-47b3-4f6c-b98a-ee8e6c731f2a", "node_type": "1", "metadata": {}, "hash": "14a5a66f01372ed775dd6c82d8633a6baad70225055bdaa8138d8830565b4156", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "8102ad44-b13e-4393-81cc-6081ff7e4bb1", "node_type": "1", "metadata": {}, "hash": "63a02dad60a8552625d205da7f8cd0a30408caa8a67122d2db20e397b1cf7bd2", "class_name": "RelatedNodeInfo"}}, "text": "> &#x20;[https://wapo-testnet.phala.network/ipfs/QmYzBTdQNPewdhD9GdBJ9TdV7LVhrh9YVRiV8aBup7qZGu?key=815cab7189f6110e&<mark style=\"background-color:yellow;\">chatQuery</mark>=Who%20are%20you](https://wapo-testnet.phala.network/ipfs/QmYzBTdQNPewdhD9GdBJ9TdV7LVhrh9YVRiV8aBup7qZGu?key=815cab7189f6110e\\&chatQuery=Who%20are%20you)&#x20;\n\n### Debugging Your Agent\n\nTo debug your agent, you can use the following command:\n\n```\ncurl https://wapo-testnet.phala.network/logs/all/ipfs/<CID>\n```\n\nAfter executing this command then you should see some output in the terminal to show the logs of requests to your agent.\n\n```\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [REPORT] END Request: Duration: 166ms\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [INFO] 'Is signature valid? ' true\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [INFO] 'Verifying Signature with PublicKey ' '0xC1BF8dB4D06416c43Aca3deB289CF7CC0aAFF540'\n2024-09-04T03:18:34.", "mimetype": "text/plain", "start_char_idx": 12260, "end_char_idx": 13246, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8102ad44-b13e-4393-81cc-6081ff7e4bb1": {"__data__": {"id_": "8102ad44-b13e-4393-81cc-6081ff7e4bb1", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-langchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "129cdf80-ca1b-48f6-83bc-088bede33a02", "node_type": "4", "metadata": {}, "hash": "73bb1982411e25e4d845b3614146731179c5a153abd0de2131747e1dc9b9709f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e22870bf-d107-4895-a9d8-88eabd1305fc", "node_type": "1", "metadata": {}, "hash": "3e49c90212a201f94bde82164a8c4dcf110492e4955ad340104868bbe25f3ac3", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c5994994-6f76-4cf1-a2c7-50132960b2f4", "node_type": "1", "metadata": {}, "hash": "9629fd0b6d24b2b2c7f655a205315bff15ba8067078a66ecf2dba35795739c31", "class_name": "RelatedNodeInfo"}}, "text": "758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd&type=verify&data=tintinland%20message%20to%20sign&signature=0x34c4d8c83406e7a292ecc940d60b34c9b11024db10a8872c753b9711cd6dbc8f746da8be9bc2ae0898ebf8f49f48c2ff4ba2a851143c3e4b371647eed32f707b1b\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [REPORT] END Request: Duration: 183ms\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [INFO] 'Signature: 0x34c4d8c83406e7a292ecc940d60b34c9b11024db10a8872c753b9711cd6dbc8f746da8be9bc2ae0898ebf8f49f48c2ff4ba2a851143c3e4b371647eed32f707b1b'\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [INFO] 'Signing data [tintinland message to sign] with Account [0xC1BF8dB4D06416c43Aca3deB289CF7CC0aAFF540]'\n2024-09-04T03:17:15.", "mimetype": "text/plain", "start_char_idx": 13246, "end_char_idx": 14097, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c5994994-6f76-4cf1-a2c7-50132960b2f4": {"__data__": {"id_": "c5994994-6f76-4cf1-a2c7-50132960b2f4", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-langchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "129cdf80-ca1b-48f6-83bc-088bede33a02", "node_type": "4", "metadata": {}, "hash": "73bb1982411e25e4d845b3614146731179c5a153abd0de2131747e1dc9b9709f", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "8102ad44-b13e-4393-81cc-6081ff7e4bb1", "node_type": "1", "metadata": {}, "hash": "63a02dad60a8552625d205da7f8cd0a30408caa8a67122d2db20e397b1cf7bd2", "class_name": "RelatedNodeInfo"}}, "text": "238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd&type=sign&data=tintinland%20message%20to%20sign\n2024-09-04T03:16:38.507Z [3717d307-bff0-4fc0-bc98-8f66c33dd46f] [REPORT] END Request: Duration: 169ms\n2024-09-04T03:16:38.507Z [3717d307-bff0-4fc0-bc98-8f66c33dd46f] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd\n2024-09-04T03:15:00.375Z [793f58f9-f24f-4580-8ebc-04debb7d727f] [REPORT] END Request: Duration: 158ms\n2024-09-04T03:15:00.375Z [793f58f9-f24f-4580-8ebc-04debb7d727f] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64\na1e805bfd\n```\n\nTo create logs in your Agent Contract, you can use the following syntax in your `index.ts` file.\n\n```\n// info logs\nconsole.log('info log message!')\n// error logs\nconsole.error('error log message!')\n```\n\nFor more information check the [MDN docs](https://developer.mozilla.org/en-US/docs/Web/API/console) on `console` object.", "mimetype": "text/plain", "start_char_idx": 14097, "end_char_idx": 15156, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "099b92a5-a419-48b0-b7b7-581ae5afc52d": {"__data__": {"id_": "099b92a5-a419-48b0-b7b7-581ae5afc52d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/base-sepolia-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "1f1d8b79-659e-40bf-a944-ec935ac7ee6e", "node_type": "4", "metadata": {}, "hash": "dcc779294b47c0db670f3ef064f64633e4b7be7558a3bcb7c801dc957069dc33", "class_name": "RelatedNodeInfo"}}, "text": "# Base Sepolia Testnet\n\nCoinbase has developed Base to work with Ethereum's second layer (L2). For more details, please visit their documentation page: [https://docs.base.org/](https://docs.base.org/)\n\n| Asset Pair  | Contract Address                           |\n| ----------- | ------------------------------------------ |\n| AAVE to USD | 0x739d71fC66397a28B3A3b7d40eeB865CA05f0185 |\n| BTC to USD  | 0x1e73C20c42a7de166868da4c47963d137030492A |\n| CRV to USD  | 0xf38b25b79A72393Fca2Af88cf948D98c64726273 |\n| DAI to USD  | 0xB842f535a88021F95e1a94245Fa549a7f75084Dc |\n| ETH to USD  | 0x2E1640853bB2dD9f47831582665477865F9240DB |\n| USDC to USD | 0x49899fBd9be6b23d5e4AF697a92dc1E6C695862b |\n| USDT to USD | 0x92E9b9348949455580EB820ba041f4cAaB998e3f |", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 750, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "15c4e7dc-5025-4a70-b124-0989d7c488af": {"__data__": {"id_": "15c4e7dc-5025-4a70-b124-0989d7c488af", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-an-agent-to-transact-onchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d", "node_type": "4", "metadata": {}, "hash": "794f0748362f038436c10ec2bf53465f15c2a4fa74ae4adb9165d443384f20e5", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "7f63c05a-909d-4005-87d9-e32d7d6b4059", "node_type": "1", "metadata": {}, "hash": "20a5cdb8d17ae4cc624424f17c2e0f0beeb8550c3368ee49b82be67cb07e38fa", "class_name": "RelatedNodeInfo"}}, "text": "# Build An Agent to Transact Onchain\n\nIf you like video tutorials, here is one of our latest workshops on building an Agent to transact onchain using the [Viem SDK](https://viem.sh) with the AI Agent Contract Template. In this tutorial, you will learn:\n\n* How to test the WapoJS functions like `deriveSecret(salt)`to derive an ECDSA key based on your `secret` added to your Agent Contract's secret vault.\n* Build and deploy your Agent Contract to IPFS then add your secret salt that will derive an ECDSA key for your deployed agent.\n* Sign and verify a message using the `viem` SDK with your agent's derived ECDSA key.&#x20;\n* Debug your Agent Contract due to a failed transaction on Base Sepolia.\n* Resolve the error and execute a successful transaction on Base Sepolia.\n\n{% embed url=\"https://youtu.be/YBaF1ivSuVE?si=0J1vnEPyluGqxnxv\" %}\n\n## Getting Started\n\n### Prepare\n\nClone git repo or use [degit](https://www.npmjs.com/package/degit) to get the source code.\n\n{% tabs %}\n{% tab title=\"git\" %}\n```sh\ngit clone https://github.com/Phala-Network/ai-agent-contract-viem.git\n```\n{% endtab %}\n\n{% tab title=\"degit\" %}\n```bash\nnpx degit github:Phala-Network/ai-agent-contract-viem#main ai-agent-contract-viem\n```\n{% endtab %}\n{% endtabs %}\n\nInstall dependencies\n\n```shell\nnpm install\n```\n\n### Testing Locally\n\nCreate `.env` file with the default ThirdWeb API key for publishing your Agent Contract to IPFS\n\n```sh\ncp .env.example .env\n```\n\nBuild your Agent\n\n```sh\nnpm run build\n```\n\nTest your Agent locally\n\n```sh\nnpm run test\n```\n\nExpected Test Results\n\n```sh\nNow you are ready to publish your agent, add secrets, and interact with your agent in the following steps:\n- Execute: 'npm run publish-agent'\n- Set secrets: 'npm run set-secrets'\n- Go to the url produced by setting the secrets (e.g.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1790, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7f63c05a-909d-4005-87d9-e32d7d6b4059": {"__data__": {"id_": "7f63c05a-909d-4005-87d9-e32d7d6b4059", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-an-agent-to-transact-onchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d", "node_type": "4", "metadata": {}, "hash": "794f0748362f038436c10ec2bf53465f15c2a4fa74ae4adb9165d443384f20e5", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "15c4e7dc-5025-4a70-b124-0989d7c488af", "node_type": "1", "metadata": {}, "hash": "3b37e286acf70a19dcf536a1978916ee1daa1568a2e6919d72fd7cdc3d34694f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "70d23144-719e-4911-b080-efec2142b01b", "node_type": "1", "metadata": {}, "hash": "d7734839c04e616429cfa2a09ad32ee1f30b7db6e15a2cdc9da46baa7cc60998", "class_name": "RelatedNodeInfo"}}, "text": "https://wapo-testnet.phala.network/ipfs/QmPQJD5zv3cYDRM25uGAVjLvXGNyQf9Vonz7rqkQB52Jae?key=b092532592cbd0cf)\n\n \u2713 tests/index.test.ts (5) 7035ms\n   \u2713 Test Viem SDK AI Agent Contract (5) 7035ms\n     \u2713 Derive Account\n     \u2713 Sign Message Data\n     \u2713 Verify Signature\n     \u2713 Send TX on Base Sepolia 6991ms\n     \u2713 POST /\n\n Test Files  1 passed (1)\n      Tests  5 passed (5)\n   Start at  16:40:10\n   Duration  7.39s (transform 34ms, setup 6ms, collect 181ms, tests 7.04s, environment 0ms, prepare 42ms)\n```\n\n### Publishing Your Agent\n\nUpload your compiled AI Agent code to IPFS.\n\n```sh\nnpm run publish-agent\n```\n\nUpon a successful upload, the command should show the URL to access your AI Agent.\n\n```sh\n- Uploading file to IPFS. This may take a while depending on file sizes.\n\n\u2714 Successfully uploaded file to IPFS.\n\u2714 Files stored at the following IPFS URI: ipfs://QmVJ3xknfRevUkc68iZc4RdPSLL2gLD8WagwMQCdGMyC4g\n\u2714 Open this link to view your upload: https://b805a9b72767504353244e0422c2b5f9.ipfscdn.io/ipfs/bafybeidhk5nzutxyx3xusgjl4v6nkvscdoiowzofc7hqnf3l4xipieshie/\n\nAgent Contract deployed at: https://wapo-testnet.phala.network/ipfs/QmVJ3xknfRevUkc68iZc4RdPSLL2gLD8WagwMQCdGMyC4g\n\nIf your agent requires secrets, ensure to do the following:\n1) Edit the ./secrets/default.json file or create a new JSON file in the ./secrets folder and add your secrets to it.", "mimetype": "text/plain", "start_char_idx": 1791, "end_char_idx": 3145, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "70d23144-719e-4911-b080-efec2142b01b": {"__data__": {"id_": "70d23144-719e-4911-b080-efec2142b01b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-an-agent-to-transact-onchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d", "node_type": "4", "metadata": {}, "hash": "794f0748362f038436c10ec2bf53465f15c2a4fa74ae4adb9165d443384f20e5", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "7f63c05a-909d-4005-87d9-e32d7d6b4059", "node_type": "1", "metadata": {}, "hash": "20a5cdb8d17ae4cc624424f17c2e0f0beeb8550c3368ee49b82be67cb07e38fa", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "8af7b5ea-c380-46d1-ba69-750e46666ca0", "node_type": "1", "metadata": {}, "hash": "636ef37ca407cc1c72058193d6f674d3072f3a0bb5306d5c28eca34a41c2fdb4", "class_name": "RelatedNodeInfo"}}, "text": "2) Run command: 'npm run set-secrets' or 'npm run set-secrets [path-to-json-file]'\nDeployment information updated in ./logs/latestDeployment.json\n```\n\n{% hint style=\"info\" %}\n\n\n**Note** that your latest deployment information will be logged to in file [`./logs/latestDeployment.json`](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/logs/latestDeployment.json). This file is updated every time you publish a new Agent Contract to IPFS. This file is also used to get the IPFS CID of your Agent Contract when setting secrets for your Agent Contract.\n\nHere is an example:\n\n```json\n{\n  \"date\": \"2024-08-29T03:55:04.278Z\",\n  \"cid\": \"Qmb2Mn72sY9h8ew6Ld5bW13Fknzge3hssRetJTUWyyoma7\",\n  \"url\": \"https://wapo-testnet.phala.network/ipfs/Qmb2Mn72sY9h8ew6Ld5bW13Fknzge3hssRetJTUWyyoma7\"\n}\n```\n{% endhint %}\n\n{% hint style=\"warning\" %}\n\n\n**Did Thirdweb fail to publish?**\n\nIf ThirdWeb fails to publish, please signup for your own ThirdWeb account to publish your Agent Contract to IPFS. Signup or login at [https://thirdweb.com/dashboard/](https://thirdweb.com/dashboard/)\n\nWhenever you log into ThirdWeb, create a new API key and replace the default API Key with yours in the [.env](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/.env) file.\n\n```\nTHIRDWEB_API_KEY=\"YOUR_THIRDWEB_API_KEY\"\n```\n{% endhint %}\n\n### Accessing The Published Agent\n\nOnce published, your AI Agent is available at the URL: `https://wapo-testnet.phala.network/ipfs/<your-cid>`. You can get it from the \"Publish to IPFS\" step.\n\nYou can test it with `curl`.\n\n```sh\ncurl https://wapo-testnet.phala.network/ipfs/<your-cid>\n```\n\n### Adding Secrets\n\nBy default, all the compiled JS code is visible for anyone to view if they look at IPFS CID.", "mimetype": "text/plain", "start_char_idx": 3146, "end_char_idx": 4886, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8af7b5ea-c380-46d1-ba69-750e46666ca0": {"__data__": {"id_": "8af7b5ea-c380-46d1-ba69-750e46666ca0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-an-agent-to-transact-onchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d", "node_type": "4", "metadata": {}, "hash": "794f0748362f038436c10ec2bf53465f15c2a4fa74ae4adb9165d443384f20e5", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "70d23144-719e-4911-b080-efec2142b01b", "node_type": "1", "metadata": {}, "hash": "d7734839c04e616429cfa2a09ad32ee1f30b7db6e15a2cdc9da46baa7cc60998", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "d4b20a6b-aca6-4c76-9468-ecc09ce8a291", "node_type": "1", "metadata": {}, "hash": "20df50fa0eeeda52a06bdca552b1bbb84033fe540c6a531e671953fdb852c3d6", "class_name": "RelatedNodeInfo"}}, "text": "This makes private info like API keys, signer keys, etc. vulnerable to be stolen. To protect devs from leaking keys, we have added a field called `secret` in the `Request` object. It allows you to store secrets in a vault for your AI Agent to access.\n\nTo add your secrets,\n\n1. Edit the [default.json](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/secrets/default.json) file or create a new JSON file in the `./secrets` folder and add your secrets to it.\n\n```sh\n{\n  \"secretSalt\": \"SALTY_BAE\"\n}\n```\n\n2. Run command to set the secrets\n\n```sh\nnpm run set-secrets\n# or if you have a custom JSON file\nnpm run set-secrets <path-to-json-file>\n```\n\nExpected output:\n\n```sh\nUse default secrets...\nStoring secrets...\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   199    0    68  100   131    121    234 --:--:-- --:--:-- --:--:--   356\n{\"token\":\"5d9faaed6be5414a\",\"key\":\"a3a8a4ef2c057d5c\",\"succeed\":true}\n\nSecrets set successfully. Go to the URL below to interact with your agent:\nhttps://wapo-testnet.phala.network/ipfs/QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc?key=a3a8a4ef2c057d5c\nLog entry added to secrets.log\n```\n\n{% hint style=\"info\" %}\n**Note** that all your secrets will be logged in file [`./logs/secrets.log`](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/logs/secrets.log). This file is updated every time you add new secrets to your Agent Contract. If you have not published an Agent Contract, yet, this command will fail since there is not a CID to map the secrets to.", "mimetype": "text/plain", "start_char_idx": 4887, "end_char_idx": 6527, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d4b20a6b-aca6-4c76-9468-ecc09ce8a291": {"__data__": {"id_": "d4b20a6b-aca6-4c76-9468-ecc09ce8a291", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-an-agent-to-transact-onchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d", "node_type": "4", "metadata": {}, "hash": "794f0748362f038436c10ec2bf53465f15c2a4fa74ae4adb9165d443384f20e5", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "8af7b5ea-c380-46d1-ba69-750e46666ca0", "node_type": "1", "metadata": {}, "hash": "636ef37ca407cc1c72058193d6f674d3072f3a0bb5306d5c28eca34a41c2fdb4", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "6f6d9f94-3e21-4772-817e-67256532bb0c", "node_type": "1", "metadata": {}, "hash": "2d1b3d7a87fe11a446bdcbb6d0e52f5b46f9c5b8de95dc276636913ee7e41282", "class_name": "RelatedNodeInfo"}}, "text": "Here is an example:\n\n```sh\n2024-08-28T19:31:07.011Z, CID: [QmYNXZ7tGijMHvweRjcx5vGPjmMBCfqnaBS7AHQDipymqh], Token: [fc908693f43dbe2f], Key: [18ba50e9c1d5822a], URL: [https://wapo-testnet.phala.network/ipfs/QmYNXZ7tGijMHvweRjcx5vGPjmMBCfqnaBS7AHQDipymqh?key=18ba50e9c1d5822a]\n2024-08-29T03:22:11.453Z, CID: [QmYNXZ7tGijMHvweRjcx5vGPjmMBCfqnaBS7AHQDipymqh], Token: [d0e96601ea38b6be], Key: [2b5fd724a4de3652], URL: [https://wapo-testnet.phala.network/ipfs/QmYNXZ7tGijMHvweRjcx5vGPjmMBCfqnaBS7AHQDipymqh?key=2b5fd724a4de3652]\n2024-08-29T03:37:10.033Z, CID: [QmYNXZ7tGijMHvweRjcx5vGPjmMBCfqnaBS7AHQDipymqh], Token: [ec667a69d0df6653], Key: [63d145b3bddf56b4], URL: [https://wapo-testnet.phala.network/ipfs/QmYNXZ7tGijMHvweRjcx5vGPjmMBCfqnaBS7AHQDipymqh?key=63d145b3bddf56b4]\n2024-08-29T03:53:54.735Z, CID: [QmYNXZ7tGijMHvweRjcx5vGPjmMBCfqnaBS7AHQDipymqh], Token: [b9b53656b1e0293b],", "mimetype": "text/plain", "start_char_idx": 6529, "end_char_idx": 7407, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6f6d9f94-3e21-4772-817e-67256532bb0c": {"__data__": {"id_": "6f6d9f94-3e21-4772-817e-67256532bb0c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-an-agent-to-transact-onchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d", "node_type": "4", "metadata": {}, "hash": "794f0748362f038436c10ec2bf53465f15c2a4fa74ae4adb9165d443384f20e5", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d4b20a6b-aca6-4c76-9468-ecc09ce8a291", "node_type": "1", "metadata": {}, "hash": "20df50fa0eeeda52a06bdca552b1bbb84033fe540c6a531e671953fdb852c3d6", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "1cd92497-2469-46c7-acb4-17ab91937017", "node_type": "1", "metadata": {}, "hash": "dd750ec16e7c2ba94f22987461269290a38ce6bfff7d0498e9a379119ecf8240", "class_name": "RelatedNodeInfo"}}, "text": "Key: [31db5184579e3427], URL: [https://wapo-testnet.phala.network/ipfs/QmYNXZ7tGijMHvweRjcx5vGPjmMBCfqnaBS7AHQDipymqh?key=31db5184579e3427]\n2024-08-29T03:55:14.959Z, CID: [Qmb2Mn72sY9h8ew6Ld5bW13Fknzge3hssRetJTUWyyoma7], Token: [beb2e71cd4c7997d], Key: [e189f4deee88dcc1], URL: [https://wapo-testnet.phala.network/ipfs/Qmb2Mn72sY9h8ew6Ld5bW13Fknzge3hssRetJTUWyyoma7?key=e189f4deee88dcc1]\n```\n{% endhint %}\n\nThe API returns a `token` and a `key`. The `key` is the id of your secret. It can be used to specify which secret you are going to pass to your frame. The `token` can be used by the developer to access the raw secret. You should never leak the `token`.\n\nTo verify the secret, run the following command where `key` and `token` are replaced with the values from adding your `secret` to the vault.\n\n```sh\ncurl https://wapo-testnet.phala.network/vaults/<key>/<token>\n```\n\nExpected output:\n\n```sh\n{\"data\":{\"secretSalt\":\"<YOUR_SECRET_SALT>\"},\"succeed\":true}\n```\n\n#### Accessing Your Secrets in Your Code\n\n```typescript\nlet vault: Record<string, string> = {}\ntry {\n  vault = JSON.parse(process.env.secret || '')\n} catch (e) {\n  console.error(e)\n  return c.json({ error: \"Failed to parse secrets\" })\n}\nconst secretSalt = (vault.secretSalt) ?", "mimetype": "text/plain", "start_char_idx": 7408, "end_char_idx": 8648, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "1cd92497-2469-46c7-acb4-17ab91937017": {"__data__": {"id_": "1cd92497-2469-46c7-acb4-17ab91937017", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-an-agent-to-transact-onchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d", "node_type": "4", "metadata": {}, "hash": "794f0748362f038436c10ec2bf53465f15c2a4fa74ae4adb9165d443384f20e5", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "6f6d9f94-3e21-4772-817e-67256532bb0c", "node_type": "1", "metadata": {}, "hash": "2d1b3d7a87fe11a446bdcbb6d0e52f5b46f9c5b8de95dc276636913ee7e41282", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "e5cdfb49-1780-485b-a5a1-498d6a0bd40a", "node_type": "1", "metadata": {}, "hash": "dadb3c9c0a496bd9a8de3cd7a8cce2591c8038fc09920ca31499d59cc91204cc", "class_name": "RelatedNodeInfo"}}, "text": "vault.secretSalt as string : 'SALTY_BAE'\n```\n\n### Example HTTP Requests\n\nBelow are some example HTTP Requests to a deployed Agent Contract without any changes made to the template.&#x20;\n\n{% hint style=\"warning\" %}\nNote that if the transaction fails for the onchain transaction agent, try sending some test ETH to the [derived address](https://wapo-testnet.phala.network/ipfs/QmVJ3xknfRevUkc68iZc4RdPSLL2gLD8WagwMQCdGMyC4g?key=6978ea391960e272) of the Agent.\n{% endhint %}\n\n{% hint style=\"info\" %}\nURL queries are highlighted in <mark style=\"background-color:yellow;\">yellow</mark>.\n{% endhint %}\n\n*   [Derived ECDSA Key](https://wapo-testnet.phala.network/ipfs/QmVJ3xknfRevUkc68iZc4RdPSLL2gLD8WagwMQCdGMyC4g?key=6978ea391960e272)\n\n    > URL: [https://wapo-testnet.phala.network/ipfs/QmVJ3xknfRevUkc68iZc4RdPSLL2gLD8WagwMQCdGMyC4g?<mark style=\"background-color:yellow;\">key</mark>=6978ea391960e272](https://wapo-testnet.phala.network/ipfs/QmVJ3xknfRevUkc68iZc4RdPSLL2gLD8WagwMQCdGMyC4g?key=6978ea391960e272)\n*   [Sign 'signedByTEE'](https://wapo-testnet.phala.network/ipfs/QmVJ3xknfRevUkc68iZc4RdPSLL2gLD8WagwMQCdGMyC4g?key=6978ea391960e272\\&type=sign\\&data=signedByTEE)\n\n    > URL: [https://wapo-testnet.phala.", "mimetype": "text/plain", "start_char_idx": 8649, "end_char_idx": 9860, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e5cdfb49-1780-485b-a5a1-498d6a0bd40a": {"__data__": {"id_": "e5cdfb49-1780-485b-a5a1-498d6a0bd40a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-an-agent-to-transact-onchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d", "node_type": "4", "metadata": {}, "hash": "794f0748362f038436c10ec2bf53465f15c2a4fa74ae4adb9165d443384f20e5", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "1cd92497-2469-46c7-acb4-17ab91937017", "node_type": "1", "metadata": {}, "hash": "dd750ec16e7c2ba94f22987461269290a38ce6bfff7d0498e9a379119ecf8240", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f630ecaf-afdf-41d6-bc3f-12299596db18", "node_type": "1", "metadata": {}, "hash": "34ececba3ca20aa5bc98d7728fcc29361a821f4b48bfb876649b7358c894490a", "class_name": "RelatedNodeInfo"}}, "text": "network/ipfs/QmVJ3xknfRevUkc68iZc4RdPSLL2gLD8WagwMQCdGMyC4g?<mark style=\"background-color:yellow;\">key</mark>=6978ea391960e272&<mark style=\"background-color:yellow;\">type</mark>=sign&<mark style=\"background-color:yellow;\">data</mark>=signedByTEE](https://wapo-testnet.phala.network/ipfs/QmVJ3xknfRevUkc68iZc4RdPSLL2gLD8WagwMQCdGMyC4g?key=6978ea391960e272\\&type=sign\\&data=signedByTEE)\n*   [Verify Signature](https://wapo-testnet.phala.network/ipfs/QmVJ3xknfRevUkc68iZc4RdPSLL2gLD8WagwMQCdGMyC4g?key=6978ea391960e272\\&type=verify\\&data=signedByTEE\\&signature=0x9b1b413f1573da2ada426f4da99416b6081ef7246a23990c0c13d764f566083920a4b07636b7d7a582fbc3d98ad42bedc26410764a4cd2963058792121a5d63d1b)\n\n    > URL: [https://wapo-testnet.phala.network/ipfs/QmVJ3xknfRevUkc68iZc4RdPSLL2gLD8WagwMQCdGMyC4g?<mark style=\"background-color:yellow;\">key</mark>=6978ea391960e272&<mark style=\"background-color:yellow;\">type</mark>=verify&<mark style=\"background-color:yellow;\">data</mark>=signedByTEE&<mark style=\"background-color:yellow;", "mimetype": "text/plain", "start_char_idx": 9860, "end_char_idx": 10877, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f630ecaf-afdf-41d6-bc3f-12299596db18": {"__data__": {"id_": "f630ecaf-afdf-41d6-bc3f-12299596db18", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-an-agent-to-transact-onchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d", "node_type": "4", "metadata": {}, "hash": "794f0748362f038436c10ec2bf53465f15c2a4fa74ae4adb9165d443384f20e5", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e5cdfb49-1780-485b-a5a1-498d6a0bd40a", "node_type": "1", "metadata": {}, "hash": "dadb3c9c0a496bd9a8de3cd7a8cce2591c8038fc09920ca31499d59cc91204cc", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5459378f-4a76-417f-a4c7-86cf1e595f06", "node_type": "1", "metadata": {}, "hash": "575d725241b3947b63cac53f1e93d6708a24a2b74d2ce8bd578b8749289f4a32", "class_name": "RelatedNodeInfo"}}, "text": "\">signature</mark>=0x9b1b413f1573da2ada426f4da99416b6081ef7246a23990c0c13d764f566083920a4b07636b7d7a582fbc3d98ad42bedc26410764a4cd2963058792121a5d63d1b](https://wapo-testnet.phala.network/ipfs/QmVJ3xknfRevUkc68iZc4RdPSLL2gLD8WagwMQCdGMyC4g?key=6978ea391960e272\\&type=verify\\&data=signedByTEE\\&signature=0x9b1b413f1573da2ada426f4da99416b6081ef7246a23990c0c13d764f566083920a4b07636b7d7a582fbc3d98ad42bedc26410764a4cd2963058792121a5d63d1b)\n*   [Send TX on Base Sepolia](https://wapo-testnet.phala.network/ipfs/QmVJ3xknfRevUkc68iZc4RdPSLL2gLD8WagwMQCdGMyC4g?key=6978ea391960e272\\&type=sendTx\\&to=0xC5227Cb20493b97bb02fADb20360fe28F52E2eff\\&gweiAmount=420)\n\n    > URL: [https://wapo-testnet.phala.network/ipfs/QmVJ3xknfRevUkc68iZc4RdPSLL2gLD8WagwMQCdGMyC4g?<mark style=\"background-color:yellow;\">key</mark>=6978ea391960e272&<mark style=\"background-color:yellow;\">type</mark>=sendTx&<mark style=\"background-color:yellow;\">to</mark>=0xC5227Cb20493b97bb02fADb20360fe28F52E2eff&<mark style=\"background-color:yellow;\">gweiAmount</mark>=420](https://wapo-testnet.phala.", "mimetype": "text/plain", "start_char_idx": 10877, "end_char_idx": 11935, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5459378f-4a76-417f-a4c7-86cf1e595f06": {"__data__": {"id_": "5459378f-4a76-417f-a4c7-86cf1e595f06", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-an-agent-to-transact-onchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d", "node_type": "4", "metadata": {}, "hash": "794f0748362f038436c10ec2bf53465f15c2a4fa74ae4adb9165d443384f20e5", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f630ecaf-afdf-41d6-bc3f-12299596db18", "node_type": "1", "metadata": {}, "hash": "34ececba3ca20aa5bc98d7728fcc29361a821f4b48bfb876649b7358c894490a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "23edfb72-841d-459a-8d92-0e5d0d2960dd", "node_type": "1", "metadata": {}, "hash": "63a02dad60a8552625d205da7f8cd0a30408caa8a67122d2db20e397b1cf7bd2", "class_name": "RelatedNodeInfo"}}, "text": "network/ipfs/QmVJ3xknfRevUkc68iZc4RdPSLL2gLD8WagwMQCdGMyC4g?key=6978ea391960e272\\&type=sendTx\\&to=0xC5227Cb20493b97bb02fADb20360fe28F52E2eff\\&gweiAmount=420)\n\n### Handling Requests\n\nCheck the [`Hono` docs](https://hono.dev/docs) for information on accessing URL `queries` or `body` from a `post` request.\n\n{% hint style=\"info\" %}\nWe recommend using @hono/tiny to avoid a large bundle size and the 20MB final artifact limitation.\n{% endhint %}\n\n**Example**\n\n```typescript\n// Access query value for a URL query named `type`\nlet queries = c.req.queries() || {}\nconst getType = (queries.type) ? queries.type[0] as string : ''\n// Access body from post request\nconst data = await c.req.json()\n```\n\n### Debugging Your Agent\n\nTo debug your agent, you can use the following command:\n\n```\ncurl https://wapo-testnet.phala.network/logs/all/ipfs/<CID>\n```\n\nAfter executing this command then you should see some output in the terminal to show the logs of requests to your agent.\n\n```\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [REPORT] END Request: Duration: 166ms\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [INFO] 'Is signature valid? ' true\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [INFO] 'Verifying Signature with PublicKey ' '0xC1BF8dB4D06416c43Aca3deB289CF7CC0aAFF540'\n2024-09-04T03:18:34.", "mimetype": "text/plain", "start_char_idx": 11935, "end_char_idx": 13280, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "23edfb72-841d-459a-8d92-0e5d0d2960dd": {"__data__": {"id_": "23edfb72-841d-459a-8d92-0e5d0d2960dd", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-an-agent-to-transact-onchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d", "node_type": "4", "metadata": {}, "hash": "794f0748362f038436c10ec2bf53465f15c2a4fa74ae4adb9165d443384f20e5", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5459378f-4a76-417f-a4c7-86cf1e595f06", "node_type": "1", "metadata": {}, "hash": "575d725241b3947b63cac53f1e93d6708a24a2b74d2ce8bd578b8749289f4a32", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "d379c656-97a0-4fcc-b684-ef1febbe9130", "node_type": "1", "metadata": {}, "hash": "9629fd0b6d24b2b2c7f655a205315bff15ba8067078a66ecf2dba35795739c31", "class_name": "RelatedNodeInfo"}}, "text": "758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd&type=verify&data=tintinland%20message%20to%20sign&signature=0x34c4d8c83406e7a292ecc940d60b34c9b11024db10a8872c753b9711cd6dbc8f746da8be9bc2ae0898ebf8f49f48c2ff4ba2a851143c3e4b371647eed32f707b1b\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [REPORT] END Request: Duration: 183ms\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [INFO] 'Signature: 0x34c4d8c83406e7a292ecc940d60b34c9b11024db10a8872c753b9711cd6dbc8f746da8be9bc2ae0898ebf8f49f48c2ff4ba2a851143c3e4b371647eed32f707b1b'\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [INFO] 'Signing data [tintinland message to sign] with Account [0xC1BF8dB4D06416c43Aca3deB289CF7CC0aAFF540]'\n2024-09-04T03:17:15.", "mimetype": "text/plain", "start_char_idx": 13280, "end_char_idx": 14131, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d379c656-97a0-4fcc-b684-ef1febbe9130": {"__data__": {"id_": "d379c656-97a0-4fcc-b684-ef1febbe9130", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-an-agent-to-transact-onchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d", "node_type": "4", "metadata": {}, "hash": "794f0748362f038436c10ec2bf53465f15c2a4fa74ae4adb9165d443384f20e5", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "23edfb72-841d-459a-8d92-0e5d0d2960dd", "node_type": "1", "metadata": {}, "hash": "63a02dad60a8552625d205da7f8cd0a30408caa8a67122d2db20e397b1cf7bd2", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5c4171f9-7173-4ebc-9493-b760a5a82490", "node_type": "1", "metadata": {}, "hash": "00b1baa99f16a84f9d706d133a2d4d77be1ee14670bedc3ae341524a86b26e88", "class_name": "RelatedNodeInfo"}}, "text": "238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd&type=sign&data=tintinland%20message%20to%20sign\n2024-09-04T03:16:38.507Z [3717d307-bff0-4fc0-bc98-8f66c33dd46f] [REPORT] END Request: Duration: 169ms\n2024-09-04T03:16:38.507Z [3717d307-bff0-4fc0-bc98-8f66c33dd46f] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd\n2024-09-04T03:15:00.375Z [793f58f9-f24f-4580-8ebc-04debb7d727f] [REPORT] END Request: Duration: 158ms\n2024-09-04T03:15:00.375Z [793f58f9-f24f-4580-8ebc-04debb7d727f] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64\na1e805bfd\n```\n\nTo create logs in your Agent Contract, you can use the following syntax in your `index.ts` file.\n\n```\n// info logs\nconsole.log('info log message!')\n// error logs\nconsole.error('error log message!')\n```\n\nFor more information check the [MDN docs](https://developer.mozilla.org/en-US/docs/Web/API/console) on `console` object.", "mimetype": "text/plain", "start_char_idx": 14131, "end_char_idx": 15190, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5c4171f9-7173-4ebc-9493-b760a5a82490": {"__data__": {"id_": "5c4171f9-7173-4ebc-9493-b760a5a82490", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-an-agent-to-transact-onchain.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d", "node_type": "4", "metadata": {}, "hash": "794f0748362f038436c10ec2bf53465f15c2a4fa74ae4adb9165d443384f20e5", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d379c656-97a0-4fcc-b684-ef1febbe9130", "node_type": "1", "metadata": {}, "hash": "9629fd0b6d24b2b2c7f655a205315bff15ba8067078a66ecf2dba35795739c31", "class_name": "RelatedNodeInfo"}}, "text": "### Run a Local Testnet With Docker\n\nRun a local testnet with [`docker` support](https://docs.docker.com/desktop/). All you need to do to get a local testnet started is run:\n\n{% hint style=\"danger\" %}\nRunning the local testnet may return an error if port **`8000`** is already in use.\n{% endhint %}\n\n```shell\nnpm run dev\n```\n\n**Make a Request to Your Local Build**\n\n```shell\n# GET request\ncurl http://127.0.0.1:8000/local\n# GET request with URL queries\ncurl http://127.0.0.1:8000/local?query1=one&query2=two\n# POST request\ncurl http://127.0.0.1:8000/local -X POST -H 'content-type: application/json' -d '{\"foo\": \"bar\"}'\n```\n\n**Add Secrets to Your Local Build**\n\n```shell\ncurl http://127.0.0.1:8000/vaults -H 'Content-Type: application/json' -d '{\"cid\": \"local\", \"data\": {\"secretKey\":\"secretValue\"}}'\n```\n\n**Check The Logs of Your Local Build**\n\n```shell\ncurl 'http://127.0.0.1:8000/logs/all/local'\n```\n\nCongratulations! You have deployed and transacted on Base Sepolia! You now have the tools to connect to any top LLM API with the RedPill Agent Contract template and perform onchain actions with the `viem` SDK.", "mimetype": "text/plain", "start_char_idx": 15192, "end_char_idx": 16304, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "916cedb9-59b7-4af5-a330-c3be641033fe": {"__data__": {"id_": "916cedb9-59b7-4af5-a330-c3be641033fe", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "036a404b-0157-4e7a-b19b-84e8af99393f", "node_type": "1", "metadata": {}, "hash": "d6bc9f9ae44a27da8a547462d477d0c7d8ed4388fe3f2862066bdb2385d4c70e", "class_name": "RelatedNodeInfo"}}, "text": "# Run Local Testnet\n\n## Overview <a href=\"#overview\" id=\"overview\"></a>\n\nIn this tutorial, we\u2019re going to set up a development environment. We are going to deploy a full stack of the core blockchain and connect the Web UI to the blockchain. By the end of the tutorial, you will be able to:\n\n* Send confidential Commands and Queries\n* Get a ready-to-hack version of Phala Network for building your confidential DApps\n\nA full Phala Network stack has three components, with an optional Javascript SDK. The core components are available at [Phala-Network/phala-blockchain](https://github.com/Phala-Network/phala-blockchain):\n\n* `phala-node`: The Substrate blockchain node\n* `pRuntime`: The TEE runtime. Contracts run in `pRuntime`\n* `pherry`: The Substrate-TEE bridge relayer. Connects the blockchain and `pRuntime`\n\n<figure><img src=\"../../.gitbook/assets/simple_architecture.png\" alt=\"\"><figcaption><p>(Phala architecture overview)</p></figcaption></figure>\n\nThe Javascript SDK is at [Phala-Network/js-sdk](https://github.com/Phala-Network/js-sdk). The Web UI based on our SDK needs to connect to both the blockchain and the `pRuntime` to send Commands and Queries.\n\n## Setting up <a href=\"#setting-up\" id=\"setting-up\"></a>\n\nIn this tutorial, we assume the operating system is **Ubuntu 22.04**. Other Linux distributions should also work, but the instructions or commands may vary. **4 cores** and **8GB RAM** is the minimal requirement to build the project including the core blockchain.\n\n{% hint style=\"warning\" %}\nThe Apple M-Series chips do not support the deployment of a local testnet at this time. If you are using a machine with these chips, you will have to deploy to the [Phala PoC6 Testnet](https://phat.phala.network/).\n{% endhint %}\n\n## Deployment Options\n\nThere are 2 ways to deploy a local testnet.\n\n1. [devPHAse](https://github.com/l00k/devphase) or [Swanky Phala](https://github.com/Phala-Network/swanky-plugin-phala) CLI Tools\n2.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1945, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "036a404b-0157-4e7a-b19b-84e8af99393f": {"__data__": {"id_": "036a404b-0157-4e7a-b19b-84e8af99393f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "916cedb9-59b7-4af5-a330-c3be641033fe", "node_type": "1", "metadata": {}, "hash": "99514fcbcd329900200ff727014e5e73c0865a1768912ffe3d53018e9a9e8e21", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "beb3e9a2-6e48-4ac8-8ce0-ccdedd4beaa7", "node_type": "1", "metadata": {}, "hash": "92ec1de4b1acc7577dd26740b09cbecb3d47ad2aa211554dd1e200c324aadba9", "class_name": "RelatedNodeInfo"}}, "text": "Build from Source (Most time-consuming)\n\n## Environment Setup\n\nMake sure to go through the environment setup before continuing.\n\nNext, install the following on your system:\n\n* [GCC](https://gcc.gnu.org/)\n* [Protobuf](https://github.com/protocolbuffers/protobuf) compiler\n* [pkg-config](https://www.freedesktop.org/wiki/Software/pkg-config)\n* [OpenSSL](https://www.openssl.org/) development package\n\n{% tabs %}\n{% tab title=\"apt\" %}\n```bash\nsudo apt install -y build-essential pkg-config libssl-dev protobuf-compiler\n```\n{% endtab %}\n\n{% tab title=\"dnf\" %}\n```bash\nsudo dnf install -y gcc protobuf-compiler pkg-config openssl-devel openssl1.1\n```\n{% endtab %}\n{% endtabs %}\n\n## Deploy via devPHAse\n\nIn this section, you will deploy your local testnet using the DevPHAse CLI Tool. First, you will need to create a new workspace folder on your system and execute the following:\n\n{% hint style=\"warning\" %}\nWhen using `npm`, you will see conflicting/duplicated packages. `yarn` will not have these errors. Until this problem is solved, it is best to use `yarn`.\n{% endhint %}\n\n{% hint style=\"danger\" %}\nCurrently, `npm` and `npx` commands do not work and will report an error `invalid format for V0 (detected) contract metadata`. Opt to use `yarn` until the problem is resolved.", "mimetype": "text/plain", "start_char_idx": 1946, "end_char_idx": 3220, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "beb3e9a2-6e48-4ac8-8ce0-ccdedd4beaa7": {"__data__": {"id_": "beb3e9a2-6e48-4ac8-8ce0-ccdedd4beaa7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "036a404b-0157-4e7a-b19b-84e8af99393f", "node_type": "1", "metadata": {}, "hash": "d6bc9f9ae44a27da8a547462d477d0c7d8ed4388fe3f2862066bdb2385d4c70e", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "2fadb61f-5412-46b7-a52f-ab009ab80dc7", "node_type": "1", "metadata": {}, "hash": "d2690ceb734153215c96de9929f7d0a5b026b3b79f8e8385c255e00256e58a21", "class_name": "RelatedNodeInfo"}}, "text": "{% endhint %}\n\n### 1) Install devPHAse and required libs\n\n{% tabs %}\n{% tab title=\"yarn\" %}\n```bash\nyarn init\nyarn add -D typescript ts-node\nyarn add -D @devphase/cli\nyarn add -D @devphase/service\n```\n{% endtab %}\n\n{% tab title=\"npm\" %}\n```bash\nnpm init\nnpm install -D typescript ts-node\nnpm install -D @devphase/cli\nnpm install -D @devphase/service\n```\n{% endtab %}\n{% endtabs %}\n\n### 2) Init project\n\n{% tabs %}\n{% tab title=\"yarn\" %}\n```bash\nyarn devphase init\n```\n{% endtab %}\n\n{% tab title=\"npx\" %}\n```bash\nnpx devphase init\n```\n{% endtab %}\n{% endtabs %}\n\nYour directory will be initiated with all required files and template Flipper contract.\n\n```\n- .devphase/        # devPHAse cache directory\n- contracts/        # here you store your contracts\n    - flipper/          # template Flipper contract\n        - Cargo.toml        # rust project file\n        - lib.rs            # contract source\n- scripts/          # scripts which you can all with devPHAse environment\n    - deploy.ts         # sample deployment script\n    - get-logs.ts       # sample demonstrating how to get contract logs\n- tests/            # here you store e2e tests for contracts\n    - flipper/          # flipper related test suite\n        - flipper.test.ts   # flipper tests example\n```\n\n### 3) Prepare environment\n\n{% tabs %}\n{% tab title=\"yarn\" %}\n```bash\nyarn devphase check\n```\n{% endtab %}\n\n{% tab title=\"npx\" %}\n```bash\nnpx devphase check\n```\n{% endtab %}\n{% endtabs %}\n\nThis command will ensure the proper stack (node, pruntime, pherry) is ready to run. Download stack from official repository. Verify dependencies.", "mimetype": "text/plain", "start_char_idx": 3221, "end_char_idx": 4823, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "2fadb61f-5412-46b7-a52f-ab009ab80dc7": {"__data__": {"id_": "2fadb61f-5412-46b7-a52f-ab009ab80dc7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "beb3e9a2-6e48-4ac8-8ce0-ccdedd4beaa7", "node_type": "1", "metadata": {}, "hash": "92ec1de4b1acc7577dd26740b09cbecb3d47ad2aa211554dd1e200c324aadba9", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "e7012b03-0f7a-4348-b6f5-c0fda88c531a", "node_type": "1", "metadata": {}, "hash": "9177f1fadd123fdb175806945a11b0e0444986dc1b43fa5025f0dfda9bcca517", "class_name": "RelatedNodeInfo"}}, "text": "#### Output:\n\n{% tabs %}\n{% tab title=\"yarn\" %}\n```bash\nyarn devphase check\n[StackBinaryDownloader] Creating stack directory\n  \u2714 Checking configuration file\n  \u2714 Check dependencies\n  \u2714 Checking Phala stack binaries\n```\n{% endtab %}\n\n{% tab title=\"npx\" %}\n```bash\nnpx devphase check\n[StackBinaryDownloader] Creating stack directory\n  \u2714 Checking configuration file\n  \u2714 Check dependencies\n  \u2714 Checking Phala stack binaries\n```\n{% endtab %}\n{% endtabs %}\n\nYou will see a new directory called `stacks/` has been created\n\n```\n- stacks/                 # here all prepared stacks will be stored\n  - nightly-2024-03-07/     # bases on your configuration it will latest available stack or any specific you choose\n      - phala-node            # node binary\n      - pherry                # pherry binary\n      - pruntime              # pruntime binary\n      - *.so.*                # multiple requried libs\n      - *.contract            # system contracts\n```\n\nNow you are ready to go.\n\n### 4) Compile contract\n\n{% tabs %}\n{% tab title=\"yarn\" %}\n```bash\nyarn devphase contract compile -c flipper\n```\n{% endtab %}\n\n{% tab title=\"npx\" %}\n```bash\nnpx devphase contract compile -c flipper\n```\n{% endtab %}\n{% endtabs %}\n\n#### Output:\n\n{% tabs %}\n{% tab title=\"yarn\" %}\n```bash\nyarn devphase contract compile -c flipper\n[MultiContractExecutor] Criteria: flipper\n[MultiContractExecutor] Matched contracts:\n[MultiContractExecutor] flipper\n[MultiContractExecutor]\n  \u276f flipper\n  \u2714 flipper\nDone in 32.49s.", "mimetype": "text/plain", "start_char_idx": 4825, "end_char_idx": 6309, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e7012b03-0f7a-4348-b6f5-c0fda88c531a": {"__data__": {"id_": "e7012b03-0f7a-4348-b6f5-c0fda88c531a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "2fadb61f-5412-46b7-a52f-ab009ab80dc7", "node_type": "1", "metadata": {}, "hash": "d2690ceb734153215c96de9929f7d0a5b026b3b79f8e8385c255e00256e58a21", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "32d723dd-658d-4d97-86c6-aaedef55abe0", "node_type": "1", "metadata": {}, "hash": "7618724fad48abe5fef577729e1de7453d529a3c0cecd043cd0fa5bd82b45c3f", "class_name": "RelatedNodeInfo"}}, "text": "```\n{% endtab %}\n\n{% tab title=\"npx\" %}\n```bash\nnpx devphase contract compile -c flipper\n[MultiContractExecutor] Criteria: flipper\n[MultiContractExecutor] Matched contracts:\n[MultiContractExecutor] flipper\n[MultiContractExecutor]\n  \u276f flipper\n  \u2714 flipper\n```\n{% endtab %}\n{% endtabs %}\n\nThis command will:\n\n* install contract dependencies\n* compile contract (only flipper in this case) and save output to ./contracts/flipper/target\n* copy contract artificats\n* generate typescript bindings which you can use in scripts and tests\n\nNew files:\n\n```\n- artifacts/            # here devPHAse will store compiled contract artifacts\n  - flipper/              # specific contract\n    - flipper.contract\n    - flipper.json\n    - flipper.wasm\n- typings/              # here devPHAse will store ts bindings\n  - Flipper.ts\n```\n\n### 5) Run tests\n\n{% hint style=\"danger\" %}\nCurrently, `npm` and `npx` commands do not work and will report an error `invalid format for V0 (detected) contract metadata`. Opt to use `yarn` until the problem is resolved.\n{% endhint %}\n\n{% tabs %}\n{% tab title=\"yarn w/o logger\" %}\n```bash\nyarn devphase contract test -t flipper\n```\n{% endtab %}\n\n{% tab title=\"yarn w/ logger\" %}\n```bash\nyarn devphase contract test -t flipper -m 3\n```\n{% endtab %}\n\n{% tab title=\"npx w/o logger \" %}\n```bash\nnpx devphase contract test -t flipper\n```\n{% endtab %}\n\n{% tab title=\"npx w/ logger\" %}\n```basic\nyarn devphase contract test -t flipper -m 3\n```\n{% endtab %}\n{% endtabs %}\n\ndevPHAse in default config will:\n\n* check stack dependencies\n* start local stack\n* configure local environment (with minimal required deps)\n* execute tests\n* save logs into files\n\n#### Output:\n\n{% tabs %}\n{% tab title=\"yarn w/o logger\" %}\n```bash\nyarn devphase contract test -t flipper\n[StackBinaryDownloader] Preparing Phala stack release", "mimetype": "text/plain", "start_char_idx": 6310, "end_char_idx": 8126, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "32d723dd-658d-4d97-86c6-aaedef55abe0": {"__data__": {"id_": "32d723dd-658d-4d97-86c6-aaedef55abe0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e7012b03-0f7a-4348-b6f5-c0fda88c531a", "node_type": "1", "metadata": {}, "hash": "9177f1fadd123fdb175806945a11b0e0444986dc1b43fa5025f0dfda9bcca517", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "25f3601c-0e0e-470a-ae9b-ee7c4829d354", "node_type": "1", "metadata": {}, "hash": "888da603d66adc8ab9138e2d36ad9714d526433610b40e05c8da06e7d53c4771", "class_name": "RelatedNodeInfo"}}, "text": "nightly-2024-03-13\n  \u2714 Checking releases directory\n  \u2714 Checking target release binaries\n \n \n[Test] Global setup start\n[Test] Preparing dev stack\n[StackManager] Starting stack nightly-2024-03-13\n  \u2714 Start node component\n  \u2714 Start pRuntime component\n  \u2714 Start pherry component\n[Test] Init API\n[Test] Setup environment\n[StackSetupService] Starting stack setup with default version\n  \u2714 Fetch worker info\n  \u2714 Load system contracts\n  \u2193 Register worker [skipped]\n  \u2714 Register gatekeeper\n  \u2714 Upload Pink system code\n  \u2714 Verify cluster\n  \u2714 Create cluster\n  \u2714 Wait for cluster to be ready\n  \u2714 Add worker endpoint\n  \u2714 Create system contract API\n[Test] Global setup done\n[Test] Starting tests\n  Flipper\n    default constructor\n      \u2714 Should be created with proper intial value\n      \u2714 Should be able to flip value (2572ms)\n    new constructor\n      \u2714 Should be created with proper intial value\n \n[Test] Global teardown start\n[Test] Internal clean up\n[Test] Stopping stack\n[Test] Global teardown done\n \n  3 passing (27s)\n \n[StackManager] pherry exited\n[StackManager] pruntime exited\n[StackManager] node exited\nDone in 33.00s.", "mimetype": "text/plain", "start_char_idx": 8127, "end_char_idx": 9240, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "25f3601c-0e0e-470a-ae9b-ee7c4829d354": {"__data__": {"id_": "25f3601c-0e0e-470a-ae9b-ee7c4829d354", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "32d723dd-658d-4d97-86c6-aaedef55abe0", "node_type": "1", "metadata": {}, "hash": "7618724fad48abe5fef577729e1de7453d529a3c0cecd043cd0fa5bd82b45c3f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "15638d57-4af8-4ed9-9d50-a8759dfff94c", "node_type": "1", "metadata": {}, "hash": "7ec813fff9a33ce9f6a851559344ec7664b07f456c49b6c486d13dc0933d6906", "class_name": "RelatedNodeInfo"}}, "text": "```\n{% endtab %}\n\n{% tab title=\"yarn w/ logger\" %}\n```bash\nyarn devphase contract test -t flipper -m 3\n[StackBinaryDownloader] Preparing Phala stack release nightly-2024-03-13\n  \u2714 Checking releases directory\n  \u2714 Checking target release binaries\n \n \n[Test] Global setup start\n[Test] Preparing dev stack\n[StackManager] Starting stack nightly-2024-03-13\n  \u2714 Start node component\n  \u2714 Start pRuntime component\n  \u2714 Start pherry component\n[Test] Init API\n[Test] Setup environment\n[StackSetupService] Starting stack setup with default version\n  \u2714 Fetch worker info\n  \u2714 Load system contracts\n  \u2193 Register worker [skipped]\n  \u2714 Register gatekeeper\n  \u2714 Upload Pink system code\n  \u2714 Verify cluster\n  \u2714 Create cluster\n  \u2714 Wait for cluster to be ready\n  \u2714 Add worker endpoint\n  \u2714 Create system contract API\n  \u2714 Deploy tokenomic driver\n  \u2714 Deploy SideVM driver\n  \u2714 Calculate logger server contract ID\n  \u2714 Prepare chain for logger server\n  \u2714 Deploy logger server\n[Test] Global setup done\n[Test] Starting tests\n  Flipper\n    default constructor\n      \u2714 Should be created with proper intial value\nLogs from pink server:\n#366\tTX\tinfo\t\tResource uploaded to cluster, by 8eaf04151687736326c9fea17e25fc5287613693c912909cb226aa4794f26a48 (5FHneW46.), type=InkCode,", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "15638d57-4af8-4ed9-9d50-a8759dfff94c": {"__data__": {"id_": "15638d57-4af8-4ed9-9d50-a8759dfff94c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "25f3601c-0e0e-470a-ae9b-ee7c4829d354", "node_type": "1", "metadata": {}, "hash": "888da603d66adc8ab9138e2d36ad9714d526433610b40e05c8da06e7d53c4771", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "18724a23-da86-41b9-8ef1-11c2aab37b8e", "node_type": "1", "metadata": {}, "hash": "060133becba9a16ad371b4ef69ac68e7133afab25904a603d55d3e4bd092b71c", "class_name": "RelatedNodeInfo"}}, "text": "hash=0xcbf8151426f6ce308a875a1c5cc6e2a4f4c0bca3be4371a15b0d25bcca336f55\n#376\tEST\tinfo\t\tinstantiated\n#392\tTX\tinfo\t\tinstantiated\n      \u2714 Should be able to flip value (2636ms)\nLogs from pink server:\n#402\tEST\tinfo\t\tinstantiated\n#422\tTX\tinfo\t\tinstantiated\n    new constructor\n      \u2714 Should be created with proper intial value\nLogs from pink server:\n#456\tEST\tinfo\t\tinstantiated\n#473\tTX\tinfo\t\tinstantiated\n \n[Test] Global teardown start\n[Test] Internal clean up\n[Test] Stopping stack\n[Test] Global teardown done\n \n  3 passing (54s)\n \n[StackManager] pherry exited\n[StackManager] pruntime exited\n[StackManager] node exited\nDone in 59.67s.\n```\n{% endtab %}\n{% endtabs %}\n\nNew directories created for logs.\n\n```\n- logs/             # here devPHAse will store execution logs\n  - 2024-03-07T16:09:43.421Z/     # single execution\n    - node.log\n    - pherry.log\n    - pruntime.log\n    - pink_logger.log               # if stack setup with logger here all logs will be stored\n```\n\nRunning tests this way is nice but only if it is single execution. If you are developing new feature it may be required to continuously test it. In this case default procedure is time-consuming, because setting up stack takes \\~40s.\n\nNothing blocks you from using the same running node for multiple tests.\n\n### 6) Long-running local environment\n\nThis command will start and keep running all stack components. However, network is not configured yet to accept contracts.\n\n{% hint style=\"danger\" %}\nCurrently, `npm` and `npx` commands do not work and will report an error `invalid format for V0 (detected) contract metadata`. Opt to use `yarn` until the problem is resolved.", "mimetype": "text/plain", "start_char_idx": 10482, "end_char_idx": 12120, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "18724a23-da86-41b9-8ef1-11c2aab37b8e": {"__data__": {"id_": "18724a23-da86-41b9-8ef1-11c2aab37b8e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "15638d57-4af8-4ed9-9d50-a8759dfff94c", "node_type": "1", "metadata": {}, "hash": "7ec813fff9a33ce9f6a851559344ec7664b07f456c49b6c486d13dc0933d6906", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "6a160a87-441b-45a3-97d1-2182cc6ff195", "node_type": "1", "metadata": {}, "hash": "7670ab9fba968822f2df4a8e1acee01809085c1d179b87e1cbcd3b7d51ba75bc", "class_name": "RelatedNodeInfo"}}, "text": "{% endhint %}\n\n{% tabs %}\n{% tab title=\"yarn\" %}\n```bash\nyarn devphase stack run --save-logs\n```\n{% endtab %}\n\n{% tab title=\"npx\" %}\n```bash\nnpx devphase stack run --save-logs\n```\n{% endtab %}\n{% endtabs %}\n\n### 7) Configure network\n\nNow let's configure the network to enable your local environment to deploy a Phat Contract and collect logs.\n\n{% hint style=\"danger\" %}\nCurrently, `npm` and `npx` commands do not work and will report an error `invalid format for V0 (detected) contract metadata`. Opt to use `yarn` until the problem is resolved.\n{% endhint %}\n\n{% tabs %}\n{% tab title=\"yarn\" %}\n```bash\nyarn devphase stack setup -m 3\n```\n{% endtab %}\n\n{% tab title=\"npx\" %}\n```bash\nnpx devphase stack setup -m 3\n```\n{% endtab %}\n{% endtabs %}\n\n#### Output:\n\n```bash\nyarn devphase stack setup -m 3\n[StackSetupService] Starting stack setup with default version\n  \u2714 Fetch worker info\n  \u2714 Load system contracts\n  \u2193 Register worker [skipped]\n  \u2714 Register gatekeeper\n  \u2714 Upload Pink system code\n  \u2714 Verify cluster\n  \u2714 Create cluster\n  \u2714 Wait for cluster to be ready\n  \u2714 Add worker endpoint\n  \u2714 Create system contract API\n  \u2714 Deploy tokenomic driver\n  \u2714 Deploy SideVM driver\n  \u2714 Calculate logger server contract ID\n  \u2714 Prepare chain for logger server\n  \u2714 Deploy logger server\n[StackSetup] Stack is ready\n[StackSetup] Cluster Id\n[StackSetup] 0x0000000000000000000000000000000000000000000000000000000000000001\nDone in 38.52s.\n```\n\nNow all required network components should be ready for Phat Contract deployment.\n\n### 8) Run tests using long-running local environment\n\n`-e` flag will make devPHAse to execute test without setting up temporary stack but using existing one.\n\n{% hint style=\"danger\" %}\nCurrently, `npm` and `npx` commands do not work and will report an error `invalid format for V0 (detected) contract metadata`.", "mimetype": "text/plain", "start_char_idx": 12121, "end_char_idx": 13938, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6a160a87-441b-45a3-97d1-2182cc6ff195": {"__data__": {"id_": "6a160a87-441b-45a3-97d1-2182cc6ff195", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "18724a23-da86-41b9-8ef1-11c2aab37b8e", "node_type": "1", "metadata": {}, "hash": "060133becba9a16ad371b4ef69ac68e7133afab25904a603d55d3e4bd092b71c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "e4ea2dc6-9213-48c6-b0e0-2d7fa77a3c69", "node_type": "1", "metadata": {}, "hash": "84d691162304342a3a630bede6c1c024c6afab3c66f53c2d47cc039c39051578", "class_name": "RelatedNodeInfo"}}, "text": "Opt to use `yarn` until the problem is resolved.\n{% endhint %}\n\n{% tabs %}\n{% tab title=\"yarn\" %}\n```bash\nyarn devphase contract test -t flipper -e\n```\n{% endtab %}\n\n{% tab title=\"npx\" %}\n```bash\nnpx devphase contract test -t flipper -e\n```\n{% endtab %}\n{% endtabs %}\n\n#### Output:\n\n```bash\nyarn devphase contract test -t flipper -e\n[Test] Global setup start\n[Test] Init API\n[Test] Setup environment\n[StackSetupService] Starting stack setup with default version\n  \u2714 Fetch worker info\n  \u2714 Load system contracts\n  \u2193 Register worker [skipped]\n  \u2193 Register gatekeeper [skipped]\n  \u2193 Upload Pink system code [skipped]\n  \u2714 Verify cluster\n  \u2193 Create cluster [skipped]\n  \u2714 Wait for cluster to be ready\n  \u2193 Add worker endpoint [skipped]\n  \u2714 Create system contract API\n[Test] Global setup done\n[Test] Starting tests\n  Flipper\n    default constructor\n      \u2714 Should be created with proper intial value\nLogs from pink server:\n#996\tTX\tinfo\t\tResource uploaded to cluster, by 8eaf04151687736326c9fea17e25fc5287613693c912909cb226aa4794f26a48 (5FHneW46...), type=InkCode, hash=0xcbf8151426f6ce308a875a1c5cc6e2a4f4c0bca3be4371a15b0d25bcca336f55\n#999\tEST\tinfo\t\tinstantiated\n#1007\tTX\tinfo\t\tinstantiated\n      \u2714 Should be able to flip value (2390ms)\nLogs from pink server:\n#1009\tEST\tinfo\t\tinstantiated\n#1021\tTX\tinfo\t\tinstantiated\n    new constructor\n      \u2714 Should be created with proper intial value\nLogs from pink server:\n#1036\tEST\tinfo\t\tinstantiated\n#1044\tTX\tinfo\t\tinstantiated\n \n[Test] Global teardown start\n[Test] Internal clean up\n[Test] Global teardown done\n \n  3 passing (18s)\n \nDone in 24.33s.", "mimetype": "text/plain", "start_char_idx": 13939, "end_char_idx": 15519, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e4ea2dc6-9213-48c6-b0e0-2d7fa77a3c69": {"__data__": {"id_": "e4ea2dc6-9213-48c6-b0e0-2d7fa77a3c69", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "6a160a87-441b-45a3-97d1-2182cc6ff195", "node_type": "1", "metadata": {}, "hash": "7670ab9fba968822f2df4a8e1acee01809085c1d179b87e1cbcd3b7d51ba75bc", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "bdcdda2d-ced1-419a-88cb-f1b05261ed33", "node_type": "1", "metadata": {}, "hash": "2c133347f604c1a0147dfa348354c1c38de97284cc2851693a1e40a99dbfc1f6", "class_name": "RelatedNodeInfo"}}, "text": "```\n\n### 9) Running Scripts\n\nDevPHAse will run script on specified environment. If environment provides a PinkLogger - logs will be saved locally.\n\n{% tabs %}\n{% tab title=\"yarn\" %}\n```bash\nyarn devphase script scripts/deploy.ts\n```\n{% endtab %}\n\n{% tab title=\"npx\" %}\n```bash\nnpx devphase script scripts/deploy.ts\n```\n{% endtab %}\n{% endtabs %}\n\n#### Output:\n\n```bash\nyarn devphase script scripts/deploy.ts\n[Script] Executing /home/hashwarlock/Templates/YarnTest/scripts/deploy.ts\nContract ID: 0x8e132d6bdebe37824b31df98669063d52d25d7eb0c40358c7f0e47876bc8a879\n{ Ok: false }\n{\n  Finalized: '0xda06fe993f51260a4bd726d721ae34ec7d1b939cb9a425a0dd4fd9c24831d023'\n}\n{ Ok: true }\nDone in 9.62s.\n```\n\n**Get logs locally**\n\nUsing the contract ID from the previous script `0x8e132d6bdebe37824b31df98669063d52d25d7eb0c40358c7f0e47876bc8a879` modify contractIds variable in `scripts/get-logs.ts` then execute the script to get logs.\n\n{% tabs %}\n{% tab title=\"yarn\" %}\n```bash\nyarn devphase script scripts/get-logs.ts\n```\n{% endtab %}\n\n{% tab title=\"npx\" %}\n```bash\nnpx devphase script scripts/get-logs.ts\n```\n{% endtab %}\n{% endtabs %}\n\n#### Output:\n\n```bash\nyarn devphase script scripts/get-logs.ts\n[Script] Executing /home/hashwarlock/Templates/YarnTest/scripts/get-logs.ts\n0x8e132d6bdebe37824b31df98669063d52d25d7eb0c40358c7f0e47876bc8a879\n[\n  {\n    sequence: 50,\n    type: 'Log',\n    blockNumber: 1714,", "mimetype": "text/plain", "start_char_idx": 15520, "end_char_idx": 16916, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "bdcdda2d-ced1-419a-88cb-f1b05261ed33": {"__data__": {"id_": "bdcdda2d-ced1-419a-88cb-f1b05261ed33", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e4ea2dc6-9213-48c6-b0e0-2d7fa77a3c69", "node_type": "1", "metadata": {}, "hash": "84d691162304342a3a630bede6c1c024c6afab3c66f53c2d47cc039c39051578", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b9a09de8-305e-4adb-9bf1-51853322f1a4", "node_type": "1", "metadata": {}, "hash": "9aba5592a7b094616696bfcc6913ecbe86f0c8373f1f1c1e28761269007b61d4", "class_name": "RelatedNodeInfo"}}, "text": "contract: '0x8e132d6bdebe37824b31df98669063d52d25d7eb0c40358c7f0e47876bc8a879',\n    entry: '0x8e132d6bdebe37824b31df98669063d52d25d7eb0c40358c7f0e47876bc8a879',\n    execMode: 'transaction',\n    timestamp: 2024-03-14T05:40:24.365Z,\n    level: 3,\n    message: 'instantiated'\n  },\n  {\n    sequence: 55,\n    type: 'MessageOutput',\n    blockNumber: 1723,\n    origin: '0xd43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d',\n    contract: '0x8e132d6bdebe37824b31df98669063d52d25d7eb0c40358c7f0e47876bc8a879',\n    nonce: '0xacac9d33a106f1051887b243f82755276d8443c070fb4c9987018674cbbe478b',\n    output: {\n      gasConsumed: { refTime: 440059308, proofSize: 67027 },\n      gasRequired: { refTime: 65728937984, proofSize: 10485760 },\n      storageDeposit: { charge: 0 },\n      debugMessage: '',\n      result: { ok: { flags: [], data: '0x00' } }\n    }\n  }\n]\n```\n\n### 10) Run devPHAse on PoC6 Testnet or Phala Mainnet\n\nYou can specify to run commands on any network - including PoC6 Testnet or Phala Mainnet. Check commands help for further details.", "mimetype": "text/plain", "start_char_idx": 16921, "end_char_idx": 17972, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b9a09de8-305e-4adb-9bf1-51853322f1a4": {"__data__": {"id_": "b9a09de8-305e-4adb-9bf1-51853322f1a4", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "bdcdda2d-ced1-419a-88cb-f1b05261ed33", "node_type": "1", "metadata": {}, "hash": "2c133347f604c1a0147dfa348354c1c38de97284cc2851693a1e40a99dbfc1f6", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "37d928c1-1a36-4090-9784-c7a165337c09", "node_type": "1", "metadata": {}, "hash": "796c449a459d7bcbfc338b149184f96da0a35d9ba7dc05854bacf9ef903dadc6", "class_name": "RelatedNodeInfo"}}, "text": "#### Deploy contract command\n\n{% tabs %}\n{% tab title=\"yarn\" %}\n```bash\nyarn devphase help contract deploy\n```\n{% endtab %}\n\n{% tab title=\"npx\" %}\n```bash\nnpx devphase help contract deploy\n```\n{% endtab %}\n{% endtabs %}\n\n#### Output:\n\n```bash\nDeploy contract\n \nUSAGE\n  $ devphase contract deploy [ARGS] -c <value> -o <value> [-t InkCode|SidevmCode|IndeterministicInkCode] [-n\n    <value>] [-l <value>] [-a <value>]\n \nARGUMENTS\n  ARGS  Constructor arguments\n \nFLAGS\n  -a, --account=<value>   [default: alice] Account used to deploy (managed account key)\n  -c, --contract=<value>  (required) Contract name\n  -l, --cluster=<value>   Target cluster Id\n  -n, --network=<value>   [default: local] Target network to deploy (local default)\n  -o, --ctor=<value>      (required) Contract constructor to call (name)\n  -t, --type=<option>     [default: InkCode]\n                          <options: InkCode|SidevmCode|IndeterministicInkCode>\n \nDone in 0.99s.\n```\n\n#### Call contract command\n\n{% tabs %}\n{% tab title=\"yarn\" %}\n```bash\nyarn devphase help contract call\n```\n{% endtab %}\n\n{% tab title=\"npx\" %}\n```bash\nnpx devphase help contract call\n```\n{% endtab %}\n{% endtabs %}\n\n#### Output:\n\n```bash\nCall contract\n \nUSAGE\n  $ devphase contract call [ARGS] -c <value> -i <value> -m <value> [-t InkCode|SidevmCode|IndeterministicInkCode]\n    [-a query|tx] [-n <value>] [-l <value>] [-a <value>]\n \nARGUMENTS\n  ARGS  Call arguments\n \nFLAGS\n  -a, --accessor=<option>  [default: query] Method type: transaction or query\n                           <options: query|tx>\n  -a, --account=<value>    [default: alice] Account used to call (managed account key)\n  -c,", "mimetype": "text/plain", "start_char_idx": 17974, "end_char_idx": 19615, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "37d928c1-1a36-4090-9784-c7a165337c09": {"__data__": {"id_": "37d928c1-1a36-4090-9784-c7a165337c09", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b9a09de8-305e-4adb-9bf1-51853322f1a4", "node_type": "1", "metadata": {}, "hash": "9aba5592a7b094616696bfcc6913ecbe86f0c8373f1f1c1e28761269007b61d4", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c06b2168-0ccf-439d-9fb7-574f1847abf1", "node_type": "1", "metadata": {}, "hash": "e1d8289bd667ef306da17bb9c62dfef8d6a26230a24cd6d08c37ca6c8f476391", "class_name": "RelatedNodeInfo"}}, "text": "--contract=<value>   (required) Contract name\n  -i, --id=<value>         (required) Contract ID\n  -l, --cluster=<value>    Target cluster Id\n  -m, --method=<value>     (required) Contract method to call (name)\n  -n, --network=<value>    [default: local] Target network to deploy (local default)\n  -t, --type=<option>      [default: InkCode]\n                           <options: InkCode|SidevmCode|IndeterministicInkCode>\n \nDone in 1.00s\n```\n\n## Build from source <a href=\"#build-from-source\" id=\"build-from-source\"></a>\n\nThe Phala-Network/phala-blockchain repository always contains [the latest build instructions](https://github.com/Phala-Network/phala-blockchain#native-build), at the time of writing (December 26, 2022), we use the following commands to set up development environment:\n\n```\n# First clone the repository\ngit clone https://github.com/Phala-Network/phala-blockchain.git\n# Change to the repository directory\ncd phala-blockchain\n# Install system dependencies:\nsudo apt install -y build-essential pkg-config libssl-dev protobuf-compiler\n# Install Rust\ncurl https://sh.rustup.rs -sSf | sh\n# Install dependencies for Substrate development\ngit submodule update --init\nsh ./scripts/init.sh\n# Installl LLVM 14\nwget https://apt.llvm.org/llvm.sh\nchmod +x llvm.sh\n./llvm.sh 14\n```\n\nThen run the following command to build the Phala blockchain:\n\n```\ncargo build --release\n```\n\nIt takes approximately 20 minutes to complete the building process on a laptop equipped with an AMD Ryzen 7 4700U processor with 8 cores, 8 threads, and 32GB of RAM.\n\n### Start the local testnet <a href=\"#start-the-local-testnet\" id=\"start-the-local-testnet\"></a>\n\nWe have a dedicate set of scripts to get the blockchain to run, checkout out [this page](https://github.com/Phala-Network/phala-blockchain/tree/master/scripts/run) for full details.", "mimetype": "text/plain", "start_char_idx": 19616, "end_char_idx": 21444, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c06b2168-0ccf-439d-9fb7-574f1847abf1": {"__data__": {"id_": "c06b2168-0ccf-439d-9fb7-574f1847abf1", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "37d928c1-1a36-4090-9784-c7a165337c09", "node_type": "1", "metadata": {}, "hash": "796c449a459d7bcbfc338b149184f96da0a35d9ba7dc05854bacf9ef903dadc6", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "45d60209-50a1-4fae-935e-2a098a3d8517", "node_type": "1", "metadata": {}, "hash": "5ec653d2f98c3862368c65e95484f0a458be8818aa761a5fa1586ceab0402226", "class_name": "RelatedNodeInfo"}}, "text": "For simplicity we can start as simple as follows:\n\nWe might want to clean up runtime data to have to clean starting environment, from the root of the `phala-blockchain` project, run this to clean things up:\n\n```\n./scripts/run/clear-pruntime.sh\n```\n\nThen go ahead and run these 3 commands in 3 separate terminals:\n\n```\n./scripts/run/node.sh\n./scripts/run/pruntime.sh\n./scripts/run/pherry.sh\n```\n\nNow you have a full node at [ws://localhost:19944](ws://localhost:19944/), and the pruntime is at [http://localhost:18000](http://localhost:18000/).\n\nAfter you start the node and the pruntime, you need set up Phat Contract environment once. This can be done with our [phala-blockchain-setup repo](https://github.com/shelvenzhou/phala-blockchain-setup):\n\n```\ngit clone https://github.com/shelvenzhou/phala-blockchain-setup.git\ncd phala-blockchain-setup\nyarn\n\nENDPOINT=ws://localhost:19944 \\\nWORKERS=http://localhost:18000 \\\nGKS=http://localhost:18000 \\\nyarn setup:drivers\n```\n\nAfter all, you testnet is ready. You can continue with the [Connect the polkadot app to the local testnet](../../developers/advanced-topics/broken-reference/) section.\n\n## Connect the Phat UI to the local testnet <a href=\"#connect-the-phat-ui-to-the-local-testnet\" id=\"connect-the-phat-ui-to-the-local-testnet\"></a>\n\nWe have a client-side application at [https://phat.phala.network/](https://phat.phala.network/), you can follow the instructions from [Phat Contract Console](../../.gitbook/assets/awesome%20phat%20contracts%20\\(2\\)/) to connect the application to the local testnet.\n\n<figure><img src=\"../../.gitbook/assets/phat-ui-to-testnet.png\" alt=\"\"><figcaption></figcaption></figure>\n\nAs the above figure shows, we first click the green dot at the upper-right cornor to set the `RPC Endpoint` to `ws://localhost:19944`, or `ws://localhost:9944` if you start the chain via the devPHAse approach, and change the PRuntime field accordingly.", "mimetype": "text/plain", "start_char_idx": 21445, "end_char_idx": 23359, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "45d60209-50a1-4fae-935e-2a098a3d8517": {"__data__": {"id_": "45d60209-50a1-4fae-935e-2a098a3d8517", "embedding": null, "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6bef3dec-1708-4401-95b3-264644cf7b21", "node_type": "4", "metadata": {}, "hash": "9a846be0a24447db5ca950100d1dc7cfe6262893afc809cc32fcf427cb1c2bd9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c06b2168-0ccf-439d-9fb7-574f1847abf1", "node_type": "1", "metadata": {}, "hash": "e1d8289bd667ef306da17bb9c62dfef8d6a26230a24cd6d08c37ca6c8f476391", "class_name": "RelatedNodeInfo"}}, "text": "Don\u2019t forget to claim some `Test-PHA`s, they\u2019re required to deploy Phat Contracts and send transactions.\n\n## Connect the polkadot app to the local testnet <a href=\"#connect-the-polkadot-app-to-the-local-testnet\" id=\"connect-the-polkadot-app-to-the-local-testnet\"></a>\n\nOpen up [https://polkadot.js.org/apps](https://polkadot.js.org/apps/#/explorer), click the upper-left corner to call forth the endpoint setup menu:\n\n<figure><img src=\"../../.gitbook/assets/phat-ui-to-polkadot-app.png\" alt=\"\"><figcaption></figcaption></figure>\n\nSet the field `custom endpoint` to `ws://localhost:9944` and then click the `switch` button to connect to it.\n\nCongratulations! Now you have a fully qualified local development environment!", "mimetype": "text/plain", "start_char_idx": 23361, "end_char_idx": 24080, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "33f73c7f-2bbd-454a-854c-1318b0856064": {"__data__": {"id_": "33f73c7f-2bbd-454a-854c-1318b0856064", "embedding": null, "metadata": {"file_path": "phala-docs_dist/use-rust-crates.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e23c6654-98ae-4eab-acc7-1a0823e295ab", "node_type": "4", "metadata": {}, "hash": "e178f20b7280f2aea9483b407e14eb5f665552059dc6068c7119f06cc390a6f6", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f2d423d2-0987-4134-a327-366b240a25c0", "node_type": "1", "metadata": {}, "hash": "3683e7e2a9b791a0e778c1078d6f046aa3e674ca6d0f838db99fc5a36ae6e3e8", "class_name": "RelatedNodeInfo"}}, "text": "# Use Rust Crates\n\n## What Crates Can Be Used <a href=\"#what-crates-can-be-used\" id=\"what-crates-can-be-used\"></a>\n\nNot every Rust crate can be used in Phat Contract. This is because the contracts are running inside the ink! runtime, which is different from operating systems like Linux. In general, there are two requirements:\n\n* The crate has `no_std` support (learn [more](https://docs.rust-embedded.org/book/intro/no-std.html) about the differences between `std` and `no_std`);\n* The crate is in Pure Rust and does not require pre-compiled libraries.\n\n## Crate Recommendations <a href=\"#crate-recommendations\" id=\"crate-recommendations\"></a>\n\nThe pink-extension contains the fundamental functions of the Phat Contract. There are also many useful crates and repositories which make developing Phat Contract easy.\n\n### Use Storage Services <a href=\"#use-storage-services\" id=\"use-storage-services\"></a>\n\n[pink-s3](https://crates.io/crates/pink-s3) enables you to store data to any storage service with S3-API support. Such storage service providers include:\n\n* [Amazon S3](https://aws.amazon.com/s3/) - 5GB, 12 months free\n* [4everland](https://www.4everland.org/bucket/) - 5GB free on IPFS and 100MB Free on Arweave\n* [Storj](https://www.storj.io/) - 150GB free\n* [Filebase](https://filebase.com/) - 5GB free\n\n### Cross-chain Operations <a href=\"#cross-chain-operations\" id=\"cross-chain-operations\"></a>\n\nWith its confidentiality and HTTP request support, you can safely store like an ETH account in Phat Contract and use it to operate an Ethereum RPC node to do any cross-chain operations. Such a pattern can be easily extended to support other blockchains.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1661, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f2d423d2-0987-4134-a327-366b240a25c0": {"__data__": {"id_": "f2d423d2-0987-4134-a327-366b240a25c0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/use-rust-crates.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e23c6654-98ae-4eab-acc7-1a0823e295ab", "node_type": "4", "metadata": {}, "hash": "e178f20b7280f2aea9483b407e14eb5f665552059dc6068c7119f06cc390a6f6", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "33f73c7f-2bbd-454a-854c-1318b0856064", "node_type": "1", "metadata": {}, "hash": "f4f05b7f3f304dbbb166ded2a352f9dab3beec57923e0198e6cf8ca4261fd9c3", "class_name": "RelatedNodeInfo"}}, "text": "* [pink-web3](https://crates.io/crates/pink-web3) provides the basic cross-chain operation support for EVM-compatible chains;\n* [subrpc](https://github.com/Phala-Network/phat-offchain-rollup/tree/sub0-workshop/phat/crates/subrpc) provides the basic support for Substrate-based chains;\n* [stateful-rollup](https://github.com/Phala-Network/phat-offchain-rollup/tree/sub0-workshop) enables reliable cross-chain request processing based on the crates above.\n\n### Other Crates <a href=\"#other-crates\" id=\"other-crates\"></a>\n\n* [phat-contract-examples](https://github.com/Phala-Network/phat-contract-examples) contains the official examples of Phat Contract. The examples are up-to-date, and may use some not-yet-released features;\n* [awesome-phat-contracts](https://github.com/Phala-Network/awesome-phat-contracts) collects the learning materials and some Phat Contract examples from previous hackathon submissions.", "mimetype": "text/plain", "start_char_idx": 1663, "end_char_idx": 2573, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "178db20b-053c-4519-b39b-9c4fa3014f38": {"__data__": {"id_": "178db20b-053c-4519-b39b-9c4fa3014f38", "embedding": null, "metadata": {"file_path": "phala-docs_dist/worker-confidence-level.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9eb32387-8c34-4936-b506-ebdfc3f1dfb0", "node_type": "4", "metadata": {}, "hash": "987ae369ba50cef37d437b3956f8d9f585fb8b8eb4ca22bc0da8db80ac9b3b7b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "53f393bd-1c47-4c08-a83f-e13c03d6109c", "node_type": "1", "metadata": {}, "hash": "16c1d6c4dda095ba9075d1c118ad8096ab89473475a65c5ec0e9a9001eb311c7", "class_name": "RelatedNodeInfo"}}, "text": "# Worker Confidence Level\n\n## Test your Intel\u00ae SGX Capability <a href=\"#test-your-intel-sgx-capability\" id=\"test-your-intel-sgx-capability\"></a>\n\nThe confidence level impacts your worker\u2019s score. Before configuring your worker, the necessary drivers are required, and the `sgx-test` option determines your Intel\u00ae SGX Capability alongside the confidence level.\n\n```\nsudo phala sgx-test\n```\n\n> This command will install \ud83d\udc33 Docker, the required Intel\u00ae SGX drivers, and pull all the necessary Docker images for your Phala worker \ud83e\udea8\u26cf\ufe0f.\n>\n> * Please follow the instruction during installation.\n\nInformation about the checks conducted during execution of the command:\n\n1. SGX system software \u2192 Able to launch enclaves \u2192 `Production Mode`\n2. Flexible launch control \u2192 `Able to launch production mode enclave`\n3. `isvEnclaveQuoteStatus` and `advisoryIDs` (explained in the next section)\n\nAmong them, **the first one is a must to run Phala Network pRuntime**. If it\u2019s not supported (tagged as \u2718 in the report example below), we are afraid you can\u2019t mine PHA with this setup. You may want to replace the motherboard and/or the CPU.\n\nThe latter two are not a must, though it is suggested to be checked as it would be essential to install the DCAP driver.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1240, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "53f393bd-1c47-4c08-a83f-e13c03d6109c": {"__data__": {"id_": "53f393bd-1c47-4c08-a83f-e13c03d6109c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/worker-confidence-level.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9eb32387-8c34-4936-b506-ebdfc3f1dfb0", "node_type": "4", "metadata": {}, "hash": "987ae369ba50cef37d437b3956f8d9f585fb8b8eb4ca22bc0da8db80ac9b3b7b", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "178db20b-053c-4519-b39b-9c4fa3014f38", "node_type": "1", "metadata": {}, "hash": "a2b21af28a351fb19515ff49be7a2e128ff0be77d4795f256197ad9837844346", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "6d691917-8802-49ba-94a6-1ae8bf0b25ed", "node_type": "1", "metadata": {}, "hash": "53ec6e55756a3cd43d2416905443b5fa6106da8e89f54a0f992014f5455778e7", "class_name": "RelatedNodeInfo"}}, "text": "The example below shows a positive result:\n\n```\nDetecting SGX, this may take a minute...\n\u2714  SGX instruction set\n  \u2714  CPU support\n  \u2714  CPU configuration\n  \u2714  Enclave attributes\n  \u2714  Enclave Page Cache\n  SGX features\n    \u2714  SGX2  \u2714  EXINFO  \u2718  ENCLV  \u2718  OVERSUB  \u2718  KSS\n    Total EPC size: 94.0MiB\n\u2714  Flexible launch control\n  \u2714  CPU support\n  \uff1f CPU configuration\n  \u2714  Able to launch production mode enclave\n\u2714  SGX system software\n  \u2714  SGX kernel device (/dev/sgx/enclave)\n  \u2714  libsgx_enclave_common\n  \u2714  AESM service\n  \u2714  Able to launch enclaves\n    \u2714  Debug mode\n    \u2714  Production mode\n    \u2714  Production mode (Intel whitelisted)\n\nYou are all set to start running SGX programs!\nGenerated machine id:\n[162, 154, 220, 15, 163, 137, 184, 233, 251, 203, 145, 36, 214, 55, 32, 54]\n\nTesting RA.\naesm_service[15]: [ADMIN]EPID Provisioning initiated\naesm_service[15]: The Request ID is 09a2bed647d24f909d4a3990f8e28b4a\naesm_service[15]: The Request ID is 8d1aa4104b304e12b7312fce06881260\naesm_service[15]: [ADMIN]EPID Provisioning successful\nisvEnclaveQuoteStatus = GROUP_OUT_OF_DATE\nplatform_info_blob { sgx_epid_group_flags: 4, sgx_tcb_evaluation_flags: 2304, pse_evaluation_flags: 0, latest_equivalent_tcb_psvn: [15, 15, 2, 4, 1, 128, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 0], latest_pse_isvsvn: [0, 11], latest_psda_svn: [0, 0, 0, 2],", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6d691917-8802-49ba-94a6-1ae8bf0b25ed": {"__data__": {"id_": "6d691917-8802-49ba-94a6-1ae8bf0b25ed", "embedding": null, "metadata": {"file_path": "phala-docs_dist/worker-confidence-level.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9eb32387-8c34-4936-b506-ebdfc3f1dfb0", "node_type": "4", "metadata": {}, "hash": "987ae369ba50cef37d437b3956f8d9f585fb8b8eb4ca22bc0da8db80ac9b3b7b", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "53f393bd-1c47-4c08-a83f-e13c03d6109c", "node_type": "1", "metadata": {}, "hash": "16c1d6c4dda095ba9075d1c118ad8096ab89473475a65c5ec0e9a9001eb311c7", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "55fd57db-43b5-4aca-84a1-7ebaac1acfc3", "node_type": "1", "metadata": {}, "hash": "09e01dbf72ee47f34e07c63c0c72d36885ee3b768463124d2927b13bdd4e32be", "class_name": "RelatedNodeInfo"}}, "text": "xeid: 0, gid: 2919956480, signature: sgx_ec256_signature_t { gx: [99, 239, 225, 171, 96, 219, 216, 210, 246, 211, 20, 101, 254, 193, 246, 66, 170, 40, 255, 197, 80, 203, 17, 34, 164, 2, 127, 95, 41, 79, 233, 58], gy: [141, 126, 227, 92, 128, 3, 10, 32, 239, 92, 240, 58, 94, 167, 203, 150, 166, 168, 180, 191, 126, 196, 107, 132, 19, 84, 217, 14, 124, 14, 245, 179] } }\nadvisoryURL = https://security-center.intel.com\nadvisoryIDs = \"INTEL-SA-00219\", \"INTEL-SA-00289\", \"INTEL-SA-00320\", \"INTEL-SA-00329\"\nconfidenceLevel = 5\n```\n\nIf you can not run Phala pRuntime with both of them tagged as \u2714, you may have to check whether your BIOS is the latest version with latest security patches. If you still can\u2019t run Phala pRuntime docker with the latest BIOS of your motherboard manufacturer, we are afraid you can\u2019t mine PHA for now with this motherboard.\n\nYour confidence level, referred to as the \u201cTier\u201d in the table below, will appear in the last line of the report after executing `sudo phala sgx-test`.", "mimetype": "text/plain", "start_char_idx": 2570, "end_char_idx": 3570, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "55fd57db-43b5-4aca-84a1-7ebaac1acfc3": {"__data__": {"id_": "55fd57db-43b5-4aca-84a1-7ebaac1acfc3", "embedding": null, "metadata": {"file_path": "phala-docs_dist/worker-confidence-level.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9eb32387-8c34-4936-b506-ebdfc3f1dfb0", "node_type": "4", "metadata": {}, "hash": "987ae369ba50cef37d437b3956f8d9f585fb8b8eb4ca22bc0da8db80ac9b3b7b", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "6d691917-8802-49ba-94a6-1ae8bf0b25ed", "node_type": "1", "metadata": {}, "hash": "53ec6e55756a3cd43d2416905443b5fa6106da8e89f54a0f992014f5455778e7", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "11c44e8c-3fa0-4e3b-b727-cc1aa369bc0c", "node_type": "1", "metadata": {}, "hash": "3f3e0a7fb2de7b802f44f036c90db2dc3a603f9d12c23f7dc2a6b33a7429e7e3", "class_name": "RelatedNodeInfo"}}, "text": "## Confidence Level of a Worker <a href=\"#confidence-level-of-a-worker\" id=\"confidence-level-of-a-worker\"></a>\n\n| Level  | isvEnclaveQuoteStatus                                            | advisoryIDs               |\n| ------ | ---------------------------------------------------------------- | ------------------------- |\n| Tier 1 | OK                                                               | None                      |\n| Tier 2 | SW\\_HARDENING\\_NEEDED                                            | None                      |\n| Tier 3 | CONFIGURATION\\_NEEDED, CONFIGURATION\\_AND\\_SW\\_HARDENING\\_NEEDED | Whitelisted\\*             |\n| Tier 4 | CONFIGURATION\\_NEEDED, CONFIGURATION\\_AND\\_SW\\_HARDENING\\_NEEDED | Some beyond the whitelist |\n| Tier 5 | GROUP\\_OUT\\_OF\\_DATE                                             | Any value                 |\n\nThe confidence level measures how secure the SGX Enclave execution environment is. It\u2019s determined by the Remote Attestation report from Intel. Among them, `isvEnclaveQuoteStatus` indicates if the platform is vulnerable to some known problems, and `advisoryIDs` indicates the actual affected problems.\n\nNot all the `advisoryIDs` are problematic. Some advisories doesn\u2019t affect Phala\u2019s security assumption, and therefore are whitelisted:\n\n* INTEL-SA-00219\n* INTEL-SA-00334\n* INTEL-SA-00381\n* INTEL-SA-00389\n\nTier 1, 2, 3 are considered with the best security level because they are either not affected by any known vulnerability, or the adversary is known trivial. It\u2019s good to run highest valuable apps on these workers, for instance:\n\n* Financial apps: privacy-preserving DEX, DeFi ,etc\n* Secret key management: wallet, node KMS, password manager\n* Phala Gatekeeper\n\nTier 4, 5 are considered with reduced security, because these machines requires some configuration fix in the BIOS or BIOS firmware (CONFIGURATION\\_NEEDED, CONFIGURATION\\_AND\\_SW\\_HARDENING\\_NEEDED), or their microcode or the corresponding BIOS firmware are out-of-date (GROUP\\_OUT\\_OF\\_DATE). Therefore we cannot assume the platform is suitable for highest security scenarios. However it\u2019s still good to run batch processing jobs, apps dealing with ephemeral privacy data, and traditional blockchain apps:\n\n* Data analysis jobs (e.g.", "mimetype": "text/plain", "start_char_idx": 3572, "end_char_idx": 5829, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "11c44e8c-3fa0-4e3b-b727-cc1aa369bc0c": {"__data__": {"id_": "11c44e8c-3fa0-4e3b-b727-cc1aa369bc0c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/worker-confidence-level.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9eb32387-8c34-4936-b506-ebdfc3f1dfb0", "node_type": "4", "metadata": {}, "hash": "987ae369ba50cef37d437b3956f8d9f585fb8b8eb4ca22bc0da8db80ac9b3b7b", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "55fd57db-43b5-4aca-84a1-7ebaac1acfc3", "node_type": "1", "metadata": {}, "hash": "09e01dbf72ee47f34e07c63c0c72d36885ee3b768463124d2927b13bdd4e32be", "class_name": "RelatedNodeInfo"}}, "text": "Web3 Analytics)\n* On-chain PvP games\n* VPN\n* Web2.0 apps\n* Blockchain Oracle\n* DApps\n\nOnce Phala is open for developers to deploy their apps, there will be an option for them to choose which tiers they will accept. Since Tier 1, 2, 3 have better security, they can potentially get higher chance to win the confidential contract assignment. However, Tier 4, 5 are useful in other use cases, and therefore can be a more economic choice for the developers.\n\nIf your worker is in tier 4 or 5, please check the FAQ page for potential fixes.", "mimetype": "text/plain", "start_char_idx": 5830, "end_char_idx": 6365, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e620f8e9-d3e8-4f83-a4b8-546261e4098e": {"__data__": {"id_": "e620f8e9-d3e8-4f83-a4b8-546261e4098e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/prb-worker-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d0012f5b-8adf-434f-8eb1-f08972054914", "node_type": "4", "metadata": {}, "hash": "77ab9dce170c795cfe833c167b394dd8c62837282015cba461e4cd9911804900", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "0eaa3233-bc6a-430c-a918-3b10d7fb81b8", "node_type": "1", "metadata": {}, "hash": "79ba1063ecf17a6ffb3c870830d55fe38460aa65ae7cc7666f93fbebcd038b47", "class_name": "RelatedNodeInfo"}}, "text": "# PRB Worker Deployment\n\n## Basic requirements\n\nApart from the reduced requirements for hard disk and memory space, the process of deploying a PRB worker is the same as deploying a solo worker. The only difference is that the PRB worker only needs to run pRuntime, while the solo worker needs to run node and pherry additionally.\n\nFor details of solo worker deployment, please refer to: [Solo worker deployment](https://wiki.phala.network/en-us/mine/phala-worker/solo-worker-deployment/)\n\nTherefore, the requirements for running a PRB worker are:\n\n* Support for SGX function\n* Ubuntu 22.04.2 LTS system with a kernel of 5.13 and above\n* 4 or more CPU cores\n* 8GB memory\n* 128GB NVME hard disk\n\n## Worker deployment\n\n### Preparations\n\nAfter installing the OS, first install the necessary docker programs\n\n```undefined\nsudo apt update && sudo apt upgrade -y && sudo apt autoremove -y\nsudo apt install docker-compose\n```\n\nThen create a folder locally, and create a docker-compose document within it.\n\n```bash\nmkdir khala-deployment\ncd ./khala-deployment\ntouch docker-compose.yml\n```\n\n### Document Editing\n\nEdit the docker-compose document using the following commands:\n\n```bash\nvim ./docker-compose.yml \n```\n\nAfter entering, you will access the document.\n\nAt this point, enter `a` and you will start editing the document. Paste the following content into the document.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1365, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0eaa3233-bc6a-430c-a918-3b10d7fb81b8": {"__data__": {"id_": "0eaa3233-bc6a-430c-a918-3b10d7fb81b8", "embedding": null, "metadata": {"file_path": "phala-docs_dist/prb-worker-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d0012f5b-8adf-434f-8eb1-f08972054914", "node_type": "4", "metadata": {}, "hash": "77ab9dce170c795cfe833c167b394dd8c62837282015cba461e4cd9911804900", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e620f8e9-d3e8-4f83-a4b8-546261e4098e", "node_type": "1", "metadata": {}, "hash": "7f13deb5f0f31d472ac038cd650f1c4f296629192a3b998ad222b12a8f15073a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "4cd99b9a-7f5b-4134-a176-77725d7899d4", "node_type": "1", "metadata": {}, "hash": "795243fbfd7edf2708a2d578316d86cb4264e22d9a9aa2d7d837c20edfcfad69", "class_name": "RelatedNodeInfo"}}, "text": "(Please note that the file content remains consistent and the indentation alignment of each line is consistent with this document)\n\n```javascript\nversion: \"3\"\nservices:\n  phala-pruntime:\n    image: phalanetwork/phala-pruntime:latest\n    container_name: phala-pruntime\n    hostname: phala-pruntime\n    ports:\n    - \"8000:8000\"\n    devices:\n    - /dev/sgx_enclave:/dev/sgx_enclave\n    - /dev/sgx_provision:/dev/sgx_provision\n    environment:\n    - EXTRA_OPTS=--cores={core_num} --checkpoint-interval=3600\n    - ROCKET_ADDRESS=0.0.0.0\n    volumes:\n    - /root/pruntime/khala/pruntime:/root/data\n\n```\n\n> A parameter needs to be customized by yourself: In phala-pruntime, change \u2013cores={core\\_num} to the number of cores of your machine, such as \u2013cores=4.\n\nAfter entering, complete the following steps to finish the text editing and save successfully.\n\n```javascript\n1\u3001Click \"esc\"\n2\u3001Enter \":wq\"\n3\u3001Click \"Enter\"\uff0cquit the editing page\n```\n\n### Program Execution\n\nInside the newly created folder, run docker-compose, and the essential components for Solo worker will run successfully.\n\n```undefined\nsudo docker-compose up -d\n```\n\n## Status Check\n\nEnter the following command to get the most recent 100 lines of pRuntime log information:\n\n```bash\nsudo docker logs phala-pruntime --tail 100\n```\n\n> If you have changed the component name through customizing docker-compose.yml, please replace \u201cphala-pruntime\u201d to your customized name in the command.", "mimetype": "text/plain", "start_char_idx": 1366, "end_char_idx": 2804, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4cd99b9a-7f5b-4134-a176-77725d7899d4": {"__data__": {"id_": "4cd99b9a-7f5b-4134-a176-77725d7899d4", "embedding": null, "metadata": {"file_path": "phala-docs_dist/prb-worker-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d0012f5b-8adf-434f-8eb1-f08972054914", "node_type": "4", "metadata": {}, "hash": "77ab9dce170c795cfe833c167b394dd8c62837282015cba461e4cd9911804900", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "0eaa3233-bc6a-430c-a918-3b10d7fb81b8", "node_type": "1", "metadata": {}, "hash": "79ba1063ecf17a6ffb3c870830d55fe38460aa65ae7cc7666f93fbebcd038b47", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "56e37b60-6292-4698-af8b-2f11704afefa", "node_type": "1", "metadata": {}, "hash": "fb765643f43e424b69aef04d37d4e36636a9d2efaa69183d458e628908651c95", "class_name": "RelatedNodeInfo"}}, "text": "A typical pRuntime log in sync will look like this:\n\n```yaml\n2023-05-10T11:55:38.478826Z  INFO phactory::prpc_service: State synced\n2023-05-10T11:55:38.479089Z  INFO phactory::storage::storage_ext: Got 17 messages from OutboundMessages    \n2023-05-10T11:55:38.479330Z  INFO phactory::prpc_service: Dispatching block=440838\n2023-05-10T11:55:38.482465Z  INFO phactory::prpc_service: State synced\n2023-05-10T11:55:38.482647Z  INFO phactory::storage::storage_ext: Got 11 messages from OutboundMessages    \n2023-05-10T11:55:38.482825Z  INFO pruntime::runtime: pRPC returned code=200 size=4\n2023-05-10T11:55:38.482881Z  INFO prpc_measuring: POST /prpc/PhactoryAPI.DispatchBlocks cost 18221 microseconds, status: 200   \n```\n\nYou can determine whether the synchronization is proceeding normally by checking the synchronized height and progress.\n\n## Configuration for adding worker to PRB server\n\nAll on-chain information configuration, including transaction accounts, pool master\u2019s information, etc., can be done through the PRBv3 configuration interface.\n\nAt this stage, you only need to record the IP of this worker to be filled into the PRB database.\n\n## How to Find the Local IP Address:\n\nInstall the net-tools package.", "mimetype": "text/plain", "start_char_idx": 2806, "end_char_idx": 4021, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "56e37b60-6292-4698-af8b-2f11704afefa": {"__data__": {"id_": "56e37b60-6292-4698-af8b-2f11704afefa", "embedding": null, "metadata": {"file_path": "phala-docs_dist/prb-worker-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d0012f5b-8adf-434f-8eb1-f08972054914", "node_type": "4", "metadata": {}, "hash": "77ab9dce170c795cfe833c167b394dd8c62837282015cba461e4cd9911804900", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "4cd99b9a-7f5b-4134-a176-77725d7899d4", "node_type": "1", "metadata": {}, "hash": "795243fbfd7edf2708a2d578316d86cb4264e22d9a9aa2d7d837c20edfcfad69", "class_name": "RelatedNodeInfo"}}, "text": "```undefined\nsudo apt install net-tools\n```\n\nThen Use this command to search the IP\n\n```undefined\nifconfig\n```\n\nThe result will look like this:\n\n```yaml\nbr-0cec631198c9: flags=4099<UP,BROADCAST,MULTICAST>  mtu 1500\n        inet xxx.xxx.xxx.xxx  netmask 255.255.240.0  broadcast 111.111.111.111\n        ...\n\nbr-2493ab4f406b: flags=4099<UP,BROADCAST,MULTICAST>  mtu 1500\n        inet xxx.xxx.xxx.xxx  netmask 255.255.0.0  broadcast 111.111.111.111\n        ...\n\nbr-2990701611a3: flags=4099<UP,BROADCAST,MULTICAST>  mtu 1500\n        inet xxx.xxx.xxx.xxx  netmask 255.255.240.0  broadcast 111.111.111.111\n        ...\n```\n\nYou can find your public or private IP after each `inet`.\n\n## Create a connection between Worker and PRB <a href=\"#create-a-connection-between-worker-and-prb\" id=\"create-a-connection-between-worker-and-prb\"></a>\n\nFor more details, please refer to the [Using PRBv3](using-prbv3-ui.md)", "mimetype": "text/plain", "start_char_idx": 4023, "end_char_idx": 4923, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "feda2f68-8811-4b6a-a3cd-387346f6be95": {"__data__": {"id_": "feda2f68-8811-4b6a-a3cd-387346f6be95", "embedding": null, "metadata": {"file_path": "phala-docs_dist/conclusion-and-future-developments.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "94a5a5fe-88df-480e-afd4-30c9e1bd5de2", "node_type": "4", "metadata": {}, "hash": "68a8c93743f4842325e0a1dc108196138a8a707842f699602860dcb59cbd610c", "class_name": "RelatedNodeInfo"}}, "text": "# Conclusion & Future Developments\n\nOur exploration of multi-proof systems has underscored its immense potential to revolutionize the blockchain sector. Seamlessly integrating TEE-Proof and ZK-Proof heightens efficiency, scalability, security, and interoperability, reshaping blockchain functionality.\n\nAs the blockchain ecosystem evolves, the need for advanced computational models becomes imminent. Multi-proof technology emerges as the answer, promising a future where scalability difficulties and security vulnerabilities are significantly minimized.\n\nAs we look to the future, our mission is clear. By relentlessly refining and enhancing our multi-proof technology, we aim to meet the ever-growing needs of the dynamic blockchain sector.\n\n## Research\n\n### A Multi-proof Based FastMode Solution for Rollup\n\nComing soon\u2026\n\n## References & Additional Resources\n\nTo explore more about the universe of multi-proof systems, we recommend the following resources:\n\n1. [Hardening rollups with multi-proofs](https://hackmd.io/@vbuterin/zk\\_slides\\_20221010#/) - talk by Vitalik Buterin\n2. [2FA zk-rollups using SGX](https://ethresear.ch/t/2fa-zk-rollups-using-sgx/14462) \u2014 by Justin Drake\n3. [Beyond ZK](https://www.youtube.com/watch?v=HNdbw4UH7s8) - talk by Andrew Miller\n4. [Scaling Security: Multi-Prover Implementation on Scroll](https://scroll.io/blog/scaling-security) \u2014 by Scroll\\&Automata\n5. [SGX 101](https://sgx101.gitbook.io/sgx101) - by SSLab", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1448, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "357ceae7-47da-49b6-906b-a96a7182426d": {"__data__": {"id_": "357ceae7-47da-49b6-906b-a96a7182426d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-from-autonolas-plugin.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "ee378d0f-bb3d-4b16-ae4c-93b45e111998", "node_type": "4", "metadata": {}, "hash": "c11c3152e866578f3a117b30a09d329205a5cf053ca3160670e5d558ed22a87c", "class_name": "RelatedNodeInfo"}}, "text": "# Connect from Autonolas Plugin\n\n<figure><img src=\"../../.gitbook/assets/WIP.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 123, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c9261018-525c-495e-8f9e-9a9541698ae9": {"__data__": {"id_": "c9261018-525c-495e-8f9e-9a9541698ae9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/buy-and-sell-keys.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "2a150c0d-6900-49e4-be11-0129ad1ff0a9", "node_type": "4", "metadata": {}, "hash": "6bea51bbd406336b8dfdb326e6ed5527069f74b67429401e18582da838f31c3e", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "872e3569-1d77-4889-9fa4-2b32e95e612e", "node_type": "1", "metadata": {}, "hash": "757e6bea8230f4d01fa6d58b32540bb9811620d21fedc8d51270aa265ef9bb8f", "class_name": "RelatedNodeInfo"}}, "text": "# Buy and Sell Keys\n\nKeys are the NFT associated with each agent. You must own at least one key of an agent to unlock unlimited chat with it. Otherwise, you only have 5 free chats with the agent.\n\nKeys can be purchased or sold at any time. You can profit by trading keys. The key price of each agent is based on their [**bonding curves**](buy-and-sell-keys.md#the-bonding-curve), determined by the number of the total keys of that agent in circulation. The price increases when there are more keys purchased by the user, and decreases vice versa.\n\n## How to buy a key\n\nYou can easily buy keys on AgentWar Dapp\n\n1.  Click the Agent you want to buy on the Explore page\n\n    <figure><img src=\"../../.gitbook/assets/image.png\" alt=\"\"><figcaption></figcaption></figure>\n2.  You can find the details of the key on the Agent page. Note that the free chats are limited without a key.\n\n    <figure><img src=\"../../.gitbook/assets/image (1).png\" alt=\"\"><figcaption></figcaption></figure>\n3.  Click \"Trade\" button. In the popup, you can choose how many keys to buy. If you want to switch between ETH (default) and PHA payment, you can click \"Switch to PHA\" or \"Switch to ETH\" button.\\\n\n\n    <figure><img src=\"../../.gitbook/assets/image (2).png\" alt=\"\" width=\"375\"><figcaption></figcaption></figure>\n4. Click \"BUY\" to buy the key. You will sign one or more transactions in your connected wallet. (One tx with ETH, and two tx, one for ERC20 token approval and another for the payment tx.)\n5.  After buying the key, you can find the number of keys you hold in the \"Holders\" tab.\\\n\n\n    <figure><img src=\"../../.gitbook/assets/image (3).png\" alt=\"\" width=\"375\"><figcaption></figcaption></figure>\n\n## How to sell a key\n\n1. Click \"Trade\" button in the detail page of the agent you want to sell\n2.  Select \"SELL\" tab. You can see how many keys you own and choose how many to sell. You can also choose to sell to ETH (default) or PHA token.\\", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1923, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "872e3569-1d77-4889-9fa4-2b32e95e612e": {"__data__": {"id_": "872e3569-1d77-4889-9fa4-2b32e95e612e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/buy-and-sell-keys.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "2a150c0d-6900-49e4-be11-0129ad1ff0a9", "node_type": "4", "metadata": {}, "hash": "6bea51bbd406336b8dfdb326e6ed5527069f74b67429401e18582da838f31c3e", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c9261018-525c-495e-8f9e-9a9541698ae9", "node_type": "1", "metadata": {}, "hash": "7c7930158545da33d1eda038f97abe65869ef4993d732c140777c62e65016ae5", "class_name": "RelatedNodeInfo"}}, "text": "<figure><img src=\"../../.gitbook/assets/image (4).png\" alt=\"\" width=\"375\"><figcaption></figcaption></figure>\n3. Click \"SELL\" button to confirm the onchain transaction.  You will sign it in your connected wallet.\n4. Congratulations! Now you have sold the key to earn the profit.\n\n## Key Bonding Curve\n\nThe price of an agent key follows a formula defined in the smart contract. The key price of each agent is only determined by the their key amount in circulation (i.e. the current total number of keys). The more keys, the higher price.\n\n| Total Keys | Price in PHA | Price in USD (PHA @ 0.15) |\n| ---------- | ------------ | ------------------------- |\n| 1          | 0.05         | 0.0075                    |\n| 10         | 5            | 0.75                      |\n| 50         | 125          | 18.75                     |\n| 500        | 2974         | 446.10                    |\n| 1000       | 4009         | 601.35                    |\n\nWhen an agent is created, the first key will be minted to the agent creator. Once created, anyone can buy and sell keys at any time, following the bonding curve. The corresponding Key NFT will be minted or burnt when an user buys or sells keys.\n\n{% hint style=\"info\" %}\nThe bonding curve is defined based on PHA token. The table above shows the corresponding USD value assuming PHA is at $0.15.\n\nThe smart contract supports buying and selling in ETH or other token. When using tokens other than PHA, it automatically uses Uniswap v3 on Base to swap against PHA. For example, when buying keys with ETH, the smart contract will receive ETH from the user, and instantly swap to the corresponding PHA based on the bonding curve.\n\nSwapping is based on Uniswap. So the process may subject to additional trading fee, price fluctuation, and potential MEV risk.\n{% endhint %}\n\nTo learn the details of the formula, please refer to [#agent-keys](../agent-war-tokenomics.md#agent-keys \"mention\").", "mimetype": "text/plain", "start_char_idx": 1930, "end_char_idx": 3858, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "fa893b48-67cf-4d9a-bd40-fba8a3cf7a7a": {"__data__": {"id_": "fa893b48-67cf-4d9a-bd40-fba8a3cf7a7a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/supported-assets.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a8d76ca1-7cee-420c-b994-cd523c7a05fe", "node_type": "4", "metadata": {}, "hash": "f14ba779839499c4e942dee8967d1691509df8dc5af7091c5fb6eaf544c36527", "class_name": "RelatedNodeInfo"}}, "text": "# Supported Assets\n\nAn asset id of type _uint32_ is allocated for each registered asset. Each asset except PHA on Khala/Phala will have an unique asset id. You can use [pallet-assets](https://github.com/paritytech/substrate/tree/master/frame/assets) to transfer asset to any accounts within Khala and Phala Network.\n\n* Assets on the Khala network\n\nForeign assets are managed by pallet-assets, supported assets can be found at [here](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkhala-api.phala.network%2Fws#/assets). On the Khala network, PHA can be transferred between parachain and Ethereum, and ZLK can be transferred to Moonriver and vice versa.\n\n* Assets on the Phala network\n\nForeign assets are managed by pallet-assets, supported assets can be found at [here](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fapi.phala.network%2Fws#/assets). On the Phala network, only PHA can be transferred between parachain and Ethereum.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 928, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "73091678-575e-4d8f-bf61-299ff12bca45": {"__data__": {"id_": "73091678-575e-4d8f-bf61-299ff12bca45", "embedding": null, "metadata": {"file_path": "phala-docs_dist/getting-started.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "04566d32-cfff-471f-8400-cfc01eca5e69", "node_type": "4", "metadata": {}, "hash": "761ee19ed3dc08c6aaca97ee8e55a18233f86de54df3992ddca83223d1f9d8ee", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c1f5047f-e390-4e42-a521-2ee059e3406d", "node_type": "1", "metadata": {}, "hash": "fc1d6e27ddff594240a844cc564598e869b5da07e0c68081956aa763bac11309", "class_name": "RelatedNodeInfo"}}, "text": "# Getting Started\n\nThe Mirrored Price Feed aims to work well with ChainLink's ABI. This means you can easily use it on any blockchain that supports EVM. To start using it, simply [find the right contract address here](https://docs-git-build-coprocessor-phala.vercel.app/solutions/mirrored-price-feed/feed-addresses).\n\nThe learn more about Chainlink's `AggregatorV3Interface`, you can check out their [API Reference](https://docs.chain.link/data-feeds/api-reference).\n\n## Reading data feeds onchain\n\nHere is some code snippets to demostrate how to use Mirrored Price Feed on-chain.\n\n### Getting the latest data\n\n```solidity\n\n// SPDX-License-Identifier: MIT\npragma solidity ^0.8.7;\n \nimport {AggregatorV3Interface} from \"@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol\";\n \n/**\n * THIS IS AN EXAMPLE CONTRACT THAT USES HARDCODED\n * VALUES FOR CLARITY.\n * THIS IS AN EXAMPLE CONTRACT THAT USES UN-AUDITED CODE.\n * DO NOT USE THIS CODE IN PRODUCTION.\n */\ncontract DataConsumerV3 {\n    AggregatorV3Interface internal dataFeed;\n \n    /**\n     * Network: Base Sepolia\n     * Aggregator: BTC/USD\n     * Address: 0x1e73C20c42a7de166868da4c47963d137030492A\n     */\n    constructor() {\n        dataFeed = AggregatorV3Interface(\n            0x1e73C20c42a7de166868da4c47963d137030492A\n        );\n    }\n \n    /**\n     * Returns the latest answer.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1350, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c1f5047f-e390-4e42-a521-2ee059e3406d": {"__data__": {"id_": "c1f5047f-e390-4e42-a521-2ee059e3406d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/getting-started.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "04566d32-cfff-471f-8400-cfc01eca5e69", "node_type": "4", "metadata": {}, "hash": "761ee19ed3dc08c6aaca97ee8e55a18233f86de54df3992ddca83223d1f9d8ee", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "73091678-575e-4d8f-bf61-299ff12bca45", "node_type": "1", "metadata": {}, "hash": "e2ca367fdc7ac998fc8a096fd4c202c4ca224af24ead5870dae80baa2b13a433", "class_name": "RelatedNodeInfo"}}, "text": "*/\n    function getChainlinkDataFeedLatestAnswer() public view returns (int) {\n        // prettier-ignore\n        (\n            /* uint80 roundID */,\n            int answer,\n            /*uint startedAt*/,\n            /*uint timeStamp*/,\n            /*uint80 answeredInRound*/\n        ) = dataFeed.latestRoundData();\n        return answer;\n    }\n}\n```\n\n### Getting the historial data\n\n```solidity\n// SPDX-License-Identifier: MIT\npragma solidity ^0.8.7;\n \nimport {AggregatorV3Interface} from \"@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol\";\n \n/**\n * THIS IS AN EXAMPLE CONTRACT THAT USES HARDCODED VALUES FOR CLARITY.\n * THIS IS AN EXAMPLE CONTRACT THAT USES UN-AUDITED CODE.\n * DO NOT USE THIS CODE IN PRODUCTION.\n */\ncontract HistoricalDataConsumerV3 {\n    AggregatorV3Interface internal dataFeed;\n \n    /**\n     * Network: Base Sepolia\n     * Aggregator: BTC/USD\n     * Address: 0x1e73C20c42a7de166868da4c47963d137030492A\n     */\n    constructor() {\n        dataFeed = AggregatorV3Interface(\n            0x1e73C20c42a7de166868da4c47963d137030492A\n        );\n    }\n \n    /**\n     * Returns historical data for a round ID.\n     * roundId is NOT incremental. Not all roundIds are valid.\n     * You must know a valid roundId before consuming historical data.\n     *\n     * ROUNDID VALUES:\n     *    InValid:      18446744073709562300\n     *    Valid:        18446744073709554683\n     *\n     * @dev A timestamp with zero value means the round is not complete and should not be used.\n     */\n    function getHistoricalData(uint80 roundId) public view returns (int256) {\n        // prettier-ignore\n        (\n            /*uint80 roundID*/,\n            int answer,\n            /*uint startedAt*/,\n            /*uint timeStamp*/,\n            /*uint80 answeredInRound*/\n        ) = dataFeed.getRoundData(roundId);\n        return answer;\n    }\n}\n```", "mimetype": "text/plain", "start_char_idx": 1356, "end_char_idx": 3217, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f0ac1733-d9ca-4704-a1ba-f27a605b6c53": {"__data__": {"id_": "f0ac1733-d9ca-4704-a1ba-f27a605b6c53", "embedding": null, "metadata": {"file_path": "phala-docs_dist/agent-war-tokenomics.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "632c9998-7894-4bf3-89c5-b795e9f34993", "node_type": "4", "metadata": {}, "hash": "1918f6bf1e7a0800c13bf7b24562b45d51b4d4bf82d57ed808af60e4f04f0a02", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "1a8b7567-25e1-4ef3-8ded-37b9aa672b79", "node_type": "1", "metadata": {}, "hash": "cc8b4d030953f4675dc5b1fa2b510694c7970280ef886c9ae0e4b4249265694a", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83d\udcb8 Agent War Tokenomics\n\n## Roles\n\nIn this game, there are two roles:\n- Agent Creator, who creates the agent and will take the full income from every sold key;\n- Key Holder, who holds a share of the agent and will benefit from the rise of key price when the agent attracts more buyers.\n\n## Create Your Agent\n\nYou are free to create agents no matter who owns the X accounts only if you are the first. Each agent is a standard ERC-721 NFT on Base chain. Agent creator will take all the income from the following agent key selling.\n\nIn Agent Wars, each agent is a unique avatar tied to an X account. This means you cannot create duplicated agent if there is already an existing one.\n\nWe introduce a one-time payment process for agent creation where all tokens will be used to cover the agent hosting cost, eliminating the need for further charges.\n\n### You own the X account\n\nIf you own the X account and you are the first to create the agent for it, congratulation!\n\nAfter verification you just need to pay for a fixed price of **400 PHA** to create your agent no matter how many followers there are.\n\n### Normal X account\n\nX accounts with less than 100k followers are considered as normal. You need to pay for the creation fee to create the agent.\n\nThe creation fee is based on the number of followers of that X account.\n\n$$Price = max(400, 8.75 * \\sqrt FollowerNum - 3750)$$\n\n<figure><img src=\"../.gitbook/assets/agent-wars-create-price.png\" alt=\"\" width=\"563\"><figcaption></figcaption></figure>\n\nFor example, the price for all accounts with fewer than 225k followers will be 400 PHA, 500k followers is ~2400 PHA, 800k followers is ~4000 PHA\n\n### Popular X account\n\nX accounts with more than 100k followers are considered as popular. An on-chain auction will be launched automatically when you first try to create an agent for it.\n\nThe minimal bid amount is based on the number of followers of that X account.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1910, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "1a8b7567-25e1-4ef3-8ded-37b9aa672b79": {"__data__": {"id_": "1a8b7567-25e1-4ef3-8ded-37b9aa672b79", "embedding": null, "metadata": {"file_path": "phala-docs_dist/agent-war-tokenomics.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "632c9998-7894-4bf3-89c5-b795e9f34993", "node_type": "4", "metadata": {}, "hash": "1918f6bf1e7a0800c13bf7b24562b45d51b4d4bf82d57ed808af60e4f04f0a02", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f0ac1733-d9ca-4704-a1ba-f27a605b6c53", "node_type": "1", "metadata": {}, "hash": "2a030fdb3171fc010e8d0e3a7217aaf46c12cac6029db4e039012a49abccddcb", "class_name": "RelatedNodeInfo"}}, "text": "$$MinBid = 8.75 * \\sqrt FollowerNum - 3750$$\n\n<figure><img src=\"../.gitbook/assets/agent-wars-auction-bid.png\" alt=\"\" width=\"563\"><figcaption></figcaption></figure>\n\nFor example, to create an agent for X account with 1 million followers, the minimal bid will be 5000 PHA; to create Elon Musk agent (with 1.8 billion followers) will take at least 113600 PHA.\n\n## Agent Keys\n\nEven if you are not the agent creator, you can still benefit from agent getting popular by owning its keys. Agent key is standarad ERC-1155 token on Base chain, and it represents your shares of the agent.\n\nThe price of agent key increases with the increasing supply of the keys. The more buyers there are, the higher the price will become. The key selling income will go to agent creator, and 10% will be taken as trading fee.\n\nEveryone is free to buy a unlimited number of keys of a certain agent. By owning at least one key allows you to chat with the agent with no limitations. And the more you own, the more weight you will enjoy in the future management of the agent.\n\nBoth buy and sell price follow the curve of\n\n$$KeyPrice = \\begin{cases}KeyNum^2 / 20   &  KeyNum <=200 \\\\4000 + 2000 * 200 * 199 * (1/KeyNum - 1/(KeyNum-1)) & KeyNum>200 \\end{cases}$$\n\n<figure><img src=\"../.gitbook/assets/agent-wars-key-price.png\" alt=\"\" width=\"563\"><figcaption></figcaption></figure>\n\nFor example, the first key, owned by the agent creator, is free. The 2nd key is 0.2 PHA, the 10th is 5 PHA, and the 200th is 2000 PHA. The key price will never exceed 4000 PHA.\n\n## Agent Management\n\n### :construction\\_site: **Coming Soon!**", "mimetype": "text/plain", "start_char_idx": 1912, "end_char_idx": 3503, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "456c9d8c-eb09-4a48-bf73-05efc7b6abf1": {"__data__": {"id_": "456c9d8c-eb09-4a48-bf73-05efc7b6abf1", "embedding": null, "metadata": {"file_path": "phala-docs_dist/store-contract-states.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "375684a5-c302-432b-821b-1c22ffc7cfd1", "node_type": "4", "metadata": {}, "hash": "9a82dbca7078c31212769b4129f445b252a0e17214739df408c05d3a28753815", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "4c065d1f-7710-4af0-b820-5100c1b79dd7", "node_type": "1", "metadata": {}, "hash": "ae4eeff7207511e151224d3eb0247e6e2264225961af4c223d4635b7e9f57bf8", "class_name": "RelatedNodeInfo"}}, "text": "# Store Contract States\n\n## Storage Hierarchy\n\n## Overview <a href=\"#overview\" id=\"overview\"></a>\n\nA Phat contract can utilize three kinds of storage solutions: local cache, contract state, and any external storage services with HTTP requests. We list the differences between the two native storage solutions in Phat Contract as follows.\n\n<table><thead><tr><th width=\"157\"></th><th width=\"109\">Persistent</th><th width=\"113\">Consistent</th><th width=\"221\">Transparently Encrypted</th><th>Cost</th></tr></thead><tbody><tr><td>Local Cache</td><td>\u274c</td><td>\u274c</td><td>\u2705</td><td>Zero</td></tr><tr><td>Contract State</td><td>\u2705</td><td>\u2705</td><td>\u2705</td><td>Gas fee</td></tr></tbody></table>\n\n### Local Cache <a href=\"#local-cache\" id=\"local-cache\"></a>\n\nThe local cache is stored in the worker\u2019s memory. As its name, it should only be used as a cache since all cached data is not shared across different workers, and can be lost if the worker is down. Also, you may experience unexpected value cleanup if the memory usage of the worker is high.\n\nThe cache can be easily accessed in [Pink extension](use-pink-extension.md). You can read and write cache in query handlers, but reading cache in transaction handlers is forbidden: the result of cache reading is nondeterministic.\n\n```rust\nuse pink::chain_extension::pink_extension_instance as ext;\n\n#[ink(message)]\npub fn test(&self) {\n    assert!(ext().cache_set(b\"key\", b\"value\").is_ok());\n    assert_eq!(ext().cache_get(b\"key\"), Some(b\"value\".to_vec()));\n    assert_eq!(ext().cache_remove(b\"key\"), Some(b\"value\".to_vec()));\n    assert_eq!", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1580, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4c065d1f-7710-4af0-b820-5100c1b79dd7": {"__data__": {"id_": "4c065d1f-7710-4af0-b820-5100c1b79dd7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/store-contract-states.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "375684a5-c302-432b-821b-1c22ffc7cfd1", "node_type": "4", "metadata": {}, "hash": "9a82dbca7078c31212769b4129f445b252a0e17214739df408c05d3a28753815", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "456c9d8c-eb09-4a48-bf73-05efc7b6abf1", "node_type": "1", "metadata": {}, "hash": "0a54f739fed2f3b13be6cc42a34a1f5f40271aabaa04e6cff15b46570746c324", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "0295d9f2-2080-4ae7-8d3a-a3baebe10dfc", "node_type": "1", "metadata": {}, "hash": "afc60a51fda4a27f1ff9eff577c21114c345f60b1337a2eec97493aea6683182", "class_name": "RelatedNodeInfo"}}, "text": "(ext().cache_get(b\"key\"), None);\n}\n```\n\n### Contract State <a href=\"#contract-state\" id=\"contract-state\"></a>\n\nHere is how you store simple values as your contract state:\n\n```rust\n#[ink(storage)]\npub struct MyContract {\n    // Store a bool\n    my_bool: bool,\n    // Store some number\n    my_number: u32,\n}\n```\n\nUnlike other ink contracts in which such values are stored publicly on-chain, in Phat Contract, all your contract state is transparently encrypted for you.\n\n> Technically speaking, your Phat contract state is not persistently stored anywhere (not even on chain). In Phat contract, any transaction handler functions must be deterministic, so any worker can restore the contract state by replaying all the historical transactions in order (since they are stored on chain). Such design is called Event Sourcing and you can learn more about it in Section 2.2 of our [whitepaper](https://files.phala.network/phala-paper.pdf).\n\n#### External Storage Services <a href=\"#external-storage-services\" id=\"external-storage-services\"></a>\n\nWith its HTTP support, you can connect to any storage services you like in your Phat contract.\n\nFor simple key-value storage, [pink-s3](https://crates.io/crates/pink-s3) enables you to store data in any storage service with S3-API support.\n\n```rust\nfn s3_example() {\n\n    use pink_s3 as s3;\n\n    let endpoint = \"s3.ap-southeast-1.amazonaws.com\";\n    let region = \"ap-southeast-1\";\n    let access_key = \"<Put your S3 access key here>\";\n    let secret_key = \"<Put your S3 access secret key here>\";\n\n    let s3 = s3::S3::new(endpoint, region, access_key, secret_key)\n        .unwrap()\n        .virtual_host_mode(); // virtual host mode is required for newly created AWS S3 buckets.\n\n    let bucket = \"my-wallet\";\n    let object_key = \"path/to/foo\";\n    let value = b\"bar\";\n\n    s3.put(bucket, object_key, value).unwrap();\n\n    let head = s3.head(bucket, object_key).unwrap();\n    assert_eq!(head.content_length, value.len() as u64);\n\n    let v = s3.get(bucket, object_key).unwrap();\n    assert_eq!", "mimetype": "text/plain", "start_char_idx": 1580, "end_char_idx": 3612, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0295d9f2-2080-4ae7-8d3a-a3baebe10dfc": {"__data__": {"id_": "0295d9f2-2080-4ae7-8d3a-a3baebe10dfc", "embedding": null, "metadata": {"file_path": "phala-docs_dist/store-contract-states.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "375684a5-c302-432b-821b-1c22ffc7cfd1", "node_type": "4", "metadata": {}, "hash": "9a82dbca7078c31212769b4129f445b252a0e17214739df408c05d3a28753815", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "4c065d1f-7710-4af0-b820-5100c1b79dd7", "node_type": "1", "metadata": {}, "hash": "ae4eeff7207511e151224d3eb0247e6e2264225961af4c223d4635b7e9f57bf8", "class_name": "RelatedNodeInfo"}}, "text": "(v, value);\n\n    s3.delete(bucket, object_key).unwrap();\n\n}\n```\n\nSuch storage service providers include:\n\n* [Amazon S3](https://aws.amazon.com/s3/) - 5GB, 12 months free\n* [4everland](https://www.4everland.org/bucket/) - 5GB free on IPFS and 100MB Free on Arweave\n* [Storj](https://www.storj.io/) - 150GB free\n* [Filebase](https://filebase.com/) - 5GB free\n\nIf you want a relational database like MySql, you can also use DBaaS services like\n\n* [PingCap](https://www.pingcap.com/), which is based on TiDB", "mimetype": "text/plain", "start_char_idx": 3612, "end_char_idx": 4115, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6b6bc4ed-bc89-4e60-991a-84f73de9a2df": {"__data__": {"id_": "6b6bc4ed-bc89-4e60-991a-84f73de9a2df", "embedding": null, "metadata": {"file_path": "phala-docs_dist/builders-program.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9e8bb349-ce3f-40f4-8555-0c50643f84e2", "node_type": "4", "metadata": {}, "hash": "d86abcfeebf97db79492f4ac4ba5be1cfb142bc9cefcec00e29ebd8d52476e44", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a89adc71-68b5-41c3-9763-142bf1f867b3", "node_type": "1", "metadata": {}, "hash": "6d0dcd6d2d4779d8c6154227867de068a82b27eaacde48349497795107eb9741", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83d\udc68\u200d\ud83d\ude80 Builders Program\n\n## _**About the Phala Builders Program**_ <a href=\"#about-the-phala-builders-program\" id=\"about-the-phala-builders-program\"></a>\n\n> _Funding and supporting innovative projects building with the Phala Compute Cloud via Phat Contract._\n\nThe Phala Builders Program provides funding, guidance, and support to developers that want to build high-value projects with Phat Contract, and add functionality to Phat Contract itself.\n\n### **Why you should apply:** <a href=\"#why-you-should-apply\" id=\"why-you-should-apply\"></a>\n\n**You want to Build Impossible Dapps**\n\n* You want to push the limits of what smart contracts are capable of by incorporating an off-chain computation solution that utilizes a self-executing and tamper-proof model.\n\n**You care about Decentralization**\n\n* You\u2019re passionate about the need for decentralized web services and user-controlled digital infrastructure.\n\n**You need a Scalable Trustless Infrastructure**\n\n* You\u2019re seeking a computation solution that can handle any level of compute demand, and perform your computation securely, privately, and trustlessly.\n\n### **What do we offer?** <a href=\"#what-do-we-offer\" id=\"what-do-we-offer\"></a>\n\n**Funding**\n\n* Up to $50,000 USD value in PHA token, paid out on-chain at agreed-upon intervals dictated by the Builder Agreement.\n\n**Technical Assistance**\n\n* Deep technical support from lead Phat Contract developers during the design, testing, and deployment phases of project development.\n\n**Marketing and Network Support**\n\n* Phala will promote your project through our own channels and within our community, and make introductions to relevant ecosystem partners. We will make sure your developed application receives the attention it deserves.\n\n### **Guidelines for Potential Applicants** <a href=\"#guidelines-for-potential-applicants\" id=\"guidelines-for-potential-applicants\"></a>\n\nThe Phala Builders Program supports high-quality teams that have a solid understanding of the Phat Contract platform and a clear vision of how they will utilize Phat Contract within their project. Projects that come into the application process with a MVP or some level of existing development with Phat Contract are more likely to be successful in securing funding.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2244, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a89adc71-68b5-41c3-9763-142bf1f867b3": {"__data__": {"id_": "a89adc71-68b5-41c3-9763-142bf1f867b3", "embedding": null, "metadata": {"file_path": "phala-docs_dist/builders-program.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9e8bb349-ce3f-40f4-8555-0c50643f84e2", "node_type": "4", "metadata": {}, "hash": "d86abcfeebf97db79492f4ac4ba5be1cfb142bc9cefcec00e29ebd8d52476e44", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "6b6bc4ed-bc89-4e60-991a-84f73de9a2df", "node_type": "1", "metadata": {}, "hash": "37d97dff96936b95fa5da4a23076822664a624eb055175c51fc20e200421c959", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "6512d727-bbac-4f8b-aba0-2de85107b031", "node_type": "1", "metadata": {}, "hash": "c98680351fa79066565de4915e9ca60367ed567cc1a66e946aaa0a322d67b039", "class_name": "RelatedNodeInfo"}}, "text": "### **What we look for:**\n\n**Compelling Teams**\n\n* Teams with strong technical backgrounds that have a clear vision for their project, including a growth strategy and structured plan of development.\n\n**Innovative Ideas**\n\n* As Phat Contract represents a new tool in the kit of Web3 developers, we\u2019re looking to support projects that seek to push the envelope of what can be built on blockchain. We want to support new ideas that add something novel to the space.\n\n**Contributions to Phat Contract Tooling**\n\n* Phat Contract is a highly composable developer resource, we value teams that seek to build out new tooling and primitives within the SDK.\n\n### **Funding Levels** <a href=\"#funding-levels\" id=\"funding-levels\"></a>\n\n**Tier One** _Maximum Value: $20,000 USD value paid in PHA_ Criteria: Development of a compelling project involving significant usage of Phat Contract.\n\n**Tier Two** _Maximum Value: $50,000 USD value paid in PHA_ Criteria: Development of a compelling project or projects involving significant usage of Phat Contract, and the development of new tooling for Phat Contract.\n\n## **Application Process** <a href=\"#application-process\" id=\"application-process\"></a>\n\n_The application process for both tier one and tier two funding is the same, however tier two applicants can expect a more rigorous evaluation._\n\n<figure><img src=\"../.gitbook/assets/builders-program.png\" alt=\"\"><figcaption></figcaption></figure>\n\n**1. Application**\n\n* Fill out and submit an application [form](https://docs.google.com/forms/d/e/1FAIpQLSdaWa5YA-YJL7Cc0b0\\_cbpCdOvu1Ra7uJI95cudSLIduMrv\\_A/viewform?usp=sf\\_link).\n\n**2. Introductory Call**\n\n* The Phala Builders Program Committee will schedule a call with compelling applicants to review the details of their application and determine whether or not to move forward. _Timeline: Applicants will hear from the Committee via email within one week of submitting an application, at which time successful applicants will schedule an introductory call with the team._\n\n**3. Evaluatory Call**\n\n* Applicants will present the technical side of their project in depth to the Phat Contract development team.", "mimetype": "text/plain", "start_char_idx": 2246, "end_char_idx": 4391, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6512d727-bbac-4f8b-aba0-2de85107b031": {"__data__": {"id_": "6512d727-bbac-4f8b-aba0-2de85107b031", "embedding": null, "metadata": {"file_path": "phala-docs_dist/builders-program.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9e8bb349-ce3f-40f4-8555-0c50643f84e2", "node_type": "4", "metadata": {}, "hash": "d86abcfeebf97db79492f4ac4ba5be1cfb142bc9cefcec00e29ebd8d52476e44", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a89adc71-68b5-41c3-9763-142bf1f867b3", "node_type": "1", "metadata": {}, "hash": "6d0dcd6d2d4779d8c6154227867de068a82b27eaacde48349497795107eb9741", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b7cec1c0-c472-4c7a-be59-59dfdd354f74", "node_type": "1", "metadata": {}, "hash": "920af2db9e6d53f1092ed6fe211684e21a08082e4b48aaf99bcefc93a2344bb8", "class_name": "RelatedNodeInfo"}}, "text": "In this call, applicants will demonstrate how their project leverages Phat Contract to create an innovative product that brings value to Phala and present a potential milestone structure. _Timeline: Scheduled within one week following a successful introductory call._\n\n**4. Committee Review**\n\n* The Phala Builders Program Committee will review the application and determine an appropriate funding amount, milestone and payment structure, and overall expectations for successful applicants, to be incorporated into a Builders Agreement. _Timeline: Within two weeks of Evaluatory Call._\n\n**5. Execution and Partnership**\n\n* Upon accepting the terms of the Builders Agreement, successful applicants will start working towards milestones with an agreed-upon level of involvement and support from the Phala developer team. _Timeline: Applicants will receive a Builders Agreement immediately following the Committee Review._\n\n**Maximum total time from application submission to Builders Agreement offer: one month.**\n\nThe Phala Builders Program is a unique opportunity to receive funding and support to build with Phat Contract, however we encourage applicants to seek support from complimentary grant programs or accelerators as well. The Phala Builders Program Committee will endeavor to be as collaborative as possible, and may offer support to successful applicants in securing external funding.\n\nIf you have questions about the Phala Builders Program or application process, please reach out to us at \\[email protected] or in our [Discord](https://discord.gg/phala-network).", "mimetype": "text/plain", "start_char_idx": 4392, "end_char_idx": 5966, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b7cec1c0-c472-4c7a-be59-59dfdd354f74": {"__data__": {"id_": "b7cec1c0-c472-4c7a-be59-59dfdd354f74", "embedding": null, "metadata": {"file_path": "phala-docs_dist/builders-program.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "9e8bb349-ce3f-40f4-8555-0c50643f84e2", "node_type": "4", "metadata": {}, "hash": "d86abcfeebf97db79492f4ac4ba5be1cfb142bc9cefcec00e29ebd8d52476e44", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "6512d727-bbac-4f8b-aba0-2de85107b031", "node_type": "1", "metadata": {}, "hash": "c98680351fa79066565de4915e9ca60367ed567cc1a66e946aaa0a322d67b039", "class_name": "RelatedNodeInfo"}}, "text": "If you\u2019d like to learn more about Phat Contract and our developer tooling, please explore our developer library below:\n\n* Detailed documents and more code examples as your reference\n  * [https://github.com/Phala-Network/awesome-phat-contracts](https://github.com/Phala-Network/awesome-phat-contracts)\n  * [https://github.com/Phala-Network/phat-contract-examples](https://github.com/Phala-Network/phat-contract-examples)\n* Developer toolings\n  * Web console: [https://phat.phala.network](https://phat.phala.network/)\n    * Build out a frontend where you can deploy and interact with your contract\n  * Project manager\n    * Quickly get a blank template and spin up a local cluster for testing with [https://github.com/l00k/devphase](https://github.com/l00k/devphase)\n    * Swanky CLI integration (wraps devphase into a swanky plugin) [https://github.com/Phala-Network/swanky-plugin-phala](https://github.com/Phala-Network/swanky-plugin-phala)\n* Basic Libraries\n  * Storage support: Wrapped Filecoin, Arweave, Storj and Amazon S3 with a S3-standard API\n    * [https://crates.io/crates/pink-s3](https://crates.io/crates/pink-s3)\n  * Cross-chain transaction support: ETH Queries & Transactions\n    * [https://crates.io/crates/pink-web3](https://crates.io/crates/pink-web3)\n* Advanced Library\n  * Stateful rollup: reliable cross-chain request processing\n    * Allows you to monitor the requests from EVM contracts and Substrate-based chains and reliably send cross-chain transactions as replies\n    * [https://github.com/Phala-Network/phat-stateful-rollup](https://github.com/Phala-Network/phat-stateful-rollup)", "mimetype": "text/plain", "start_char_idx": 5968, "end_char_idx": 7573, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "642f716b-a2e0-48ad-a49e-f049c9249237": {"__data__": {"id_": "642f716b-a2e0-48ad-a49e-f049c9249237", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "015f861f-e44d-4f18-b6da-37d1debba8c3", "node_type": "1", "metadata": {}, "hash": "ba4f407b5597d2fe31731014cae3ce77e46a3a43e2bf11dd4d56b7dad1949499", "class_name": "RelatedNodeInfo"}}, "text": "# Integrate with 3rd Party API with HTTP Request\n\nNow that we have been able to deploy a couple of template AI Agents, let's connect our AI Agent to a 3rd party API through HTTP request. We will use the [OpenAI AI Agent Contract](build-your-ai-agent-contract-with-openai.md) for this example.\n\n{% hint style=\"info\" %}\nView the example code [here](https://github.com/HashWarlock/ai-agent-template-hello). The code is based on the [guide](https://cookbook.openai.com/examples/how\\_to\\_build\\_an\\_agent\\_with\\_the\\_node\\_sdk) on how to build an agent from the OpenAI Cookbook.\n{% endhint %}\n\n## Overview\n\nIn this tutorial, you will learn how to create an agent with 2 functions to enable [function calling](https://platform.openai.com/docs/guides/function-calling) for your agent. The 2 functions we will implement are:\n\n* `getLocation()`  - Get the current location (latitude, longitude) based on the IP of the worker node if no location is described in the user prompt.\n* `getWeatherData(latitude, longitude)` - Get the current weather data based on the latitude and longitude retrieved from `getLocation()`.&#x20;\n\nThese two functions will be described for your agent to understand the purpose of the functions. Then we will set the system prompt for the agent with:\n\n```\nYou are a helpful assistant. Only use the functions you have been provided with.\n```\n\n## Getting Started\n\n### Prepare\n\nClone git repo or use [degit](https://www.npmjs.com/package/degit) to get the source code.\n\n{% tabs %}\n{% tab title=\"git\" %}\n```sh\ngit clone https://github.com/Phala-Network/ai-agent-template-openai.git\n```\n{% endtab %}\n\n{% tab title=\"degit\" %}\n```sh\nnpx degit github:Phala-Network/ai-agent-template-openai#main ai-agent-template-openai\n```\n{% endtab %}\n{% endtabs %}\n\nInstall dependencies\n\n```\nnpm install\n```\n\n## Creating Your Functions\n\nIn this step, we will create our 2 functions `getLocation()` and `getWeatherData(latitude, longitude)` then we will describe our functions for the agent to understand how to use the functions.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2023, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "015f861f-e44d-4f18-b6da-37d1debba8c3": {"__data__": {"id_": "015f861f-e44d-4f18-b6da-37d1debba8c3", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "642f716b-a2e0-48ad-a49e-f049c9249237", "node_type": "1", "metadata": {}, "hash": "817d19c30e0ac84746bfb686ac5a9ef29974b4dc3f147877cb17ee3b4f579c5c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "18d442e2-a9ad-419f-a81f-f2479e073d04", "node_type": "1", "metadata": {}, "hash": "1f0843e6a545b4a9c3c34b3174249b8049d97da37a0e1f5c398cb3618f0dea81", "class_name": "RelatedNodeInfo"}}, "text": "Go to your `src/index.ts` file, your initial file should look like the following.\n\n<details>\n\n<summary>src/index.ts</summary>\n\n```typescript\nimport { Request, Response, route } from './httpSupport'\nimport { renderHtml } from './uiSupport'\n\nimport OpenAI from 'openai'\n\nasync function GET(req: Request): Promise<Response> {\n    const secret = req.queries?.key ?? '';\n    const openaiApiKey = req.secret?.openaiApiKey as string;\n    const openai = new OpenAI({ apiKey: openaiApiKey })\n    const query = req.queries.chatQuery[0] as string;\n\n    const completion = await openai.chat.completions.create({\n        messages: [{ role: \"system\", content: `${query}` }],\n        model: 'gpt-3.5-turbo',\n    });\n\n    return new Response(renderHtml(completion.choices[0].message.content as string))\n}\n\nasync function POST(req: Request): Promise<Response> {\n    const secret = req.queries?.key ?? '';\n    const openaiApiKey = req.secret?.openaiApiKey as string;\n    const openai = new OpenAI({ apiKey: openaiApiKey })\n    const query = req.queries.chatQuery[0] as string;\n\n    const completion = await openai.chat.completions.create({\n        messages: [{ role: \"system\", content: `${query}` }],\n        model: 'gpt-3.5-turbo',\n    });\n\n    return new Response(renderHtml(completion.choices[0].message.content as string))\n}\n\nexport default async function main(request: string) {\n    return await route({ GET, POST }, request)\n}\n```\n\n</details>\n\n### Create getLocation()\n\nFor the `getLocation()` function, we will need to call an API to get the location based on [https://ipapi.co/](https://ipapi.co/). Traditionally, devs will not have access to the internet, but with Phala's AI Agent Contracts, devs now can make async HTTP calls to bring more data for fine tuning their agents.&#x20;\n\nThe implementation is simple and we will add this following code.", "mimetype": "text/plain", "start_char_idx": 2025, "end_char_idx": 3865, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "18d442e2-a9ad-419f-a81f-f2479e073d04": {"__data__": {"id_": "18d442e2-a9ad-419f-a81f-f2479e073d04", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "015f861f-e44d-4f18-b6da-37d1debba8c3", "node_type": "1", "metadata": {}, "hash": "ba4f407b5597d2fe31731014cae3ce77e46a3a43e2bf11dd4d56b7dad1949499", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "68f0d708-caa7-4ad6-a04c-44b6303ce570", "node_type": "1", "metadata": {}, "hash": "96955a75a24090cc2849dc3806131617512cbea855da160772fda28c4fc3b53b", "class_name": "RelatedNodeInfo"}}, "text": "```typescript\nasync function getLocation() {\n    const response = await fetch(\"https://ipapi.co/json/\");\n    const locationData = await response.json();\n    return locationData;\n}\n```\n\n### Create getWeatherData(latitude, longitude)\n\nFor the getWeatherData(latitude, longitude) function, we will call the free weather API by [https://open-meteo.com/](https://open-meteo.com/).&#x20;\n\nWe will add the following code to our `index.ts` file.\n\n```typescript\nasync function getCurrentWeather(latitude: any, longitude: any) {\n    const url = `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&hourly=apparent_temperature`;\n    const response = await fetch(url);\n    const weatherData = await response.json();\n    return weatherData;\n}\n```\n\n### Describe Functions\n\nFor our OpenAI agent to understand the purpose of these functions, we need to describe them using a specific schema. We'll create an array called `tools` that contains one object per function. Each object will have two keys: `type`, `function`, and the `function` key has three subkeys: `name`, `description`, and `parameters`.\n\n```typescript\nconst tools = [\n    {\n        type: \"function\",\n        function: {\n            name: \"getCurrentWeather\",\n            description: \"Get the current weather in a given location\",\n            parameters: {\n                type: \"object\",\n                properties: {\n                    latitude: {\n                        type: \"string\",\n                    },\n                    longitude: {\n                        type: \"string\",\n                    },\n                },\n                required: [\"longitude\", \"latitude\"],\n            },\n        }\n    },\n    {\n        type: \"function\",\n        function: {\n            name: \"getLocation\",\n            description: \"Get the user's location based on their IP address\",\n            parameters: {\n                type: \"object\",\n                properties: {},\n            },\n        }\n    },\n];\n\nconst availableTools = {\n    getCurrentWeather,\n    getLocation,\n};\n```\n\n## Add Agent Functionality\n\n### Setup Messages for Agent\n\nWe need to define a `messages` array. This will keep track of all of the messages back and forth between our app and OpenAI. Here we create a type `MessageInfo` that will be the fields that may be included in the `messages` array.", "mimetype": "text/plain", "start_char_idx": 3867, "end_char_idx": 6212, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "68f0d708-caa7-4ad6-a04c-44b6303ce570": {"__data__": {"id_": "68f0d708-caa7-4ad6-a04c-44b6303ce570", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "18d442e2-a9ad-419f-a81f-f2479e073d04", "node_type": "1", "metadata": {}, "hash": "1f0843e6a545b4a9c3c34b3174249b8049d97da37a0e1f5c398cb3618f0dea81", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "9304a8a2-7d60-4be8-b089-06b81d760198", "node_type": "1", "metadata": {}, "hash": "7e8c0694f8c59f502c6216e556a13a43fc75cc2a6bfd812e36de928c23345170", "class_name": "RelatedNodeInfo"}}, "text": "The first object in the array should always have the `role` property set to `\"system\"`, which tells OpenAI that this is how we want it to behave.\n\n```typescript\ntype MessageInfo = {\n    role: any,\n    content: any,\n    name?: any,\n}\n\nconst messages: MessageInfo[] = [\n    {\n        role: \"system\",\n        content: `You are a helpful assistant. Only use the functions you have been provided with.`,\n    },\n];\n```\n\n### Create Agent Function For User Input\n\nWe are now ready to build the logic of our app, which lives in the `agent` function. It is asynchronous and takes one argument: the `userInput`.\n\nWe start by pushing the `userInput` to the messages array. This time, we set the `role` to `\"user\"`, so that OpenAI knows that this is the input from the user.\n\n```typescript\nasync function agent(openai, userInput) {\n  messages.push({\n    role: \"user\",\n    content: userInput,\n  });\n  const response = await openai.chat.completions.create({\n    model: \"gpt-4o\",\n    messages: messages,\n    tools: tools,\n  });\n  console.log(response);\n}\n```\n\nNext, we'll send a request to the Chat completions endpoint via the `chat.completions.create()` method in the Node SDK. This method takes a configuration object as an argument. In it, we'll specify three properties:\n\n* `model` - Decides which AI model we want to use (in our case, GPT-4).\n* `messages` - The entire history of messages between the user and the AI up until this point.\n* `tools` - A list of tools the model may call. Currently, only functions are supported as a tool., we'll we use the `tools` array we created earlier.\n\n### Turn OpenAI Agent Response into Functions\n\nNow that we have the name of the function as a string, we'll need to translate that into a function call.", "mimetype": "text/plain", "start_char_idx": 6214, "end_char_idx": 7946, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "9304a8a2-7d60-4be8-b089-06b81d760198": {"__data__": {"id_": "9304a8a2-7d60-4be8-b089-06b81d760198", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "68f0d708-caa7-4ad6-a04c-44b6303ce570", "node_type": "1", "metadata": {}, "hash": "96955a75a24090cc2849dc3806131617512cbea855da160772fda28c4fc3b53b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "36b0483c-375f-4b56-992e-1d64eb94cfac", "node_type": "1", "metadata": {}, "hash": "1cce29a21f358328777e6079cc311c14ba4fdc1adebff633ffd4ee0852545df0", "class_name": "RelatedNodeInfo"}}, "text": "To help us with that, we'll gather both of our functions in an object called `availableTools`:\n\n```typescript\nconst availableTools = {  getCurrentWeather,  getLocation,};\n```\n\nThis is handy because we'll be able to access the `getLocation` function via bracket notation and the string we got back from OpenAI, like this: `availableTools[\"getLocation\"]`.\n\n```typescript\nconst { finish_reason, message } = response.choices[0]; \nif (finish_reason === \"tool_calls\" && message.tool_calls) {  \n    const functionName = message.tool_calls[0].function.name;  \n    const functionToCall = availableTools[functionName];  \n    const functionArgs = JSON.parse(message.tool_calls[0].function.arguments);  \n    const functionArgsArr = Object.values(functionArgs);  \n    const functionResponse = await functionToCall.apply(null, functionArgsArr);  \n    console.log(functionResponse);\n}\n```\n\nWe're also grabbing ahold of any arguments OpenAI wants us to pass into the function: `message.tool_calls[0].function.arguments`. However, we won't need any arguments for this first function call.\n\nIf we run the code again with the same input (`\"Where am I located right now?\"`), we'll see that `functionResponse` is an object filled with location about where the user is located right now. In my case, that is Oslo, Norway.", "mimetype": "text/plain", "start_char_idx": 7947, "end_char_idx": 9246, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "36b0483c-375f-4b56-992e-1d64eb94cfac": {"__data__": {"id_": "36b0483c-375f-4b56-992e-1d64eb94cfac", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "9304a8a2-7d60-4be8-b089-06b81d760198", "node_type": "1", "metadata": {}, "hash": "7e8c0694f8c59f502c6216e556a13a43fc75cc2a6bfd812e36de928c23345170", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c648f211-3ec2-4e11-b524-b1a375e10ac4", "node_type": "1", "metadata": {}, "hash": "5274399673e8225230b0bd733b17b9814670b06d9c52801786b72e9ea0c55497", "class_name": "RelatedNodeInfo"}}, "text": "```bash\n{ip: \"193.212.60.170\", network: \"193.212.60.0/23\", version: \"IPv4\", city: \"Oslo\", region: \"Oslo County\", region_code: \"03\", country: \"NO\", country_name: \"Norway\", country_code: \"NO\", country_code_iso3: \"NOR\", country_capital: \"Oslo\", country_tld: \".no\", continent_code: \"EU\", in_eu: false, postal: \"0026\", latitude: 59.955, longitude: 10.859, timezone: \"Europe/Oslo\", utc_offset: \"+0200\", country_calling_code: \"+47\", currency: \"NOK\", currency_name: \"Krone\", languages: \"no,nb,nn,se,fi\", country_area: 324220, country_population: 5314336, asn: \"AS2119\", org: \"Telenor Norge AS\"}\n```\n\nWe'll add this data to a new item in the `messages` array, where we also specify the name of the function we called.\n\n```typescript\nmessages.push({\n  role: \"function\",\n  name: functionName,\n  content: `The result of the last function was this: ${JSON.stringify(\n    functionResponse\n  )}\n  `,\n});\n```\n\nNotice that the `role` is set to `\"function\"`. This tells OpenAI that the `content` parameter contains the result of the function call and not the input from the user.\n\nAt this point, we need to send a new request to OpenAI with this updated `messages` array. However, we don\u2019t want to hard code a new function call, as our agent might need to go back and forth between itself and GPT several times until it has found the final answer for the user.\n\nThis can be solved in several different ways, e.g. recursion, a while-loop, or a for-loop. We'll use a good old for-loop for the sake of simplicity.&#x20;\n\n### Creating The Loop\n\nAt the top of the `agent` function, we'll create a loop that lets us run the entire procedure up to five times.", "mimetype": "text/plain", "start_char_idx": 9248, "end_char_idx": 10882, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c648f211-3ec2-4e11-b524-b1a375e10ac4": {"__data__": {"id_": "c648f211-3ec2-4e11-b524-b1a375e10ac4", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "36b0483c-375f-4b56-992e-1d64eb94cfac", "node_type": "1", "metadata": {}, "hash": "1cce29a21f358328777e6079cc311c14ba4fdc1adebff633ffd4ee0852545df0", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "08167894-b979-4a82-98e2-672db922885d", "node_type": "1", "metadata": {}, "hash": "1fc465da41e82459ceaf12ba92086260d4c980586c0087a5dfba562014f6d8ec", "class_name": "RelatedNodeInfo"}}, "text": "If we get back `finish_reason: \"tool_calls\"` from GPT, we'll just push the result of the function call to the `messages` array and jump to the next iteration of the loop, triggering a new request.\n\nIf we get `finish_reason: \"stop\"` back, then GPT has found a suitable answer, so we'll return the function and cancel the loop.\n\n```typescript\nfor (let i = 0; i < 5; i++) {\n  const response = await openai.chat.completions.create({\n    model: \"gpt-4o\",\n    messages: messages,\n    tools: tools,\n  });\n  const { finish_reason, message } = response.choices[0];\n \n  if (finish_reason === \"tool_calls\" && message.tool_calls) {\n    const functionName = message.tool_calls[0].function.name;\n    const functionToCall = availableTools[functionName];\n    const functionArgs = JSON.parse(message.tool_calls[0].function.arguments);\n    const functionArgsArr = Object.values(functionArgs);\n    const functionResponse = await functionToCall.apply(null, functionArgsArr);\n \n    messages.push({\n      role: \"function\",\n      name: functionName,\n      content: `\n          The result of the last function was this: ${JSON.stringify(\n            functionResponse\n          )}\n          `,\n    });\n  } else if (finish_reason === \"stop\") {\n    messages.push(message);\n    return message.content;\n  }\n}\nreturn \"The maximum number of iterations has been met without a suitable answer. Please try again with a more specific input.\";\n```\n\nIf we don't see a `finish_reason: \"stop\"` within our five iterations, we'll return a message saying we couldn\u2019t find a suitable answer.\n\n## Update GET() and POST()\n\nNow we need to call our `agent(openai, userInput)` in our `GET` and `POST` calls that will pass in a users prompt that can be accessed in the `chatQuery` property. The code change is minimial and our functions look like the following.\n\n```typescript\nasync function GET(req: Request): Promise<Response> {\n    const secret = req.queries?.key ??", "mimetype": "text/plain", "start_char_idx": 10884, "end_char_idx": 12804, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "08167894-b979-4a82-98e2-672db922885d": {"__data__": {"id_": "08167894-b979-4a82-98e2-672db922885d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c648f211-3ec2-4e11-b524-b1a375e10ac4", "node_type": "1", "metadata": {}, "hash": "5274399673e8225230b0bd733b17b9814670b06d9c52801786b72e9ea0c55497", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "0a48f20f-64cf-476c-9162-082e3e84b40a", "node_type": "1", "metadata": {}, "hash": "7aa0b80fc8bc75fa22a4095a00b6414fb67dde5f61e6ee1578b6dfacb75ca02b", "class_name": "RelatedNodeInfo"}}, "text": "'';\n    const openaiApiKey = req.secret?.openaiApiKey as string;\n    const openai = new OpenAI({ apiKey: openaiApiKey })\n    const query = req.queries.chatQuery[0] as string;\n\n    const response = await agent(openai, query);\n\n    return new Response(renderHtml(response as string))\n}\n\nasync function POST(req: Request): Promise<Response> {\n    const secret = req.queries?.key ?? '';\n    const openaiApiKey = req.secret?.openaiApiKey as string;\n    const openai = new OpenAI({ apiKey: openaiApiKey })\n    const query = req.queries.chatQuery[0] as string;\n\n    const response = await agent(openai, query);\n\n    return new Response(renderHtml(response as string))\n}\n```\n\n## Test Locally\n\nNow that we have the code implemented to interact with APIs and call the functions, let's test the code locally.\n\nCreate `.env` file with the default ThirdWeb API key for publishing your Agent Contract to IPFS\n\n```\ncp .env.local .env\n```\n\nIn `./secrets/default.json` file replace `YOUR_OPENAI_KEY` with your API Key\n\n```json\n{\n  \"openaiApiKey\": \"YOUR_OPENAI_API_KEY\"\n}\n```\n\n> In your `./tests/test.ts` file. Add your API Key manually to have a functional test.\n>\n> ```typescript\n> let getResult = await execute({\n>     method: 'GET',\n>     path: '/ipfs/CID',\n>     queries: { chatQuery: [\"Who are you?\"] },\n>     secret: { openaiApiKey: \"YOUR_OPENAI_API_KEY\" },\n>     headers: {},\n> })\n> ```\n\nBuild your Agent\n\n```\nnpm run build\n```\n\nTest your Agent locally\n\n```\nnpm run test\n```\n\nExpected output:\n\n```bash\nINPUT: {\"method\":\"GET\",\"path\":\"/ipfs/CID\",\"queries\":{},\"secret\":{\"openaiApiKey\":\"OPENAI_API_KEY\"},\"headers\":{}}\n[0]chat\n[1]chat\n[2]chat\nGET RESULT: {\n  status: 200,\n  body: `{\"message\":\"There's a lot to do in Austin, Texas! Here are some activities you might consider based on the current weather and various interests:\\\\n\\\\n### Outdoor Activities\\\\n1.", "mimetype": "text/plain", "start_char_idx": 12805, "end_char_idx": 14649, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0a48f20f-64cf-476c-9162-082e3e84b40a": {"__data__": {"id_": "0a48f20f-64cf-476c-9162-082e3e84b40a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "08167894-b979-4a82-98e2-672db922885d", "node_type": "1", "metadata": {}, "hash": "1fc465da41e82459ceaf12ba92086260d4c980586c0087a5dfba562014f6d8ec", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "335cc0a4-1dab-4c59-85ec-dc9afa737f8d", "node_type": "1", "metadata": {}, "hash": "aaf0e8260d75b17cfbca591f96a9523c04cce1c5f7271a22c8e300b3b33afb35", "class_name": "RelatedNodeInfo"}}, "text": "**Lady Bird Lake & Zilker Park**\\\\n   - **Kayaking/Paddleboarding**: Enjoy a relaxing paddle on Lady Bird Lake.\\\\n   - **Hiking/Biking**: Explore the trails around Zilker Park and Barton Springs.\\\\n\\\\n2. **Barton Springs Pool**\\\\n   - A perfect spot for a swim and to cool off from the summer heat.\\\\n\\\\n3. **Mount Bonnell**\\\\n   - For those who love scenic views and a bit of hiking, head to Mount Bonnell for a panoramic view of the city.\\\\n\\\\n### Cultural Activities\\\\n1. **Blanton Museum of Art**\\\\n   - Explore a variety of art collections ranging from contemporary to ancient.\\\\n\\\\n2. **Bullock Texas State History Museum**\\\\n   - Learn about the rich history of Texas through exhibits and films.\\\\n\\\\n3. **South Congress Avenue (SoCo)**\\\\n   - Wander through boutique shops, galleries, and enjoy some street performances.\\\\n\\\\n### Music & Nightlife\\\\n1. **Live Music**\\\\n   - Check out iconic venues like the Continental Club or Antone\u2019s for some live performances.\\\\n\\\\n2. **Rainey Street Historic District**\\\\n   - Explore a variety of bars and food trucks in this lively area.\\\\n\\\\n### Food & Beverage\\\\n1. **BBQ Heaven**\\\\n   - Visit Franklin Barbecue or la Barbecue for some of the best BBQ in the city.\\\\n   \\\\n2. **Food Trucks**\\\\n   - Explore the diverse array of food trucks offering a variety of cuisines.\\\\n\\\\n### Weather Considerations\\\\n- The apparent temperature during the day can reach up to 37.2\u00b0C (98.96\u00b0F) with some moments going as high as 38.9\u00b0C (102.02\u00b0F). Ensure you stay hydrated and take breaks in shaded or air-conditioned areas.\\\\n\\\\nNo matter what your interests are, Austin has a variety of activities to make your day enjoyable. Make sure to check local event listings as well for any special events or festivals happening today.", "mimetype": "text/plain", "start_char_idx": 14650, "end_char_idx": 16416, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "335cc0a4-1dab-4c59-85ec-dc9afa737f8d": {"__data__": {"id_": "335cc0a4-1dab-4c59-85ec-dc9afa737f8d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "0a48f20f-64cf-476c-9162-082e3e84b40a", "node_type": "1", "metadata": {}, "hash": "7aa0b80fc8bc75fa22a4095a00b6414fb67dde5f61e6ee1578b6dfacb75ca02b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b1e2778b-2faa-429b-a509-4b4b71923e9f", "node_type": "1", "metadata": {}, "hash": "a7dabb7349ebbab040ea262e5fd2ab83ce775f7fb17b8e017c6605b95e79dd35", "class_name": "RelatedNodeInfo"}}, "text": "\"}`,\n  headers: {\n    'Content-Type': 'application/json',\n    'Access-Control-Allow-Origin': '*'\n  }\n}\nINPUT: {\"method\":\"GET\",\"path\":\"/ipfs/CID\",\"queries\":{\"chatQuery\":[\"What are some activities based in Brussels today?\"]},\"secret\":{\"openaiApiKey\":\"OPENAI_API_KEY\"},\"headers\":{}}\n[0]chat\n[1]chat\n[2]chat\n[3]chat\nGET RESULT: {\n  status: 200,\n  body: `{\"message\":\"Brussels is a vibrant city with a lot of things to offer on any given day. Here are some activities you can enjoy today:\\\\n\\\\n### Outdoor Activities\\\\n1. **Grand Place**\\\\n   - Visit the heart of Brussels and marvel at the stunning architecture. You might catch some street performances as well.\\\\n\\\\n2. **Parc du Cinquantenaire**\\\\n   - Take a relaxing stroll or have a picnic in this beautiful park.\\\\n\\\\n3. **Atomium**\\\\n   - Explore this unique building and enjoy panoramic views of the city.\\\\n\\\\n### Cultural Activities\\\\n1. **Royal Museums of Fine Arts of Belgium**\\\\n   - Explore Belgian art and various exhibitions ranging from ancient to modern art.\\\\n\\\\n2. **Magritte Museum**\\\\n   - Dive into the surreal world of Ren\u00e9 Magritte, one of Belgium's most famous artists.\\\\n\\\\n3. **Belgian Comic Strip Center**\\\\n   - Discover the rich history of comic strips in Belgium, including famous characters like Tintin.\\\\n\\\\n### Gourmet Experiences\\\\n1. **Chocolate and Beer Tours**\\\\n   - Take a guided tour to sample some of Brussels' best chocolates and beers.\\\\n\\\\n2. **Waffles and Frites**\\\\n   - Enjoy traditional Belgian waffles and fries at local eateries.\\\\n\\\\n### Shopping and Markets\\\\n1. **Galeries Royales Saint-Hubert**\\\\n   - Explore this beautiful shopping arcade filled with boutique shops and cafes.\\\\n\\\\n2. **Marolles Flea Market**\\\\n   - Hunt for unique items and antiques at this bustling market.\\\\n\\\\n### Theatre and Music\\\\n1.", "mimetype": "text/plain", "start_char_idx": 16416, "end_char_idx": 18227, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b1e2778b-2faa-429b-a509-4b4b71923e9f": {"__data__": {"id_": "b1e2778b-2faa-429b-a509-4b4b71923e9f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "335cc0a4-1dab-4c59-85ec-dc9afa737f8d", "node_type": "1", "metadata": {}, "hash": "aaf0e8260d75b17cfbca591f96a9523c04cce1c5f7271a22c8e300b3b33afb35", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "cde64662-2320-4143-9efd-22474a2c1e62", "node_type": "1", "metadata": {}, "hash": "b13922e4659cd9dcb9c381e05e9fa40e336be1bb0f5e384ca4a8250fb32101e9", "class_name": "RelatedNodeInfo"}}, "text": "**Ancienne Belgique**\\\\n   - Check out the schedule for any concerts or performances happening today.\\\\n\\\\n2. **La Monnaie/De Munt**\\\\n   - Attend an opera or a ballet performance if available.\\\\n\\\\n### Historical Sites\\\\n1. **Manneken Pis**\\\\n   - Visit this famous statue, which often gets dressed up in various costumes.\\\\n\\\\n2. **Palais de Justice**\\\\n   - Visit this impressive courthouse and enjoy the views from its location.\\\\n\\\\n### Weather Considerations\\\\n- The apparent temperature in Brussels today ranges from 15.9\u00b0C (60.62\u00b0F) in the early morning to a high of around 31.6\u00b0C (88.88\u00b0F) in the late afternoon. Thus, it is quite pleasant for outdoor activities.\\\\n\\\\nWhatever your interests, Brussels has something to offer for everyone. Make sure to check local event listings as well for any special events or festivals happening today. Enjoy your day!\"}`,\n  headers: {\n    'Content-Type': 'application/json',\n    'Access-Control-Allow-Origin': '*'\n  }\n}\nNow you are ready to publish your agent, add secrets, and interact with your agent in the following steps:\n- Execute: 'npm run publish-agent'\n- Set secrets: 'npm run set-secrets'\n- Go to the url produced by setting the secrets (e.g. https://wapo-testnet.phala.network/ipfs/QmPQJD5zv3cYDRM25uGAVjLvXGNyQf9Vonz7rqkQB52Jae?key=b092532592cbd0cf)\n```\n\n## Publish & Interact with Agent\n\nWith our test passing and everything working as expected, now we can build and publish our agent code to IPFS. Then we will set our secrets and access our deployed agent via the Phala Gateway at https://wapo-testnet.phala.network/ipfs/\\<cid>?key=\\<key\\_id>\\&chatQuery=\\<chat\\_query>.\n\nUpload your compiled AI Agent code to IPFS.\n\n```bash\nnpm run publish-agent\n```\n\nUpon a successful upload, the command should show the URL to access your AI Agent.\n\n```\n\u2713 Compiled successfully.", "mimetype": "text/plain", "start_char_idx": 18228, "end_char_idx": 20054, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "cde64662-2320-4143-9efd-22474a2c1e62": {"__data__": {"id_": "cde64662-2320-4143-9efd-22474a2c1e62", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b1e2778b-2faa-429b-a509-4b4b71923e9f", "node_type": "1", "metadata": {}, "hash": "a7dabb7349ebbab040ea262e5fd2ab83ce775f7fb17b8e017c6605b95e79dd35", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "0de1a9f7-da60-459c-8e59-e1972bf3a7e1", "node_type": "1", "metadata": {}, "hash": "1517482869521cea284c7280a3ce3b5d88905844608737171e976e444b77005c", "class_name": "RelatedNodeInfo"}}, "text": "78.19 KB  dist/index.js\nRunning command: npx thirdweb upload dist/index.js\nThis may require you to log into thirdweb and will take some time to publish to IPFS...\n\n    $$\\     $$\\       $$\\                 $$\\                         $$\\       \n    $$ |    $$ |      \\__|                $$ |                        $$ |      \n  $$$$$$\\   $$$$$$$\\  $$\\  $$$$$$\\   $$$$$$$ |$$\\  $$\\  $$\\  $$$$$$\\  $$$$$$$\\  \n  \\_$$  _|  $$  __$$\\ $$ |$$  __$$\\ $$  __$$ |$$ | $$ | $$ |$$  __$$\\ $$  __$$\\ \n    $$ |    $$ |  $$ |$$ |$$ |  \\__|$$ /  $$ |$$ | $$ | $$ |$$$$$$$$ |$$ |  $$ |\n    $$ |$$\\ $$ |  $$ |$$ |$$ |      $$ |  $$ |$$ | $$ | $$ |$$   ____|$$ |  $$ |\n    \\$$$$  |$$ |  $$ |$$ |$$ |      \\$$$$$$$ |\\$$$$$\\$$$$  |\\$$$$$$$\\ $$$$$$$  |\n     \\____/ \\__|  \\__|\\__|\\__|       \\_______| \\_____\\____/  \\_______|\\_______/ \n\n \ud83d\udc8e thirdweb v0.14.12 \ud83d\udc8e\n\n- Uploading file to IPFS. This may take a while depending on file sizes.\n\n\u2714 Successfully uploaded file to IPFS.", "mimetype": "text/plain", "start_char_idx": 20057, "end_char_idx": 21005, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0de1a9f7-da60-459c-8e59-e1972bf3a7e1": {"__data__": {"id_": "0de1a9f7-da60-459c-8e59-e1972bf3a7e1", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "cde64662-2320-4143-9efd-22474a2c1e62", "node_type": "1", "metadata": {}, "hash": "b13922e4659cd9dcb9c381e05e9fa40e336be1bb0f5e384ca4a8250fb32101e9", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "8c7ceb60-904e-49f0-ba8c-f91bcc6a0c06", "node_type": "1", "metadata": {}, "hash": "aad5f1e91c64c1c8b2af8c471fdeb431572025c91bf394ef39b77e6cd20ca133", "class_name": "RelatedNodeInfo"}}, "text": "\u2714 Files stored at the following IPFS URI: ipfs://QmQZYAkEz8RnX9phpWscDLsv1u7uBATaAYHb1prpFGvD4n\n\u2714 Open this link to view your upload: https://b805a9b72767504353244e0422c2b5f9.ipfscdn.io/ipfs/bafybeibbasdv4xt32ea74ga77rpr5kgnkxcgqbtoslgxagzhmmujcjwkym/\n\nAgent Contract deployed at: https://wapo-testnet.phala.network/ipfs/QmQZYAkEz8RnX9phpWscDLsv1u7uBATaAYHb1prpFGvD4n\n\nIf your agent requires secrets, ensure to do the following:\n1) Edit the ./secrets/default.json file or create a new JSON file in the ./secrets folder and add your secrets to it.\n2) Run command: 'npm run set-secrets' or 'npm run set-secrets [path-to-json-file]'\nLogs folder created.\nDeployment information updated in ./logs/latestDeployment.json\n```\n\n{% hint style=\"info\" %}\n**Note** that your latest deployment information will be logged to in file [`./logs/latestDeployment.json`](https://github.com/Phala-Network/ai-agent-template-func-calling/blob/main/logs/latestDeployment.json). This file is updated every time you publish a new Agent Contract to IPFS. This file is also used to get the IPFS CID of your Agent Contract when setting secrets for your Agent Contract.\n\nHere is an example:\n\n```\n{\n  \"date\": \"2024-08-29T20:28:20.081Z\",\n  \"cid\": \"QmYzBTdQNPewdhD9GdBJ9TdV7LVhrh9YVRiV8aBup7qZGu\",\n  \"url\": \"https://wapo-testnet.phala.network/ipfs/QmYzBTdQNPewdhD9GdBJ9TdV7LVhrh9YVRiV8aBup7qZGu\"\n}\n```\n{% endhint %}\n\n{% hint style=\"warning\" %}\n**Did Thirdweb fail to publish?", "mimetype": "text/plain", "start_char_idx": 21006, "end_char_idx": 22448, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8c7ceb60-904e-49f0-ba8c-f91bcc6a0c06": {"__data__": {"id_": "8c7ceb60-904e-49f0-ba8c-f91bcc6a0c06", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "0de1a9f7-da60-459c-8e59-e1972bf3a7e1", "node_type": "1", "metadata": {}, "hash": "1517482869521cea284c7280a3ce3b5d88905844608737171e976e444b77005c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a7044042-008f-4136-bf3a-b925e678cfb9", "node_type": "1", "metadata": {}, "hash": "ea67436df927e99e58e58376279243c69f7fb4f166744234c0d9b8fbb5cffd0f", "class_name": "RelatedNodeInfo"}}, "text": "**\n\nIf ThirdWeb fails to publish, please signup for your own ThirdWeb account to publish your Agent Contract to IPFS. Signup or login at [https://thirdweb.com/dashboard/](https://thirdweb.com/dashboard/)\n\nWhenever you log into ThirdWeb, create a new API key and replace the default API Key with yours in the [.env](https://github.com/Phala-Network/ai-agent-template-func-calling/blob/main/.env) file.\\\n`THIRDWEB_API_KEY=\"YOUR_THIRDWEB_API_KEY\"`\n{% endhint %}\n\n### Add Secrets\n\nBy default, all the compiled JS code is visible for anyone to view if they look at IPFS CID. This makes private info like API keys, signer keys, etc. vulnerable to be stolen. To protect devs from leaking keys, we have added a field called `secret` in the `Request` object. It allows you to store secrets in a vault for your AI Agent to access.\n\nTo add your secrets,\n\n1. Edit the [default.json](https://github.com/Phala-Network/ai-agent-template-func-calling/blob/main/secrets/default.json) file or create a new JSON file in the `./secrets` folder and add your secrets to it.\n\n```\n{\n  \"openaiApiKey\": \"YOUR_OPENAI_API_KEY\"\n}\n```\n\n2. Run command to set the secrets\n\n```\nnpm run set-secrets\n# or if you have a custom JSON file\nnpm run set-secrets <path-to-json-file>\n```\n\nExpected output:\n\n```sh\nUse default secrets...\nStoring secrets...\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   205    0    68  100   137    105    213 --:--:-- --:--:-- --:--:--   319\n{\"token\":\"37a0f3f344a3bbf7\",\"key\":\"343e2a7dc130fedf\",\"succeed\":true}\n\nSecrets set successfully.", "mimetype": "text/plain", "start_char_idx": 22448, "end_char_idx": 24092, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a7044042-008f-4136-bf3a-b925e678cfb9": {"__data__": {"id_": "a7044042-008f-4136-bf3a-b925e678cfb9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "8c7ceb60-904e-49f0-ba8c-f91bcc6a0c06", "node_type": "1", "metadata": {}, "hash": "aad5f1e91c64c1c8b2af8c471fdeb431572025c91bf394ef39b77e6cd20ca133", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "3886631b-abbd-4f62-8e50-f93ba1aa6e33", "node_type": "1", "metadata": {}, "hash": "bb89d8575f8ad4dd6332024d915288a30215df48c57ccabdd6f3b539ddcbfbb9", "class_name": "RelatedNodeInfo"}}, "text": "Go to the URL below to interact with your agent:\nhttps://wapo-testnet.phala.network/ipfs/QmYzBTdQNPewdhD9GdBJ9TdV7LVhrh9YVRiV8aBup7qZGu?key=343e2a7dc130fedf\nLog entry added to secrets.log\n```\n\n> Note that all your secrets will be logged in file [`./logs/secrets.log`](https://github.com/Phala-Network/ai-agent-template-func-calling/blob/main/logs/secrets.log). This file is updated every time you add new secrets to your Agent Contract. If you have not published an Agent Contract, yet, this command will fail since there is not a CID to map the secrets to.\n>\n> Here is an example:\n>\n> ```\n> 2024-08-29T20:30:35.480Z, CID: [QmYzBTdQNPewdhD9GdBJ9TdV7LVhrh9YVRiV8aBup7qZGu], Token: [37a0f3f344a3bbf7], Key: [343e2a7dc130fedf], URL: [https://wapo-testnet.phala.network/ipfs/QmYzBTdQNPewdhD9GdBJ9TdV7LVhrh9YVRiV8aBup7qZGu?key=343e2a7dc130fedf]\n> ```\n\nThe API returns a `token` and a `key`. The `key` is the id of your secret. It can be used to specify which secret you are going to pass to your frame. The `token` can be used by the developer to access the raw secret. You should never leak the `token`.\n\nTo verify the secret, run the following command where `key` and `token` are replaced with the values from adding your `secret` to the vault.", "mimetype": "text/plain", "start_char_idx": 24093, "end_char_idx": 25334, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "3886631b-abbd-4f62-8e50-f93ba1aa6e33": {"__data__": {"id_": "3886631b-abbd-4f62-8e50-f93ba1aa6e33", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a7044042-008f-4136-bf3a-b925e678cfb9", "node_type": "1", "metadata": {}, "hash": "ea67436df927e99e58e58376279243c69f7fb4f166744234c0d9b8fbb5cffd0f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "babd6db6-b439-4160-bff2-d53d09999ef7", "node_type": "1", "metadata": {}, "hash": "0556d6f77179c75cb34d21dedbf9e2b1a9957dfd416bf8f78d85e41cf688ee77", "class_name": "RelatedNodeInfo"}}, "text": "```\ncurl https://wapo-testnet.phala.network/vaults/<key>/<token>\n```\n\nExpected output:\n\n```\n{\"data\":{\"openaiApiKey\":\"<OPENAI_API_KEY>\"},\"succeed\":true}\n```\n\n### Access Queries\n\nTo help create custom logic, we have an array variable named `queries` that can be accessed in the `Request` class. To access the `queries` array variable `chatQuery` value at index `0`, the syntax will look as follows:\n\n```\nconst query = req.queries.chatQuery[0] as string;\n```\n\nHere is an example of adding a URL query named `chatQuery` with a value of `When did humans land on the moon`. `queries` can have any field name, so `chatQuery` is just an example of a field name and not a mandatory name, but remember to update your `index.ts` file logic to use your expected field name.\n\n> [https://wapo-testnet.phala.network/ipfs/Qmc7EDq1X8rfYGGfHyXZ6xsmcSUWQcqsDoeRMfmvFujih3?key=51f265212c26086c&<mark style=\"background-color:yellow;\">**chatQuery**</mark>=When%20did%20humans%20land%20on%20the%20moon](https://wapo-testnet.phala.network/ipfs/Qmc7EDq1X8rfYGGfHyXZ6xsmcSUWQcqsDoeRMfmvFujih3?key=51f265212c26086c\\&chatQuery=When%20did%20humans%20land%20on%20the%20moon)\n\n### Query Your Deployed Agent\n\nNow that your agent is deployed, you can access the agent through a `curl` request or insert the url with the `key` and `chatQuery` defined. Here is an example of the code from the tutorial we just walked through.", "mimetype": "text/plain", "start_char_idx": 25336, "end_char_idx": 26726, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "babd6db6-b439-4160-bff2-d53d09999ef7": {"__data__": {"id_": "babd6db6-b439-4160-bff2-d53d09999ef7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "3886631b-abbd-4f62-8e50-f93ba1aa6e33", "node_type": "1", "metadata": {}, "hash": "bb89d8575f8ad4dd6332024d915288a30215df48c57ccabdd6f3b539ddcbfbb9", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f1256d81-e25d-42c2-bc9b-9380a550d40d", "node_type": "1", "metadata": {}, "hash": "63a02dad60a8552625d205da7f8cd0a30408caa8a67122d2db20e397b1cf7bd2", "class_name": "RelatedNodeInfo"}}, "text": "Example: [https://wapo-testnet.phala.network/ipfs/QmQZYAkEz8RnX9phpWscDLsv1u7uBATaAYHb1prpFGvD4n?key=5150856fe20eb558&<mark style=\"background-color:yellow;\">chatQuery</mark>=What%20are%20activities%20to%20do%20in%20Singapore%20today](https://wapo-testnet.phala.network/ipfs/QmQZYAkEz8RnX9phpWscDLsv1u7uBATaAYHb1prpFGvD4n?key=5150856fe20eb558\\&chatQuery=What%20are%20activities%20to%20do%20in%20Singapore%20today)\n\n### Debugging Your Agent\n\nTo debug your agent, you can use the following command:\n\n```\ncurl https://wapo-testnet.phala.network/logs/all/ipfs/<CID>\n```\n\nAfter executing this command then you should see some output in the terminal to show the logs of requests to your agent.\n\n```\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [REPORT] END Request: Duration: 166ms\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [INFO] 'Is signature valid? ' true\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [INFO] 'Verifying Signature with PublicKey ' '0xC1BF8dB4D06416c43Aca3deB289CF7CC0aAFF540'\n2024-09-04T03:18:34.", "mimetype": "text/plain", "start_char_idx": 26728, "end_char_idx": 27795, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f1256d81-e25d-42c2-bc9b-9380a550d40d": {"__data__": {"id_": "f1256d81-e25d-42c2-bc9b-9380a550d40d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "babd6db6-b439-4160-bff2-d53d09999ef7", "node_type": "1", "metadata": {}, "hash": "0556d6f77179c75cb34d21dedbf9e2b1a9957dfd416bf8f78d85e41cf688ee77", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f5dabb94-d271-40a5-92bb-6a58190f6a30", "node_type": "1", "metadata": {}, "hash": "9629fd0b6d24b2b2c7f655a205315bff15ba8067078a66ecf2dba35795739c31", "class_name": "RelatedNodeInfo"}}, "text": "758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd&type=verify&data=tintinland%20message%20to%20sign&signature=0x34c4d8c83406e7a292ecc940d60b34c9b11024db10a8872c753b9711cd6dbc8f746da8be9bc2ae0898ebf8f49f48c2ff4ba2a851143c3e4b371647eed32f707b1b\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [REPORT] END Request: Duration: 183ms\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [INFO] 'Signature: 0x34c4d8c83406e7a292ecc940d60b34c9b11024db10a8872c753b9711cd6dbc8f746da8be9bc2ae0898ebf8f49f48c2ff4ba2a851143c3e4b371647eed32f707b1b'\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [INFO] 'Signing data [tintinland message to sign] with Account [0xC1BF8dB4D06416c43Aca3deB289CF7CC0aAFF540]'\n2024-09-04T03:17:15.", "mimetype": "text/plain", "start_char_idx": 27795, "end_char_idx": 28646, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f5dabb94-d271-40a5-92bb-6a58190f6a30": {"__data__": {"id_": "f5dabb94-d271-40a5-92bb-6a58190f6a30", "embedding": null, "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "386be83e-e394-4b37-8896-fffe4d3efdee", "node_type": "4", "metadata": {}, "hash": "9d3bb6c46d9895462c8c278da04b9b53013d966510401dc333c79a915c40b728", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f1256d81-e25d-42c2-bc9b-9380a550d40d", "node_type": "1", "metadata": {}, "hash": "63a02dad60a8552625d205da7f8cd0a30408caa8a67122d2db20e397b1cf7bd2", "class_name": "RelatedNodeInfo"}}, "text": "238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd&type=sign&data=tintinland%20message%20to%20sign\n2024-09-04T03:16:38.507Z [3717d307-bff0-4fc0-bc98-8f66c33dd46f] [REPORT] END Request: Duration: 169ms\n2024-09-04T03:16:38.507Z [3717d307-bff0-4fc0-bc98-8f66c33dd46f] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd\n2024-09-04T03:15:00.375Z [793f58f9-f24f-4580-8ebc-04debb7d727f] [REPORT] END Request: Duration: 158ms\n2024-09-04T03:15:00.375Z [793f58f9-f24f-4580-8ebc-04debb7d727f] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64\na1e805bfd\n```\n\nTo create logs in your Agent Contract, you can use the following syntax in your `index.ts` file.\n\n```\n// info logs\nconsole.log('info log message!')\n// error logs\nconsole.error('error log message!')\n```\n\nFor more information check the [MDN docs](https://developer.mozilla.org/en-US/docs/Web/API/console) on `console` object.", "mimetype": "text/plain", "start_char_idx": 28646, "end_char_idx": 29705, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c70b0011-fe2c-4e52-9c7b-35e0836e0cd2": {"__data__": {"id_": "c70b0011-fe2c-4e52-9c7b-35e0836e0cd2", "embedding": null, "metadata": {"file_path": "phala-docs_dist/get-an-airstack-api-key.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "58b44cce-15dc-40ac-ada6-24005530c5c8", "node_type": "4", "metadata": {}, "hash": "8bb366b5255801950b324a86394b284fc649b1329acee0e55436310531d94b3b", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83d\udddd\ufe0f Get an Airstack API Key\n\nYou can get an API Key from Airstack by following the documentation [here](https://app.bitly.com/Bn9tntEUUft/links/bit.ly/41h8IhD/details).", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 169, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "41fc9d25-23af-401a-ba73-bb0e24151d9f": {"__data__": {"id_": "41fc9d25-23af-401a-ba73-bb0e24151d9f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/the-graph-agent.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a12891ca-476d-493f-8a7b-39aa25f63b26", "node_type": "4", "metadata": {}, "hash": "448e8bc74bfbfc7c6c6578b76e9cb4c77143c721d54a45048b576b8049718243", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83d\udcc8 The Graph Agent\n\n<figure><img src=\"../../.gitbook/assets/The_Graph.png\" alt=\"\" width=\"563\"><figcaption></figcaption></figure>\n\nThe Graph template enables you to connect to subgraph endpoints for data and utilize the data to calculate a trust score and send to a Web3 dApp on an EVM chain.\n\n## Requirements Before Deployment\n\n* Create API Key from The Graph. See how to get an API Key [here](https://bit.ly/the-graph-api-key). By default a rate-limited key is provided with no guarantee of service if limit is exhausted.\n\n## Features and Benefits\n\nWith the ability to bring The Graph data on-chain with customized logic performed on the data, this template enables developers to securely connect your indexed data to your web3 dApps. There are many features and benefits that can be built. For example:\n\n* On-chain Trust Score\n* Spam Filters\n* Copy Trading\n* Dynamic NFTs w/ On-chain Indexed Data\n* Conditional Transactions, etc.\n\n## Resources\n\n* [The Graph AI Agent Contract Code Template](https://bit.ly/pc-the-graph-repo)\n* [The Graph Docs](https://thegraph.com/docs/en/about/)", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1083, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "613c7c5a-babe-4a19-84a7-7b6f875eb751": {"__data__": {"id_": "613c7c5a-babe-4a19-84a7-7b6f875eb751", "embedding": null, "metadata": {"file_path": "phala-docs_dist/wallet-setup-and-get-pha.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e78c2de3-af3e-4222-926a-2f3ec59396f3", "node_type": "4", "metadata": {}, "hash": "52f60211be98b5bffc27264046da2d9fbcd78247469b434c2e14e0c02c936208", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "d27c1677-bb40-469d-9a02-31c931b9aee7", "node_type": "1", "metadata": {}, "hash": "c1d306353f0f97827d4adb59034d759ae5347e7eba769e2a23bb4ef83462d336", "class_name": "RelatedNodeInfo"}}, "text": "# Wallet Setup & Get PHA\n\nAgent Wars is deployed on the [Base chain](https://www.base.org/), a popular high performance Ethereum L2 built by Coinbase. You will need to have two tokens to participate:\n\n* **ETH**: needed to pay the gas fee on Base\n* **PHA**: used to buy keys and create agents\n\n## Set up wallets on Base chain\n\nAgent Wars supports all EVM-compatible wallets. Recommended wallets include:\n\n1. [Coinbase Wallet](https://chrome.google.com/webstore/detail/coinbase-wallet-extension/hnfanknocfeofbddgcijnmhnfnkdnaad?hl=en): desktop and mobile\n2. [MetaMask](https://metamask.io/): desktop and mobile\n3. [Rabby](https://rabby.io/): desktop only\n\nFor more information, please refer to [the official Base docs](https://docs.base.org/docs/using-base/).\n\n{% hint style=\"info\" %}\nSoon, the Agent Wars dapp will come with Social Login Wallets, powered by Privy. You will be able to create an in-app wallet with your social accounts (Google, Facebook, etc).\n{% endhint %}\n\n## Get ETH on Base\n\nETH is the native token of the Base chain. You need to have ETH in your Base wallet to pay the gas fee. You can either buy ETH from centralized exchanges (e.g. [Coinbase](https://www.coinbase.com/), [Binance](https://www.binance.com/)), or bridge ETH from the Ethereum mainnet via the [Base Bridge](https://bridge.base.org/deposit).\n\n{% hint style=\"info\" %}\nIt's suggested to have at least $10 worth of ETH on Base to cover transaction gas fees. As of Apr 2024, a typical Base transaction takes $0.01 to $0.20 worth of gas in ETH.\n{% endhint %}\n\n## Get PHA on Base\n\nYou will need PHA on the Base chain to participate in Agent Wars. It's used to buy keys and create agents.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1666, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d27c1677-bb40-469d-9a02-31c931b9aee7": {"__data__": {"id_": "d27c1677-bb40-469d-9a02-31c931b9aee7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/wallet-setup-and-get-pha.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e78c2de3-af3e-4222-926a-2f3ec59396f3", "node_type": "4", "metadata": {}, "hash": "52f60211be98b5bffc27264046da2d9fbcd78247469b434c2e14e0c02c936208", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "613c7c5a-babe-4a19-84a7-7b6f875eb751", "node_type": "1", "metadata": {}, "hash": "180862739077ffa72e132553af29fa121d5e6e215c4198f0984ea03b79a42d1a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "13f7fdb5-cff1-4d3a-a4ed-ee9449408141", "node_type": "1", "metadata": {}, "hash": "4b84a898b7911181ea369a4fb3fc7220802774d276cb24c3865ab3d63f9373e2", "class_name": "RelatedNodeInfo"}}, "text": "You can easily obtain PHA in the following ways:\n\n### Uniswap V3 (Recommended)\n\nYou can [buy and sell PHA on Uniswap V3](https://app.uniswap.org/explore/tokens/base/0x336c9297afb7798c292e9f80d8e566b947f291f0) on the Base chain.\n\n{% embed url=\"https://youtu.be/Xqb3mzh8_mo\" %}\n\n### Bridge from Ethereum (Advanced)\n\nYou can bridge PHA token between Ethereum mainnet and Base chain with Wormhole bridge.\n\n<details>\n\n<summary>Wormhole Bridge Instructions</summary>\n\nPHA is bridged from Ethereum to Base chain via [Wormhole](https://wormhole.com/) bridge. If you have PHA on Ethereum, you can easily bridge it to Base with Wormhole's UI, Portal Bridge:\n\n1. Open [Portal Bridge (Advanced Tool)](https://portalbridge.com/advanced-tools/#/transfer)\n2. Select the chains: from **Ethereum** to **Base**\n3. Connect your Web3 wallet\n4. Search the token name `Phala` or the token address `0x6c5ba91642f10282b576d91922ae6448c9d52f4e`\n5. Input the amount you want to bridge, and follow the instructions on the web page to proceed\n\nNote that the bridging operation between Ethereum and Base takes around 15 mins. To get PHA on Ethereum, you can buy it from centralized exchanges (Binance, OKX, Kucoin, etc), and decentralized exchanges (Uniswap, 1inch, etc).\n\nIf you closed the web page after finishing the transfer step but haven't claimed it on the destination blockchain, you can use the \"Redeem\" tab in the Portal Bridge (Advanced Tool). You will need to find the tx id of your transfering tx from a blockchain explorer. The redeem tool will recover the transaction and guide you to redeem the PHA on the destination chain. Learn more at [their official docs](https://portalbridge.com/docs/tutorials/how-to-use-recovery-workflow).\n\n</details>\n\n{% hint style=\"info\" %}\nSoon, the Agent Wars dapp will support buying keys and creating agents with ETH.", "mimetype": "text/plain", "start_char_idx": 1667, "end_char_idx": 3503, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "13f7fdb5-cff1-4d3a-a4ed-ee9449408141": {"__data__": {"id_": "13f7fdb5-cff1-4d3a-a4ed-ee9449408141", "embedding": null, "metadata": {"file_path": "phala-docs_dist/wallet-setup-and-get-pha.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e78c2de3-af3e-4222-926a-2f3ec59396f3", "node_type": "4", "metadata": {}, "hash": "52f60211be98b5bffc27264046da2d9fbcd78247469b434c2e14e0c02c936208", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d27c1677-bb40-469d-9a02-31c931b9aee7", "node_type": "1", "metadata": {}, "hash": "c1d306353f0f97827d4adb59034d759ae5347e7eba769e2a23bb4ef83462d336", "class_name": "RelatedNodeInfo"}}, "text": "Once upgraded, you will be able to use your ETH balance to buy keys or create agents directly without manually purchasing PHA. The smart contracts will do the heavy lifting for you.\n{% endhint %}\n\n### Token Information\n\n<table data-header-hidden><thead><tr><th width=\"218\"></th><th></th></tr></thead><tbody><tr><td>Base ERC20</td><td><a href=\"https://basescan.org/token/0x336c9297afb7798c292e9f80d8e566b947f291f0\">0x336c9297afb7798c292e9f80d8e566b947f291f0</a></td></tr><tr><td>Uniswap PHA/ETH</td><td><a href=\"https://basescan.org/address/0x03aC059Fd9eb9c2da65D745E923583F05bF388DB\">0x03aC059Fd9eb9c2da65D745E923583F05bF388DB</a></td></tr><tr><td>Mainnet ERC20</td><td><a href=\"https://etherscan.io/token/0x6c5ba91642f10282b576d91922ae6448c9d52f4e\">0x6c5ba91642f10282b576d91922ae6448c9d52f4e</a></td></tr></tbody></table>\n\n<details>\n\n<summary>Wormhole Bridge Technical Details</summary>\n\nPHA is bridged from Ethereum to Base chain via [Wormhole](https://wormhole.com/) bridge. The bridged Wrapped ERC20 token is created by and managed by Wormhole on Base chain. The related smart contracts are audited as the other Wormhole bridged tokens.\n\n</details>", "mimetype": "text/plain", "start_char_idx": 3504, "end_char_idx": 4656, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0b48c105-4da3-4de5-b046-b7c78b0f65ab": {"__data__": {"id_": "0b48c105-4da3-4de5-b046-b7c78b0f65ab", "embedding": null, "metadata": {"file_path": "phala-docs_dist/unit-tests.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "c5188efa-8d1d-4299-be98-73a17db82280", "node_type": "4", "metadata": {}, "hash": "932eb6285346964faed785b8b557a9f397e6210f7a3295d2dca189e31b2dfa5a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "be4879b7-1fbc-41bf-b32d-62f82d48ae2b", "node_type": "1", "metadata": {}, "hash": "ed7605b8f74e2010574fe87707439b87befa01af5bbd285aa3096baf8730045c", "class_name": "RelatedNodeInfo"}}, "text": "# Unit Tests\n\nBefore you deploy your contract to our Testnet or release it on mainnet, a thorough local unit test can help you fix most of the bugs.\n\n## Unit test Basics <a href=\"#unit-test-basics\" id=\"unit-test-basics\"></a>\n\nLet\u2019s take the unit test in our Phat Hello World as an example:\n\n```\n/// Unit tests in Rust are normally defined within such a `#[cfg(test)]`\n/// module and test functions are marked with a `#[test]` attribute.\n/// The below code is technically just normal Rust code.\n#[cfg(test)]\nmod tests {\n    /// Imports all the definitions from the outer scope so we can use them here.\n    use super::*;\n    /// Imports `ink_lang` so we can use `#[ink::test]`.\n    use ink_lang as ink;\n\n    /// We test a simple use case of our contract.\n    #[ink::test]\n    fn it_works() {\n        // when your contract is really deployed, the Phala Worker will do the HTTP requests\n        // mock is needed for local test\n        pink_extension_runtime::mock_ext::mock_all_ext();\n\n        let phat_hello = PhatHello::new();\n        let account = String::from(\"0xD0fE316B9f01A3b5fd6790F88C2D53739F80B464\");\n        let res = phat_hello.get_eth_balance(account.clone());\n        assert!(res.is_ok());\n\n        // run with `cargo +nightly test -- --nocapture` to see the following output\n        println!(\"Account {} gets {} Wei\", account, res.unwrap());\n    }\n}\n```\n\nA Phat Contract unit test makes little difference compared with normal Rust programs. It is labeled by `#`\\[cfg(test)]`, and you just write each test as a function headed by` #\\[ink::test]\\`.\n\nYou can easily create a new contract instance in a unit test by calling its constructor (e.g. `PhatHello::new()`). Then you can call any functions (no matter query/transaction handlers) in that contract directly.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1772, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "be4879b7-1fbc-41bf-b32d-62f82d48ae2b": {"__data__": {"id_": "be4879b7-1fbc-41bf-b32d-62f82d48ae2b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/unit-tests.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "c5188efa-8d1d-4299-be98-73a17db82280", "node_type": "4", "metadata": {}, "hash": "932eb6285346964faed785b8b557a9f397e6210f7a3295d2dca189e31b2dfa5a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "0b48c105-4da3-4de5-b046-b7c78b0f65ab", "node_type": "1", "metadata": {}, "hash": "a1b7040a3b4c92ac434b600322199f7c4390dc84e57759ef9ef9efc3c2938982", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "6b6867e3-d775-4a81-a6e8-3457c3032c84", "node_type": "1", "metadata": {}, "hash": "9b53e914679b5dd51acbf0185364301882de02fa2b98426e843c51761098f8aa", "class_name": "RelatedNodeInfo"}}, "text": "### Setup Context of Blockchain <a href=\"#setup-context-of-blockchain\" id=\"setup-context-of-blockchain\"></a>\n\nThe [ink](https://ink.substrate.io/basics/contract-testing/) crate contains all the functions to set up the blockchain calling context like the caller of the contract functions, the balance of a certain account, etc.\n\nWe recommend reading the [ink](https://ink.substrate.io/basics/contract-testing/)! official document]\\(https://ink.substrate.io/basics/contract-testing/) to learn about its basic usage. And you can refer to the unit tests in [ink! Examples](https://github.com/paritytech/ink/tree/master/examples) to find useful pieces.\n\nAlso, we prepare a cheat sheet for you here:\n\n```\n// this gives you the default test accounts [alice, bob, charlie, django, eve, frank]\nlet accounts = ink::env::test::default_accounts::<ink::env::DefaultEnvironment>();\n\nlet phat_hello = PhatHello::new();\n\n// control the caller of the contract\n\n// by default, the caller is `accounts.alice`\nlet account = String::from(\"0xD0fE316B9f01A3b5fd6790F88C2D53739F80B464\");\nlet res = phat_hello.get_eth_balance(account.clone());\nassert!(res.is_ok());\n\n// 1. get contract address\nlet contract = ink::env::account_id::<ink::env::DefaultEnvironment>();\n// 2. set caller to bob and callee to the contract\nink::env::test::set_callee::<ink::env::DefaultEnvironment>(contract);\nink::env::test::set_caller::<ink::env::DefaultEnvironment>(accounts.bob);\n// now the caller will be `accounts.bob`\nlet res = phat_hello.get_eth_balance(account.clone());\nassert!(res.is_ok());\n```\n\n## Mock Pink Extension Functions <a href=\"#mock-pink-extension-functions\" id=\"mock-pink-extension-functions\"></a>\n\nBy default, the functions in pink-extension are delegated to the runtime for real execution, thus your unit test can fail if your functions include any invoke to these functions.\n\nIn the example above, that\u2019s why we call\n\n```\npink_extension_runtime::mock_ext::mock_all_ext();\n```\n\nbefore we really call the contract functions.", "mimetype": "text/plain", "start_char_idx": 1774, "end_char_idx": 3773, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6b6867e3-d775-4a81-a6e8-3457c3032c84": {"__data__": {"id_": "6b6867e3-d775-4a81-a6e8-3457c3032c84", "embedding": null, "metadata": {"file_path": "phala-docs_dist/unit-tests.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "c5188efa-8d1d-4299-be98-73a17db82280", "node_type": "4", "metadata": {}, "hash": "932eb6285346964faed785b8b557a9f397e6210f7a3295d2dca189e31b2dfa5a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "be4879b7-1fbc-41bf-b32d-62f82d48ae2b", "node_type": "1", "metadata": {}, "hash": "ed7605b8f74e2010574fe87707439b87befa01af5bbd285aa3096baf8730045c", "class_name": "RelatedNodeInfo"}}, "text": "`mock_all_ext()` will redirect all the runtime requests to your local machine. For example, after that is called, `phat_hello.get_eth_balance()` will send an HTTP request from your computer to read the Ethereum balance from Etherscan.\n\nSometimes, you do not want the contract to really send the HTTP request / generate a random number, instead, you want it to use the pre-defined values. In such cases, you can use the code example below:\n\n```\nuse pink_extension::chain_extension::{mock, HttpResponse};\n\nmock::mock_http_request(|request| {\n    if request.url == \"https://localhost\" {\n        HttpResponse::ok(b\"user-controlled response\".to_vec())\n    } else {\n        HttpResponse::not_found()\n    }\n});\n\n// a not-that-random generator\nmock::mock_getrandom(|length| {\n    vec![0u8; length as usize]\n})\n```", "mimetype": "text/plain", "start_char_idx": 3774, "end_char_idx": 4579, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6c3bd0bd-6d8e-4c59-af90-1dc98d039b17": {"__data__": {"id_": "6c3bd0bd-6d8e-4c59-af90-1dc98d039b17", "embedding": null, "metadata": {"file_path": "phala-docs_dist/delegate-to-stakepool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "da27b964-9989-4833-b81d-cf68385bb800", "node_type": "4", "metadata": {}, "hash": "c001f56a0075e9af14c7741fa1417ada80d46964d07a5f005b86f09249b01e9a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f045dc83-4886-4f44-9b62-87df081e343f", "node_type": "1", "metadata": {}, "hash": "72ee8789fd3204b04c7befef90473762911db242f6a561a22f92d6689727c1d4", "class_name": "RelatedNodeInfo"}}, "text": "# Delegate to StakePool\n\n### Why is Delegation needed? <a href=\"#why-is-delegation-needed\" id=\"why-is-delegation-needed\"></a>\n\nDelegation is the name of the \u201cStake to Earn\u201d mechanism on the Phala and Khala Network. Staking is currently enabled on both Phala Network and Khala Network.\n\n* Compute cannot simply be added to the network on its own. To ensure a secure and stable environment, \u201cProof of Stake\u201d is used. Each worker on the network must be staked with some PHA, which is put at risk, in order to incentivize good behavior.\n* Compute providers and those wishing to provide stake do not have to be the same people. To improve flexibility and efficiency, Phala provides a delegation mechanism that allows delegators to stake to workers they do not control and earn rewards.\n* This mechanism is enabled by a feature we call the StakePool.\n* Overall Delegation incentivizes high-quality compute providers to generate consistent and reliable rewards for their delegators. This in turn ensures the stability of the compute provided.\n* For even more accessibility there is another major feature called Vault. This allows delegators to pass the management of their delegation to individual StakePools to someone else. These Vault operators, for a small fee, bring further efficiency to the ecosystem by driving delegations to the best compute providers. You can read more about Vault here.\n\n## Delegation Mechanism <a href=\"#delegation-mechanism\" id=\"delegation-mechanism\"></a>\n\n### Glossary <a href=\"#glossary\" id=\"glossary\"></a>\n\n<table><thead><tr><th width=\"197.33333333333331\"></th><th width=\"373\">Meaning</th><th>Type</th></tr></thead><tbody><tr><td><strong>Delegator</strong></td><td>Delegates PHA to <strong>StakePools</strong> or <strong>Vaults</strong></td><td>On-chain Account</td></tr><tr><td><strong>StakePool</strong></td><td>Created and managed by the <strong>StakePool Owner</strong>. Delegators put PHA into these.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1931, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f045dc83-4886-4f44-9b62-87df081e343f": {"__data__": {"id_": "f045dc83-4886-4f44-9b62-87df081e343f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/delegate-to-stakepool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "da27b964-9989-4833-b81d-cf68385bb800", "node_type": "4", "metadata": {}, "hash": "c001f56a0075e9af14c7741fa1417ada80d46964d07a5f005b86f09249b01e9a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "6c3bd0bd-6d8e-4c59-af90-1dc98d039b17", "node_type": "1", "metadata": {}, "hash": "a0fba784fbffe130273d9a146e0ec6bd81baf66e58fbe5cfbe5b69ac03cd098f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "67a31168-656f-461d-9c97-6e4cbeb0d2e2", "node_type": "1", "metadata": {}, "hash": "275f27e1bc2045f3829ea3e5b551f9f7d7029c5b7ca1fe045f896c7b4ac0b922", "class_name": "RelatedNodeInfo"}}, "text": "Delegated tokens can only be used for staking.</td><td>On-chain Object</td></tr><tr><td><strong>StakePool Owner</strong></td><td>The account that controls the <strong>StakePool</strong>. Ownership is non-transferable.</td><td>On-chain Account</td></tr><tr><td><strong>Worker</strong></td><td>The <strong>StakePool Owner</strong> uses delegated funds to stake to a number of workers and therefore provide compute to the network. A worker can only belong to a single StakePool at any one time. The rewards generated will be distributed to the owner and the delegators based on the <strong>StakePool</strong> and <strong>Vault</strong> commissions. The mechanism is detailed below.</td><td>Physical Machine</td></tr><tr><td><strong>Vault</strong></td><td>Created and managed by the <strong>Vault Owner</strong>. Delegators put PHA into these. Delegated tokens can only be used for staking. The <strong>Vault Owner</strong> manages the delegations to specific StakePools, allowing delegation by proxy.</td><td>On-chain Object</td></tr><tr><td><strong>Vault Owner</strong></td><td>The account that controls the <strong>Vault</strong>. Ownership is non-transferable.</td><td>On-chain Account</td></tr></tbody></table>\n\n### How It Works <a href=\"#how-it-works\" id=\"how-it-works\"></a>\n\n![](https://i.imgur.com/yMXCTbA.png)\n\n### **Lifecycle**\n\n**1. Delegation**\n\nPHA holders delegate tokens into a StakePool or a Vault.\n\n**2. Vault distributes (Optional)**\n\nThe owner of the Vault chooses high-quality StakePools to delegate to on behalf of their delegators.\n\n**3. Workers staked and started**\n\nThe owners of individual StakePools use the delegations provided to stake and start workers and so provide computing power to the network. Over time stable and well-behaved Workers generate rewards.\n\n**4. Rewards distributed**\n\nBased on the StakePool\u2019s commission rewards earned by Workers are distributed to the owner and the delegators.", "mimetype": "text/plain", "start_char_idx": 1932, "end_char_idx": 3856, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "67a31168-656f-461d-9c97-6e4cbeb0d2e2": {"__data__": {"id_": "67a31168-656f-461d-9c97-6e4cbeb0d2e2", "embedding": null, "metadata": {"file_path": "phala-docs_dist/delegate-to-stakepool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "da27b964-9989-4833-b81d-cf68385bb800", "node_type": "4", "metadata": {}, "hash": "c001f56a0075e9af14c7741fa1417ada80d46964d07a5f005b86f09249b01e9a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f045dc83-4886-4f44-9b62-87df081e343f", "node_type": "1", "metadata": {}, "hash": "72ee8789fd3204b04c7befef90473762911db242f6a561a22f92d6689727c1d4", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "66d046c7-bc17-4a72-8008-b697db7eb8e9", "node_type": "1", "metadata": {}, "hash": "a27566edcf9f8565a75953f934f47466f802eb52c9e229dd147917113a0909a0", "class_name": "RelatedNodeInfo"}}, "text": "Owner rewards can be claimed into the owner\u2019s account directly while Delegator rewards will automatically be reinvested into the StakePool. Those delegators using Vault pay a further commission for Vault\u2019s management services.\n\n#### Delegation represented as an NFT <a href=\"#delegation-represented-as-an-nft\" id=\"delegation-represented-as-an-nft\"></a>\n\nAfter you delegate to a StakePool, your tokens will be transferred and locked. As proof of the delegation, you receive a Delegation NFT in return. The Delegation NFT records its owner, the StakePool where the delegation is located, and the share of the corresponding StakePool.\n\nYour Delegation NFT is transferable, and you can also sell it to others on PhalaWorld\u2019s NFT platform.\n\n> **NOTE** When your Delegation NFT is transferred or sold to someone else, the delegated PHA will no longer belong to you, because you have lost the certificate to withdraw it back from the corresponding StakePool or Vault.\n\n### Rewards <a href=\"#rewards\" id=\"rewards\"></a>\n\nThe moment you delegate, you immediately start to earn rewards.\n\nAll staked and started workers are rewarded for providing computing power. Every time rewards are distributed 20% goes to the treasury. The remaining 80% is distributed amongst the Vault Owners (optional), StakePool Owners, and delegators. Once the commissions are paid the rewards will be divided equally based on the number of delegations from each delegator. (Please refer to [Gemini Tokenomics](../../../compute-providers/basic-info/worker-rewards.md) for specific reward details)\n\nThe delegator rewards distributed each time will be automatically reinvested.\n\nThe APR of the pool which is shown on the Phala App is a real-time estimate. The APR calculation is based solely on the delegator\u2019s income, after the pool owner\u2019s commission has been taken.\n\n### How to choose a high-quality StakePool <a href=\"#how-to-choose-a-high-quality-stakepool\" id=\"how-to-choose-a-high-quality-stakepool\"></a>\n\nYou can find the historical data performance of the StakePool on the pool details page of the Phala App. The common methods for choosing the StakePools are:\n\n1. Check the historical APR trend performance of the StakePool.", "mimetype": "text/plain", "start_char_idx": 3857, "end_char_idx": 6054, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "66d046c7-bc17-4a72-8008-b697db7eb8e9": {"__data__": {"id_": "66d046c7-bc17-4a72-8008-b697db7eb8e9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/delegate-to-stakepool.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "da27b964-9989-4833-b81d-cf68385bb800", "node_type": "4", "metadata": {}, "hash": "c001f56a0075e9af14c7741fa1417ada80d46964d07a5f005b86f09249b01e9a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "67a31168-656f-461d-9c97-6e4cbeb0d2e2", "node_type": "1", "metadata": {}, "hash": "275f27e1bc2045f3829ea3e5b551f9f7d7029c5b7ca1fe045f896c7b4ac0b922", "class_name": "RelatedNodeInfo"}}, "text": "The historical APR of a high-quality StakePool must be stable enough.\n2. Check the number of workers in the StakePool, and check the status trend of the workers. Generally, the larger the StakePool, the better the operation and maintenance level of the pool owner, and the better the stability of the mining pool. Historical data will prove that.\n3. Take the initiative to contact the StakePool owner. Contact will be shown on the pool detailed page. The friendly pool owner will be happy to talk with you and guide you on how to delegate to his StakePool.\n\n> Note, please don\u2019t be too obsessed with the Pool APR, there are often evil pool owners who only rely on lowering their commission to achieve a high APR, but this will not be sustainable, please be sure to observe the historical trend of APR!\n\nAfter you have selected the pool and delegated, please also be sure to check the performance of the StakePool regularly. Contact the pool owner when the performance of the pool does not go well.\n\nIf you find these methods are too hard for you or you want to check constantly to see if your delegation continues to turn out well. Try to delegate to **Vault**.\n\n**Vault is always a simpler and more friendly delegation method.** Click [here](whats-vault.md) to learn more about Vault.\n\n## Things to consider before delegating <a href=\"#things-to-consider-before-delegating\" id=\"things-to-consider-before-delegating\"></a>\n\nThis section is a short summary of some of the risks related to delegating PHA. Although delegation is non-custodial there are still situations that delegators should know about before committing to delegating to a StakePool or Vault.\n\n* At present, Slashing is not yet enabled on the Khala Network, however, it will be at some point in the future. For now, you can always get back as much PHA as you delegate. Once Slashing is enabled this will no longer be guaranteed.\n* It may take up to 14 days to withdraw your PHA from a Vault or StakePool.\n* The actual rewards obtained may not be as high as the APR shown at the time of delegation. Current performance does not predict future returns.", "mimetype": "text/plain", "start_char_idx": 6055, "end_char_idx": 8170, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e6191116-a7b4-48f3-834a-9f15ca8e5db9": {"__data__": {"id_": "e6191116-a7b4-48f3-834a-9f15ca8e5db9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/confidence-level-and-sgx-function.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fc88b9d1-b571-4f78-b6c3-b47bb9a3c5fe", "node_type": "4", "metadata": {}, "hash": "1ec2b4e254f4bf0c91acffdf854919db30a8c1a07b51a50fc3f78cf38d12ec22", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "96640968-7d84-4eda-a8d0-48d1b801a5a6", "node_type": "1", "metadata": {}, "hash": "31ebe49ffa511f58ba631931f56cf4ab641d4398367ecd1e8564caf5ad144070", "class_name": "RelatedNodeInfo"}}, "text": "# Confidence Level & SGX Function\n\n### Test your Intel\u00ae SGX Capability\n\nThe confidence level impacts your worker\u2019s score. Before configuring your worker, the necessary drivers are required, and the `sgx-test` option determines your Intel\u00ae SGX Capability alongside the confidence level.\n\n```bash\nsudo docker pull phalanetwork/phala-sgx_detect\nsudo docker run -it --network host --device /dev/sgx_enclave --device /dev/sgx_provision  --device /dev/sgx_enclave:/dev/sgx/enclave --device /dev/sgx_provision:/dev/sgx/provision  phalanetwork/phala-sgx_detect\n```\n\n> This command need to install \ud83d\udc33 Docker, the required Intel\u00ae SGX drivers, and pull all the necessary Docker images for your Phala worker \ud83e\udea8\u26cf\ufe0f.\n>\n> * Please follow the instruction during installation.\n\nInformation about the checks conducted during execution of the command:\n\n1. SGX system software \u2192 Able to launch enclaves \u2192 `Production Mode`\n2. Flexible launch control \u2192 `Able to launch production mode enclave`\n3. `isvEnclaveQuoteStatus` and `advisoryIDs` (explained in the next section)\n\nAmong them, **the first one is a must to run Phala Network pRuntime**. If it\u2019s not supported (tagged as \u2718 in the report example below), we are afraid you can\u2019t contribute computing power with this setup. You may need to replace the motherboard and/or the CPU.\n\nThe latter two is not a must, though it is suggested to be checked as it would be essential to install the DCAP driver.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1428, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "96640968-7d84-4eda-a8d0-48d1b801a5a6": {"__data__": {"id_": "96640968-7d84-4eda-a8d0-48d1b801a5a6", "embedding": null, "metadata": {"file_path": "phala-docs_dist/confidence-level-and-sgx-function.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fc88b9d1-b571-4f78-b6c3-b47bb9a3c5fe", "node_type": "4", "metadata": {}, "hash": "1ec2b4e254f4bf0c91acffdf854919db30a8c1a07b51a50fc3f78cf38d12ec22", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e6191116-a7b4-48f3-834a-9f15ca8e5db9", "node_type": "1", "metadata": {}, "hash": "5aba6c4e0f438ae2ce815bf98b3429fcd1234003865849e7ef0ec86703ba0482", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "84bbd52a-546e-468a-a114-fe5e08161589", "node_type": "1", "metadata": {}, "hash": "bc37605eba9b3b7db6c5ca0ee22c00c67cff37271dbd004a91acfd2b6800eb6c", "class_name": "RelatedNodeInfo"}}, "text": "The example below shows a positive result:\n\n```txt\nDetecting SGX, this may take a minute...\n\u2714  SGX instruction set\n  \u2714  CPU support\n  \u2714  CPU configuration\n  \u2714  Enclave attributes\n  \u2714  Enclave Page Cache\n  SGX features\n    \u2714  SGX2  \u2714  EXINFO  \u2718  ENCLV  \u2718  OVERSUB  \u2718  KSS\n    Total EPC size: 94.0MiB\n\u2714  Flexible launch control\n  \u2714  CPU support\n  \uff1f CPU configuration\n  \u2714  Able to launch production mode enclave\n\u2714  SGX system software\n  \u2714  SGX kernel device (/dev/sgx/enclave)\n  \u2714  libsgx_enclave_common\n  \u2714  AESM service\n  \u2714  Able to launch enclaves\n    \u2714  Debug mode\n    \u2714  Production mode\n    \u2714  Production mode (Intel whitelisted)\n\nYou are all set to start running SGX programs!\nGenerated machine id:\n[162, 154, 220, 15, 163, 137, 184, 233, 251, 203, 145, 36, 214, 55, 32, 54]\n\nTesting RA.\naesm_service[15]: [ADMIN]EPID Provisioning initiated\naesm_service[15]: The Request ID is 09a2bed647d24f909d4a3990f8e28b4a\naesm_service[15]: The Request ID is 8d1aa4104b304e12b7312fce06881260\naesm_service[15]: [ADMIN]EPID Provisioning successful\nisvEnclaveQuoteStatus = GROUP_OUT_OF_DATE\nplatform_info_blob { sgx_epid_group_flags: 4, sgx_tcb_evaluation_flags: 2304, pse_evaluation_flags: 0, latest_equivalent_tcb_psvn: [15, 15, 2, 4, 1, 128, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 0], latest_pse_isvsvn: [0, 11], latest_psda_svn: [0, 0, 0, 2],", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "84bbd52a-546e-468a-a114-fe5e08161589": {"__data__": {"id_": "84bbd52a-546e-468a-a114-fe5e08161589", "embedding": null, "metadata": {"file_path": "phala-docs_dist/confidence-level-and-sgx-function.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fc88b9d1-b571-4f78-b6c3-b47bb9a3c5fe", "node_type": "4", "metadata": {}, "hash": "1ec2b4e254f4bf0c91acffdf854919db30a8c1a07b51a50fc3f78cf38d12ec22", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "96640968-7d84-4eda-a8d0-48d1b801a5a6", "node_type": "1", "metadata": {}, "hash": "31ebe49ffa511f58ba631931f56cf4ab641d4398367ecd1e8564caf5ad144070", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b1d38547-fbd1-4fab-857d-4352579b77ed", "node_type": "1", "metadata": {}, "hash": "eefaade405c7aded25a62d1892ff5ad1ab34725080ac37b51227674316adcdf1", "class_name": "RelatedNodeInfo"}}, "text": "xeid: 0, gid: 2919956480, signature: sgx_ec256_signature_t { gx: [99, 239, 225, 171, 96, 219, 216, 210, 246, 211, 20, 101, 254, 193, 246, 66, 170, 40, 255, 197, 80, 203, 17, 34, 164, 2, 127, 95, 41, 79, 233, 58], gy: [141, 126, 227, 92, 128, 3, 10, 32, 239, 92, 240, 58, 94, 167, 203, 150, 166, 168, 180, 191, 126, 196, 107, 132, 19, 84, 217, 14, 124, 14, 245, 179] } }\nadvisoryURL = https://security-center.intel.com\nadvisoryIDs = \"INTEL-SA-00219\", \"INTEL-SA-00289\", \"INTEL-SA-00320\", \"INTEL-SA-00329\"\nconfidenceLevel = 5\n```\n\nIf you can not run Phala pRuntime with both of them tagged as \u2714, you may have to check whether your BIOS is the latest version with latest security patches. If you still can\u2019t run Phala pRuntime docker with the latest BIOS of your motherboard manufacturer, we are afraid you can\u2019t contribute computing power for now with this motherboard.\n\nYour confidence level, referred to as the \u201cTier\u201d in the table below, will appear in the last line of the report after executing `sudo phala sgx-test`.", "mimetype": "text/plain", "start_char_idx": 2761, "end_char_idx": 3779, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b1d38547-fbd1-4fab-857d-4352579b77ed": {"__data__": {"id_": "b1d38547-fbd1-4fab-857d-4352579b77ed", "embedding": null, "metadata": {"file_path": "phala-docs_dist/confidence-level-and-sgx-function.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fc88b9d1-b571-4f78-b6c3-b47bb9a3c5fe", "node_type": "4", "metadata": {}, "hash": "1ec2b4e254f4bf0c91acffdf854919db30a8c1a07b51a50fc3f78cf38d12ec22", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "84bbd52a-546e-468a-a114-fe5e08161589", "node_type": "1", "metadata": {}, "hash": "bc37605eba9b3b7db6c5ca0ee22c00c67cff37271dbd004a91acfd2b6800eb6c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "2f12add8-1fe9-4ee6-9c5b-69368efb4ecc", "node_type": "1", "metadata": {}, "hash": "3f3e0a7fb2de7b802f44f036c90db2dc3a603f9d12c23f7dc2a6b33a7429e7e3", "class_name": "RelatedNodeInfo"}}, "text": "### Confidence Level of a Worker\n\n| Level  | isvEnclaveQuoteStatus                                            | advisoryIDs               |\n| ------ | ---------------------------------------------------------------- | ------------------------- |\n| Tier 1 | OK                                                               | None                      |\n| Tier 2 | SW\\_HARDENING\\_NEEDED                                            | None                      |\n| Tier 3 | CONFIGURATION\\_NEEDED, CONFIGURATION\\_AND\\_SW\\_HARDENING\\_NEEDED | Whitelisted\\*             |\n| Tier 4 | CONFIGURATION\\_NEEDED, CONFIGURATION\\_AND\\_SW\\_HARDENING\\_NEEDED | Some beyond the whitelist |\n| Tier 5 | GROUP\\_OUT\\_OF\\_DATE                                             | Any value                 |\n\nThe confidence level measures how secure the SGX Enclave execution environment is. It\u2019s determined by the Remote Attestation report from Intel. Among them, `isvEnclaveQuoteStatus` indicates if the platform is vulnerable to some known problems, and `advisoryIDs` indicates the actual affected problems.\n\nNot all the `advisoryIDs` are problematic. Some advisories doesn\u2019t affect Phala\u2019s security assumption, and therefore are whitelisted:\n\n* INTEL-SA-00219\n* INTEL-SA-00334\n* INTEL-SA-00381\n* INTEL-SA-00389\n\nTier 1, 2, 3 are considered with the best security level because they are either not affected by any known vulnerability, or the adversary is known trivial. It\u2019s good to run highest valuable apps on these workers, for instance:\n\n* Financial apps: privacy-preserving DEX, DeFi ,etc\n* Secret key management: wallet, node KMS, password manager\n* Phala Gatekeeper\n\nTier 4, 5 are considered with reduced security, because these machines requires some configuration fix in the BIOS or BIOS firmware (CONFIGURATION\\_NEEDED, CONFIGURATION\\_AND\\_SW\\_HARDENING\\_NEEDED), or their microcode or the corresponding BIOS firmware are out-of-date (GROUP\\_OUT\\_OF\\_DATE). Therefore we cannot assume the platform is suitable for highest security scenarios. However it\u2019s still good to run batch processing jobs, apps dealing with ephemeral privacy data, and traditional blockchain apps:\n\n* Data analysis jobs (e.g.", "mimetype": "text/plain", "start_char_idx": 3781, "end_char_idx": 5960, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "2f12add8-1fe9-4ee6-9c5b-69368efb4ecc": {"__data__": {"id_": "2f12add8-1fe9-4ee6-9c5b-69368efb4ecc", "embedding": null, "metadata": {"file_path": "phala-docs_dist/confidence-level-and-sgx-function.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fc88b9d1-b571-4f78-b6c3-b47bb9a3c5fe", "node_type": "4", "metadata": {}, "hash": "1ec2b4e254f4bf0c91acffdf854919db30a8c1a07b51a50fc3f78cf38d12ec22", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b1d38547-fbd1-4fab-857d-4352579b77ed", "node_type": "1", "metadata": {}, "hash": "eefaade405c7aded25a62d1892ff5ad1ab34725080ac37b51227674316adcdf1", "class_name": "RelatedNodeInfo"}}, "text": "Web3 Analytics)\n* On-chain PvP games\n* VPN\n* Web2.0 apps\n* Blockchain Oracle\n* DApps\n\nOnce Phala is open for developers to deploy their apps, there will be an option for them to choose which tiers they will accept. Since Tier 1, 2, 3 have better security, they can potentially get higher chance to win the confidential contract assignment. However, Tier 4, 5 are useful in other use cases, and therefore can be a more economic choice for the developers.\n\nIf your worker is in tier 4 or 5, please check the FAQ page for potential fixes.", "mimetype": "text/plain", "start_char_idx": 5961, "end_char_idx": 6496, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "87e2f789-1116-48c4-96ca-683b65938d71": {"__data__": {"id_": "87e2f789-1116-48c4-96ca-683b65938d71", "embedding": null, "metadata": {"file_path": "phala-docs_dist/ai-execution-layer.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e7987774-37b5-41c0-b11d-e3dc713dd591", "node_type": "4", "metadata": {}, "hash": "7e807b27c5a98a9c4210184e8e4295a7c6aebb32f85dbb49c66122e97615848e", "class_name": "RelatedNodeInfo"}}, "text": "# \u26a1 AI Execution Layer\n\nWith the advancements of autonomous AI Agents, a new paradigm had started to form, and thought leaders in Blockchain started to realize the potential synergies that AI x Blockchain can offer. For example, [Vitalik's blog post](https://vitalik.eth.limo/general/2024/01/30/cryptoai.html) about AI x Blockchain sparked a new realization. AI Agents can serve as an intelligent interface to Blockchain, and help AI understand the blockchain world while ensuring their behavior (i.e. signed messages and transactions) matches their intentions and avoid being tricked or scammed.\n\n<figure><img src=\"../.gitbook/assets/AIxBlockchain.png\" alt=\"\"><figcaption><p>Diagram from Vitalk's Blog</p></figcaption></figure>\n\nIn this intersection of AI x Blockchain, AI Agents are missing some key elements that Blockchain could solve given the right architecture. Phala's Blockchain-TEE hybrid system has the answer to make AI Agents act like Smart Contracts by providing the following features for AI Agents:\n\n* Hosted on decentralized platform to ensure service availability.\n* Governed by smart contracts. This involves prompt management and access control.\n* Free to call each other to form complex applications, while the callers need to cover the cost during callee execution.\n* The secrecy of prompts are protected by TEE.\n* Highly user interactive with low latency requirements and require no gas fee.\n\nAll of these leads to a system that allow AI Agents to run in TEE workers, but are fully controlled by on-chain smart contracts. This is what Phala is good at.\n\n## The Phala Network Advantage\n\n<figure><img src=\"../.gitbook/assets/AI-Agent-DePIN (1).png\" alt=\"\"><figcaption></figcaption></figure>\n\n### Why build AI Agents on Phala Network?\n\n* **Agentize** **Smart Contracts**: Create smart contract centric AI Agents for popular web3 services and smart contracts.\n* **Decentralized**: Powered by the largest TEE network, agents are fully decentralized, tamper-proof, and unstoppable.\n* **Incentivized**: Get funded and profit on [Agent Wars](broken-reference) with innovative ideas.\n* **Powerful**: Code in fully customizable Javascript & WASM runtime.\n* **Rich Integration**: OpenAI, LangChain, [io.net](http://io.net/), etc.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2241, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "135592b8-8c14-4e6f-993c-376bd36e8dcc": {"__data__": {"id_": "135592b8-8c14-4e6f-993c-376bd36e8dcc", "embedding": null, "metadata": {"file_path": "phala-docs_dist/use-phala-app-to-delegate.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "efedb385-51ac-4032-b428-5c22e7ebfccb", "node_type": "4", "metadata": {}, "hash": "86fabbc457561ed04e310b7613ed5266fbe7c870ed2ff0dcbd37897ea82a718a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "95e2717c-503a-4844-abb6-52be382f8803", "node_type": "1", "metadata": {}, "hash": "2b86f8716b2ad2c558e65ac7d45c8225f59fcec19ca8d4e13a9025ca72797fb2", "class_name": "RelatedNodeInfo"}}, "text": "# Use Phala App to Delegate\n\n## Delegate <a href=\"#delegate\" id=\"delegate\"></a>\n\n### How to delegate <a href=\"#how-to-delegate\" id=\"how-to-delegate\"></a>\n\n1. Open Phala App [Delegate](https://app.phala.network/delegate/) page. You can see the list of StakePools and Vaults, the StakePools are sorted by APR by default and Vaults are sorted by APY by default. You can switch the StakePool list or Vault list by clicking the button. Filter out the Pools that meet the remaining quota according to the amount you want to delegate;\n\n<figure><img src=\"https://user-images.githubusercontent.com/110812052/209429064-02506702-8646-48f1-9d32-0a2578380218.png\" alt=\"\"><figcaption></figcaption></figure>\n\n2. Click the pool you want to delegate, and details of the pools being collapsed are displayed. Enter the amount to be delegated (less than Pool Remaining and Delegable Balance). Click delegate and sign. After the transaction is sent successfully, data will be updated on the App in about 20 seconds.\n\n<figure><img src=\"https://user-images.githubusercontent.com/110812052/209429293-f97c0736-04a2-4cff-9e92-d4f2130a4eab.png\" alt=\"\"><figcaption></figcaption></figure>\n\n3. If you want to use your Vault to delegate, click the account switch button in the upper left corner of the \u201cdelegate\u201d page to switch to the corresponding Vault account, and then the delegation you made will be paid by the Vault account.\n\n<figure><img src=\"https://user-images.githubusercontent.com/110812052/209429779-a1b7b517-42e6-4b6f-ad78-e36e49070578.png\" alt=\"\"><figcaption></figcaption></figure>\n\n### How could I cancel my delegation? <a href=\"#how-could-i-cancel-my-delegation\" id=\"how-could-i-cancel-my-delegation\"></a>\n\n**Withdraw the delegations**\n\nYou need to find the corresponding delegation from the \u201cmy delegation\u201d page of the Phala App, click `withdraw` and enter the value to be withdrawn to cancel the delegation.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1895, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "95e2717c-503a-4844-abb6-52be382f8803": {"__data__": {"id_": "95e2717c-503a-4844-abb6-52be382f8803", "embedding": null, "metadata": {"file_path": "phala-docs_dist/use-phala-app-to-delegate.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "efedb385-51ac-4032-b428-5c22e7ebfccb", "node_type": "4", "metadata": {}, "hash": "86fabbc457561ed04e310b7613ed5266fbe7c870ed2ff0dcbd37897ea82a718a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "135592b8-8c14-4e6f-993c-376bd36e8dcc", "node_type": "1", "metadata": {}, "hash": "386cad884a5b932adf0e8d05d1cbb8d6d6eda62f965f6eb6de94e6f57f267e30", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "3e28470f-1744-429d-8474-85fa5d779d1a", "node_type": "1", "metadata": {}, "hash": "e70d3e49abb77bf859cdb7c1fe6d79daef96a451905ad91d69e1cbbbc515e5be", "class_name": "RelatedNodeInfo"}}, "text": "<figure><img src=\"https://user-images.githubusercontent.com/110812052/209429550-27a28ae0-d20e-4749-9aae-970328cccaa1.png\" alt=\"\"><figcaption></figcaption></figure>\n\nIf there are enough free delegations in the stakepool, your withdrawal request will be completed in real-time.\n\nIf the free delegation is insufficient, a withdrawal queue will be generated.\n\n* The pool owner needs to add enough free delegation within seven days after the withdrawal queue is generated. Anyone can manually trigger a `reclaim` operation at any time and use the free delegation in the stakepool to eliminate the withdraw queue.\n* If the free delegation is still insufficient after seven days, and the existing releasing stake is also insufficient to afford the withdrawal, the stakepool will be forced to stop after a new `reclaim` operation, and all active workers will enter a cooling-down period for 7 days. When the cooling down countdown of the workers is over, any delegator can reclaim the delegations from the stakepool, take out the delegation which was staked into the workers, and use it to eliminate the withdrawal queue of the pool.\n\n> When the withdrawal queue is generated, this part of the delegation will be separated from your Delegation NFT in this pool, your Delegation NFT in this pool records the remaining delegation, and a Withdrawal Delegation NFT which belongs to the stakepool will be generated (Don\u2019t worry, this NFT records the token orientation after withdrawal, and you can find your Withdrawal NFT in the Phala App, why we do like this is for keeping the withdrawal queue being paid back in order)\n>\n> And the withdrawal queue is eliminated in order. The earlier the withdrawal, the earlier the free delegation in the pool will be obtained.\n\nTherefore, in the worst case, you will need to wait 14 days to get your delegation back from a StakePool, but in most cases, the good behavior stakepool owner will take the initiative to complete your withdrawal application within 1-7 days. If you delegated to a Vault, another 7 days are needed. Therefore, in the worst case, you will need to wait 21 days to get your delegation back from a Vault.\n\nWhen you already have a withdrawal queue in stakepool/Vault, you cannot cancel the existing withdrawal application.", "mimetype": "text/plain", "start_char_idx": 1897, "end_char_idx": 4166, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "3e28470f-1744-429d-8474-85fa5d779d1a": {"__data__": {"id_": "3e28470f-1744-429d-8474-85fa5d779d1a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/use-phala-app-to-delegate.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "efedb385-51ac-4032-b428-5c22e7ebfccb", "node_type": "4", "metadata": {}, "hash": "86fabbc457561ed04e310b7613ed5266fbe7c870ed2ff0dcbd37897ea82a718a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "95e2717c-503a-4844-abb6-52be382f8803", "node_type": "1", "metadata": {}, "hash": "2b86f8716b2ad2c558e65ac7d45c8225f59fcec19ca8d4e13a9025ca72797fb2", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5559da3c-4c4b-40d5-a5ee-a22039bba44b", "node_type": "1", "metadata": {}, "hash": "6006a946ca061d35053a19779812502aeb536be9fe33237d5d568d2bbe4a7c3c", "class_name": "RelatedNodeInfo"}}, "text": "Once you initiate a new withdrawal application under the same pool, the old withdrawal queue will be invalidated and the withdrawal will be re-initiated with an updated application, and the countdown will restart to the countdown on a 7-day period.\n\nIf you want to withdraw the delegations in your Vault account, click the account switch button in the upper left corner of the \u201cmy delegation\u201d page to switch to the corresponding Vault account, and then the withdrawal you made will be operated by the Vault account.\n\n<figure><img src=\"https://user-images.githubusercontent.com/110812052/209429873-440f22f5-9640-4c00-93d6-5b330aa40883.png\" alt=\"\"><figcaption></figcaption></figure>\n\n**Unwrap the wPHA**\n\nAfter withdrawal is finished, your tokens will be stored as wPHA. You need to unwrap it on the \u201cdelegate\u201d page and click \u201cunwrap all\u201d to unwrap the tokens.\n\n## StakePool/Vault management <a href=\"#stakepoolvault-management\" id=\"stakepoolvault-management\"></a>\n\n### Create <a href=\"#create\" id=\"create\"></a>\n\nYou can select the type of pools you want to operate under the \u201cfarm\u201d, choose \u201cStakePool\u201d or \u201cVault\u201d, and click to enter the corresponding page. On the StakePool and Vault pages, you can do the same operation:\n\nClick the \u201cCreate\u201d button in the upper right corner to create your pool.\n\n![image](https://user-images.githubusercontent.com/110812052/209429918-868fdbf3-627d-412c-9be9-9ba20cb26d2f.png)\n\n### Claim Owner rewards <a href=\"#claim-owner-rewards\" id=\"claim-owner-rewards\"></a>\n\n**Rewards of StakePool**\n\n1. You can check your current available rewards on the [My StakePools](https://app.phala.network/farm/stake-pool) page;\n\n<figure><img src=\"https://user-images.githubusercontent.com/110812052/209430378-eae91aa1-155a-49fc-bd06-5a477f9461d3.png\" alt=\"\"><figcaption></figcaption></figure>\n\n2.", "mimetype": "text/plain", "start_char_idx": 4167, "end_char_idx": 5977, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5559da3c-4c4b-40d5-a5ee-a22039bba44b": {"__data__": {"id_": "5559da3c-4c4b-40d5-a5ee-a22039bba44b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/use-phala-app-to-delegate.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "efedb385-51ac-4032-b428-5c22e7ebfccb", "node_type": "4", "metadata": {}, "hash": "86fabbc457561ed04e310b7613ed5266fbe7c870ed2ff0dcbd37897ea82a718a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "3e28470f-1744-429d-8474-85fa5d779d1a", "node_type": "1", "metadata": {}, "hash": "e70d3e49abb77bf859cdb7c1fe6d79daef96a451905ad91d69e1cbbbc515e5be", "class_name": "RelatedNodeInfo"}}, "text": "Confirm the PID and Rewards, click the _claim rewards_ in the pop-up window, enter the reward receiving address (you can directly click _My Address_ to add your own address), click _submit_, sign, and after the transaction is sent successfully, you can see the data update on the App in about 20 seconds.\n3. You can also use _Claim all_ to claim the rewards from all the StakePools by one transaction.\n\n> Note if you claim the owner rewards to another address not the StakePool owner address, the rewards will be stored as wPHA. You need to unwrap it on the delegate page.\n\n**Rewards of Vault**\n\n1. You can check your current available rewards on the [My Vaults](https://app.phala.network/farm/vault) page;\n\n<figure><img src=\"https://user-images.githubusercontent.com/110812052/209430114-8ce86909-2439-4770-9ed9-aa3e6fa524f5.png\" alt=\"\"><figcaption></figcaption></figure>\n\n2. Click the _mint cut_ and sign, to manually claim the Vault owner reward. After the transaction is successful, the Vault owner\u2019s rewards will be stored in the form of the Vault\u2019s Delegation NFT. After that, you can click _claim to delegation_ to distribute the Vault owner rewards to the address you want to receive rewards, after which you will be able to manage these delegations. You can see the data update on the App in about 20 seconds.\n3. You can also use _Mint Cut_ and _Claim to Delegation_ on the upper of the page to claim the rewards from all the StakePools by one transaction.", "mimetype": "text/plain", "start_char_idx": 5978, "end_char_idx": 7442, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f065052c-211c-46e3-86a5-d851c6673a7c": {"__data__": {"id_": "f065052c-211c-46e3-86a5-d851c6673a7c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/SUMMARY.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fd536039-a969-4e29-8034-3836af76e2b3", "node_type": "4", "metadata": {}, "hash": "aacbf82bb431ba9c575642aa57d7808adfb5b55da585240a330368079aa21ad8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b34141a2-263d-4be4-99ec-5a05bedf43c3", "node_type": "1", "metadata": {}, "hash": "2f64b8161efed470235127d3e1b29693997d9a293628805738422f5c4cbda739", "class_name": "RelatedNodeInfo"}}, "text": "# Table of contents\n\n## Home\n\n* [\ud83d\udc7e Phala Network Docs](README.md)\n\n## Overview\n\n* [\u2696\ufe0f Phala Network](overview/phala-network.md)\n* [\u26a1 AI Execution Layer](overview/ai-execution-layer.md)\n* [\ud83d\udc8e PHA Token](overview/pha-token/README.md)\n  * [\ud83e\ude99 Introduction](overview/pha-token/introduction.md)\n  * [\ud83d\udc50 Delegation](overview/pha-token/delegation/README.md)\n    * [Delegate to StakePool](overview/pha-token/delegation/delegate-to-stakepool.md)\n    * [What is Vault](overview/pha-token/delegation/whats-vault.md)\n    * [What is Share](overview/pha-token/delegation/whats-share.md)\n    * [WrappedBalances & W-PHA](overview/pha-token/delegation/wrappedbalances-and-w-pha.md)\n    * [Examples of Delegation](overview/pha-token/delegation/examples-of-delegation.md)\n    * [Use Phala App to Delegate](overview/pha-token/delegation/use-phala-app-to-delegate.md)\n    * [Estimate Your Reward](overview/pha-token/delegation/estimate-your-reward.md)\n  * [\ud83d\uddf3\ufe0f Governance](overview/pha-token/governance/README.md)\n    * [Governance Mechanism](overview/pha-token/governance/governance-mechanism.md)\n    * [Join the Council](overview/pha-token/governance/join-the-council.md)\n    * [Voting for Councillors](overview/pha-token/governance/voting-for-councillors.md)\n    * [Apply for Project Funding](overview/pha-token/governance/apply-for-project-funding.md)\n    * [Khala Treasury](overview/pha-token/governance/khala-treasury.md)\n    * [Khala Governance](overview/pha-token/governance/khala-governance.md)\n    * [Setting Up an Account Identity](overview/pha-token/governance/setup-account-identity.md)\n\n## AI Agent Contract\n\n* [\ud83d\udc69\u200d\ud83d\udcbb Getting Started](ai-agent-contract/getting-started/README.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1663, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b34141a2-263d-4be4-99ec-5a05bedf43c3": {"__data__": {"id_": "b34141a2-263d-4be4-99ec-5a05bedf43c3", "embedding": null, "metadata": {"file_path": "phala-docs_dist/SUMMARY.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fd536039-a969-4e29-8034-3836af76e2b3", "node_type": "4", "metadata": {}, "hash": "aacbf82bb431ba9c575642aa57d7808adfb5b55da585240a330368079aa21ad8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f065052c-211c-46e3-86a5-d851c6673a7c", "node_type": "1", "metadata": {}, "hash": "47ed6bf89529cf0e43b29b02a623b104e7eff243f0ac34a89976864ff093344b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "60c446a5-8636-4a78-bc30-a0855ab678bc", "node_type": "1", "metadata": {}, "hash": "090cd7e97ff76e3967b604361b414d3866db47a29ca6f05b9e71b31db116d248", "class_name": "RelatedNodeInfo"}}, "text": "md)\n  * [Build Your First AI Agent Contract](ai-agent-contract/getting-started/build-your-first-ai-agent-contract.md)\n  * [Build An Agent to Transact Onchain](ai-agent-contract/getting-started/build-an-agent-to-transact-onchain.md)\n  * [Build Your AI Agent Contract with OpenAI](ai-agent-contract/getting-started/build-your-ai-agent-contract-with-openai.md)\n  * [Build Your AI Agent Contract with LangChain](ai-agent-contract/getting-started/build-your-ai-agent-contract-with-langchain.md)\n  * [Integrate with 3rd Party API with HTTP Request](ai-agent-contract/getting-started/integrate-with-3rd-party-api-with-http-request.md)\n  * [Run a Local Testnet With Docker](ai-agent-contract/getting-started/run-a-local-testnet-with-docker.md)\n  * [AI Agent Contract Templates](ai-agent-contract/getting-started/ai-agent-contract-templates.md)\n* [\ud83d\udd28 Build](ai-agent-contract/build/README.md)\n  * [Define Your Agent](ai-agent-contract/build/define-your-agent.md)\n  * [Add a Data Source](ai-agent-contract/build/add-a-data-source.md)\n  * [Connect to Smart Contracts](ai-agent-contract/build/connect-to-smart-contracts.md)\n  * [Invoke Other Agents](ai-agent-contract/build/invoke-other-agents.md)\n  * [Test and Benchmark](ai-agent-contract/build/test-and-benchmark.md)\n  * [Token Gated Access](ai-agent-contract/build/token-gated-access.md)\n* [\ud83d\ude80 Launch](ai-agent-contract/launch/README.md)\n  * [Publish Agent Script](ai-agent-contract/launch/publish-agent-script.md)\n* [\ud83e\udd33 Use](ai-agent-contract/use/README.md)\n  * [Access from UI](ai-agent-contract/use/access-from-ui.md)\n  * [Access from Other Agents](ai-agent-contract/use/access-from-other-agents.md)\n* [\ud83e\uddd9\u200d\u2642\ufe0f Examples](ai-agent-contract/examples/README.", "mimetype": "text/plain", "start_char_idx": 1663, "end_char_idx": 3357, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "60c446a5-8636-4a78-bc30-a0855ab678bc": {"__data__": {"id_": "60c446a5-8636-4a78-bc30-a0855ab678bc", "embedding": null, "metadata": {"file_path": "phala-docs_dist/SUMMARY.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fd536039-a969-4e29-8034-3836af76e2b3", "node_type": "4", "metadata": {}, "hash": "aacbf82bb431ba9c575642aa57d7808adfb5b55da585240a330368079aa21ad8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b34141a2-263d-4be4-99ec-5a05bedf43c3", "node_type": "1", "metadata": {}, "hash": "2f64b8161efed470235127d3e1b29693997d9a293628805738422f5c4cbda739", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "6321e8e6-92c6-4d1a-b2e2-49f245846fe2", "node_type": "1", "metadata": {}, "hash": "1122ed308b320d42a61b28c241f237244ae071ad79eea35bd0d859c359c07ff1", "class_name": "RelatedNodeInfo"}}, "text": "md)\n  * [Create a Weather Agent w/ Function Calling](ai-agent-contract/examples/create-a-weather-agent-w-function-calling.md)\n  * [Connect from Autonolas Plugin](ai-agent-contract/examples/connect-from-autonolas-plugin.md)\n  * [Connect from Morpheus Plugin](ai-agent-contract/examples/connect-from-morpheus-plugin.md)\n* [\ud83d\udd0c Integrations](ai-agent-contract/integrations/README.md)\n  * [\u2708\ufe0f Airstack Agent](ai-agent-contract/integrations/airstack-agent.md)\n  * [\ud83d\udcc8 The Graph Agent](ai-agent-contract/integrations/the-graph-agent.md)\n  * [\ud83e\ude9e Mirrored Price Feeds Agent](ai-agent-contract/integrations/mirrored-price-feeds-agent/README.md)\n    * [Getting Started](ai-agent-contract/integrations/mirrored-price-feeds-agent/getting-started.md)\n    * [Feed Addresses](ai-agent-contract/integrations/mirrored-price-feeds-agent/feed-addresses/README.md)\n      * [Astar zKatana Testnet](ai-agent-contract/integrations/mirrored-price-feeds-agent/feed-addresses/astar-zkatana-testnet.md)\n      * [Tanssi Dancebox Testnet](ai-agent-contract/integrations/mirrored-price-feeds-agent/feed-addresses/tanssi-dancebox-testnet.md)\n      * [Base Sepolia Testnet](ai-agent-contract/integrations/mirrored-price-feeds-agent/feed-addresses/base-sepolia-testnet.md)\n    * [How Mirrored Price Feeds Work](ai-agent-contract/integrations/mirrored-price-feeds-agent/how-mirrored-price-feeds-work.md)\n  * [\ud83c\udf31 LensAPI Oracle Agent](ai-agent-contract/integrations/lensapi-oracle-agent.md)\n* [\u26d3\ufe0f Supported Chains](ai-agent-contract/supported-chains.md)\n* [FAQ](ai-agent-contract/faq.md)\n\n## Agent Wars\n\n* [\ud83d\udcdc Introduction](agent-wars/agent-wars-introduction.md)\n* [\ud83d\udcb8 Tokenomics](agent-wars/agent-war-tokenomics.", "mimetype": "text/plain", "start_char_idx": 3357, "end_char_idx": 5028, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6321e8e6-92c6-4d1a-b2e2-49f245846fe2": {"__data__": {"id_": "6321e8e6-92c6-4d1a-b2e2-49f245846fe2", "embedding": null, "metadata": {"file_path": "phala-docs_dist/SUMMARY.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fd536039-a969-4e29-8034-3836af76e2b3", "node_type": "4", "metadata": {}, "hash": "aacbf82bb431ba9c575642aa57d7808adfb5b55da585240a330368079aa21ad8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "60c446a5-8636-4a78-bc30-a0855ab678bc", "node_type": "1", "metadata": {}, "hash": "090cd7e97ff76e3967b604361b414d3866db47a29ca6f05b9e71b31db116d248", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "1d5f77cf-8005-43c7-b8a1-cc06cd256229", "node_type": "1", "metadata": {}, "hash": "3262d3d80918988134e8bba890b1ee07fa831e4f150a1a487f0dc42f99570cf9", "class_name": "RelatedNodeInfo"}}, "text": "md)\n* [\u25b6\ufe0f Getting Started](agent-wars/getting-started/README.md)\n  * [Wallet Setup & Get PHA](agent-wars/getting-started/wallet-setup-and-get-pha.md)\n  * [Buy and Sell Keys](agent-wars/getting-started/buy-and-sell-keys.md)\n  * [Create and Play with Social Agents](agent-wars/getting-started/create-and-play-with-social-agents.md)\n* [\ud83e\uddd1\u200d\ud83c\udfeb Tutorial](agent-wars/tutorial.md)\n\n## Tech Specs\n\n* [\ud83e\udd77 AI Agent Contract](tech-specs/ai-agent-contract/README.md)\n  * [WapoJS Functions](tech-specs/ai-agent-contract/wapojs-functions.md)\n  * [Phala Agent Gateway](tech-specs/ai-agent-contract/phala-agent-gateway.md)\n* [\u2705 Multi-Proof and Verifiable Compute](tech-specs/multi-proof-and-verifiable-compute/README.md)\n  * [Why Multi-Proof and How We Can Help](tech-specs/multi-proof-and-verifiable-compute/why-multi-proof-and-how-we-can-help.md)\n  * [Trusted Execution Environments (TEE) and Compute Verifiability](tech-specs/multi-proof-and-verifiable-compute/trusted-execution-environments-tee-and-compute-verifiability.md)\n  * [How to Build with Multi-Proof](tech-specs/multi-proof-and-verifiable-compute/how-to-build-with-multi-proof.md)\n  * [Conclusion & Future Developments](tech-specs/multi-proof-and-verifiable-compute/conclusion-and-future-developments.md)\n* [\u26d3\ufe0f Blockchain](tech-specs/blockchain/README.md)\n  * [Blockchain Entities](tech-specs/blockchain/blockchain-entities.md)\n  * [Cluster of Workers](tech-specs/blockchain/cluster-of-workers.md)\n  * [Secret Key Hierarchy](tech-specs/blockchain/secret-key-hierarchy.md)\n\n## References\n\n* [\ud83d\udd10 Setting Up a Wallet on Phala](references/basic-guidance/README.md)\n  * [Acquiring PHA](references/basic-guidance/get-pha-and-transfer.", "mimetype": "text/plain", "start_char_idx": 5028, "end_char_idx": 6699, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "1d5f77cf-8005-43c7-b8a1-cc06cd256229": {"__data__": {"id_": "1d5f77cf-8005-43c7-b8a1-cc06cd256229", "embedding": null, "metadata": {"file_path": "phala-docs_dist/SUMMARY.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fd536039-a969-4e29-8034-3836af76e2b3", "node_type": "4", "metadata": {}, "hash": "aacbf82bb431ba9c575642aa57d7808adfb5b55da585240a330368079aa21ad8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "6321e8e6-92c6-4d1a-b2e2-49f245846fe2", "node_type": "1", "metadata": {}, "hash": "1122ed308b320d42a61b28c241f237244ae071ad79eea35bd0d859c359c07ff1", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "74ae9d44-ba47-483a-8a27-4c8d234602c1", "node_type": "1", "metadata": {}, "hash": "be8ba5ed40964b7a9e1b3aa232607d54a91e6895a1517d368c9f436d702f1625", "class_name": "RelatedNodeInfo"}}, "text": "md)\n* [\ud83e\udd16 AI Agent Contract SDKs](references/ai-agent-contract-sdks/README.md)\n  * [JS SDK](references/ai-agent-contract-sdks/bricks-and-blueprints/README.md)\n    * [\ud83d\udc7e Create a Dashboard Profile](references/ai-agent-contract-sdks/bricks-and-blueprints/create-a-dashboard-profile.md)\n    * [\u2728 Phat Contract Starter Kit](references/ai-agent-contract-sdks/bricks-and-blueprints/featured-blueprints/README.md)\n      * [\ud83c\udfc3\u200d\u2642\ufe0f Quick Start](references/ai-agent-contract-sdks/bricks-and-blueprints/featured-blueprints/quick-start.md)\n      * [\u2694\ufe0f Connect Phat Contract to EVM Consumer Contract](references/ai-agent-contract-sdks/bricks-and-blueprints/featured-blueprints/connect-phat-contract-to-evm-consumer-contract.md)\n      * [\ud83c\udfd7\ufe0f Customizing Your Phat Contract](references/ai-agent-contract-sdks/bricks-and-blueprints/featured-blueprints/customizing-your-phat-contract.md)\n      * [\ud83e\udd2b Handling Secrets](references/ai-agent-contract-sdks/bricks-and-blueprints/featured-blueprints/handling-secrets.md)\n    * [\ud83e\udeb4 LensAPI Oracle](references/ai-agent-contract-sdks/bricks-and-blueprints/lensapi-oracle/README.md)\n      * [\ud83e\uddd1\u200d\ud83d\ude80 Polygon Consumer Contract for LensAPI Oracle](references/ai-agent-contract-sdks/bricks-and-blueprints/lensapi-oracle/polygon-consumer-contract-for-lensapi-oracle.md)\n    * [\ud83d\udcc8 The Graph](references/ai-agent-contract-sdks/bricks-and-blueprints/the-graph/README.md)\n      * [\ud83e\udd8b Quick Start](references/ai-agent-contract-sdks/bricks-and-blueprints/the-graph/quick-start.md)\n      * [\ud83c\udfab Connect The Graph Phat Contract to EVM Consumer Contract](references/ai-agent-contract-sdks/bricks-and-blueprints/the-graph/connect-the-graph-phat-contract-to-evm-consumer-contract.", "mimetype": "text/plain", "start_char_idx": 6699, "end_char_idx": 8372, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "74ae9d44-ba47-483a-8a27-4c8d234602c1": {"__data__": {"id_": "74ae9d44-ba47-483a-8a27-4c8d234602c1", "embedding": null, "metadata": {"file_path": "phala-docs_dist/SUMMARY.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fd536039-a969-4e29-8034-3836af76e2b3", "node_type": "4", "metadata": {}, "hash": "aacbf82bb431ba9c575642aa57d7808adfb5b55da585240a330368079aa21ad8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "1d5f77cf-8005-43c7-b8a1-cc06cd256229", "node_type": "1", "metadata": {}, "hash": "3262d3d80918988134e8bba890b1ee07fa831e4f150a1a487f0dc42f99570cf9", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "21d18e35-8894-4bcb-9a43-dfa7220cb039", "node_type": "1", "metadata": {}, "hash": "2d1dd77f03e04cff105f59d532b92d563c579ff8dab6670f1bc9f2b38486dac4", "class_name": "RelatedNodeInfo"}}, "text": "md)\n      * [\ud83d\udddd\ufe0f Get an API Key for The Graph](references/ai-agent-contract-sdks/bricks-and-blueprints/the-graph/get-an-api-key-for-the-graph.md)\n    * [\u2708\ufe0f Airstack](references/ai-agent-contract-sdks/bricks-and-blueprints/airstack/README.md)\n      * [\ud83d\udee9\ufe0f Quick Start](references/ai-agent-contract-sdks/bricks-and-blueprints/airstack/quick-start.md)\n      * [\ud83e\udec2 Connect Airstack Phat Contract to EVM Consumer Contract](references/ai-agent-contract-sdks/bricks-and-blueprints/airstack/connect-airstack-phat-contract-to-evm-consumer-contract.md)\n      * [\ud83d\udddd\ufe0f Get an Airstack API Key](references/ai-agent-contract-sdks/bricks-and-blueprints/airstack/get-an-airstack-api-key.md)\n  * [Rust SDK](references/ai-agent-contract-sdks/getting-started/README.md)\n    * [Generate Test Account](references/ai-agent-contract-sdks/getting-started/generate-test-account.md)\n    * [Phat Contract Console](references/ai-agent-contract-sdks/getting-started/phat-contract-console.md)\n    * [Next Step](references/ai-agent-contract-sdks/getting-started/next-step.md)\n    * [Build](references/ai-agent-contract-sdks/getting-started/build-on-phat-contract/README.md)\n      * [Environment Setup](references/ai-agent-contract-sdks/getting-started/build-on-phat-contract/environment-setup.md)\n      * [Swanky Phala CLI Tool](references/ai-agent-contract-sdks/getting-started/build-on-phat-contract/swanky-phala-cli-tool.md)\n      * [Create Contract](references/ai-agent-contract-sdks/getting-started/build-on-phat-contract/create-contract.md)\n      * [Deploy Contract](references/ai-agent-contract-sdks/getting-started/build-on-phat-contract/deploy-contract.", "mimetype": "text/plain", "start_char_idx": 8372, "end_char_idx": 9998, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "21d18e35-8894-4bcb-9a43-dfa7220cb039": {"__data__": {"id_": "21d18e35-8894-4bcb-9a43-dfa7220cb039", "embedding": null, "metadata": {"file_path": "phala-docs_dist/SUMMARY.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fd536039-a969-4e29-8034-3836af76e2b3", "node_type": "4", "metadata": {}, "hash": "aacbf82bb431ba9c575642aa57d7808adfb5b55da585240a330368079aa21ad8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "74ae9d44-ba47-483a-8a27-4c8d234602c1", "node_type": "1", "metadata": {}, "hash": "be8ba5ed40964b7a9e1b3aa232607d54a91e6895a1517d368c9f436d702f1625", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "8f531ec7-6726-480d-925a-93459d26d7d4", "node_type": "1", "metadata": {}, "hash": "ef66493f81229c81885d5266a43c7d5e353a46a3f2c7d73ee691c5573fff0f24", "class_name": "RelatedNodeInfo"}}, "text": "md)\n      * [Language Basics](references/ai-agent-contract-sdks/getting-started/build-on-phat-contract/language-basics.md)\n      * [Call Your Contract](references/ai-agent-contract-sdks/getting-started/build-on-phat-contract/call-your-contract.md)\n      * [Build Stateless Backend](references/ai-agent-contract-sdks/getting-started/build-on-phat-contract/build-stateless-backend.md)\n      * [Use Pink Extension](references/ai-agent-contract-sdks/getting-started/build-on-phat-contract/use-pink-extension.md)\n      * [Use Rust Crates](references/ai-agent-contract-sdks/getting-started/build-on-phat-contract/use-rust-crates.md)\n      * [Unit Tests](references/ai-agent-contract-sdks/getting-started/build-on-phat-contract/unit-tests.md)\n      * [Store Contract States](references/ai-agent-contract-sdks/getting-started/build-on-phat-contract/store-contract-states.md)\n* [\u2692\ufe0f Phala SDK](references/phala-sdk.md)\n* [\ud83d\uddbc\ufe0f FrameHub](references/framehub.md)\n* [\ud83c\udf09 SubBridge](references/subbridge/README.md)\n  * [Cross-chain Transfer](references/subbridge/cross-chain-transfer.md)\n  * [Supported Assets](references/subbridge/supported-assets.md)\n  * [Asset Integration Guide](references/subbridge/asset-integration-guide.md)\n  * [Technical Details](references/subbridge/technical-details.md)\n* [\ud83d\udc68\u200d\ud83d\ude80 Builders Program](references/builders-program.md)\n* [\ud83d\udc77 Community Builders](references/community-builders.md)\n* [\ud83e\udd39 Hackathon Guides](references/hackathon-guides/README.md)\n  * [ETHGlobal Hackathon Guide](references/hackathon-guides/ethglobal-hackathon-guide.md)\n* [\ud83e\udd2f Advanced Topics](references/advanced-topics/README.md)\n  * [Cross Chain Solutions](references/advanced-topics/cross-chain-solutions.md)\n  * [System Contract and Drivers](references/advanced-topics/system-contract-and-drivers.", "mimetype": "text/plain", "start_char_idx": 9998, "end_char_idx": 11777, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8f531ec7-6726-480d-925a-93459d26d7d4": {"__data__": {"id_": "8f531ec7-6726-480d-925a-93459d26d7d4", "embedding": null, "metadata": {"file_path": "phala-docs_dist/SUMMARY.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fd536039-a969-4e29-8034-3836af76e2b3", "node_type": "4", "metadata": {}, "hash": "aacbf82bb431ba9c575642aa57d7808adfb5b55da585240a330368079aa21ad8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "21d18e35-8894-4bcb-9a43-dfa7220cb039", "node_type": "1", "metadata": {}, "hash": "2d1dd77f03e04cff105f59d532b92d563c579ff8dab6670f1bc9f2b38486dac4", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "cffc8e82-d713-443b-be88-3b379e3503f6", "node_type": "1", "metadata": {}, "hash": "c20d643620f037aad6407b8187a8281acc9694ad8bf4af263134629bbbccded0", "class_name": "RelatedNodeInfo"}}, "text": "md)\n  * [Run Local Testnet](references/advanced-topics/run-local-testnet.md)\n  * [SideVM](references/advanced-topics/sidevm.md)\n* [\ud83c\udd98 Support](references/support/README.md)\n  * [Available Phala Chains](references/support/endpoints.md)\n  * [Resource Limits](references/support/resource-limits.md)\n  * [Transaction Costs](references/support/transaction-costs.md)\n  * [Compatibility Matrix](references/support/compatibility-matrix.md)\n  * [Block Explorers](references/support/block-explorers.md)\n  * [Faucet](references/support/faucet.md)\n* [\u2049\ufe0f FAQ](references/faq.md)\n\n## Compute Providers\n\n* [\ud83d\ude43 Basic Info](compute-providers/basic-info/README.md)\n  * [Introduction](compute-providers/basic-info/introduction.md)\n  * [Gemini Tokenomics (Worker Rewards)](compute-providers/basic-info/worker-rewards.md)\n  * [Budget balancer](compute-providers/basic-info/budget-balancer.md)\n  * [Staking Mechanism](compute-providers/basic-info/staking-mechanism.md)\n  * [Requirements in Phala/Khala](compute-providers/basic-info/requirements-in-phala-khala.md)\n  * [Confidence Level & SGX Function](compute-providers/basic-info/confidence-level-and-sgx-function.md)\n  * [Rent Hardware](compute-providers/basic-info/rent-hardware.md)\n  * [Error Summary](compute-providers/basic-info/error-summary.md)\n* [\ud83e\uddbf Run Workers on Phala](compute-providers/run-workers-on-phala/README.md)\n  * [Solo Worker Deployment](compute-providers/run-workers-on-phala/solo-worker-deployment.md)\n  * [PRBv3 Deployment](compute-providers/run-workers-on-phala/prbv3-deployment.md)\n  * [Using PRBv3 UI](compute-providers/run-workers-on-phala/using-prbv3-ui.md)\n  * [PRB Worker Deployment](compute-providers/run-workers-on-phala/prb-worker-deployment.", "mimetype": "text/plain", "start_char_idx": 11777, "end_char_idx": 13479, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "cffc8e82-d713-443b-be88-3b379e3503f6": {"__data__": {"id_": "cffc8e82-d713-443b-be88-3b379e3503f6", "embedding": null, "metadata": {"file_path": "phala-docs_dist/SUMMARY.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fd536039-a969-4e29-8034-3836af76e2b3", "node_type": "4", "metadata": {}, "hash": "aacbf82bb431ba9c575642aa57d7808adfb5b55da585240a330368079aa21ad8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "8f531ec7-6726-480d-925a-93459d26d7d4", "node_type": "1", "metadata": {}, "hash": "ef66493f81229c81885d5266a43c7d5e353a46a3f2c7d73ee691c5573fff0f24", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f4b61da6-f5cb-4041-b410-c5b7b510cd93", "node_type": "1", "metadata": {}, "hash": "998981f376c857e57ac65172b9eeb799556854ecf9b8fa84863f0e158a651e90", "class_name": "RelatedNodeInfo"}}, "text": "md)\n  * [Switch Workers from Solo to PRB Mode](compute-providers/run-workers-on-phala/switch-workers-from-solo-to-prb-mode.md)\n  * [Headers-cache deployment](compute-providers/run-workers-on-phala/headers-cache-deployment.md)\n  * [Archive node deployment](compute-providers/run-workers-on-phala/archive-node-deployment.md)\n* [\ud83c\udfc3\u200d\u2640\ufe0f Run Workers on Khala](compute-providers/run-workers-on-khala/README.md)\n  * [Solo Scripts Guidance](compute-providers/run-workers-on-khala/solo-scripts-guidance/README.md)\n    * [Installing Khala Solo Scripts](compute-providers/run-workers-on-khala/solo-scripts-guidance/installing-phala-mining-tools.md)\n    * [Worker Confidence Level](compute-providers/run-workers-on-khala/solo-scripts-guidance/worker-confidence-level.md)\n    * [Configure the Worker](compute-providers/run-workers-on-khala/solo-scripts-guidance/configure-the-worker.md)\n    * [Deploy the Worker](compute-providers/run-workers-on-khala/solo-scripts-guidance/deploy-the-worker.md)\n    * [Monitor Worker's Status](compute-providers/run-workers-on-khala/solo-scripts-guidance/monitor-workers-status.md)\n    * [Accelerate Khala Syncing](compute-providers/run-workers-on-khala/solo-scripts-guidance/accelerate-khala-syncing.md)\n    * [Update your Worker's Node](compute-providers/run-workers-on-khala/solo-scripts-guidance/update-your-workers-node.md)\n  * [PRBv3 Deployment Guide](compute-providers/run-workers-on-khala/prbv3-deployment.md)\n  * [Using PRBv3 UI](compute-providers/run-workers-on-khala/using-prbv3-ui.md)\n  * [Migration from PRBv2 to v3](compute-providers/run-workers-on-khala/migration-from-prbv2-to-v3.md)\n  * [Headers-cache deployment](compute-providers/run-workers-on-khala/headers-cache-deployment.md)\n  * [Archive node deployment](compute-providers/run-workers-on-khala/archive-node-deployment.", "mimetype": "text/plain", "start_char_idx": 13479, "end_char_idx": 15290, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f4b61da6-f5cb-4041-b410-c5b7b510cd93": {"__data__": {"id_": "f4b61da6-f5cb-4041-b410-c5b7b510cd93", "embedding": null, "metadata": {"file_path": "phala-docs_dist/SUMMARY.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fd536039-a969-4e29-8034-3836af76e2b3", "node_type": "4", "metadata": {}, "hash": "aacbf82bb431ba9c575642aa57d7808adfb5b55da585240a330368079aa21ad8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "cffc8e82-d713-443b-be88-3b379e3503f6", "node_type": "1", "metadata": {}, "hash": "c20d643620f037aad6407b8187a8281acc9694ad8bf4af263134629bbbccded0", "class_name": "RelatedNodeInfo"}}, "text": "md)\n  * [PRBv2 Deployment Guide](compute-providers/run-workers-on-khala/deployment-guide-for-prbv2.md)\n  * [PRB Worker Deployment](compute-providers/run-workers-on-khala/prb-worker-deployment.md)\n  * [How to switch from Solo scripts to PRB worker](compute-providers/run-workers-on-khala/how-to-switch-from-solo-mining-to-prb-mining.md)\n  * [Khala Worker Rewards](compute-providers/run-workers-on-khala/khala-worker-rewards.md)\n  * [Troubleshooting](compute-providers/run-workers-on-khala/troubleshooting.md)\n* [\ud83d\udee1\ufe0f Gatekeeper](compute-providers/gatekeeper/README.md)\n  * [Collator](compute-providers/gatekeeper/collator.md)\n  * [Gatekeeper](compute-providers/gatekeeper/gatekeeper.md)\n\n## Web Directory\n\n* [Discord](https://discord.gg/phala-network)\n* [GitHub](https://github.com/Phala-Network/)\n* [Twitter](https://twitter.com/PhalaNetwork)\n* [YouTube](https://www.youtube.com/@PhalaNetwork)\n* [Forum](https://forum.phala.network/)\n* [Medium](https://medium.com/phala-network)\n\n***\n\n* [Telegram](https://t.me/phalanetwork)", "mimetype": "text/plain", "start_char_idx": 15290, "end_char_idx": 16312, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0e53a53b-1f0b-4ba9-9318-3a72877bc374": {"__data__": {"id_": "0e53a53b-1f0b-4ba9-9318-3a72877bc374", "embedding": null, "metadata": {"file_path": "phala-docs_dist/gatekeeper.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "156d6ab7-38b0-42f9-bdb0-030ee1fa3afd", "node_type": "4", "metadata": {}, "hash": "605fbd90be7bb76ebad5bf46568bda9db663b43d418c77dbce577180c5ce92bd", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "2b384deb-bf37-4a8f-a4a2-f0ab8c690e4a", "node_type": "1", "metadata": {}, "hash": "f409a1a1711968aaaa6ddf30f31ba65a0327525b41e040b037725c5fbb832a38", "class_name": "RelatedNodeInfo"}}, "text": "# Gatekeeper\n\nGatekeeper is a special role that manages the secrets in the network and runs the tokenomic model. Gatekeepers are supposed to be elected by the PHA token holders with NPoS, and should also run as a collator. However, as of now, Gatekeepers are designated by the council directly, not associated with collators, because collator binding and NPoS are still under development.\n\nTo set up a Gatekeeper, you should follow the steps below:\n\n1. Prepare an account with some PHA token to pay for the transaction fee.\n2. Prepare a server with proper Intel SGX support\n3. Deploy a worker stack: full node, pherry, and pRuntime\n4. Make a council proposal to add the worker to the Gatekeeper list\n5. Finally, you Gatkeeper should be up and running. As the opereator, you should keep monitoring.\n\n## Prepare the Gatekeeper operator account <a href=\"#prepare-the-gatekeeper-operator-account\" id=\"prepare-the-gatekeeper-operator-account\"></a>\n\nTo operate a Gatekeeper, an account with some PHA balance is required. The Gatekeeper program runs by pruntime in Secure Enclaves. It communicates with the blockchain in two directions. It reads the events from the blockchain, runs the algorithm, and periodically writes back to the blockchain by sending transactions. An account with some balances is used to pay the transaction fee.\n\nYou may already have an account. Or you can create the account on Polkadot.js Extension, or some other wallets. In either way, you will need to keep the mnemonic (sometimes called SURI), or the raw private key, because it will be used in the next step.\n\nIt\u2019s suggested to have at least 10 PHA in the account. The Gatekeepers may consume the transacion fee in different speed. It can burn up to 5-10 PHA per day, but can also have nearly zero transaction per day. Gatekeepers generate messages constantly, but only the first one who submits the message will be charged (other transactions are just de-duped). So theoritically each Gatekeeper has an even chance to pay for the transaction fee.\n\n## Server requirements <a href=\"#server-requirements\" id=\"server-requirements\"></a>\n\n1.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2110, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "2b384deb-bf37-4a8f-a4a2-f0ab8c690e4a": {"__data__": {"id_": "2b384deb-bf37-4a8f-a4a2-f0ab8c690e4a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/gatekeeper.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "156d6ab7-38b0-42f9-bdb0-030ee1fa3afd", "node_type": "4", "metadata": {}, "hash": "605fbd90be7bb76ebad5bf46568bda9db663b43d418c77dbce577180c5ce92bd", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "0e53a53b-1f0b-4ba9-9318-3a72877bc374", "node_type": "1", "metadata": {}, "hash": "40d11caa4a181fe1cea8208ea7500a7e2d423130f377f39cc0292de205010808", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "85d1d450-dbe3-49f9-b56d-8b27639e97eb", "node_type": "1", "metadata": {}, "hash": "20bd2e791fd8ae5affaba90c40f169f3e6e8c4d59d53dc23cb940953522e6673", "class_name": "RelatedNodeInfo"}}, "text": "500G SSD for running the Khala full node in Archive mode\n\n    The large space is majorly for the Kusama full node, which takes more than 300 GiB. If you can run the full node on another server close to the Gatekeeper server, the disk requirement can be safely ignored. In such case, the network latency and bandwidth matters. SSD is always recommended because there will be a lot of random access to the database when syncing a Gatekeeper.\n2.  Good internet connection\n\n    A bandwidth of 50 Mbps or faster is recommended. Otherwise the initial block download will take a very long time. A public IP address is recommended because otherwise you may got too few peer connections, causing the full node got stuck for some period. A stable network is always required. Once Gatekeeper online detection is on, any detected offline event may cause significant slash. (So far it\u2019s still under the development.)\n3.  Intel SGX compatible hardware with a confidence level >= 3\n\n    Gatekeeper runs its pRuntime inside the Secure Encalve (Intel SGX), which is the same requirement of mining on Khala Network. Please refer to the mining guide to learn more about Intel SGX compatability and the confidence score. Gatekeepers manage highly sensitive data. Therefore it requires the highest confidence level (1, 2, or 3).\n\n    Although SGX is a feature in CPU, some configuration in BIOS is still needed. Please refer to the mining guide to tune the BIOS when necessary.\n4.  Linux OS\n\n    So far only Linux is supported. We suggest to deploy the Gatekeeper stack on Ubuntu 21.04. While other versions of Ubuntu or other Linxu distribution could be supported, this document will assume you are running on Ubuntu.\n\n    The Intel SGX driver is required. However, you don\u2019t need to install it manually on Ubuntu 21.04 because it\u2019s shipped with the native kernel SGX driver. The kernel driver doesn\u2019t support all the legacy SGX CPUs though. For legacy CPUs, you may need to run an older Linux kernel without the native driver, and install the iSGX driver instead.\n5. [Docker](https://docs.docker.com/engine/install/ubuntu/#install-using-the-convenience-script)\n\n## **SGX virtualization (vSGX)**\n\nvSGX is supported.", "mimetype": "text/plain", "start_char_idx": 2112, "end_char_idx": 4307, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "85d1d450-dbe3-49f9-b56d-8b27639e97eb": {"__data__": {"id_": "85d1d450-dbe3-49f9-b56d-8b27639e97eb", "embedding": null, "metadata": {"file_path": "phala-docs_dist/gatekeeper.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "156d6ab7-38b0-42f9-bdb0-030ee1fa3afd", "node_type": "4", "metadata": {}, "hash": "605fbd90be7bb76ebad5bf46568bda9db663b43d418c77dbce577180c5ce92bd", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "2b384deb-bf37-4a8f-a4a2-f0ab8c690e4a", "node_type": "1", "metadata": {}, "hash": "f409a1a1711968aaaa6ddf30f31ba65a0327525b41e040b037725c5fbb832a38", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "689718a8-db50-43c3-9ab5-ed48a2024c4e", "node_type": "1", "metadata": {}, "hash": "c6339fcdd0b5e7b1c73b6815501a01a2542b901ecc782e501ce2b0865d90160f", "class_name": "RelatedNodeInfo"}}, "text": "VMWare and KVM based vSGX are being tested successfully. However, the more instances to virtualize, the less EPC size each VM can get. Smaller EPC can cause a decrease of the performance. Please use with caution.\n\n## Deploy the full stack <a href=\"#deploy-the-full-stack\" id=\"deploy-the-full-stack\"></a>\n\nPlease make sure you have meet all the above requirements, so that you can start to deploy the three components by Docker.\n\nFirst, run the full node and wait it to sync. If you already have a full node, this step can be skipped.\n\n```\ndocker run -dti --rm \\\n    --name khala-node \\\n    -e NODE_NAME=khala-node \\\n    -e NODE_ROLE=MINER \\\n    -p 9933:9933 -p 9944:9944 -p 9615:9615 -p 30333:30333 \\\n    -p 9934:9934 -p 9945:9945 -p 9616:9616 -p 30334:30334 \\\n    -v $HOME/data/khala-dev-node:/root/data phalanetwork/khala-node\n```\n\nThe command line above will start the Khala node docker image managed by the Phala team. The node runs in Archive mode (specified by `NODE_ROLE=MINER`). Then two sets of the ports are exported, including the p2p ports (30333, 30334), Prometheus metrics (9615, 9616), ws rpc (9944, 9945), and http rpc ports (9933, 9944). For each pair of the ports, the former one is Khala\u2019s and the later one is Kusama\u2019s. The data directory `/root/data` is mapped to the disk. Feel free to change it to somewhere better.\n\nThe node may take a few days to be fully synced. Recovering from a backup can greatly reduce the time to sync, if you have one.", "mimetype": "text/plain", "start_char_idx": 4308, "end_char_idx": 5775, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "689718a8-db50-43c3-9ab5-ed48a2024c4e": {"__data__": {"id_": "689718a8-db50-43c3-9ab5-ed48a2024c4e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/gatekeeper.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "156d6ab7-38b0-42f9-bdb0-030ee1fa3afd", "node_type": "4", "metadata": {}, "hash": "605fbd90be7bb76ebad5bf46568bda9db663b43d418c77dbce577180c5ce92bd", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "85d1d450-dbe3-49f9-b56d-8b27639e97eb", "node_type": "1", "metadata": {}, "hash": "20bd2e791fd8ae5affaba90c40f169f3e6e8c4d59d53dc23cb940953522e6673", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "17fde8c3-ce16-4c76-a1c8-2b1d88c6a35a", "node_type": "1", "metadata": {}, "hash": "a0aa3aeaba61b4867116799488c0c8bedc0ffa8df34fd43fcfa70448ca92c115", "class_name": "RelatedNodeInfo"}}, "text": "Second, run pRuntime:\n\n```\ndocker run -dti --rm \\\n    --name phala-pruntime \\\n    -p 8000:8000 \\\n    -v $HOME/data/phala-pruntime:/root/data \\\n    -e EXTRA_OPTS=\"-c 0\" \\\n    --device /dev/sgx \\\n    --device /dev/sgx_enclave \\\n    --device /dev/sgx_provision \\\n    --device /dev/sgx_vepc \\\n    phalanetwork/phala-pruntime\n```\n\nThe command brings up a pRuntime instance with its RPC port 8000 exported. Please note that if you run with the iSGX driver (legacy driver), there\u2019s only one SGX device file `/etc/isgx`. Note that pruntime will store its credentials under `/root/data`, which is mapped to the locla disk. The credentials are encrypted with the CPU keys. It\u2019s important to backup the key in order to keep the identity of the worker (pRuntime instance). However, it\u2019s impossible to recover the credentials in another CPU (vCPU).\n\nIn the above command line we assumed you are running with the kernel SGX driver. If you have to run with the manually installed driver on an older kernel, you may consider to switch to differnt device arguments:\n\n* Standalone DCAP driver\n  * `--device /dev/sgx/enclave`\n  * `--device /dev/sgx/provision`\n* Standalone iSGX driver\n  * `--device /dev/isgx`\n\nFinally, run pherry, the relayer to connect the node and pRuntime (specify your own mnenomic).\n\n```\ndocker run -dti --rm \\\n    --name phala-pherry \\\n    -e PRUNTIME_ENDPOINT=\"http://phala-pruntime:8000\" \\\n    -e PHALA_NODE_WS_ENDPOINT=\"ws://khala-node:9945\" \\\n    -e MNEMONIC=\"<Insert-Your-Mnemonic>\" \\\n    -e EXTRA_OPTS=\"-r --parachain --collator-ws-endpoint=ws://khala-node:9944\" \\\n    --link khala-node --link phala-pruntime \\\n    phalanetwork/phala-pherry\n```\n\nThe command starts pherry, linked with `khala-node` and `phala-pruntime` containers.", "mimetype": "text/plain", "start_char_idx": 5777, "end_char_idx": 7518, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "17fde8c3-ce16-4c76-a1c8-2b1d88c6a35a": {"__data__": {"id_": "17fde8c3-ce16-4c76-a1c8-2b1d88c6a35a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/gatekeeper.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "156d6ab7-38b0-42f9-bdb0-030ee1fa3afd", "node_type": "4", "metadata": {}, "hash": "605fbd90be7bb76ebad5bf46568bda9db663b43d418c77dbce577180c5ce92bd", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "689718a8-db50-43c3-9ab5-ed48a2024c4e", "node_type": "1", "metadata": {}, "hash": "c6339fcdd0b5e7b1c73b6815501a01a2542b901ecc782e501ce2b0865d90160f", "class_name": "RelatedNodeInfo"}}, "text": "It reads the blokchain from `khala-node:9944` and sync the data to `phala-pruntime:8000`. If you run the full node remotely, just change the host name `khala-node` to the node rpc endpoint. The mnenomic is specified by the environment variable.\n\npherry usually takes 1-2 days to sync the blockchain history. However, since pRuntime doesn\u2019t persist the state, if it exits, you will need to sync from scratch in the next time.\n\nThe account you specified will be used to send transactions on behalf of the Gatekeeper. Once it\u2019s fully synced, it will initiate a `PhalaRegistry.registerWorker()` extrinsic to the blockchain. A Gatekeeper is identified by its worker public key (worker pubkey). You can find it from `http://phala-pruntime:8000/get_info` RPC, and check the registration status from the blockchain at `PhalaRegistry.workers()`.\n\nSummary:\n\n1. Run the full node in Archive mode and keep it in sync\n2. Run pRuntime with the SGX device set up correctly\n3. Run pherry to connect the full node and pRuntime\n\n## Propose to join the Gatekeeper whitelist <a href=\"#propose-to-join-the-gatekeeper-whitelist\" id=\"propose-to-join-the-gatekeeper-whitelist\"></a>\n\n(WIP)\n\n## Monitor the Gatekeeper <a href=\"#monitor-the-gatekeeper\" id=\"monitor-the-gatekeeper\"></a>\n\n(WIP)", "mimetype": "text/plain", "start_char_idx": 7519, "end_char_idx": 8784, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "22ed22ba-fc0b-4406-a380-a47b25559a22": {"__data__": {"id_": "22ed22ba-fc0b-4406-a380-a47b25559a22", "embedding": null, "metadata": {"file_path": "phala-docs_dist/configure-the-worker.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "4db4e53f-159d-4dff-9a73-6b02c77e59d2", "node_type": "4", "metadata": {}, "hash": "b645732677e20981a5d783e5158f8d2e1fe5830bf6b2a1175f026720324a01d0", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "832bf062-780f-48ae-ab60-581ec83c0719", "node_type": "1", "metadata": {}, "hash": "440e20af547390d36077f7289b1889a9c9167c7f561c1f98d6acbd67758c0ab7", "class_name": "RelatedNodeInfo"}}, "text": "# Configure the Worker\n\n## Get the Worker Ready <a href=\"#get-the-worker-ready\" id=\"get-the-worker-ready\"></a>\n\nThis section shows you how to set up your Phala mining CLI, the respective tools, and setting the last parameters for your drivers.\n\nExecute the following command to get your worker ready to launch for mining.\n\n```\nsudo ~/solo-mining-scripts-main/phala.sh install\n```\n\n> `phala.sh` will update the worker to use your newly installed driver settings and configuration. This is required for first-time workers or whenever you update or change your driver configuration for this change to take effect.\n\n## Mode selection <a href=\"#mode-selection\" id=\"mode-selection\"></a>\n\nDuring the installation process, you will receive a prompt like:\n\n`mode select ( full | prune ) (Default: PRUNE):`\n\nThe default option here is \u201cprune\u201d mode, which means less hard disk space is used to install node data. Just click `Enter` to go to the next step.\n\nIf your hard disk has more than 2T space and you want to install the complete Kusama node data, type `full` and click `Enter` to go to the next step.\n\n## Worker Configuration <a href=\"#worker-configuration\" id=\"worker-configuration\"></a>\n\n> \u26a0\ufe0f DO NOT reuse the same gas fee account across multiple solo workers.\n\n### Set Wallet Address & More <a href=\"#set-wallet-address--more\" id=\"set-wallet-address--more\"></a>\n\nYou will be prompted to set:\n\n* the number of CPU cores to use\n\n<details>\n\n<summary>How to look up your CPU Cores</summary>\n\nIf you do not know your CPUs utilizable cores, you may look them up by executing the following command:\n\n```\nlscpu | grep -E '^Thread|^Core|^Socket|^CPU\\('\n```\n\n</details>\n\n* node name\n* gas fee account mnemonic\n* the pool owner account\n\n> If any entered parameter is invalid, the script will ask to re-enter the information.\n>\n> \u2139 To ensure the proceeding of mining, the balance of the gas fee account should be >2 PHA.\n\n### Check Current Configuration <a href=\"#check-current-configuration\" id=\"check-current-configuration\"></a>\n\n> Note, the following command will show sensitive information (mnemonic seed).", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2096, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "832bf062-780f-48ae-ab60-581ec83c0719": {"__data__": {"id_": "832bf062-780f-48ae-ab60-581ec83c0719", "embedding": null, "metadata": {"file_path": "phala-docs_dist/configure-the-worker.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "4db4e53f-159d-4dff-9a73-6b02c77e59d2", "node_type": "4", "metadata": {}, "hash": "b645732677e20981a5d783e5158f8d2e1fe5830bf6b2a1175f026720324a01d0", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "22ed22ba-fc0b-4406-a380-a47b25559a22", "node_type": "1", "metadata": {}, "hash": "401f4e2340dbef7c090a131518cf97bd30508291f8475a75164dd0e5e7046522", "class_name": "RelatedNodeInfo"}}, "text": "During the daily operation of workers (not in the installation process above), You can get the current parameters in use with\n\n```\nsudo phala config show\n```\n\nAnd use the following command to reset your parameters.\n\n```\nsudo phala config\n```\n\n## Headers update\n\nIf you select the \u201cPrune\u201d mode, and this is the first time that you install the mining tools which means there is no headers data in the worker.\n\nAfter the Configuration, do remember to update headers with\n\n```\nsudo phala update headers\n```\n\nIt may take some time to update headers, after the update, the installation is finished.\n\n## Snapshot update <a href=\"#snapshot-update\" id=\"snapshot-update\"></a>\n\nIf you need to download node data from the beginning, you can download the node snapshot with\n\n```\nsudo phala update snapshot\n```", "mimetype": "text/plain", "start_char_idx": 2098, "end_char_idx": 2894, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8f25fac2-7d5a-4e56-b3f2-d7e59cf35d36": {"__data__": {"id_": "8f25fac2-7d5a-4e56-b3f2-d7e59cf35d36", "embedding": null, "metadata": {"file_path": "phala-docs_dist/how-to-build-with-multi-proof.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6131f5e5-1d7c-4d4e-ae35-1f6da10024d7", "node_type": "4", "metadata": {}, "hash": "277ce100f6397cca05d07dc0d271a04b69d5e5e6db79bfdb773bda74b51389f0", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b771582f-ac20-4972-8b63-c881e595ee11", "node_type": "1", "metadata": {}, "hash": "6d23f8ceb0cde9fcba1b166392352cea6ba7f9aaa33f8cc0e81519aeeabc5a91", "class_name": "RelatedNodeInfo"}}, "text": "# How to Build with Multi-Proof\n\nWe have JS Runtime custom-built based on [QuickJS](https://bellard.org/quickjs/). JavaScript code can be deployed to Phala TEE workers. We have engineered a WASM virtual machine called [Wapo](https://github.com/Phala-Network/wapo) based on [wasmtime](https://wasmtime.dev/), to facilitate its execution in SGX with the Gramine SDK.\n\nBefore we dive into the steps, here is a brief explanation of why you can simply write JavaScript code to generate TEE proof and run it inside a TEE environment:\n\n<figure><img src=\"../../.gitbook/assets/Build-Multi-Proof.png\" alt=\"\"><figcaption></figcaption></figure>\n\nWe provide WASM virtual machine as underlying infrastructure to run WASM smart contract in TEE environment, we integrated [QuickJS](https://bellard.org/quickjs/), which is a small and embeddable JavaScript engine. The QuickJS engine was compiled to a WASM binary and run in WASM virtual machine, when you submit your Javascript code, it will actually run in QuickJS engine, and essentially run it in a TEE environment. We exported bunch of useful data from Rust SDK that you can use in JS SDK by inject those data into customer's Javascript code when it being execute, one of them is the private key derived from Rust smart contract engine which you can use sign data.\n\nNow, let's break down step by step to see how you can generate a TEE-proof with JavaScript:\n\nTo make the whole progress as easy as possible, we have built a CLI called [jtee](https://github.com/tolak/jtee) to help user create and run JavaScript project on Phala TEE workers.\n\n1.  We haven published `jtee` to npm public registry so now you can use it with `npx`, for more details you can head to the source code repo on [Github](https://github.com/tolak/jtee). You can simply create a project by issuing the following command in terminal:\n\n    ```bash\n    $ npx jtee new  <my-jtee-project>\n    ```\n2.  As the diagram show above, each Javascript code is running in a seperate WASM virtual machine instance and Javascript engine deployed by developer.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2054, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b771582f-ac20-4972-8b63-c881e595ee11": {"__data__": {"id_": "b771582f-ac20-4972-8b63-c881e595ee11", "embedding": null, "metadata": {"file_path": "phala-docs_dist/how-to-build-with-multi-proof.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6131f5e5-1d7c-4d4e-ae35-1f6da10024d7", "node_type": "4", "metadata": {}, "hash": "277ce100f6397cca05d07dc0d271a04b69d5e5e6db79bfdb773bda74b51389f0", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "8f25fac2-7d5a-4e56-b3f2-d7e59cf35d36", "node_type": "1", "metadata": {}, "hash": "7019a4d2c8d69676014fbda11374b02f4e9ef4a58ef7b66b82286fb0c758c9f6", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "17244134-8e12-4d19-b435-37207b96afbb", "node_type": "1", "metadata": {}, "hash": "5ecc66b080a7a4bab1383a22d4ed7f98d12b2bbc21e1189b88adc8de9a8188a7", "class_name": "RelatedNodeInfo"}}, "text": "For the next step is to deploy the engine for your project, the purpose to do so is to have a dedicated private key that only be used for this project.\n\n    Before run deploy command, you need to prepare a Phala blockchain account with enough balance and the node endpoint in the .env file like below in your project root directory. You can check your account balance at [Phala blockchain explorer](https://polkadot.js.org/apps/#/accounts).\n\n    ```bash\n    PHALA_ACCOUNT_URI=\"elegant capable test bar uncover comic speed cabin tattoo company cabin layer\"\n    PHALA_RPC=wss://poc6.phala.network/ws\n    ```\n\n    Then, execute the following command to deploy the engine, the corresponding account will be the deployer of the engine contract:\n\n    ```bash\n    $ npx jtee deploy\n    ```\n\n    You finally will get the contract ID if everything went well, contract ID would be used when execute Javascript code in the engine:\n\n    ```\n    \u2705 Contract uploaded & instantiated:  0x9caa44c6686d1c1e17b4885a96faa6d055055930a248531950b0c11217cebf51\n    ```\n\n    If you really want to dig into the details of how the engine manage the key derivation and script running, check the code [here](https://github.com/tolak/jtee/blob/main/engine/lib.rs).\n3.  The last and final step is to run your Javascript code in the engine. Simple type `jtee run` at the root director of your project.\n\n    ```jsx\n    $ npx jtee run\n    ```\n\n    This will 1) First compile your project to a single Javascript file from entry file located at app/index.js to dist/index.js , 2) Then upload the code and execute the it in the Javascript engine you deployed on last step. Note that only the engine deployer have the permission to execute Javascript code using this engine, which can protect your from other malicious code upload by attacker.", "mimetype": "text/plain", "start_char_idx": 2055, "end_char_idx": 3860, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "17244134-8e12-4d19-b435-37207b96afbb": {"__data__": {"id_": "17244134-8e12-4d19-b435-37207b96afbb", "embedding": null, "metadata": {"file_path": "phala-docs_dist/how-to-build-with-multi-proof.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6131f5e5-1d7c-4d4e-ae35-1f6da10024d7", "node_type": "4", "metadata": {}, "hash": "277ce100f6397cca05d07dc0d271a04b69d5e5e6db79bfdb773bda74b51389f0", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b771582f-ac20-4972-8b63-c881e595ee11", "node_type": "1", "metadata": {}, "hash": "6d23f8ceb0cde9fcba1b166392352cea6ba7f9aaa33f8cc0e81519aeeabc5a91", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "6016ff9a-e83c-4797-924e-59d698e7cea6", "node_type": "1", "metadata": {}, "hash": "a0b421036047f3d819b8258bc3446f491307408ccc4d5304564f549e7cab6d06", "class_name": "RelatedNodeInfo"}}, "text": "Now, let\u2019s take a look of the code in `app/index.js` to see what you can do with the `key`\n\n```typescript\nasync function main() {\n    // The account public key in Phala network you used to deploy the engine\n    console.log('executor owner:', jtee.owner);\n\n    // The account derived inside TEE for your project which you can use to\n    // submit transaction to Ethereum\n    console.log('executor account:', jtee.account);\n\n    // ! NEVER print the key to log\n    // The private key of jtee account above, never revealed to outside\n    const key = jtee.key;\n\n    // Now you can create transaction data and sign it with `key`,\n    // Make sure have ETH in the executor account before send tx to blockchain\n    // For example, call method Flipper.flip() of solidity contract `contract/Flipper.sol`\n    /*\n    const abi = [\n        \"function flip() public\",\n    ];\n    const wallet = new ethers.Wallet(key, new ethers.JsonRpcProvider(process.env.ETHEREUM_RPC | '<http://127.0.0.1:8488>'));\n    const flipper = new ethers.Contract('0x...', abi, wallet);\n    await flipper.flip();\n    */\n}\n\nmain().catch(console.error);\n```\n\nThe code is super simple, the only new thing for you probably is the object `jtee` if you have build with `ethers` package before. `jtee` object was injected by the engine which exported several objects that you can use in your script. `jtee.account` is the corresponding account of the `jtee.key`. Which you can use to submit transaction to blockchain (**Before that, don't forget top-up native asset to this account**). `jtee.key` is the private key derived from engine, the security of the key is guranteed by TEE but you should take care of it and **never print it to logs**. The rest commented code is the example to call smart contract located in `contract/Flipper.sol` using [ethers.js](https://docs.ethers.org/).", "mimetype": "text/plain", "start_char_idx": 3862, "end_char_idx": 5701, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6016ff9a-e83c-4797-924e-59d698e7cea6": {"__data__": {"id_": "6016ff9a-e83c-4797-924e-59d698e7cea6", "embedding": null, "metadata": {"file_path": "phala-docs_dist/how-to-build-with-multi-proof.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6131f5e5-1d7c-4d4e-ae35-1f6da10024d7", "node_type": "4", "metadata": {}, "hash": "277ce100f6397cca05d07dc0d271a04b69d5e5e6db79bfdb773bda74b51389f0", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "17244134-8e12-4d19-b435-37207b96afbb", "node_type": "1", "metadata": {}, "hash": "5ecc66b080a7a4bab1383a22d4ed7f98d12b2bbc21e1189b88adc8de9a8188a7", "class_name": "RelatedNodeInfo"}}, "text": "In real use case, your probably need to construct transaction data from your own smart contract, and the `TEE-proof` which we mentioned few times is also not a concrete form, because your code already run in a trusted environment, and `jtee.key` can be used to create the certification to prove the code has run as expected and returned a legitimate result. In the context of verify them on Ethereum, an ECDSA signature is enough.", "mimetype": "text/plain", "start_char_idx": 5702, "end_char_idx": 6132, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7be02fb4-d224-4cdf-b15f-97f91cf1b43d": {"__data__": {"id_": "7be02fb4-d224-4cdf-b15f-97f91cf1b43d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-stateless-backend.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "30affdf8-fbc8-438a-863a-d986b424c71c", "node_type": "4", "metadata": {}, "hash": "0f69325408ca44dfc70a42c1d86e20efe9f32f10e1309e3be0e4e2c6bb0714b8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c9220e96-80ba-4364-805f-09520e844a11", "node_type": "1", "metadata": {}, "hash": "1a8e3862dea01009245ce4067d2060b9e9828f2eb32cd11a6402c46ca6097a49", "class_name": "RelatedNodeInfo"}}, "text": "# Build Stateless Backend\n\n## Why start with a stateless backend <a href=\"#why-start-with-a-stateless-backend\" id=\"why-start-with-a-stateless-backend\"></a>\n\nCompared with traditional smart-contract-based DApps which store all their states on-chain and require transactions for interaction, the desired use cases of Phat Contract happen off-chain with no (or limited) data stored on-chain. For example, instead of implementing an [ERC-20](https://ethereum.org/en/developers/docs/standards/tokens/erc-20/) token with Phat Contract (whose balance has to be stored on-chain), we recommend deploying your ERC-20 contract on Ethereum and using Phat Contract to operate it.\n\nPhat Contract itself focuses on computation instead of storage, so it can be very easy to build a stateless backend with Phat Contract. In fact, you can connect to other storage services with the HTTP requests using Phat Contract. Backends and especially serverless backends are usually stateless and work very well without databases.\n\nImplementing a stateless backend also brings immediate benefits at no developing cost:\n\n* **Easy concurrent processing.** With Phala, it\u2019s easy to deploy your contract to multiple Workers, then all the instances can handle the users' off-chain requests (called [Query](call-your-contract.md)) concurrently if there are no state-consistency limitations;\n* **Go purely off-chain.** If your contract is stateless, it goes totally off-chain and is no longer limited by gas fee and block latency anymore. Many Phat Contract advantages (like HTTP support) are only allowed off-chain.\n\n## What if I really need states / transactions? <a href=\"#what-if-i-really-need-states--transactions\" id=\"what-if-i-really-need-states--transactions\"></a>\n\nPhat Contract still supports the vanilla on-chain states and transaction processing!\n\nWhat\u2019s more, all the contract states are encrypted and stored. But when you use these states, Phat Contract will still become subject to gas fees and low performance just like smart contracts. We explain contract states in the [store-contract-states.md](store-contract-states.md \"mention\").\n\nFor off-chain computation, the recommended way to store your states is to use external storage services. Phat Contract can easily connect to S3-compatible storage services and use them as cheaper and faster off-chain state storage.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2348, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c9220e96-80ba-4364-805f-09520e844a11": {"__data__": {"id_": "c9220e96-80ba-4364-805f-09520e844a11", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-stateless-backend.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "30affdf8-fbc8-438a-863a-d986b424c71c", "node_type": "4", "metadata": {}, "hash": "0f69325408ca44dfc70a42c1d86e20efe9f32f10e1309e3be0e4e2c6bb0714b8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "7be02fb4-d224-4cdf-b15f-97f91cf1b43d", "node_type": "1", "metadata": {}, "hash": "56e43078ec6974d757e8d1853ee57b0e7ad23e5447dd298bcdc8058323ca16e0", "class_name": "RelatedNodeInfo"}}, "text": "Explore how to do this in the following section.\n\n> Always remember your contract may be deployed to multiple Workers and they run concurrently. If multiple instances try to write to the storage services at the same time, there can be [race conditions](https://ketanbhatt.com/db-concurrency-defects/).\n>\n> For now, we do not provide native locking or transaction support for these storage services.", "mimetype": "text/plain", "start_char_idx": 2349, "end_char_idx": 2747, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7fd6da47-793d-43ec-9f96-fed1bf64b4fe": {"__data__": {"id_": "7fd6da47-793d-43ec-9f96-fed1bf64b4fe", "embedding": null, "metadata": {"file_path": "phala-docs_dist/add-a-data-source.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "b97982b0-8202-438f-b247-bdf5d1cb34d9", "node_type": "4", "metadata": {}, "hash": "d7c531919bcfc9eb83a76709644144c488b4aa88ea3ba7cebaad84ce92aa0c6e", "class_name": "RelatedNodeInfo"}}, "text": "# Add a Data Source\n\nCheck out the [Weather Agent example](../examples/create-a-weather-agent-w-function-calling.md) for a tutorial on how building a Data Source Agent for retrieval.\n\n<figure><img src=\"../../.gitbook/assets/WIP.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 274, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e672cf69-a405-4592-a932-fd5f2be558b7": {"__data__": {"id_": "e672cf69-a405-4592-a932-fd5f2be558b7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/how-to-switch-from-solo-mining-to-prb-mining.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e1282358-cb68-401e-8f00-ab6537fd6204", "node_type": "4", "metadata": {}, "hash": "7a0e7d59957d6775b8e7fff49d79c6c9bbf40ba84912540027ec5451e4a3834e", "class_name": "RelatedNodeInfo"}}, "text": "---\ndescription: worker\n---\n\n# How to switch from Solo scripts to PRB worker\n\n## How Solo Worker Works <a href=\"#how-solo-worker-works\" id=\"how-solo-worker-works\"></a>\n\nSolo worker runs 3 Docker containers named Phala-node, Phala-pherry, and Phala-pRuntime.\n\nNode provides blockchain node services; PRuntime provides TEE-runtime services; And Pherry acts as a bridge between TEE and blockchain nodes. The only component that really provides decentralized computing services to the network is pRuntime\n\n## How PRB Works <a href=\"#how-prb-works\" id=\"how-prb-works\"></a>\n\nPRB is \u201cPhala Runtime Bridge\u201d which replaces pherry to make a bridge between the blockchain and pRuntime to convey information in batches.\n\n## How to switch from Solo mining to PRB mining <a href=\"#how-to-switch-from-solo-mining-to-prb-mining\" id=\"how-to-switch-from-solo-mining-to-prb-mining\"></a>\n\n* Turn off Pherry service on solo workers\n* Shut down the Node service on solo workers\n* Let pRuntime run alone and add pruntime\u2019s endpoint to PRB\n\n## Operation steps <a href=\"#operation-steps\" id=\"operation-steps\"></a>\n\n* Step1 `sudo phala stop`\n* Step 2 `sudo mkdir ~/prb`\n* Step 3 Copy the docker-compse.yml and .env files in the Solo mining folder to \\~/prb\n* Step 4 `sudo vim docker-compose.yml` Edit the docker-compose file and delete the descriptions of the node and pherry services\n* Step 5 `sudo docker-compose up -d` start pruntime alone\n* Step 6 Add the endpoint of this pruntime on the Worker page of Prb (the format is: http://xxx.xxx.xxx.xxx:8000)\n* Step 7 Restart the lifecycle component of prb\n\n## How to set up a PRB worker <a href=\"#how-to-set-up-a-prb-worker\" id=\"how-to-set-up-a-prb-worker\"></a>\n\nJust learn from this page: PRB setup", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1722, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "05f73831-d55b-4c8b-bc2b-13d6da9ddfa9": {"__data__": {"id_": "05f73831-d55b-4c8b-bc2b-13d6da9ddfa9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-first-ai-agent-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7098720b-ca69-490b-8851-0355d00e896c", "node_type": "4", "metadata": {}, "hash": "df9768aa563fe3c45bf3dc7c6955afcec8359b43e2e3d226c4d3bc2e9236bf15", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "15a16b5f-4b40-48cc-9900-0250b88c2511", "node_type": "1", "metadata": {}, "hash": "de8e6e86d4b8e5f4e85cdfb71e9660fc52a660ab28f2d779724bba62d48799bf", "class_name": "RelatedNodeInfo"}}, "text": "# Build Your First AI Agent Contract\n\nIf you like video tutorials, here is one of our latest workshops on building your first AI Agent Contract. In this tutorial, you will learn:\n\n* How to get an OpenAI API Key at https://red-pill.ai&#x20;\n* Clone the AI Agent Contract template repo\n* Build and test your Agent Script\n* Launch and interact with your Agent Script through the Phala Agent Gateway\n\n{% embed url=\"https://youtu.be/XX7NCKi7Y2I?si=GRORzY9acBDcy6UY\" %}\n\n<figure><img src=\"../../.gitbook/assets/AI-Agent-Contract-Execution.png\" alt=\"\"><figcaption><p>Agent Script executes in TEE Agent VM on Phala Network</p></figcaption></figure>\n\nThe RedPill AI Agent template is a **MINIMAL** template to build an AI Agent that can be hosted on Phala Network's decentralized hosting protocol. Unlike Vercel or other FaaS, it allows you to publish your AI Agent compiled code to IPFS and hosts it on a fully decentralized FaaS cloud with the following benefits:\n\n* \ud83d\udca8 **Ship Fast**: Build and ship with familiar toolchain in minutes\n* &#x20;\u26d1\ufe0f **Secure**: Execution guarded by rock solid TEE\n* &#x20;\ud83d\udd12 **Private**: Host API keys and user privacy at ease\n* \ud83d\udc8e **Unstoppable**: Powered by IPFS and Phala's 40k+ decentralized TEE workers\n* :fire: [@**hono/tiny**](https://hono.dev/docs/api/presets#hono-tiny) **Support**: a small, simple, and ultrafast web framework built on Web Standards.\n* \ud83e\uddea [**Vite Test Framework**](https://vitest.dev/guide/): Vite Testing Framework support, but you're free to change the test framework to your desire.\n\n{% hint style=\"info\" %}\nWe recommend using [@hono/tiny](https://hono.dev/docs/api/presets#hono-tiny) to avoid a large bundle size and the 20MB final artifact limitation.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1702, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "15a16b5f-4b40-48cc-9900-0250b88c2511": {"__data__": {"id_": "15a16b5f-4b40-48cc-9900-0250b88c2511", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-first-ai-agent-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7098720b-ca69-490b-8851-0355d00e896c", "node_type": "4", "metadata": {}, "hash": "df9768aa563fe3c45bf3dc7c6955afcec8359b43e2e3d226c4d3bc2e9236bf15", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "05f73831-d55b-4c8b-bc2b-13d6da9ddfa9", "node_type": "1", "metadata": {}, "hash": "c748fb3d5e51b3e625d9c53e49d87b110453f7df1456adb6510bedf189d1f532", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "330ac0d4-f745-468c-8655-aee537e237d1", "node_type": "1", "metadata": {}, "hash": "34ae119f4aab976c5893805a991c409c434c569a984af1c90b363e04b91512d9", "class_name": "RelatedNodeInfo"}}, "text": "{% endhint %}\n\nThis guide will focus on the following topics:\n\n* **Build** and **Deploy** Your AI Agent Contract\n  * Build and deploy your **Agent Contract** that is deployed to IPFS and served through the Phala Agent Gateway executed on Phala Network\n* **Use**/**Interact** with Your AI Agent Contract\n  * The Agent Gateway will fetch the Agent Contract code/prompt located on IPFS.\n  * Interact with your agent hosted through Phala's Agent Gateway (https://wapo-testnet.phala.network/ipfs/\\<CID>).\n\n## Getting Started\n\n### Prepare\n\nClone git repo or use [degit](https://www.npmjs.com/package/degit) to get the source code.\n\n{% tabs %}\n{% tab title=\"git\" %}\n```sh\ngit clone https://github.com/Phala-Network/ai-agent-template-redpill.git\n```\n{% endtab %}\n\n{% tab title=\"degit\" %}\n```bash\nnpx degit github:Phala-Network/ai-agent-template-redpill#main ai-agent-template-redpill\n```\n{% endtab %}\n{% endtabs %}\n\nInstall dependencies\n\n```shell\nnpm install\n```\n\n### Testing Locally\n\nCreate `.env` file with the default ThirdWeb API key for publishing your Agent Contract to IPFS\n\n```sh\ncp .env.example .env\n```\n\nGet an API Key from Redpill\n\n> **Note**\n>\n> There is a default RedPill API Key provided in the .env.example file. This API key is rate limited and if you run into an error that displays `Insufficient funds`, reach out to the Phala Team on [discord](https://discord.gg/phala-network).", "mimetype": "text/plain", "start_char_idx": 1703, "end_char_idx": 3092, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "330ac0d4-f745-468c-8655-aee537e237d1": {"__data__": {"id_": "330ac0d4-f745-468c-8655-aee537e237d1", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-first-ai-agent-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7098720b-ca69-490b-8851-0355d00e896c", "node_type": "4", "metadata": {}, "hash": "df9768aa563fe3c45bf3dc7c6955afcec8359b43e2e3d226c4d3bc2e9236bf15", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "15a16b5f-4b40-48cc-9900-0250b88c2511", "node_type": "1", "metadata": {}, "hash": "de8e6e86d4b8e5f4e85cdfb71e9660fc52a660ab28f2d779724bba62d48799bf", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "de02a404-d2c2-4ee4-8bd7-6639ea804a0b", "node_type": "1", "metadata": {}, "hash": "c5b83d18c91803bd0e75a6b7b1b23419dae168cc595eb29d97a0e707e41bea0c", "class_name": "RelatedNodeInfo"}}, "text": ">\n> * Go to [https://red-pill.ai/dashboard](https://red-pill.ai/dashboard) and claim your API Key by swapping some ETH for wGPT at [https://app.uniswap.org/explore/tokens/base/0x74F62Bc1961028C22b8080961c6534f4eDD49D6C](https://app.uniswap.org/explore/tokens/base/0x74F62Bc1961028C22b8080961c6534f4eDD49D6C)\n> * Video Tutorial: [https://youtu.be/ZoJwbLNhbWE](https://youtu.be/ZoJwbLNhbWE)\n\nIn [default.json](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/secrets/default.json) file replace `YOUR_API_KEY` with your API Key. The default has a rate limit. If you want access to a RedPill code, reach out to the Phala Team.\n\n```json\n{\n  \"apiKey\": \"YOUR_REDPILL_API_KEY\"\n}\n```\n\nBuild your Agent\n\n```sh\nnpm run build\n```\n\nTest your Agent locally\n\n```sh\nnpm run test\n```\n\nExpected Test Results\n\n```sh\nNow you are ready to publish your agent, add secrets, and interact with your agent in the following steps:\n- Execute: 'npm run publish-agent'\n- Set secrets: 'npm run set-secrets'\n- Go to the url produced by setting the secrets (e.g.", "mimetype": "text/plain", "start_char_idx": 3093, "end_char_idx": 4142, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "de02a404-d2c2-4ee4-8bd7-6639ea804a0b": {"__data__": {"id_": "de02a404-d2c2-4ee4-8bd7-6639ea804a0b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-first-ai-agent-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7098720b-ca69-490b-8851-0355d00e896c", "node_type": "4", "metadata": {}, "hash": "df9768aa563fe3c45bf3dc7c6955afcec8359b43e2e3d226c4d3bc2e9236bf15", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "330ac0d4-f745-468c-8655-aee537e237d1", "node_type": "1", "metadata": {}, "hash": "34ae119f4aab976c5893805a991c409c434c569a984af1c90b363e04b91512d9", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "85d67446-05ad-4796-ab6b-c20e26d2dc21", "node_type": "1", "metadata": {}, "hash": "a265709e162019c98d8909764d0725e6c2cfdd53530d8ba05fb13a18ae04211a", "class_name": "RelatedNodeInfo"}}, "text": "https://wapo-testnet.phala.network/ipfs/QmPQJD5zv3cYDRM25uGAVjLvXGNyQf9Vonz7rqkQB52Jae?key=b092532592cbd0cf)\n\n \u2713 tests/index.test.ts (2) 6157ms\n   \u2713 Test RedPill AI Agent Contract (2) 6156ms\n     \u2713 GET Test: Pass chatQuery through URL Query 2722ms\n     \u2713 POST Test: Pass chatQuery and model through body of POST request 3434ms\n\n Test Files  1 passed (1)\n      Tests  2 passed (2)\n   Start at  16:30:03\n   Duration  6.36s (transform 23ms, setup 6ms, collect 31ms, tests 6.16s, environment 0ms, prepare 39ms)\n```\n\nUpload your compiled AI Agent code to IPFS.\n\n```sh\nnpm run publish-agent\n```\n\nUpon a successful upload, the command should show the URL to access your AI Agent.\n\n```sh\n- Uploading file to IPFS. This may take a while depending on file sizes.\n\n\u2714 Successfully uploaded file to IPFS.\n\u2714 Files stored at the following IPFS URI: ipfs://QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc\n\u2714 Open this link to view your upload: https://b805a9b72767504353244e0422c2b5f9.ipfscdn.io/ipfs/bafybeifukvkuyztltpq2gi55nswzvwkpgrwrogwykm4ymoqeymh2pxoukm/\n\nAgent Contract deployed at: https://wapo-testnet.phala.network/ipfs/QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc\n\nIf your agent requires secrets, ensure to do the following:\n1) Edit the ./secrets/default.json file or create a new JSON file in the ./secrets folder and add your secrets to it.", "mimetype": "text/plain", "start_char_idx": 4143, "end_char_idx": 5481, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "85d67446-05ad-4796-ab6b-c20e26d2dc21": {"__data__": {"id_": "85d67446-05ad-4796-ab6b-c20e26d2dc21", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-first-ai-agent-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7098720b-ca69-490b-8851-0355d00e896c", "node_type": "4", "metadata": {}, "hash": "df9768aa563fe3c45bf3dc7c6955afcec8359b43e2e3d226c4d3bc2e9236bf15", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "de02a404-d2c2-4ee4-8bd7-6639ea804a0b", "node_type": "1", "metadata": {}, "hash": "c5b83d18c91803bd0e75a6b7b1b23419dae168cc595eb29d97a0e707e41bea0c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "de90e004-ff2f-418b-9671-8da5c6df48cb", "node_type": "1", "metadata": {}, "hash": "9b46085dc82bfa7089471e0e4485cdcd0f8cc2b9e26536c1ba79785720ba72e8", "class_name": "RelatedNodeInfo"}}, "text": "2) Run command: 'npm run set-secrets' or 'npm run set-secrets [path-to-json-file]'\nLogs folder created.\nDeployment information updated in ./logs/latestDeployment.json\n```\n\n{% hint style=\"info\" %}\n\n\n**Note** that your latest deployment information will be logged to in file [`./logs/latestDeployment.json`](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/logs/latestDeployment.json). This file is updated every time you publish a new Agent Contract to IPFS. This file is also used to get the IPFS CID of your Agent Contract when setting secrets for your Agent Contract.\n\nHere is an example:\n\n```\n{\n  \"date\": \"2024-08-29T18:47:55.108Z\",\n  \"cid\": \"QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc\",\n  \"url\": \"https://wapo-testnet.phala.network/ipfs/QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc\"\n}\n```\n{% endhint %}\n\n{% hint style=\"warning\" %}\n\n\n**Did Thirdweb fail to publish?**\n\nIf ThirdWeb fails to publish, please signup for your own ThirdWeb account to publish your Agent Contract to IPFS. Signup or login at [https://thirdweb.com/dashboard/](https://thirdweb.com/dashboard/)\n\nWhenever you log into ThirdWeb, create a new API key and replace the default API Key with yours in the [.env](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/.env) file.\n\n```\nTHIRDWEB_API_KEY=\"YOUR_THIRDWEB_API_KEY\"\n```\n{% endhint %}\n\n### Accessing The Published Agent\n\nOnce published, your AI Agent is available at the URL: `https://wapo-testnet.phala.network/ipfs/<your-cid>`. You can get it from the \"Publish to IPFS\" step.\n\nYou can test it with `curl`.", "mimetype": "text/plain", "start_char_idx": 5482, "end_char_idx": 7058, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "de90e004-ff2f-418b-9671-8da5c6df48cb": {"__data__": {"id_": "de90e004-ff2f-418b-9671-8da5c6df48cb", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-first-ai-agent-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7098720b-ca69-490b-8851-0355d00e896c", "node_type": "4", "metadata": {}, "hash": "df9768aa563fe3c45bf3dc7c6955afcec8359b43e2e3d226c4d3bc2e9236bf15", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "85d67446-05ad-4796-ab6b-c20e26d2dc21", "node_type": "1", "metadata": {}, "hash": "a265709e162019c98d8909764d0725e6c2cfdd53530d8ba05fb13a18ae04211a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "dc77b532-cc15-4e53-8df9-ea77bf7756a5", "node_type": "1", "metadata": {}, "hash": "faf558c7301ab0877b816d5a2d1dc79d74dd5ada24a9cdb82fc76ee84e900212", "class_name": "RelatedNodeInfo"}}, "text": "```sh\ncurl https://wapo-testnet.phala.network/ipfs/<your-cid>\n```\n\n### Adding Secrets\n\nBy default, all the compiled JS code is visible for anyone to view if they look at IPFS CID. This makes private info like API keys, signer keys, etc. vulnerable to be stolen. To protect devs from leaking keys, we have added a field called `secret` in the `Request` object. It allows you to store secrets in a vault for your AI Agent to access.\n\nTo add your secrets,\n\n1. Edit the [default.json](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/secrets/default.json) file or create a new JSON file in the `./secrets` folder and add your secrets to it.\n\n```sh\n{\n  \"apiKey\": \"YOUR_REDPILL_API_KEY\"\n}\n```\n\n2. Run command to set the secrets\n\n```sh\nnpm run set-secrets\n# or if you have a custom JSON file\nnpm run set-secrets <path-to-json-file>\n```\n\nExpected output:\n\n```sh\nUse default secrets...\nStoring secrets...\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   199    0    68  100   131    121    234 --:--:-- --:--:-- --:--:--   356\n{\"token\":\"5d9faaed6be5414a\",\"key\":\"a3a8a4ef2c057d5c\",\"succeed\":true}\n\nSecrets set successfully. Go to the URL below to interact with your agent:\nhttps://wapo-testnet.phala.network/ipfs/QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc?key=a3a8a4ef2c057d5c\nLog entry added to secrets.log\n```\n\n{% hint style=\"info\" %}\n**Note** that all your secrets will be logged in file [`./logs/secrets.log`](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/logs/secrets.log).", "mimetype": "text/plain", "start_char_idx": 7060, "end_char_idx": 8690, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "dc77b532-cc15-4e53-8df9-ea77bf7756a5": {"__data__": {"id_": "dc77b532-cc15-4e53-8df9-ea77bf7756a5", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-first-ai-agent-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7098720b-ca69-490b-8851-0355d00e896c", "node_type": "4", "metadata": {}, "hash": "df9768aa563fe3c45bf3dc7c6955afcec8359b43e2e3d226c4d3bc2e9236bf15", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "de90e004-ff2f-418b-9671-8da5c6df48cb", "node_type": "1", "metadata": {}, "hash": "9b46085dc82bfa7089471e0e4485cdcd0f8cc2b9e26536c1ba79785720ba72e8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f7561e66-02ca-4da4-a6c0-f384f9b6e0ea", "node_type": "1", "metadata": {}, "hash": "376dd18996d52013c5b8b8b28542618919ff80c76e2b9da5e559a565bba632c0", "class_name": "RelatedNodeInfo"}}, "text": "This file is updated every time you add new secrets to your Agent Contract. If you have not published an Agent Contract, yet, this command will fail since there is not a CID to map the secrets to.\n\nHere is an example:\n\n```sh\n2024-08-29T18:54:16.643Z, CID: [QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc], Token: [5d9faaed6be5414a], Key: [a3a8a4ef2c057d5c], URL: [https://wapo-testnet.phala.network/ipfs/QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc?key=a3a8a4ef2c057d5c]\n```\n{% endhint %}\n\nThe API returns a `token` and a `key`. The `key` is the id of your secret. It can be used to specify which secret you are going to pass to your frame. The `token` can be used by the developer to access the raw secret. You should never leak the `token`.\n\nTo verify the secret, run the following command where `key` and `token` are replaced with the values from adding your `secret` to the vault.\n\n```sh\ncurl https://wapo-testnet.phala.network/vaults/<key>/<token>\n```\n\nExpected output:\n\n```sh\n{\"data\":{\"apiKey\":\"<REDPILL_API_KEY>\"},\"succeed\":true}\n```\n\n#### Accessing Your Secrets in Your Code\n\n```typescript\nlet vault: Record<string, string> = {}\ntry {\n  vault = JSON.parse(process.env.secret || '')\n} catch (e) {\n  console.error(e)\n  return c.json({ error: \"Failed to parse secrets\" })\n}\nconst apiKey = (vault.apiKey) ? vault.apiKey as string : 'SALTY_BAE'\n```\n\n### Handling Requests\n\nCheck the [`Hono` docs](https://hono.dev/docs) for information on accessing URL `queries` or `body` from a `post` request.", "mimetype": "text/plain", "start_char_idx": 8691, "end_char_idx": 10191, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f7561e66-02ca-4da4-a6c0-f384f9b6e0ea": {"__data__": {"id_": "f7561e66-02ca-4da4-a6c0-f384f9b6e0ea", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-first-ai-agent-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7098720b-ca69-490b-8851-0355d00e896c", "node_type": "4", "metadata": {}, "hash": "df9768aa563fe3c45bf3dc7c6955afcec8359b43e2e3d226c4d3bc2e9236bf15", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "dc77b532-cc15-4e53-8df9-ea77bf7756a5", "node_type": "1", "metadata": {}, "hash": "faf558c7301ab0877b816d5a2d1dc79d74dd5ada24a9cdb82fc76ee84e900212", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "3b6545cb-5382-44be-9ca7-79f7e8891c00", "node_type": "1", "metadata": {}, "hash": "63a02dad60a8552625d205da7f8cd0a30408caa8a67122d2db20e397b1cf7bd2", "class_name": "RelatedNodeInfo"}}, "text": "{% hint style=\"info\" %}\nWe recommend using @hono/tiny to avoid a large bundle size and the 20MB final artifact limitation.\n{% endhint %}\n\n**Example**\n\n```typescript\n// Access query value for a URL query named `type`\nlet queries = c.req.queries() || {}\nconst getType = (queries.type) ? queries.type[0] as string : ''\n// Access body from post request\nconst data = await c.req.json()\n```\n\n### Debugging Your Agent\n\nTo debug your agent, you can use the following command:\n\n```\ncurl https://wapo-testnet.phala.network/logs/all/ipfs/<CID>\n```\n\nAfter executing this command then you should see some output in the terminal to show the logs of requests to your agent.\n\n```\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [REPORT] END Request: Duration: 166ms\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [INFO] 'Is signature valid? ' true\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [INFO] 'Verifying Signature with PublicKey ' '0xC1BF8dB4D06416c43Aca3deB289CF7CC0aAFF540'\n2024-09-04T03:18:34.", "mimetype": "text/plain", "start_char_idx": 10193, "end_char_idx": 11232, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "3b6545cb-5382-44be-9ca7-79f7e8891c00": {"__data__": {"id_": "3b6545cb-5382-44be-9ca7-79f7e8891c00", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-first-ai-agent-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7098720b-ca69-490b-8851-0355d00e896c", "node_type": "4", "metadata": {}, "hash": "df9768aa563fe3c45bf3dc7c6955afcec8359b43e2e3d226c4d3bc2e9236bf15", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f7561e66-02ca-4da4-a6c0-f384f9b6e0ea", "node_type": "1", "metadata": {}, "hash": "376dd18996d52013c5b8b8b28542618919ff80c76e2b9da5e559a565bba632c0", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "e5b91e2c-a46d-46b7-b0b4-cc25da7fb7f4", "node_type": "1", "metadata": {}, "hash": "9629fd0b6d24b2b2c7f655a205315bff15ba8067078a66ecf2dba35795739c31", "class_name": "RelatedNodeInfo"}}, "text": "758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd&type=verify&data=tintinland%20message%20to%20sign&signature=0x34c4d8c83406e7a292ecc940d60b34c9b11024db10a8872c753b9711cd6dbc8f746da8be9bc2ae0898ebf8f49f48c2ff4ba2a851143c3e4b371647eed32f707b1b\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [REPORT] END Request: Duration: 183ms\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [INFO] 'Signature: 0x34c4d8c83406e7a292ecc940d60b34c9b11024db10a8872c753b9711cd6dbc8f746da8be9bc2ae0898ebf8f49f48c2ff4ba2a851143c3e4b371647eed32f707b1b'\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [INFO] 'Signing data [tintinland message to sign] with Account [0xC1BF8dB4D06416c43Aca3deB289CF7CC0aAFF540]'\n2024-09-04T03:17:15.", "mimetype": "text/plain", "start_char_idx": 11232, "end_char_idx": 12083, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e5b91e2c-a46d-46b7-b0b4-cc25da7fb7f4": {"__data__": {"id_": "e5b91e2c-a46d-46b7-b0b4-cc25da7fb7f4", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-first-ai-agent-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7098720b-ca69-490b-8851-0355d00e896c", "node_type": "4", "metadata": {}, "hash": "df9768aa563fe3c45bf3dc7c6955afcec8359b43e2e3d226c4d3bc2e9236bf15", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "3b6545cb-5382-44be-9ca7-79f7e8891c00", "node_type": "1", "metadata": {}, "hash": "63a02dad60a8552625d205da7f8cd0a30408caa8a67122d2db20e397b1cf7bd2", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "625c9d0d-5cb8-445d-82c8-aceef61b9aac", "node_type": "1", "metadata": {}, "hash": "edef84c2ff8f73fa068290af1cf4fab772d4ef372907e2d9c7dcc2a126da54ca", "class_name": "RelatedNodeInfo"}}, "text": "238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd&type=sign&data=tintinland%20message%20to%20sign\n2024-09-04T03:16:38.507Z [3717d307-bff0-4fc0-bc98-8f66c33dd46f] [REPORT] END Request: Duration: 169ms\n2024-09-04T03:16:38.507Z [3717d307-bff0-4fc0-bc98-8f66c33dd46f] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd\n2024-09-04T03:15:00.375Z [793f58f9-f24f-4580-8ebc-04debb7d727f] [REPORT] END Request: Duration: 158ms\n2024-09-04T03:15:00.375Z [793f58f9-f24f-4580-8ebc-04debb7d727f] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64\na1e805bfd\n```\n\nTo create logs in your Agent Contract, you can use the following syntax in your `index.ts` file.\n\n```\n// info logs\nconsole.log('info log message!')\n// error logs\nconsole.error('error log message!')\n```\n\nFor more information check the [MDN docs](https://developer.mozilla.org/en-US/docs/Web/API/console) on `console` object.", "mimetype": "text/plain", "start_char_idx": 12083, "end_char_idx": 13142, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "625c9d0d-5cb8-445d-82c8-aceef61b9aac": {"__data__": {"id_": "625c9d0d-5cb8-445d-82c8-aceef61b9aac", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-first-ai-agent-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7098720b-ca69-490b-8851-0355d00e896c", "node_type": "4", "metadata": {}, "hash": "df9768aa563fe3c45bf3dc7c6955afcec8359b43e2e3d226c4d3bc2e9236bf15", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e5b91e2c-a46d-46b7-b0b4-cc25da7fb7f4", "node_type": "1", "metadata": {}, "hash": "9629fd0b6d24b2b2c7f655a205315bff15ba8067078a66ecf2dba35795739c31", "class_name": "RelatedNodeInfo"}}, "text": "### Run a Local Testnet With Docker\n\nRun a local testnet with [`docker` support](https://docs.docker.com/desktop/). All you need to do to get a local testnet started is run:\n\n{% hint style=\"danger\" %}\nRunning the local testnet may return an error if port **`8000`** is already in use.\n{% endhint %}\n\n```shell\nnpm run dev\n```\n\n**Make a Request to Your Local Build**\n\n```shell\n# GET request\ncurl http://127.0.0.1:8000/local\n# GET request with URL queries\ncurl http://127.0.0.1:8000/local?query1=one&query2=two\n# POST request\ncurl http://127.0.0.1:8000/local -X POST -H 'content-type: application/json' -d '{\"foo\": \"bar\"}'\n```\n\n**Add Secrets to Your Local Build**\n\n```shell\ncurl http://127.0.0.1:8000/vaults -H 'Content-Type: application/json' -d '{\"cid\": \"local\", \"data\": {\"secretKey\":\"secretValue\"}}'\n```\n\n**Check The Logs of Your Local Build**\n\n```shell\ncurl 'http://127.0.0.1:8000/logs/all/local'\n```\n\nCongratulations! You have deployed and interacted with your first AI Agent Contract on Phala Network! Now let's move to a more Web3-centric agent to execute transactions onchain by importing  the [Viem SDK](https://viem.sh) into the AI Agent Contract.", "mimetype": "text/plain", "start_char_idx": 13144, "end_char_idx": 14298, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7149b8a3-c58f-4e06-9950-68c7d453ee40": {"__data__": {"id_": "7149b8a3-c58f-4e06-9950-68c7d453ee40", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "d8d88919-ef78-43ce-a359-86defc92ac7d", "node_type": "1", "metadata": {}, "hash": "567a655feda44ced81b90853d7065c035596e0f1bca3f60f149e38507ac79c0c", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83c\udfab Connect The Graph Phat Contract to EVM Consumer Contract\n\nIn the previous section we described how The Graph Starter Kit works. Let's revisit the diagram and description below.\n\n## Overview\n\n<figure><img src=\"../../../../.gitbook/assets/TheGraphFlow.jpg\" alt=\"\"><figcaption></figcaption></figure>\n\nThe diagram above displays the user journey of (1) Alice requesting a trust score for Eve from the EVM Consumer Contract. When (2) a new action request is added to the queue, (3) the Phala Network Phat Contract will pop the action off the queue and perform the off-chain work to compute a trust score.\n\nFirst (4) the Phat Contract will create a `batchHttpRequest` to query 3 separate subgraph endpoints to determine if Eve has any ERC-721 NFTs, a NounsDAO NFT,  an ENS Domain, and if any accounts delegate votes to Eve on Snapshot. Once this data is returned then (5) the Phat Contract will compute a score based on some scoring criteria. You can view the code [here](https://bit.ly/pc-the-graph-repo). Lastly, (6) the trust score for Eve has been returned to the EVM Consumer Contract and Eve's score is set in the Consumer Contract's storage for anyone to query.\n\n## Getting Started\n\nIf you have not setup The Graph code repo locally, go back to the [Quick Start](quick-start.md) section and follow the initial setup steps.\n\n### Before Deployment\n\nBefore deploying, you will need to either export your Phala Account via polkadot.js extension or store your private key in the .env (optionally you can manually enter during deployment as well).\n\n**Option 1: Export Polkadot account as json file**\n\nGo to your browser and click on the polkadot.js extension. Select your account and click \"Export Account\". Next, you will be prompted for your password before saving the file to your project directory. **Note** this is what will be set to `POLKADOT_WALLET_ACCOUNT_PASSPHRASE`. Make sure to save the file as `polkadot-account.json` in the **root** of your project directory.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1973, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d8d88919-ef78-43ce-a359-86defc92ac7d": {"__data__": {"id_": "d8d88919-ef78-43ce-a359-86defc92ac7d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "7149b8a3-c58f-4e06-9950-68c7d453ee40", "node_type": "1", "metadata": {}, "hash": "71798069ae21fbe10b631121f53b5ff336c5867d15efbc266086905c43cb84c8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "046ef454-364c-47d1-8167-1b2a0e4d86a3", "node_type": "1", "metadata": {}, "hash": "1f195c278900781ac0c1ede71507c9f8c00de4784738a88f5701d36e0b4c6f83", "class_name": "RelatedNodeInfo"}}, "text": "<figure><img src=\"../../../../.gitbook/assets/image (5) (1).png\" alt=\"\"><figcaption></figcaption></figure>\n\n<figure><img src=\"../../../../.gitbook/assets/image (3) (1).png\" alt=\"\"><figcaption></figcaption></figure>\n\n<figure><img src=\"../../../../.gitbook/assets/image (4) (1).png\" alt=\"\"><figcaption></figcaption></figure>\n\n**Option 2: Set mnemonic phrase to `POLKADOT_WALLET_SURI`**\n\nAfter creating your Phala Profile, set your `.env` variable `POLKADOT_WALLET_SURI` to the mnemonic phrase from generating the new Polkadot Account.\n\nHere is a screenshot of how to set `POLKADOT_WALLET_SURI`:\n\n<figure><img src=\"../../../../.gitbook/assets/image (8).png\" alt=\"\"><figcaption></figcaption></figure>\n\n## Deployments (Local, Testnet, Mainnet)\n\nThis guide will be separated into 3 tabs including:\n\n* **Local**: Local Testnet Deployment\n* **Testnet**: PoC6 Testnet & EVM Chain Testnet Deployment\n* **Mainnet**: Phala Mainnet & EVM Chain Mainnet Deployment\n\n> **Secrets (**[**What are Secrets**](../featured-blueprints/handling-secrets.md)**?", "mimetype": "text/plain", "start_char_idx": 1975, "end_char_idx": 3010, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "046ef454-364c-47d1-8167-1b2a0e4d86a3": {"__data__": {"id_": "046ef454-364c-47d1-8167-1b2a0e4d86a3", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d8d88919-ef78-43ce-a359-86defc92ac7d", "node_type": "1", "metadata": {}, "hash": "567a655feda44ced81b90853d7065c035596e0f1bca3f60f149e38507ac79c0c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b9ef0e73-16c3-48d7-852b-c32548d086c9", "node_type": "1", "metadata": {}, "hash": "aa5ef7e3323657078c8090f1c966ff294fba873538a415f054fe31e6a566082d", "class_name": "RelatedNodeInfo"}}, "text": "):**\n>\n> * `apiUrl` - The endpoint base URL to the separate subgraph endpoints hosted on The Graph\n> * `apiKey` - an API key created on The Graph\n>\n> ```\n> {\n>     \"apiUrl\": \"https://gateway.thegraph.com/api/\",\n>     \"apiKey\": \"cd22a01e5b7f9828cddcb52caf03ee79\"\n> }\n> ```\n\n{% tabs %}\n{% tab title=\"Local\" %}\nIn the previous [Quick Start](quick-start.md) section, we installed the dependencies and ran 2 separate tests locally, but these tests were not run against a live local testnet.&#x20;\n\nThis section will describe the process of:\n\n* Start up a local hardhat node\n* Deploy the EVM Consumer Contract to the local testnet\n* Run the `@phala/fn watch` command to run a local instance of The Graph Phat Contract\n* Simulate a sample request by executing `npm run localhost-push-request`\n* See the The Graph Phat Contract reply with a result to the EVM Consumer Contract\n\n### Testing Locally\n\nFirst step is to install the package dependencies with the following command:\n\n```bash\nnpm install\n```\n\nWith all the dependencies installed, we are ready to build The Graph Phat Contract.\n\n```bash\nnpx @phala/fn build\n```\n\nTo simulate the expected result locally, run the Phat Contract script now with this command:\n\n> Use `decode` and `encode` playground at [https://playground.ethers.org](https://playground.ethers.org).\n\n```bash\nnpx @phala/fn run dist/index.js -a 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000de1683287529b9b4c3132af8aad210644b259cfd '{\"apiUrl\": \"https://gateway.thegraph.com/api/\", \"apiKey\": \"cd22a01e5b7f9828cddcb52caf03ee79\"}'\n```\n\nHere is the expected output of this call where the encoded call will request a trust score result for the address `hashwarlock.eth`. The result is `16`.\n\n```bash\nnpx @phala/fn run dist/index.", "mimetype": "text/plain", "start_char_idx": 3010, "end_char_idx": 4790, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b9ef0e73-16c3-48d7-852b-c32548d086c9": {"__data__": {"id_": "b9ef0e73-16c3-48d7-852b-c32548d086c9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "046ef454-364c-47d1-8167-1b2a0e4d86a3", "node_type": "1", "metadata": {}, "hash": "1f195c278900781ac0c1ede71507c9f8c00de4784738a88f5701d36e0b4c6f83", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "1322fa93-421f-4a1e-bd69-8cdc92766708", "node_type": "1", "metadata": {}, "hash": "b88acfe36de71f809a73d4d0ec0a9272fded303c4b26ff7b50a429ba44608d63", "class_name": "RelatedNodeInfo"}}, "text": "js -a 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000de1683287529b9b4c3132af8aad210644b259cfd '{\"apiUrl\": \"https://gateway.thegraph.com/api/\", \"apiKey\": \"cd22a01e5b7f9828cddcb52caf03ee79\"}'\nhandle req: 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000de1683287529b9b4c3132af8aad210644b259cfd\n[1]: 0xdE1683287529B9B4C3132af8AaD210644B259CfD\nRequest received for profile 0xdE1683287529B9B4C3132af8AaD210644B259CfD\n{\"data\":{\"account\":{\"id\":\"0xde1683287529b9b4c3132af8aad210644b259cfd\",\"ERC721tokens\":[{\"id\":\"0x57f1887a8bf19b14fc0df6fd9b2acc9af147ea85/0x1c1f4a45a4e02789c110c3771dac92f92a9498f8016c8a6fefcf4d117603d277\",\"identifier\":\"12720044626168998947918556575205935844278720363082869735772187331921734521463\",\"contract\":{\"id\":\"0x57f1887a8bf19b14fc0df6fd9b2acc9af147ea85\"}},{\"id\":\"0x57f1887a8bf19b14fc0df6fd9b2acc9af147ea85/0x8078323181367af7deac0d322698034faf460e340e8bcfde9469655682e637b5\",\"identifier\":\"58108412688393927589019354909227047790661963669020827084996334376817871173557\",", "mimetype": "text/plain", "start_char_idx": 4790, "end_char_idx": 5858, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "1322fa93-421f-4a1e-bd69-8cdc92766708": {"__data__": {"id_": "1322fa93-421f-4a1e-bd69-8cdc92766708", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b9ef0e73-16c3-48d7-852b-c32548d086c9", "node_type": "1", "metadata": {}, "hash": "aa5ef7e3323657078c8090f1c966ff294fba873538a415f054fe31e6a566082d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f1e106ec-3c26-411f-8f6c-f76106a4c0ec", "node_type": "1", "metadata": {}, "hash": "4e3542f9fc0499ec90e1bbb403f3c8683d560001906733b5b5febfbe1202bd7d", "class_name": "RelatedNodeInfo"}}, "text": "\"contract\":{\"id\":\"0x57f1887a8bf19b14fc0df6fd9b2acc9af147ea85\"}},{\"id\":\"0x57f1887a8bf19b14fc0df6fd9b2acc9af147ea85/0x94286edc2c3c238c35cdeb1775c329c554fdd9df064c9ce86dad277d74a1667\",\"identifier\":\"4188358787553715944519630366137388336862205236752970957509174576540310705767\",\"contract\":{\"id\":\"0x57f1887a8bf19b14fc0df6fd9b2acc9af147ea85\"}},{\"id\":\"0x57f1887a8bf19b14fc0df6fd9b2acc9af147ea85/0xba4f236216fb3975855ea0572713af6335f992a110b7ea520a05f06440768b05\",\"identifier\":\"84270014960222169810810437893688928763911475898905132261856796581223088950021\",\"contract\":{\"id\":\"0x57f1887a8bf19b14fc0df6fd9b2acc9af147ea85\"}}]}}}\nERC-721 NFTs owned on ETH Check. Result [4]\n{\"data\":{\"account\":{\"id\":\"0xde1683287529b9b4c3132af8aad210644b259cfd\",\"ERC721tokens\":[]}}}\nHas a NounsDAO NFT Check. Result [4]\n{\"data\":{\"account\":{\"domains\":[{\"name\":\"warlox.eth\"},{\"name\":\"hashwarlock.eth\"},{\"name\":\"[4df3c10b7d9a8cfdbb386728d398389b2dfbcd0f66e4c1ee612a7c82f649ac0a].addr.reverse\"}]}}}\nHas ENS Domains Check. Result [16]\n{\"data\":{\"delegations\":[]}}\nHas Delegated Votes on Snapshot Check. Result [16]\nresponse: 0,1,", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f1e106ec-3c26-411f-8f6c-f76106a4c0ec": {"__data__": {"id_": "f1e106ec-3c26-411f-8f6c-f76106a4c0ec", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "1322fa93-421f-4a1e-bd69-8cdc92766708", "node_type": "1", "metadata": {}, "hash": "b88acfe36de71f809a73d4d0ec0a9272fded303c4b26ff7b50a429ba44608d63", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5fd5c905-bf55-4028-bed3-f7f320f2fb8b", "node_type": "1", "metadata": {}, "hash": "865686c37400ace09f13046e994a47889c4c45a9efdda7525595468e945af685", "class_name": "RelatedNodeInfo"}}, "text": "16\n{\"output\":\"0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000010\"}\n```\n\n#### Deploy a Local Hardhat Node\n\nNow that we have a simple understanding of the expected functionality of the Phat Contract, we can now take our tests to a local testnet. Here we will use Hardhat to deploy the EVM Consumer Contract then listen from new action requests and reply with built Phat Contract script.\n\nFirst we will start a local hardhat node.\n\n```sh\nnpm run localhost-node\n```\n\nWith our hardhat node running locally, we can now deploy the `OracleConsumerContract.sol` contract to the local hardhat network.\n\n```bash\nnpm run localhost-deploy\n```\n\n```bash\nnpm run localhost-deploy\n> the-graph-phat-contract@1.0.0 localhost-deploy\n> hardhat run --network localhost ./scripts/localhost/deploy.ts\n\nCompiled 18 Solidity files successfully (evm target: london).\nDeploying...\nDeployed { consumer: '0x5FbDB2315678afecb367f032d93F642f64180aa3' }\n```\n\nMake sure to copy the deployed contract address when you deploy your own contract locally. Note you contract address will be different than `0x5FbDB2315678afecb367f032d93F642f64180aa3`. We will now start watching the hardhat node deployed contract for any new requests from The Graph Phat Contract.", "mimetype": "text/plain", "start_char_idx": 6957, "end_char_idx": 8325, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5fd5c905-bf55-4028-bed3-f7f320f2fb8b": {"__data__": {"id_": "5fd5c905-bf55-4028-bed3-f7f320f2fb8b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f1e106ec-3c26-411f-8f6c-f76106a4c0ec", "node_type": "1", "metadata": {}, "hash": "4e3542f9fc0499ec90e1bbb403f3c8683d560001906733b5b5febfbe1202bd7d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "4b491e60-b4c6-4df6-b12f-11d975a42cd2", "node_type": "1", "metadata": {}, "hash": "b602f9dd454b6d2ec145b175d9c2dc1abfdd74b334b7d8bb9eb8bbff3c0f3c8f", "class_name": "RelatedNodeInfo"}}, "text": "```bash\nnpx @phala/fn watch 0x5FbDB2315678afecb367f032d93F642f64180aa3 artifacts/contracts/OracleConsumerContract.sol/OracleConsumerContract.json dist/index.js -a '{\"apiUrl\": \"https://gateway.thegraph.com/api/\", \"apiKey\": \"cd22a01e5b7f9828cddcb52caf03ee79\"}'\n```\n\n```bash\nnpx @phala/fn watch 0x5FbDB2315678afecb367f032d93F642f64180aa3 artifacts/contracts/OracleConsumerContract.sol/OracleConsumerContract.json dist/index.js -a '{\"apiUrl\": \"https://gateway.thegraph.com/api/\", \"apiKey\": \"cd22a01e5b7f9828cddcb52caf03ee79\"}'\nListening for OracleConsumerContract MessageQueued events...\n```\n\nLet\u2019s now make a new request and see what happens with the listener\u2019s output. In separate tab, you will push a request with the following.\n\n> **Note**: The file can be edited [here](https://github.com/Phala-Network/the-graph-phat-contract/blob/b9ba89d26ac288500685410b98d2fe01bf426846/scripts/localhost/push-request.ts#L16) where you can change the `target` address.\n\n```bash\nLOCALHOST_CONSUMER_CONTRACT_ADDRESS=0x5FbDB2315678afecb367f032d93F642f64180aa3 npm run localhost-push-request\n```\n\n```bash\nLOCALHOST_CONSUMER_CONTRACT_ADDRESS=0x5FbDB2315678afecb367f032d93F642f64180aa3 npm run localhost-push-request\n> the-graph-phat-contract@1.0.0 localhost-push-request\n> hardhat run --network localhost ./scripts/localhost/push-request.ts\n\nPushing a request.\nReceived event [ResponseReceived]: {\n  reqId: BigNumber { value: \"1\" },\n  target: '0x011c23b3AadAf3D4991f3aBeE262A34d18e9fdb5',", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4b491e60-b4c6-4df6-b12f-11d975a42cd2": {"__data__": {"id_": "4b491e60-b4c6-4df6-b12f-11d975a42cd2", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5fd5c905-bf55-4028-bed3-f7f320f2fb8b", "node_type": "1", "metadata": {}, "hash": "865686c37400ace09f13046e994a47889c4c45a9efdda7525595468e945af685", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "dad99d03-32e9-4e37-8cab-bf8a261bf9fe", "node_type": "1", "metadata": {}, "hash": "ae0b37391b469327b0b19a91a2c0b61f617eb9306ae9c25394358f8f35ae19a0", "class_name": "RelatedNodeInfo"}}, "text": "value: BigNumber { value: \"70\" }\n}\n```\n\nIf you check back the tab where the Phat Contract is listening for new requests, the console log may look similar to below:\n\n```bash\nReceived event [MessageQueued]: {\n  tail: 0n,\n  data: '0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000011c23b3aadaf3d4991f3abee262a34d18e9fdb5'\n}\nhandle req: 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000011c23b3aadaf3d4991f3abee262a34d18e9fdb5\n[1]: 0x011c23b3AadAf3D4991f3aBeE262A34d18e9fdb5\nRequest received for profile 0x011c23b3AadAf3D4991f3aBeE262A34d18e9fdb5\n{\"data\":{\"account\":{\"id\":\"0x011c23b3aadaf3d4991f3abee262a34d18e9fdb5\",\"ERC721tokens\":[{\"id\":\"0x00703f9b11f2ac02d391a11e7b97c6ee80cd8563/0x2bd\",\"identifier\":\"701\",\"contract\":{\"id\":\"0x00703f9b11f2ac02d391a11e7b97c6ee80cd8563\"}},{\"id\":\"0x008f5a13d37db25d1bf7e7115747450e12e471b9/0x13fc\",\"identifier\":\"5116\",\"contract\":{\"id\":\"0x008f5a13d37db25d1bf7e7115747450e12e471b9\"}},{\"id\":\"0x0144ecf966096108b03148d0071df6c70c051a52/0x149f\",\"identifier\":\"5279\",", "mimetype": "text/plain", "start_char_idx": 9802, "end_char_idx": 10873, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "dad99d03-32e9-4e37-8cab-bf8a261bf9fe": {"__data__": {"id_": "dad99d03-32e9-4e37-8cab-bf8a261bf9fe", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "4b491e60-b4c6-4df6-b12f-11d975a42cd2", "node_type": "1", "metadata": {}, "hash": "b602f9dd454b6d2ec145b175d9c2dc1abfdd74b334b7d8bb9eb8bbff3c0f3c8f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b40aead8-9ba3-4102-9ec2-c0cd8f6ad294", "node_type": "1", "metadata": {}, "hash": "76cd666c567467cbe2e88099ffda2486da9e9759c45df41078f3516e27dec1a8", "class_name": "RelatedNodeInfo"}}, "text": "\"contract\":{\"id\":\"0x0144ecf966096108b03148d0071df6c70c051a52\"}},{\"id\":\"0x015fcab6a246cfc0679c33ef0b9d9ef947d0bde4/0x1782\",\"identifier\":\"6018\",\"contract\":{\"id\":\"0x015fcab6a246cfc0679c33ef0b9d9ef947d0bde4\"}},{\"id\":\"0x0191c41dbceb20a612b25137133ca719e84f7933/0x11f\",\"identifier\":\"287\",\"contract\":{\"id\":\"0x0191c41dbceb20a612b25137133ca719e84f7933\"}},{\"id\":\"0x0191c41dbceb20a612b25137133ca719e84f7933/0x120\",\"identifier\":\"288\",\"contract\":{\"id\":\"0x0191c41dbceb20a612b25137133ca719e84f7933\"}},{\"id\":\"0x0191c41dbceb20a612b25137133ca719e84f7933/0xd8e\",\"identifier\":\"3470\",\"contract\":{\"id\":\"0x0191c41dbceb20a612b25137133ca719e84f7933\"}},{\"id\":\"0x0208517aa68e7c72769af76f4cfdeea9fa4ef4b9/0x213\",\"identifier\":\"531\",\"contract\":{\"id\":\"0x0208517aa68e7c72769af76f4cfdeea9fa4ef4b9\"}},{\"id\":\"0x026dce20bf77e08ca8aceb6b239cc54bb9d638ac/0x237\",\"identifier\":\"567\",\"contract\":{\"id\":\"0x026dce20bf77e08ca8aceb6b239cc54bb9d638ac\"}},{\"id\":\"0x032d96756697af7ec02ce03d39001b39f7a5d849/0x1a4\",\"identifier\":\"420\",", "mimetype": "text/plain", "start_char_idx": 10873, "end_char_idx": 11856, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b40aead8-9ba3-4102-9ec2-c0cd8f6ad294": {"__data__": {"id_": "b40aead8-9ba3-4102-9ec2-c0cd8f6ad294", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "dad99d03-32e9-4e37-8cab-bf8a261bf9fe", "node_type": "1", "metadata": {}, "hash": "ae0b37391b469327b0b19a91a2c0b61f617eb9306ae9c25394358f8f35ae19a0", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f2bba4e7-aa78-4708-97db-df939bf4dae3", "node_type": "1", "metadata": {}, "hash": "c35e0eb765afe8d3784d8b0d5d647045a5fcd9d2f307906f9543f7394f51140e", "class_name": "RelatedNodeInfo"}}, "text": "\"contract\":{\"id\":\"0x032d96756697af7ec02ce03d39001b39f7a5d849\"}},{\"id\":\"0x038cc0f103c380400482d87be0d3abcc4d9b2225/0x2ed\",\"identifier\":\"749\",\"contract\":{\"id\":\"0x038cc0f103c380400482d87be0d3abcc4d9b2225\"}},{\"id\":\"0x039483c56aad5ee68a92eff1a1b666f2893c623e/0xf9d\",\"identifier\":\"3997\",\"contract\":{\"id\":\"0x039483c56aad5ee68a92eff1a1b666f2893c623e\"}},{\"id\":\"0x03ef30e1aee25abd320ad961b8cd31aa1a011c97/0x17a1\",\"identifier\":\"6049\",\"contract\":{\"id\":\"0x03ef30e1aee25abd320ad961b8cd31aa1a011c97\"}},{\"id\":\"0x03ef30e1aee25abd320ad961b8cd31aa1a011c97/0xcf1\",\"identifier\":\"3313\",\"contract\":{\"id\":\"0x03ef30e1aee25abd320ad961b8cd31aa1a011c97\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1000\",\"identifier\":\"4096\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x100b\",\"identifier\":\"4107\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x107d\",\"identifier\":\"4221\",", "mimetype": "text/plain", "start_char_idx": 11856, "end_char_idx": 12846, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f2bba4e7-aa78-4708-97db-df939bf4dae3": {"__data__": {"id_": "f2bba4e7-aa78-4708-97db-df939bf4dae3", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b40aead8-9ba3-4102-9ec2-c0cd8f6ad294", "node_type": "1", "metadata": {}, "hash": "76cd666c567467cbe2e88099ffda2486da9e9759c45df41078f3516e27dec1a8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c81d3541-6ad3-4d61-9176-221576be2502", "node_type": "1", "metadata": {}, "hash": "4f8feda0b4e3b5722fe7e5f86734d2b2c5564a63b7e6aeedc61301f92ed761f2", "class_name": "RelatedNodeInfo"}}, "text": "\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x10de\",\"identifier\":\"4318\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x11aa\",\"identifier\":\"4522\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x12c5\",\"identifier\":\"4805\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x139a\",\"identifier\":\"5018\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x144\",\"identifier\":\"324\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x144e\",\"identifier\":\"5198\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x14a9\",\"identifier\":\"5289\",", "mimetype": "text/plain", "start_char_idx": 12846, "end_char_idx": 13838, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c81d3541-6ad3-4d61-9176-221576be2502": {"__data__": {"id_": "c81d3541-6ad3-4d61-9176-221576be2502", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f2bba4e7-aa78-4708-97db-df939bf4dae3", "node_type": "1", "metadata": {}, "hash": "c35e0eb765afe8d3784d8b0d5d647045a5fcd9d2f307906f9543f7394f51140e", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "d526427e-b1f2-4c67-a490-f29dbd566e4a", "node_type": "1", "metadata": {}, "hash": "2504578e877fac2fd8e115a639ede789e9d2f086a4ecb1abad7f70d49247f56b", "class_name": "RelatedNodeInfo"}}, "text": "\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x14c0\",\"identifier\":\"5312\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1531\",\"identifier\":\"5425\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x153e\",\"identifier\":\"5438\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1569\",\"identifier\":\"5481\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x158c\",\"identifier\":\"5516\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x15ee\",\"identifier\":\"5614\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x161f\",\"identifier\":\"5663\",", "mimetype": "text/plain", "start_char_idx": 13838, "end_char_idx": 14832, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d526427e-b1f2-4c67-a490-f29dbd566e4a": {"__data__": {"id_": "d526427e-b1f2-4c67-a490-f29dbd566e4a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c81d3541-6ad3-4d61-9176-221576be2502", "node_type": "1", "metadata": {}, "hash": "4f8feda0b4e3b5722fe7e5f86734d2b2c5564a63b7e6aeedc61301f92ed761f2", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "61c3d22a-4923-4279-9237-2124eb161990", "node_type": "1", "metadata": {}, "hash": "04f9f8aa623de8cf9510f6c720ce3a13e1307176fd86e2fd3401e29f21767239", "class_name": "RelatedNodeInfo"}}, "text": "\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x164d\",\"identifier\":\"5709\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x16db\",\"identifier\":\"5851\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1735\",\"identifier\":\"5941\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1742\",\"identifier\":\"5954\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1764\",\"identifier\":\"5988\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1793\",\"identifier\":\"6035\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x18b7\",\"identifier\":\"6327\",", "mimetype": "text/plain", "start_char_idx": 14832, "end_char_idx": 15826, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "61c3d22a-4923-4279-9237-2124eb161990": {"__data__": {"id_": "61c3d22a-4923-4279-9237-2124eb161990", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d526427e-b1f2-4c67-a490-f29dbd566e4a", "node_type": "1", "metadata": {}, "hash": "2504578e877fac2fd8e115a639ede789e9d2f086a4ecb1abad7f70d49247f56b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "490c035a-c582-48db-9d96-fdcb1b510602", "node_type": "1", "metadata": {}, "hash": "aacddb1adf3dfa5bed2f05f5abb5a1206486abe9e1af737eede5a8fce1470a06", "class_name": "RelatedNodeInfo"}}, "text": "\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1926\",\"identifier\":\"6438\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1940\",\"identifier\":\"6464\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1988\",\"identifier\":\"6536\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x199a\",\"identifier\":\"6554\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1a8e\",\"identifier\":\"6798\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1b4\",\"identifier\":\"436\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1be3\",\"identifier\":\"7139\",", "mimetype": "text/plain", "start_char_idx": 15826, "end_char_idx": 16818, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "490c035a-c582-48db-9d96-fdcb1b510602": {"__data__": {"id_": "490c035a-c582-48db-9d96-fdcb1b510602", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "61c3d22a-4923-4279-9237-2124eb161990", "node_type": "1", "metadata": {}, "hash": "04f9f8aa623de8cf9510f6c720ce3a13e1307176fd86e2fd3401e29f21767239", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "3fc2e8ac-7022-4be6-a8d9-25d0bf10a1a1", "node_type": "1", "metadata": {}, "hash": "23ec3b64fda45d1cbcde38e1fe9609110f7c4b9e6f200df2a07bac3716bed929", "class_name": "RelatedNodeInfo"}}, "text": "\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1beb\",\"identifier\":\"7147\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1d83\",\"identifier\":\"7555\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1dc0\",\"identifier\":\"7616\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1dd8\",\"identifier\":\"7640\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}},{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429/0x1e45\",\"identifier\":\"7749\",\"contract\":{\"id\":\"0x04b4786c3bb42387235a63628b7a4cb178817429\"}}]}}}\nERC-721 NFTs owned on ETH Check. Result [50]\n{\"data\":{\"account\":{\"id\":\"0x011c23b3aadaf3d4991f3abee262a34d18e9fdb5\",\"ERC721tokens\":[]}}}\nHas a NounsDAO NFT Check. Result [50]\n{\"data\":{\"account\":{\"domains\":[{\"name\":\"sissitian.eth\"},{\"name\":\"ariahuang.eth\"},{\"name\":\"hugovault.eth\"},{\"name\":\"hugosu.eth\"},{\"name\":\"dominichuang.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "3fc2e8ac-7022-4be6-a8d9-25d0bf10a1a1": {"__data__": {"id_": "3fc2e8ac-7022-4be6-a8d9-25d0bf10a1a1", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "490c035a-c582-48db-9d96-fdcb1b510602", "node_type": "1", "metadata": {}, "hash": "aacddb1adf3dfa5bed2f05f5abb5a1206486abe9e1af737eede5a8fce1470a06", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "452c45bb-5c70-4826-9549-b87a872325be", "node_type": "1", "metadata": {}, "hash": "db3712c63d876797344abb5dd8c3dc5231f6b27890c392cb2f7af0ffe4ea2b26", "class_name": "RelatedNodeInfo"}}, "text": "eth\"}]}}}\nHas ENS Domains Check. Result [70]\n{\"data\":{\"delegations\":[]}}\nHas Delegated Votes on Snapshot Check. Result [70]\nresponse: 0,1,70\nJS Execution output: 0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000046\n```\n\n:tada: **Congratulations!**&#x20;\n\nYou've completed deploying and testing The Graph Phat Contract successfully in a local testnet. Now let's move to deploying to an EVM Testnet and connecting a deployed Phat Contract on PoC6 Testnet to visualize how this works autonomously.\n{% endtab %}\n\n{% tab title=\"Testnet\" %}\n{% hint style=\"danger\" %}\n**Important**\n\nThis guide references the `mumbai` testnet chain.&#x20;\n\nThe`mumbai` testnet is [deprecated since 2024/04/08](https://polygon.technology/blog/introducing-the-amoy-testnet-for-polygon-pos), meaning the steps to deploy to a testnet will no longer work out of the box.\n\nYou can opt to use the [`amoy`](https://polygon.technology/blog/introducing-the-amoy-testnet-for-polygon-pos) testnet or any other EVM testnet instead.\n{% endhint %}\n\nIn the previous [Quick Start](../airstack/quick-start.md) section, we installed the dependencies.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "452c45bb-5c70-4826-9549-b87a872325be": {"__data__": {"id_": "452c45bb-5c70-4826-9549-b87a872325be", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "3fc2e8ac-7022-4be6-a8d9-25d0bf10a1a1", "node_type": "1", "metadata": {}, "hash": "23ec3b64fda45d1cbcde38e1fe9609110f7c4b9e6f200df2a07bac3716bed929", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "525b6b39-c10a-4889-9e35-76fdf7d01f1c", "node_type": "1", "metadata": {}, "hash": "e28a55cff8a39f13a067b277b4babdcd4a68075eaa56486872afade757106bd3", "class_name": "RelatedNodeInfo"}}, "text": "Now it is time to deploy and test to an EVM public testnet.&#x20;\n\nThe following steps will be performed:\n\n* Deploy the EVM Consumer Contract to the target EVM chain\n  * The EVM Consumer Contract will request actions to be executed off-chain by the Phat Contract\n* Deploy The Graph Phat Contract to the Phala PoC6 Testnet\n  * Once deployed, update the `ATTESTOR_ROLE` in the EVM Consumer Contract to the `Attestor Address` in the Phat Contract 2.0 UI Dashboard\n* Send a `request(address target)` transaction to get a trust score about an EVM target address\n* See The Graph Phat Contract respond with an action reply with a score for the target address\n\n### Minimum Requirements\n\n* [ ] Create a [Phala Dashboard Profile](../create-a-dashboard-profile.md) on Phala PoC6 Testnet\n  * [ ] Add funds to the EVM Gas Account to pay TX fees on target EVM Testnet Chain\n* [ ] Finished the [Quick Start](quick-start.md)\n* [ ] (Recommended) Go through the `Local` tab deployment process\n* [ ] Burner Account for EVM Consumer Contract deployment\n\n### Deployment\n\nIn this example, we will use Polygon Mumbai Testnet as the target EVM Testnet Chain, but this can be changed to any EVM testnet of the developers choice.\n\n#### Install Dependencies & Compile Contracts <a href=\"#user-content-install-dependencies--compile-contracts\" id=\"user-content-install-dependencies--compile-contracts\"></a>\n\n```sh\n# install dependencies\n$ npm install\n\n# compile contracts\n$ npm run compile\n```\n\n#### Deploy to Polygon Mumbai Testnet <a href=\"#user-content-deploy-to-polygon-mumbai-testnet\" id=\"user-content-deploy-to-polygon-mumbai-testnet\"></a>\n\nWith the contracts successfully compiled, now we can begin deploying first to Polygon Mumbai Testnet. If you have not gotten `MATIC` for Mumbai Testnet then get `MATIC` from a [faucet](https://bit.ly/3ZyFoT3). Ensure to save the address after deploying the Consumer Contract because this address will be use in the \"Configure Client\" section of Phat Contract 2.0 UI.", "mimetype": "text/plain", "start_char_idx": 19178, "end_char_idx": 21162, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "525b6b39-c10a-4889-9e35-76fdf7d01f1c": {"__data__": {"id_": "525b6b39-c10a-4889-9e35-76fdf7d01f1c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "452c45bb-5c70-4826-9549-b87a872325be", "node_type": "1", "metadata": {}, "hash": "db3712c63d876797344abb5dd8c3dc5231f6b27890c392cb2f7af0ffe4ea2b26", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "9a1a1281-b7cb-4cfe-9b7e-fdf85ea1383c", "node_type": "1", "metadata": {}, "hash": "46b35f518275ef40e7d80da12a6d836be6d2be22ae79b6f43d950a36ce4be4a2", "class_name": "RelatedNodeInfo"}}, "text": "The deployed address will also be set to the environment variable `MUMBAI_CONSUMER_CONTRACT_ADDRESS`.\n\n<pre class=\"language-sh\"><code class=\"lang-sh\"><strong>npm run test-deploy\n</strong></code></pre>\n\n```sh\n# deploy contracts to testnet mumbai\nnpm run test-deploy\n# > the-graph-phat-contract@1.0.0 test-deploy\n# > hardhat run --network mumbai ./scripts/mumbai/deploy.ts\n#\n# Deploying...\n#\n# \ud83c\udf89 Your Consumer Contract has been deployed, check it out here: https://mumbai.polygonscan.com/address/0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355\n#\n# You also need to set up the consumer contract address in your .env file:\n#\n# MUMBAI_CONSUMER_CONTRACT_ADDRESS=0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355\n#\n# Done\n```\n\n#### **(Optional) Verify Contract on Polygon Mumbai Testnet**\n\nEnsure to update the `mumbai.arguments.ts` file with the constructor arguments used to instantiate the Consumer Contract. If you add additional parameters to the constructor function then make sure to update the `mumbai.arguments.ts` file.\n\n> **Note**: Your contract address will be different than `0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355` when verifying your contract. Make sure to get your actual contract address from the console log output after executing `npm run test-deploy`.\n\n```sh\nnpm run test-verify -- <MUMBAI_CONSUMER_CONTRACT_ADDRESS>\n```\n\n```sh\nnpm run test-verify -- 0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355\n# > the-graph-phat-contract@1.0.0 test-verify\n# > hardhat verify --network mumbai --constructor-args mumbai.arguments.ts 0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355\n#\n# Nothing to compile\n# No need to generate any newer typings.", "mimetype": "text/plain", "start_char_idx": 21163, "end_char_idx": 22789, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "9a1a1281-b7cb-4cfe-9b7e-fdf85ea1383c": {"__data__": {"id_": "9a1a1281-b7cb-4cfe-9b7e-fdf85ea1383c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "525b6b39-c10a-4889-9e35-76fdf7d01f1c", "node_type": "1", "metadata": {}, "hash": "e28a55cff8a39f13a067b277b4babdcd4a68075eaa56486872afade757106bd3", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f6a5fb76-a144-437f-a2ec-fe77bd899226", "node_type": "1", "metadata": {}, "hash": "9719acb73425f83f1e037e544bdadf5ebd0f799bb1ae61324dfd0c32163c8142", "class_name": "RelatedNodeInfo"}}, "text": "# Successfully submitted source code for contract\n# contracts/OracleConsumerContract.sol:OracleConsumerContract at 0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355\n# for verification on the block explorer. Waiting for verification result...\n#\n# Successfully verified contract OracleConsumerContract on Etherscan.\n# https://mumbai.polygonscan.com/address/0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355#code\n```\n\n#### Deploy Phat Contract to PoC6 Testnet <a href=\"#user-content-deploy-phat-contract-to-poc5-testnet\" id=\"user-content-deploy-phat-contract-to-poc5-testnet\"></a>\n\nFor customizing your Phat Contract, checkout Phat Contract custom configurations in [Cusomizing Your Phat Contract](../featured-blueprints/customizing-your-phat-contract.md) to learn more before deploying to PoC6 testnet.\n\nNow that are Phat Contract has built successfully, let's deploy to Phala PoC6 Testnet with the following command:\n\n```shell\n# If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn upload --coreSettings='{\"apiUrl\": \"https://gateway.thegraph.com/api/\", \"apiKey\": \"cd22a01e5b7f9828cddcb52caf03ee79\"}'\n# If polkadot-account.json is in the root of project\nnpx @phala/fn upload -a ./polkadot-account.json --coreSettings='{\"apiUrl\": \"https://gateway.thegraph.com/api/\", \"apiKey\": \"cd22a01e5b7f9828cddcb52caf03ee79\"}'\n```\n\nHere is the expected output:\n\n> Note: your contract IDs will vary and not be the same as the IDs below.\n\n```bash\nnpx @phala/fn upload -a ./polkadot-account.json --coreSettings='{\"apiUrl\": \"https://gateway.thegraph.com/api/\", \"apiKey\": \"cd22a01e5b7f9828cddcb52caf03ee79\"}'\n# ?", "mimetype": "text/plain", "start_char_idx": 22790, "end_char_idx": 24430, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f6a5fb76-a144-437f-a2ec-fe77bd899226": {"__data__": {"id_": "f6a5fb76-a144-437f-a2ec-fe77bd899226", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "9a1a1281-b7cb-4cfe-9b7e-fdf85ea1383c", "node_type": "1", "metadata": {}, "hash": "46b35f518275ef40e7d80da12a6d836be6d2be22ae79b6f43d950a36ce4be4a2", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "765f5d0a-d3bb-4c34-82a5-6fafe361738b", "node_type": "1", "metadata": {}, "hash": "c07c663a8479ef83ac700ce44e3018ed2e12cf82114b07157a7364f5af844e93", "class_name": "RelatedNodeInfo"}}, "text": "Please enter your client RPC URL https://polygon-mumbai.g.alchemy.com/v2/JLjOfWJycWFOA0kK_SJ4jLGjtXkMN1wc\n# ? Please enter your consumer address 0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355\n# ? Please Enter hahaha account password [hidden]\n# \u2713 Compiled successfully.\n# \u2713 Connected to the endpoint: wss://poc6.phala.network/ws\n#\n# You are connecting to a testnet.\n#\n# \u2713 Your Brick Profile contract ID: 0x2a9f9a07886e11e1c5d63a176e3f75253d6765aadb90beb112fb3e55f7c98ea8\n# \u2713 The ActionOffchainRollup contract has been instantiated: 0xc9b96a665c3f1730606760f056b78bbb493f31a2b5406f8dd19e138561177336\n# ? Please select an external account: [1] 0x20050cae178a72e7c5adc207a060a16e65bbb7cf. https://polygon-mumbai.g.alchemy.com/v2/JLjOfWJycWFOA0kK_SJ4jLGjtXkMN1wc\n# \u2713 Checking your settings\n# ? Please enter your project name My Phat Contract 6\n# \u2713 \ud83c\udf89 Your workflow has been added, you can check it out here: https://bricks.phala.network/workflows/0x2a9f9a07886e11e1c5d63a176e3f75253d6765aadb90beb112fb3e55f7c98ea8/6\n# Your Attestor address: 0x4a8e621202af9206959017c3795721f327f2ef28\n# Your WORKFLOW_ID: 6\n```\n\nGo to the [Phala Dashboard](https://dashboard.phala.network) and you can see your newly deployed Phat Contract.", "mimetype": "text/plain", "start_char_idx": 24431, "end_char_idx": 25643, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "765f5d0a-d3bb-4c34-82a5-6fafe361738b": {"__data__": {"id_": "765f5d0a-d3bb-4c34-82a5-6fafe361738b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f6a5fb76-a144-437f-a2ec-fe77bd899226", "node_type": "1", "metadata": {}, "hash": "9719acb73425f83f1e037e544bdadf5ebd0f799bb1ae61324dfd0c32163c8142", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5de0a6e7-71f6-4ce3-89f9-06c33f3ad740", "node_type": "1", "metadata": {}, "hash": "384477b12dfa34c3dee1bc988208d656d01f19912ccf502e9e2ea71a4edd8c1b", "class_name": "RelatedNodeInfo"}}, "text": "<figure><img src=\"../../../../.gitbook/assets/DeployedTheGraphPC.png\" alt=\"\"><figcaption></figcaption></figure>\n\n#### **Interact with Consumer Contract on Polygon Mumbai**\n\nTest Consumer Contract on Mumbai with a few tests to check for malformed requests failures, successful requests, and set the attestor.\n\n```sh\nnpm run test-set-attestor\n```\n\n```sh\nnpm run test-set-attestor\n# > the-graph-phat-contract@1.0.0 test-set-attestor\n# > hardhat run --network mumbai ./scripts/mumbai/set-attestor.ts\n#\n# Setting attestor...\n# \ud83d\udea8NOTE\ud83d\udea8\n# Make sure to set the Consumer Contract Address in your Phat Contract 2.0 UI dashboard (https://bricks.phala.network)\n# - Go to the 'Configuration' tab and update the 'Client' box\n# - Set value to 0xEE2F3526686D27f682ecb6E3dC91cd8c972Cf355\n# Done\n```\n\nTest pushing a malform request.\n\n```sh\nnpm run test-push-malformed-request\n```\n\n```sh\nnpm run test-push-malformed-request\n# > the-graph-phat-contract@1.0.0 test-push-malformed-request\n# > hardhat run --network mumbai ./scripts/mumbai/push-malformed-request.ts\n#\n# Pushing a malformed request...\n# Done\n```\n\nWe can visualize the response from the Phat Contract in the block explorer.\n\n<figure><img src=\"../../../../.gitbook/assets/malformreq-thegraph-pc.png\" alt=\"\"><figcaption></figcaption></figure>\n\nTest pushing a valid request.\n\n```sh\nnpm run test-push-request\n```\n\n```sh\nnpm run test-push-request\n# Pushing a request...\n# Done\n# \u2728  Done in 2.97s.\n```\n\nThe next 2 images will show the request to the Consumer Contract with a reply from the Phat Contract, and the last picture shows what the Phat Contract replied with.", "mimetype": "text/plain", "start_char_idx": 25645, "end_char_idx": 27248, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5de0a6e7-71f6-4ce3-89f9-06c33f3ad740": {"__data__": {"id_": "5de0a6e7-71f6-4ce3-89f9-06c33f3ad740", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "765f5d0a-d3bb-4c34-82a5-6fafe361738b", "node_type": "1", "metadata": {}, "hash": "c07c663a8479ef83ac700ce44e3018ed2e12cf82114b07157a7364f5af844e93", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c0ffb2cb-b729-40ca-8b71-852a77ccee38", "node_type": "1", "metadata": {}, "hash": "fa62346ddebcf570f29eba826e2b285ef29ccc343b45b184c55c50530c0fe216", "class_name": "RelatedNodeInfo"}}, "text": "<figure><img src=\"../../../../.gitbook/assets/push-request-thegraph.png\" alt=\"\"><figcaption></figcaption></figure>\n\nHere is the emitted event `ResponseReceived` with the score `70` for `target` address `0x011c23b3AadAf3D4991f3aBeE262A34d18e9fdb5.`\n\n<figure><img src=\"../../../../.gitbook/assets/thegraph-pc-reply-info.png\" alt=\"\"><figcaption></figcaption></figure>\n\n#### Update Phat Contract on Phala PoC6 Testnet <a href=\"#user-content-update-phat-contract-on-phala-poc5-testnet\" id=\"user-content-update-phat-contract-on-phala-poc5-testnet\"></a>\n\nSometimes you may have had a bug in your script or you want to test things out on the fly without deploying a whole new Phat Contract. The `npx @phala/fn update` command will update your Phat Contract easily in the command line.&#x20;\n\nNow let's update the Phat Contract:\n\n```bash\n# If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn update\n# If polkadot-account.json is in the root of project\nnpx @phala/fn update -a ./polkadot-account.json\n```\n\n```bash\nnpx @phala/fn update -a ./polkadot-account.json\n# ? Please Enter hahaha account password [hidden]\n# \u2713 Compiled successfully.\n# \u2713 Connected to the endpoint: wss://poc6.phala.network/ws\n#\n# You are connecting to a testnet.\n#\n# \u2713 Your Brick Profile contract ID: 0x2a9f9a07886e11e1c5d63a176e3f75253d6765aadb90beb112fb3e55f7c98ea8\n# \u2713 The JavaScript code for workflow 6 has been updated.\n```\n\n:tada: **Congratulations!** You have now completed a full testnet deployment and have a fully functional Phat Contract connected to The Graph to compute a score and return to your EVM Consumer Contract.", "mimetype": "text/plain", "start_char_idx": 27250, "end_char_idx": 28908, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c0ffb2cb-b729-40ca-8b71-852a77ccee38": {"__data__": {"id_": "c0ffb2cb-b729-40ca-8b71-852a77ccee38", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5de0a6e7-71f6-4ce3-89f9-06c33f3ad740", "node_type": "1", "metadata": {}, "hash": "384477b12dfa34c3dee1bc988208d656d01f19912ccf502e9e2ea71a4edd8c1b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "60d8db21-9157-4688-90ba-61ca1ea06022", "node_type": "1", "metadata": {}, "hash": "bb7e32d78f4e279c3d46e9261aff84f90604f454307b97815d77cdfd58b465b1", "class_name": "RelatedNodeInfo"}}, "text": "The steps for mainnet deployment are nearly identical, but let's take a look at the process in the `Mainnet` tab.\n{% endtab %}\n\n{% tab title=\"Mainnet\" %}\nIn the previous `Testnet` tab, you went through the full deployment process to connect The Graph Phat Contract to a Consumer Contract on an EVM Testnet Chain. Now it is time to take these talents to **Mainnet** :sunglasses:.&#x20;\n\nThe following steps will be performed:\n\n* Deploy the EVM Consumer Contract to the target EVM  Mainnet chain\n  * The EVM Consumer Contract will request actions to be executed off-chain by the Phat Contract\n* Deploy The Graph Phat Contract to the Phala Mainnet\n  * Once deployed, update the `ATTESTOR_ROLE` in the EVM Consumer Contract to the `Attestor Address` in the Phat Contract 2.0 UI Dashboard\n* Send a `request(address target)` transaction to get a trust score about an EVM target address\n* See The Graph Phat Contract respond with an action reply with a score for the target address\n\n### Minimum Requirements\n\n* [ ] Create a [Phala Dashboard Profile](../create-a-dashboard-profile.md) on Phala Mainnet\n  * [ ] Add funds to the EVM Gas Account to pay TX fees on target EVM Mainnet Chain\n* [ ] Finished the [Quick Start](quick-start.md)\n* [ ] (Recommended) Go through the `Local` AND `Testnet` tabs to understand the deployment process fully\n* [ ] Burner Account for EVM Consumer Contract deployment\n\n### Deployment\n\nIn this example, we will use Polygon PoS Mainnet as the target EVM Mainnet Chain, but this can be changed to any EVM chain of the developer's choice.\n\n#### Install Dependencies & Compile Contracts <a href=\"#user-content-install-dependencies--compile-contracts\" id=\"user-content-install-dependencies--compile-contracts\"></a>\n\n```sh\n# install dependencies\n$ npm install\n\n# compile contracts\n$ npm run compile\n```\n\n#### Deploy to Polygon Mainnet <a href=\"#user-content-deploy-to-polygon-mumbai-testnet\" id=\"user-content-deploy-to-polygon-mumbai-testnet\"></a>\n\nWith the contracts successfully compiled, now we can begin deploying first to Polygon PoS Mainnet.", "mimetype": "text/plain", "start_char_idx": 28909, "end_char_idx": 30971, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "60d8db21-9157-4688-90ba-61ca1ea06022": {"__data__": {"id_": "60d8db21-9157-4688-90ba-61ca1ea06022", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c0ffb2cb-b729-40ca-8b71-852a77ccee38", "node_type": "1", "metadata": {}, "hash": "fa62346ddebcf570f29eba826e2b285ef29ccc343b45b184c55c50530c0fe216", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "8526f99f-3bf7-49e3-8d54-67989d393fb8", "node_type": "1", "metadata": {}, "hash": "e0bd8685b768ffdd812dd873ad76c781072c92047692970152c504c279d90e1c", "class_name": "RelatedNodeInfo"}}, "text": "If you have not gotten `MATIC` then get `MATIC` from an exchange or through their [Wallet Suite](https://wallet.polygon.technology/). Ensure to save the address after deploying the Consumer Contract because this address will be use in the \"Configure Client\" section of Phat Contract 2.0 UI. The deployed address will also be set to the environment variable `POLYGON_CONSUMER_CONTRACT_ADDRESS`.\n\n<pre class=\"language-sh\"><code class=\"lang-sh\"><strong>npm run main-deploy\n</strong></code></pre>\n\n```sh\n# deploy contracts to Polygon PoS mainnet\nnpm run main-deploy\n# > the-graph-phat-contract@1.0.0 main-deploy\n# > hardhat run --network polygon ./scripts/polygon/deploy.ts\n#\n# Deploying...\n#\n# \ud83c\udf89 Your Consumer Contract has been deployed, check it out here: https://polygonscan.com/address/0x0b9aC89924483077899d2B52bc8AF794F546a1e9\n#\n# You also need to set up the consumer contract address in your .env file:\n#\n# POLYGON_CONSUMER_CONTRACT_ADDRESS=0x0b9aC89924483077899d2B52bc8AF794F546a1e9\n# \n# Done\n```\n\n#### **(Optional) Verify Contract on Polygon Mainnet**\n\nEnsure to update the `polygon.arguments.ts` file with the constructor arguments used to instantiate the Consumer Contract. If you add additional parameters to the constructor function then make sure to update the `polygon.arguments.ts` file.\n\n> **Note**: Your contract address will be different than `0x0b9aC89924483077899d2B52bc8AF794F546a1e9` when verifying your contract. Make sure to get your actual contract address from the console log output after executing `npm run main-deploy`.", "mimetype": "text/plain", "start_char_idx": 30972, "end_char_idx": 32517, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8526f99f-3bf7-49e3-8d54-67989d393fb8": {"__data__": {"id_": "8526f99f-3bf7-49e3-8d54-67989d393fb8", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "60d8db21-9157-4688-90ba-61ca1ea06022", "node_type": "1", "metadata": {}, "hash": "bb7e32d78f4e279c3d46e9261aff84f90604f454307b97815d77cdfd58b465b1", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ff50379e-baa0-40fe-aed0-e60b17b899d4", "node_type": "1", "metadata": {}, "hash": "e805b5284c29c4bb412b0c166202c6b0e3a8ffa12bedce83fa19ea956714b8dc", "class_name": "RelatedNodeInfo"}}, "text": "```sh\nnpm run main-verify -- <MUMBAI_CONSUMER_CONTRACT_ADDRESS>\n```\n\n```sh\nnpm run main-verify -- 0x0b9aC89924483077899d2B52bc8AF794F546a1e9\n# > the-graph-phat-contract@1.0.0 main-verify\n# > hardhat verify --network polygon --constructor-args polygon.arguments.ts 0x0b9aC89924483077899d2B52bc8AF794F546a1e9\n#\n# Nothing to compile\n# No need to generate any newer typings.\n# Successfully submitted source code for contract\n# contracts/OracleConsumerContract.sol:OracleConsumerContract at 0x0b9aC89924483077899d2B52bc8AF794F546a1e9\n# for verification on the block explorer. Waiting for verification result...\n#\n# Successfully verified contract OracleConsumerContract on Etherscan.\n# https://polygonscan.com/address/0x0b9aC89924483077899d2B52bc8AF794F546a1e9#code\n```\n\n#### Deploy Phat Contract to Phala Mainnet <a href=\"#user-content-deploy-phat-contract-to-poc5-testnet\" id=\"user-content-deploy-phat-contract-to-poc5-testnet\"></a>\n\nFor customizing your Phat Contract, checkout Phat Contract custom configurations in [Customizing Your Phat Contract](../featured-blueprints/customizing-your-phat-contract.md) to learn more before deploying to Phala Mainnet.", "mimetype": "text/plain", "start_char_idx": 32519, "end_char_idx": 33672, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ff50379e-baa0-40fe-aed0-e60b17b899d4": {"__data__": {"id_": "ff50379e-baa0-40fe-aed0-e60b17b899d4", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "8526f99f-3bf7-49e3-8d54-67989d393fb8", "node_type": "1", "metadata": {}, "hash": "e0bd8685b768ffdd812dd873ad76c781072c92047692970152c504c279d90e1c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "329f478a-0baf-400a-b390-38bcf4d2e611", "node_type": "1", "metadata": {}, "hash": "097250894e93b6cf2b271829c649d472cfff0922421597ecd75d3ecfec2d042f", "class_name": "RelatedNodeInfo"}}, "text": "Now that are Phat Contract has built successfully, let's deploy to Phala Mainnet with the following command:\n\n<pre class=\"language-shell\"><code class=\"lang-shell\"># If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn upload --mode=production --coreSettings='{\"apiUrl\": \"https://gateway.thegraph.com/api/\", \"apiKey\": \"cd22a01e5b7f9828cddcb52caf03ee79\"}'\n# If polkadot-account.json is in the root of project\n<strong>npx @phala/fn upload --mode=production -a ./polkadot-account.json --coreSettings='{\"apiUrl\": \"https://gateway.thegraph.com/api/\", \"apiKey\": \"cd22a01e5b7f9828cddcb52caf03ee79\"}'\n</strong></code></pre>\n\nHere is the expected output:\n\n> Note: your contract IDs will vary and not be the same as the IDs below.\n\n```bash\nnpx @phala/fn upload --mode=production -a ./polkadot-account.json --coreSettings='{\"apiUrl\": \"https://gateway.thegraph.com/api/\", \"apiKey\": \"cd22a01e5b7f9828cddcb52caf03ee79\"}'\n# ? Please enter your client RPC URL https://polygon-mainnet.g.alchemy.com/v2/UZpqlxsFm0aVm_euopH95rQ6YxiRa3VC\n# ? Please enter your consumer address 0x0b9aC89924483077899d2B52bc8AF794F546a1e9\n# ? Please Enter hahaha account password [hidden]\n# \u2713 Compiled successfully.", "mimetype": "text/plain", "start_char_idx": 33674, "end_char_idx": 34912, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "329f478a-0baf-400a-b390-38bcf4d2e611": {"__data__": {"id_": "329f478a-0baf-400a-b390-38bcf4d2e611", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ff50379e-baa0-40fe-aed0-e60b17b899d4", "node_type": "1", "metadata": {}, "hash": "e805b5284c29c4bb412b0c166202c6b0e3a8ffa12bedce83fa19ea956714b8dc", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "32ca947c-58ec-4a9f-a1cc-ed4f4b294f16", "node_type": "1", "metadata": {}, "hash": "9c4ad978a4bd56baf0fe5e1b47c92ed9433b11d22650b0c22c5d2154fbe2e571", "class_name": "RelatedNodeInfo"}}, "text": "# \u2713 Connected to the endpoint: wss://api.phala.network/ws\n# \u2713 Your Brick Profile contract ID: 0x6e96d8c209fc14b69533e3627c4766b6eeef8f77a25348b2d77b28c90b0bd012\n# \u2713 The ActionOffchainRollup contract has been instantiated: 0xe2ac2edc835de67f71f76ef686ebb4e48bdf0c2da2b6862329cca00c3c9b8349\n# ? Please select an external account: [0] 0x8438ce1a6196b7edae83cbc2a58d33db6fae6bee. https://polygon-mainnet.g.alchemy.com/v2/W1kyx17tiFQFT2b19mGOqppx90BLHp0a\n# \u2713 Checking your settings\n# ? Please enter your project name My Phat Contract 0\n# \u2713 \ud83c\udf89 Your workflow has been added, you can check it out here: https://bricks.phala.network/workflows/0x6e96d8c209fc14b69533e3627c4766b6eeef8f77a25348b2d77b28c90b0bd012/0\n# Your Attestor address: 0x2829d70d48516b7d1be2b5f5f424b41ce4da8056\n# Your WORKFLOW_ID: 0\n```\n\nGo to the [Phat Contract 2.0 Dashboard](https://bit.ly/3LHccmR) and you can see your newly deployed Phat Contract.\n\n<figure><img src=\"../../../../.gitbook/assets/deploy-thegraph-main.png\" alt=\"\"><figcaption></figcaption></figure>\n\n#### **Interact with Consumer Contract on Polygon PoS Mainnet**\n\nConsumer Contract on Mumbai with a few transactions to set the attestor, check for malformed requests failures, and successfully fulfilled requests.", "mimetype": "text/plain", "start_char_idx": 34913, "end_char_idx": 36154, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "32ca947c-58ec-4a9f-a1cc-ed4f4b294f16": {"__data__": {"id_": "32ca947c-58ec-4a9f-a1cc-ed4f4b294f16", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "329f478a-0baf-400a-b390-38bcf4d2e611", "node_type": "1", "metadata": {}, "hash": "097250894e93b6cf2b271829c649d472cfff0922421597ecd75d3ecfec2d042f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "18e1d441-c270-4186-84d6-8b9a8f84a225", "node_type": "1", "metadata": {}, "hash": "4cd3c07327939e11e206a4eca5f355cebd16c5ea21588e732af375fadd56e12d", "class_name": "RelatedNodeInfo"}}, "text": "```sh\nnpm run main-set-attestor\n```\n\n<pre class=\"language-sh\"><code class=\"lang-sh\">npm run main-set-attestor\n<strong># > the-graph-phat-contract@1.0.0 main-set-attestor\n</strong># > hardhat run --network polygon ./scripts/polygon/set-attestor.ts\n#\n# Setting attestor...\n# \ud83d\udea8NOTE\ud83d\udea8\n# Make sure to set the Consumer Contract Address in your Phat Contract 2.0 UI dashboard (https://bricks.phala.network)\n# - Go to the 'Configuration' tab and update the 'Client' box\n# - Set value to 0x0b9aC89924483077899d2B52bc8AF794F546a1e9\n# Done\n</code></pre>\n\nTry pushing a malform request to ensure failures behave appropriately.\n\n```sh\nnpm run main-push-malformed-request\n```\n\n```sh\nnpm run main-push-malformed-request\n# > the-graph-phat-contract@1.0.0 main-push-malformed-request\n# > hardhat run --network polygon ./scripts/polygon/push-malformed-request.ts\n#\n# Pushing a malformed request...\n# Done\n```\n\nWe can visualize the response from the Phat Contract in the Polygonscan block explorer.\n\n<figure><img src=\"../../../../.gitbook/assets/malform-request-pc-main.png\" alt=\"\"><figcaption></figcaption></figure>\n\nTest pushing a valid request that will get a valid reply of a trust score value for a `target` address.\n\n```sh\nnpm run main-push-request\n```\n\n```sh\nnpm run main-push-request\n# > the-graph-phat-contract@1.0.0 main-push-request\n# > hardhat run --network polygon ./scripts/polygon/push-request.ts\n#\n# Pushing a request...\n# Done\n```\n\nThe next 2 images will show the request to the Consumer Contract with a reply from the Phat Contract, and the last picture shows what the Phat Contract replied with.", "mimetype": "text/plain", "start_char_idx": 36156, "end_char_idx": 37750, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "18e1d441-c270-4186-84d6-8b9a8f84a225": {"__data__": {"id_": "18e1d441-c270-4186-84d6-8b9a8f84a225", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "32ca947c-58ec-4a9f-a1cc-ed4f4b294f16", "node_type": "1", "metadata": {}, "hash": "9c4ad978a4bd56baf0fe5e1b47c92ed9433b11d22650b0c22c5d2154fbe2e571", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "deb7c9f1-5c8f-4521-9f58-a10c05a16688", "node_type": "1", "metadata": {}, "hash": "ed8eed8cbb2f40d6e7de3e736252385519027b4c6f0d99c08e3217ec32321512", "class_name": "RelatedNodeInfo"}}, "text": "<figure><img src=\"../../../../.gitbook/assets/push-request-thegraph-main.png\" alt=\"\"><figcaption></figcaption></figure>\n\nHere is the emitted event `ResponseReceived` with the score `206` for `target` address `0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045` (aka vitalik.eth)\n\n<figure><img src=\"../../../../.gitbook/assets/thegraph-pc-reply-info-vitalik.png\" alt=\"\"><figcaption></figcaption></figure>\n\n#### Update Phat Contract on Phala Mainnet <a href=\"#user-content-update-phat-contract-on-phala-poc5-testnet\" id=\"user-content-update-phat-contract-on-phala-poc5-testnet\"></a>\n\nSometimes you may have had a bug in your script or you want to test things out on the fly without deploying a whole new Phat Contract. The `npx @phala/fn update` command will update your Phat Contract easily in the command line.&#x20;\n\nNow let's update the Phat Contract:\n\n```bash\n# If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn update --mode=production\n# If polkadot-account.json is in the root of project\nnpx @phala/fn update --mode=production -a ./polkadot-account.json\n```\n\n<pre class=\"language-bash\"><code class=\"lang-bash\">npx @phala/fn update --mode=production -a ./polkadot-account.json\n<strong># ? Please Enter hahaha account password [hidden]\n</strong># \u2713 Compiled successfully.\n# \u2713 Connected to the endpoint: wss://api.phala.network/ws\n# \u2713 Your Brick Profile contract ID: 0x6e96d8c209fc14b69533e3627c4766b6eeef8f77a25348b2d77b28c90b0bd012\n# \u2713 The JavaScript code for workflow 0 has been updated.\n</code></pre>\n\n:tada: **Congratulations!** You have now completed a full mainnet deployment and have a fully functional Phat Contract connected to The Graph to compute a score and return to your EVM Consumer Contract.", "mimetype": "text/plain", "start_char_idx": 37752, "end_char_idx": 39520, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "deb7c9f1-5c8f-4521-9f58-a10c05a16688": {"__data__": {"id_": "deb7c9f1-5c8f-4521-9f58-a10c05a16688", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22", "node_type": "4", "metadata": {}, "hash": "8ec885ee3b7da7767588a8fd945d09f914c2b3f7140e61ac0aa7e3951984c39a", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "18e1d441-c270-4186-84d6-8b9a8f84a225", "node_type": "1", "metadata": {}, "hash": "4cd3c07327939e11e206a4eca5f355cebd16c5ea21588e732af375fadd56e12d", "class_name": "RelatedNodeInfo"}}, "text": "{% endtab %}\n{% endtabs %}", "mimetype": "text/plain", "start_char_idx": 39521, "end_char_idx": 39547, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d154e78b-9763-4aa9-8eb3-0af6b556c6c1": {"__data__": {"id_": "d154e78b-9763-4aa9-8eb3-0af6b556c6c1", "embedding": null, "metadata": {"file_path": "phala-docs_dist/phala-network.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "457f4450-af45-4315-a5ae-6132b1516166", "node_type": "4", "metadata": {}, "hash": "6141f4e733803fdb78fe6cff99250eb422ec33422b759c66a51f1e642a364674", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "cc7d6f03-602b-4ee7-bc4b-20417c24cb89", "node_type": "1", "metadata": {}, "hash": "61eb94fa00fdfd97c3443f45b5801a4da16119c28a270187025182a860f18fb2", "class_name": "RelatedNodeInfo"}}, "text": "# \u2696\ufe0f Phala Network\n\nPhala Network is the Execution Layer for Web3 AI. By enabling AI to understand and interact with blockchains, it unlocks the barrier for the first billion users to join web3.\n\n### The Missing AI Execution Layer\n\nWeb3 is complex. You often need to use multiple wallets across a few blockchains and dapps to complete a basic task. For example, buying a NFT may involve swapping, bridging, and purchasing. This complexity is the biggest barrier of mass adoption.\n\nAI can greatly improve the web3 user experience. Imagine that AI can do its own research, and go one step further to delegate every operation for you. You can simply give instructions and wait them to be done. This is where AI Agent projects like Autonolas, Polywrap, fetch.ai (and more) can help.\n\nHowever, none of the existing AI Agents is smart contract centric. They cannot execute smart contract operations securely and autonomously, due to its off-chain nature. The missing AI Execution Layer Agents is preventing developers from creating smart contracts centric AI Agents.\n\n### Our Solution\n\nPhala Network's multi-proof system is the answer to the AI execution problem. On top of the Phala Network, you can easily build tamper-proof and unstoppable AI Agents that closely integrated with on-chain smart contracts.\n\nPhala offers the full toolkits to help you build, ship, and profit from your smart contract centric AI Agents.\n\n<figure><img src=\"../.gitbook/assets/Phala-AI-Agent-Contract-HLD.png\" alt=\"\"><figcaption></figcaption></figure>\n\n### AI Agent Contract\n\nAI Agent Contract allows you to build your smart contract centric AI Agents in three steps:\n\n1. **Agentize smart contracts**: Create smart contract centric AI Agents for popular web3 services and smart contracts. \"**Regulate**\" your AI Agents through a DAO to enforce business logic for your agents.&#x20;\n2. **Connect to the internet of multi-agents**: Make your agents accessible by other cross-platform AI Agents deployed on Autonolas, FLock.io, Morpheus, Polywrap, etc.\n3. **Launch and get incentivized**: Own your agents and build a profitable tokenomic through our default tokenomic model or customize your own.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2168, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "cc7d6f03-602b-4ee7-bc4b-20417c24cb89": {"__data__": {"id_": "cc7d6f03-602b-4ee7-bc4b-20417c24cb89", "embedding": null, "metadata": {"file_path": "phala-docs_dist/phala-network.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "457f4450-af45-4315-a5ae-6132b1516166", "node_type": "4", "metadata": {}, "hash": "6141f4e733803fdb78fe6cff99250eb422ec33422b759c66a51f1e642a364674", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d154e78b-9763-4aa9-8eb3-0af6b556c6c1", "node_type": "1", "metadata": {}, "hash": "d94f209a5ba20f2872713e343e9b9f3b4943b92df2fee0f520d76a2f97617009", "class_name": "RelatedNodeInfo"}}, "text": "To learn more about AI Agent Contract: [getting-started](../ai-agent-contract/getting-started/ \"mention\")\n\nTo learn more about launching agents with tokenomics: [agent-wars-introduction.md](../agent-wars/agent-wars-introduction.md \"mention\")", "mimetype": "text/plain", "start_char_idx": 2170, "end_char_idx": 2411, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ca3fce4d-56dd-43ef-8b49-503b01f29315": {"__data__": {"id_": "ca3fce4d-56dd-43ef-8b49-503b01f29315", "embedding": null, "metadata": {"file_path": "phala-docs_dist/using-prbv3-ui.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "36b6c17a-7b40-451a-b619-a1d4cfe9fba4", "node_type": "4", "metadata": {}, "hash": "95a129309126eea16b6c36c63f7830713372ba83858069306e7b7b411bb9115d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "3feaa4c6-1e23-4a0c-9df4-ce75ab17a2fb", "node_type": "1", "metadata": {}, "hash": "224fd88ce8eb19bfb1e75345b2f2f5e51d60e331dd5c0cd5bcca701c75b6b56e", "class_name": "RelatedNodeInfo"}}, "text": "# Using PRBv3 UI\n\nYou can configure StakePool, Pool operator, and worker information by using the PRBv3 UI, and can also check the running status of workers, and perform related error diagnosis there.\n\n## Login\n\nAccess the PRB UI by going to http://localhost:3000/. Replace localhost with the IP of the PRB Server.\n\n> If you are accessing this page from an external network, please note to check the firewall configuration of the PRB server.\n\n## Data configuration on PRBv3 UI\n\n### StakePool Configuration\n\nClick `Pools` in `Inventory` to jump to the StakePool configuration interface.\n\n* Click `Add` button\n* Enter `PID` of the StakePool and your custom name for it\n* Click `confirm`\n\nThis completes the input of StakePool information.\n\n### Pool Operator Configuration\n\nClick `Pool Operators` in `Inventory` to jump to the Operator configuration interface.\n\n* Click `Set` button.\n* Enter `PID` of the StakePool.\n* Select `seed` for `Account Type`.\n* If your operator account does not use the proxy method, enter the mnemonic of the operator in the `Account` section; leave `Proxied Account (SS58)` empty.\n* If your operator account uses the proxy method, enter the mnemonic of the authorized gas fee account in the `Account` section; enter the real pool operator\u2019s account address in `Proxied Account (SS58)`.\n* Click `confirm`.\n\nThis completes the input of Pool operator information.\n\n### Worker Configuration\n\nClick `Workers` in `Inventory` to jump to the Worker configuration interface.\n\n* Click `Add` button\n* Enter your custom name for the Worker and the desired `PID` for the worker\n* Enter the worker\u2019s endpoint in the format http://{pRuntime-ip}:8000/. Replace {pRuntime-ip} with the IP of the worker.\n* Enter the desired worker staking amount and add 12 zeros after the number. For example, `5000000000000000` means a staking value of `5000`.\n* Click `confirm`\n\nThis completes the input of Worker information.\n\n> Similar to PRBv2, PRBv3 supports multi-mode worker synchronization.\n\nIf you choose the `SyncOnly` mode, the worker will only participate in synchronization and will not register worker\u2019s information on chain after reaching the maximum height.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2165, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "3feaa4c6-1e23-4a0c-9df4-ce75ab17a2fb": {"__data__": {"id_": "3feaa4c6-1e23-4a0c-9df4-ce75ab17a2fb", "embedding": null, "metadata": {"file_path": "phala-docs_dist/using-prbv3-ui.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "36b6c17a-7b40-451a-b619-a1d4cfe9fba4", "node_type": "4", "metadata": {}, "hash": "95a129309126eea16b6c36c63f7830713372ba83858069306e7b7b411bb9115d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ca3fce4d-56dd-43ef-8b49-503b01f29315", "node_type": "1", "metadata": {}, "hash": "30fe8b838a0688b5ad63e4d3bbfa1606baa342cf4461aef08ce1da59195f3743", "class_name": "RelatedNodeInfo"}}, "text": "There is a similar option in StakePool configuration page, and they are the same functions.\n\n> Additionally, PRBv3 has added `GateKeeper` mode, allowing you to deploy GateKeeper with PRBv3.\n\n\u2022 The GateKeeper reward function as originally planned in the tokenomics is not yet enabled; Therefore, if you deploy GateKeeper, you will not receive any rewards. \u2022 GateKeeper cannot be added to StakePool for computation contributing. \u2022 After GateKeeper synchronization is completed, the operator needs to initiate an on-chain proposal and complete GK registration through community referendum before it can start running. The specific registration transaction is:phalaRegistry.registerGatekeeper(gatekeeper)\n\n## Start running\n\nAfter all information is configured, click the `Restart WM` and then click the `reload` button in the upper left corner of the page. The new configuration information will be loaded, and PRBv3 will start working.\n\n## Status check\n\nClick `Workers` in `Status` to check the synchronization status of all workers and manage workers using the `restart` and `re-register` buttons.\n\nClick `Transactions` in `Status` to check the transaction records sent by the PRB and confirm the details.", "mimetype": "text/plain", "start_char_idx": 2166, "end_char_idx": 3369, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0fc46bee-4d83-4d62-be47-97111726af69": {"__data__": {"id_": "0fc46bee-4d83-4d62-be47-97111726af69", "embedding": null, "metadata": {"file_path": "phala-docs_dist/token-gated-access.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7209c06f-72f8-42c9-8d9e-80f68146862a", "node_type": "4", "metadata": {}, "hash": "d4d95b42502fafbf46abee6f80c19e7951b1dc16101c4d0ff0725890bb003376", "class_name": "RelatedNodeInfo"}}, "text": "# Token Gated Access\n\n<figure><img src=\"../../.gitbook/assets/WIP.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 112, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "bc28a4b4-53bb-420b-8d39-53fa81e180f1": {"__data__": {"id_": "bc28a4b4-53bb-420b-8d39-53fa81e180f1", "embedding": null, "metadata": {"file_path": "phala-docs_dist/airstack-agent.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fa07fe36-2da4-4504-9464-1c4578676764", "node_type": "4", "metadata": {}, "hash": "4fc3e43f7943f5c48fd191874c870a1a0ca47f86641f1e4c7a41e142f6781b53", "class_name": "RelatedNodeInfo"}}, "text": "# \u2708\ufe0f Airstack Agent\n\n<figure><img src=\"../../.gitbook/assets/AirStack.png\" alt=\"\" width=\"563\"><figcaption></figcaption></figure>\n\nThe Airstack template allows for users to request data from Airstack\u2019s API to compute a trust/risk score and send to an on-chain consumer contract.\n\n## Requirements Before Deployment\n\n* Create API Key from Airstack. See how to get an API Key [here](https://bit.ly/airstack-api-key). By default a rate-limited key is provided with no guarantee of service if limit is exhausted.\n\n## Features and Benefits\n\nWith the ability to bring Airstack\u2019s data on-chain with customized logic performed on the data, developers can now securely connect their indexed data to their web3 dApps. There are many features and benefits that can be built. For example:\n\n* Web3 Social\n  * Spam Filter\n  * Recommendation Engine\n  * Trust Score\n  * Web3 Social Actions based on data from Airstack\u2019s API\n* Token Gating\n* Web3 Marketing Technology, etc.\n\n## Resources\n\n* [Airstack AI Agent Contract Code Template](https://bit.ly/pc-airstack-repo)\n* [Airstack Docs](https://docs.airstack.xyz/airstack-docs-and-faqs/)", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1116, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5d762a68-d8fa-46e6-bd2e-459692d7f32c": {"__data__": {"id_": "5d762a68-d8fa-46e6-bd2e-459692d7f32c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/troubleshooting.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "39bb7120-2ae2-4bd2-acf2-17669962abc2", "node_type": "4", "metadata": {}, "hash": "d636698ec846581f7c9a13ce86a549fed0ad918c44335c84aa0ac4798012fa2e", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ca0202e0-57e6-4858-a28f-fd7d2c8c42ec", "node_type": "1", "metadata": {}, "hash": "b59d169e48ca3cbbb55e3f56950663f4ea00615a245eff43a2baf1646177cf85", "class_name": "RelatedNodeInfo"}}, "text": "# Troubleshooting\n\n## Quick Links <a href=\"#quick-links\" id=\"quick-links\"></a>\n\n[General](https://github.com/Phala-Network/solo-mining-scripts#navigate) | [Investigate](https://github.com/Phala-Network/solo-mining-scripts#investigating-the-issue) | [Confidence Level](https://wiki.phala.network/en-us/mine/solo/4-0-faq/#confidence-level) | [Stuck Worker](https://github.com/Phala-Network/solo-mining-scripts/tree/main#khala-node-stops-synching) | [Forum](https://forum.phala.network/c/mai/42-category/42)\n\n\\\n\ud83d\udc47 You can also join our Discord or Telegram worker group to discuss your issue. \ud83d\udc47\n\n* [Discord](https://discord.gg/C6E4hQjk)\n* [Telegram](https://t.me/phalaworker)\n* [Forum](https://forum.phala.network/c/mai/42-category/42)\n* [GitHub](https://github.com/Phala-Network/solo-mining-scripts)\n\n## General <a href=\"#general\" id=\"general\"></a>\n\nMost symptoms are solved by restarting your node. If you experience issues running your node, try stopping the node by:\n\n```\nsudo phala stop\n```\n\nAnd attempt a restart with\n\n```\nsudo phala start\n```\n\nIf you still have issues attempt to [update the script](solo-scripts-guidance/update-your-workers-node.md).\n\n## Investigating the Issue <a href=\"#investigating-the-issue\" id=\"investigating-the-issue\"></a>\n\nGet an overview of your worker\u2019s status first.\n\n```\nsudo phala status\n```\n\nIn case your node is stuck, a typical scenario would look like the following:\n\n<figure><img src=\"https://user-images.githubusercontent.com/37558304/147273109-d4d1d5e3-5098-43d1-99f5-2ba995ecd1b6.png\" alt=\"\"><figcaption></figcaption></figure>\n\n(image showing stuck node on the worker)\n\nWith the symptom in the scenario above, the right method to solve the issue would be restarting the `node` container only, with the commands mentioned [here](troubleshooting.md#general), and restarting the containers.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1829, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ca0202e0-57e6-4858-a28f-fd7d2c8c42ec": {"__data__": {"id_": "ca0202e0-57e6-4858-a28f-fd7d2c8c42ec", "embedding": null, "metadata": {"file_path": "phala-docs_dist/troubleshooting.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "39bb7120-2ae2-4bd2-acf2-17669962abc2", "node_type": "4", "metadata": {}, "hash": "d636698ec846581f7c9a13ce86a549fed0ad918c44335c84aa0ac4798012fa2e", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5d762a68-d8fa-46e6-bd2e-459692d7f32c", "node_type": "1", "metadata": {}, "hash": "cc668ce9ca4f96d6d44fe2b7a1e81623bc4bc205f34a0625e8dd510c73ff0170", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "710f3060-0d74-4fbc-8f9b-114dd4486236", "node_type": "1", "metadata": {}, "hash": "e8c80295f491f5c2d13d80641125b88a2c054e2a63920310f047c45f3ee87a87", "class_name": "RelatedNodeInfo"}}, "text": "Now check the status of the node again.\n\nIf the local node block height is empty first, check if all required containers are running.\n\n```\nsudo docker ps\n```\n\nYou should have three containers running as shown in this example:\n\n<figure><img src=\"https://user-images.githubusercontent.com/37558304/145825263-50d69b7e-a7e1-45c9-9eca-cc2d7d3a6b69.png\" alt=\"\"><figcaption></figcaption></figure>\n\n(image showing the worker node\u2019s running docker containers)\n\nTo get the most recent logs of each container, you may execute:\n\n```\ndocker logs <container_ID/container_name> -n 100 -f\n```\n\nNote that `<container_ID/container_name>` must be replaced with the container you wish the receive the logs from. In the example above the `container_ID` is `8dc34f63861e` and `container_name` would be `phala-pherry`.\n\n\\\nIf you attempt to post on the phala forum and do not know where the issue lies, please post the logs of all three docker containers. Copy-paste the container logs from the terminal into the forum post.\n\n### < 3 running containers <a href=\"#3-running-containers\" id=\"3-running-containers\"></a>\n\nIf a container is missing (<3 are running), you may attempt to restart it separately with the respective commands below.\n\n> Use the applicable command to restart your missing container.\n\n```\nsudo phala start node\n```\n\n```\nsudo phala start pruntime\n```\n\n```\nsudo phala start pherry\n```\n\n## Advanced Troubleshooting <a href=\"#advanced-troubleshooting\" id=\"advanced-troubleshooting\"></a>\n\nIn some cases, it might be beter to reinstall the mining script. To do this, first uninstall the script:\n\n```\nsudo phala uninstall\n```\n\nAnd delete the mining script repository by executing:\n\n```\nrm -rf $HOME/solo-mining-scripts-main\n```\n\nNow you may reinstall the mining script.", "mimetype": "text/plain", "start_char_idx": 1831, "end_char_idx": 3588, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "710f3060-0d74-4fbc-8f9b-114dd4486236": {"__data__": {"id_": "710f3060-0d74-4fbc-8f9b-114dd4486236", "embedding": null, "metadata": {"file_path": "phala-docs_dist/troubleshooting.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "39bb7120-2ae2-4bd2-acf2-17669962abc2", "node_type": "4", "metadata": {}, "hash": "d636698ec846581f7c9a13ce86a549fed0ad918c44335c84aa0ac4798012fa2e", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ca0202e0-57e6-4858-a28f-fd7d2c8c42ec", "node_type": "1", "metadata": {}, "hash": "b59d169e48ca3cbbb55e3f56950663f4ea00615a245eff43a2baf1646177cf85", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b26b2cf8-39da-4a82-a4c8-7e99d1a6d232", "node_type": "1", "metadata": {}, "hash": "b88f1c8aab3051699d5da47643ec3b073f36ace8d8eff5910b932a30a12a5351", "class_name": "RelatedNodeInfo"}}, "text": "```\nsudo apt update && sudo apt upgrade -y && sudo apt autoremove -y\nsudo apt install wget unzip\ncd ~\n```\n\n```\nwget https://github.com/Phala-Network/solo-mining-scripts/archive/refs/heads/main.zip\nunzip main.zip\nrm -r main.zip #cleaning up the installation\ncd solo-mining-scripts-main/ #note this depends on your current directory\nsudo ./phala.sh install\n```\n\nYou may now [restart your node](troubleshooting.md#general).\n\n## Peer Connectivity <a href=\"#peer-connectivity\" id=\"peer-connectivity\"></a>\n\nSome users running nodes may find their nodes are struggling to connect to peers, which causes nodes to be dropped from the network. You can check your node connections through executing:\n\n```\nsudo docker logs -f phala-node\n```\n\nFor an optimal setup, you should have between 40 and 50 peers.\n\nIf you have insufficient peers do the following:\n\n* Check your firewall settings\n* Ensure there are no NAT or Policy-based filters\n\nFeel free to read [NAT](https://en.wikipedia.org/wiki/Network\\_address\\_translation) for more information if you are curious about the root causes. Also, do not hesitate to look for existing [Phala forum posts](https://forum.phala.network/c/mai/42-category/42) before posing your issue if you are stuck.\n\n## Driver Issues <a href=\"#driver-issues\" id=\"driver-issues\"></a>\n\n### DCAP driver Installation <a href=\"#dcap-driver-installation\" id=\"dcap-driver-installation\"></a>\n\n\u2139\ufe0f The most common issue is that your motherboard may not support a DCAP driver. In this case, the script cannot automatically install the `isgx` driver and results in the following error message.", "mimetype": "text/plain", "start_char_idx": 3590, "end_char_idx": 5185, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b26b2cf8-39da-4a82-a4c8-7e99d1a6d232": {"__data__": {"id_": "b26b2cf8-39da-4a82-a4c8-7e99d1a6d232", "embedding": null, "metadata": {"file_path": "phala-docs_dist/troubleshooting.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "39bb7120-2ae2-4bd2-acf2-17669962abc2", "node_type": "4", "metadata": {}, "hash": "d636698ec846581f7c9a13ce86a549fed0ad918c44335c84aa0ac4798012fa2e", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "710f3060-0d74-4fbc-8f9b-114dd4486236", "node_type": "1", "metadata": {}, "hash": "e8c80295f491f5c2d13d80641125b88a2c054e2a63920310f047c45f3ee87a87", "class_name": "RelatedNodeInfo"}}, "text": "<figure><img src=\"https://user-images.githubusercontent.com/37558304/143471619-1116c12f-7ef5-4313-93a5-51f3ed30c355.png\" alt=\"\"><figcaption></figcaption></figure>\n\n(image of the terminal showing the DCAP driver error message)\n\nIn this case, prior to running `sudo phala start`, you need to manually install the `isgx` driver:\n\n```\nsudo phala install isgx\n```\n\n## Khala Node Stops Synching <a href=\"#khala-node-stops-synching\" id=\"khala-node-stops-synching\"></a>\n\nIf the Khala Chain stops synching and is stuck at a specific block and does not continue to sync, we advise you first to [restart your node](troubleshooting.md#general).\n\nIf the synchronization still fails, you may try to delete the khala chain database on your worker\u2019s node. It is located in `/var/khala-dev-node/chains/khala`.\n\n<figure><img src=\"https://user-images.githubusercontent.com/37558304/143770078-26a3c457-ce1d-447c-8e26-81ea0e1beb9b.png\" alt=\"\"><figcaption></figcaption></figure>\n\n(image showing the khala blockchain files of the worker node)\n\nIt is located in `/var/khala-dev-node/chains/khala`.\n\nFirst, stop your node with:\n\n```\nsudo phala stop\n```\n\nTo delete the khala blockchain database on your node, execute the following commands:\n\n```\nrm -rf /var/khala-dev-node/chains/khala\n```\n\nTo delete the Kusama blockchain , run:\n\n```\nrm -rf /var/khala-dev-node/chains/polkadot\n```\n\n## Deleting the Mining Scripts <a href=\"#deleting-the-mining-scripts\" id=\"deleting-the-mining-scripts\"></a>\n\nIf you encounter any issues uninstalling the mining scripts and all dependencies except the drivers, you may delete them by executing the following commands:\n\n```\nsudo rm -r /opt/phala\nsudo rm -r ~/solo-mining-scripts-main\nsudo rm ~/main.zip\n```\n\nYou can [follow this tutorial](./) to redownload and reinstall the new phala mining scripts.", "mimetype": "text/plain", "start_char_idx": 5187, "end_char_idx": 6992, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "917b662a-4b10-46fc-9d92-9931ad8e016d": {"__data__": {"id_": "917b662a-4b10-46fc-9d92-9931ad8e016d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/rent-hardware.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "063335c8-e881-45cb-8e4f-3991603da90d", "node_type": "4", "metadata": {}, "hash": "cd2423d7ed9d5099c01109075eff8d840961a2c987d0fb0c320498223062d1c2", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "227aea20-0ed4-488e-b0fa-8999ccc4b22c", "node_type": "1", "metadata": {}, "hash": "80ab3a484f4961550472fd12ba415d1239ec793427b6fc7818d3fa5088b69dcf", "class_name": "RelatedNodeInfo"}}, "text": "# Rent Hardware\n\n## Worker on Vultr <a href=\"#khala-worker-on-vultr\" id=\"khala-worker-on-vultr\"></a>\n\n> This guide will show you how to set up your worker on the `VULTR Bare Metal Simplified\u2122 Intel E-2286G` Instance. For mining on your own hardware check our guide [here](requirements-in-phala-khala.md).\n\n## Before Getting Started <a href=\"#before-getting-started\" id=\"before-getting-started\"></a>\n\n1. Sign up on [ ](https://www.vultr.com/?ref=9108833-8H)[Vultr](https://vultr.com/).\n2. Enter your [billing information](https://my.vultr.com/billing/).\n3. Request to [increase your limit](https://my.vultr.com/billing/#billinglimits) may be required.\n\n> Increasing the credit depends on the cloud provider\u2019s support\u2019s response time.\n\n## Deploy Instance <a href=\"#deploy-instance\" id=\"deploy-instance\"></a>\n\nAfter successfully signing up and increasing your credit limit, it is time to pick the correct instance.\n\n* Go to [Deploy](https://my.vultr.com/deploy/)\n  * Select \u2018Bare Metal\u2019\n  * Pick an available location geographically closest to you.\n  * Select `Intel E-2286G`\n  * Choose the 64 bit OS Ubuntu 21.10 x64\n  * Leave any remaining options as default.\n  * Add a meaningful \u2018Server Hostname & Label\u2019\n  * You are ready to hit \u2018Deploy Now\u2019\n  * Wait for 5-15 minutes: Get a cup of coffee \u2615 until your instance is ready\n\n## Instance Settings <a href=\"#instance-settings\" id=\"instance-settings\"></a>\n\nOnce your new instance is displayed as \u2018Running,\u2019 there are currently no additional steps required to adjust the machine\u2019s BIOS. The instance works out of the box.\n\n> _Optional:_ To optimize the worker\u2019s score, you can reboot the instance, head over to the console, and enter the BIOS with F11, to adjust the BIOS settings mentioned in this [guide](requirements-in-phala-khala.md#os-requirements).\n\nYou can get the correct drivers from our guide here under the Ubuntu 21.10 tab.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1880, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "227aea20-0ed4-488e-b0fa-8999ccc4b22c": {"__data__": {"id_": "227aea20-0ed4-488e-b0fa-8999ccc4b22c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/rent-hardware.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "063335c8-e881-45cb-8e4f-3991603da90d", "node_type": "4", "metadata": {}, "hash": "cd2423d7ed9d5099c01109075eff8d840961a2c987d0fb0c320498223062d1c2", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "917b662a-4b10-46fc-9d92-9931ad8e016d", "node_type": "1", "metadata": {}, "hash": "74e1980dae91da260c0419ac818fcadb2252efc13c79ef402a13fe8c2518cafd", "class_name": "RelatedNodeInfo"}}, "text": "Once the drivers are installed, you may now turn your instance into a Phala worker.\\\n\ud83d\udc49 [Get mining scripts](../run-workers-on-khala/solo-scripts-guidance/installing-phala-mining-tools.md)", "mimetype": "text/plain", "start_char_idx": 1882, "end_char_idx": 2069, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5eef2db4-c43b-4be2-b567-e6213a7ea6a3": {"__data__": {"id_": "5eef2db4-c43b-4be2-b567-e6213a7ea6a3", "embedding": null, "metadata": {"file_path": "phala-docs_dist/publish-agent-script.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e614e01a-2b10-470f-99fd-186db26545c1", "node_type": "4", "metadata": {}, "hash": "c4aa4e6594c876049c517a97a06aecee647aacc01fc424390fd0f8870c815112", "class_name": "RelatedNodeInfo"}}, "text": "# Publish Agent Script\n\n:construction\\_site: Work In Progress\n\n<figure><img src=\"../../.gitbook/assets/Agent-Script.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 162, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d6083096-5cdb-427b-b379-d329c8a2cace": {"__data__": {"id_": "d6083096-5cdb-427b-b379-d329c8a2cace", "embedding": null, "metadata": {"file_path": "phala-docs_dist/migration-from-prbv2-to-v3.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e5b44697-e508-4ed7-867c-ac90455e7e20", "node_type": "4", "metadata": {}, "hash": "3899dc037aa0fdf47b4aa041153c5b436fe67a2fb8e2d439f1e20a6aca4c3614", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f263413e-0d60-4341-8146-bbee4acd18b4", "node_type": "1", "metadata": {}, "hash": "206458046ec54c147174416017233db9521fbc997e3553608930b9dc16f79661", "class_name": "RelatedNodeInfo"}}, "text": "# Migration from PRBv2 to v3\n\nThis guide will show you how to migrate a PRBv2 deployment to PRBv3 using Docker Compose.\n\n### Deploy PRBv3\n\nFirst, you should create a clean PRBv3 deployment by referring to this page: [PRBv3 Deployment Guide](../run-workers-on-phala/prbv3-deployment.md)\n\nMake sure it's running and the `wm` should be running and listening on port 3001 by default.\n\n### Update PRBv2 docker image\n\nCheck your `.yml` file of PRBv2 and set the docker image of `lifecycle` component to `phalanetwork/prb:git-current-v2` to receive the bundled migration script.\n\nIn the `lifecycle` , the component\u2019s docker-compose configuration file should be like:\n\n```yaml\nlifecycle:\n    network_mode: host\n    image: phalanetwork/prb:git-current-v2\n\t\t# leave other things as is\n```\n\nThen run `sudo docker compose pull`.\n\nYour will see the `lifecycle should pull a new image and restart.`\n\n### Run the migration script\n\nIn the docker-compose folder of PRBv2's `lifecycle` component, run:\n\n```bash\ndocker compose down\n# Change PRB3_API_ENDPOINT to your actual endpoint of prb3-wm\ndocker compose run -e \"PRB3_API_ENDPOINT=http://127.0.0.1:3001\" --entrypoint \"yarn migrate_to_prb3\" lifecycle\n```\n\nTo stop the PRBv2 and to run the migration script.\n\n> There you should use the same endpoint of what you wrote in wm.yml to replace the \\`http://127.0.0.1:3001\\`.\n\nNow the migration is done, just waiting for the worker's beginning to start.\n\n### Limitations of Migration\n\n#### Duplicated worker name\n\nBefore Migration, you must ensure that there can be no duplicate items in the names of the pools and workers. Includes but is not limited to worker names being equal to pool names.\n\n#### PID #0 error\n\nPRBv2 supports PID #0, but PRBv3 does not support it.\n\nThis makes the migration fail if you want to migrate PID #0 from PRBv2 to PRBv3.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1827, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f263413e-0d60-4341-8146-bbee4acd18b4": {"__data__": {"id_": "f263413e-0d60-4341-8146-bbee4acd18b4", "embedding": null, "metadata": {"file_path": "phala-docs_dist/migration-from-prbv2-to-v3.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e5b44697-e508-4ed7-867c-ac90455e7e20", "node_type": "4", "metadata": {}, "hash": "3899dc037aa0fdf47b4aa041153c5b436fe67a2fb8e2d439f1e20a6aca4c3614", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d6083096-5cdb-427b-b379-d329c8a2cace", "node_type": "1", "metadata": {}, "hash": "2f7206375159141c023cda9db5cfcc8a41a448e0166eb553dddbd885f32bf970", "class_name": "RelatedNodeInfo"}}, "text": "#### Database conflicts\n\nIf your PRBv3 is running and migration from PRBv2 is also necessary. Before your migration, check it to avoid the 2 limitations above.\n\nIf your PRBv3 is brand new but may have some test data or you failed to migrate before, the previous test data or half-imported dirty data will result in poor synchronization results. Therefore, you need to:\n\n* First, stop PRBv3 by `sudo docker compose down`\n* Delete the `inv` and `po` folders.\n* Start the normal synchronization process from the start of this article.", "mimetype": "text/plain", "start_char_idx": 1829, "end_char_idx": 2360, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7dde3b5c-3b95-4202-8c15-e1989fab1f69": {"__data__": {"id_": "7dde3b5c-3b95-4202-8c15-e1989fab1f69", "embedding": null, "metadata": {"file_path": "phala-docs_dist/headers-cache-deployment.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "b0cf9fd8-85af-49c5-93ad-d34e816ba45b", "node_type": "4", "metadata": {}, "hash": "77114117e08fa5613d331a00efc29d6e6aa547d017f6875c6105563535a2b31d", "class_name": "RelatedNodeInfo"}}, "text": "# Headers-cache deployment\n\n## What's the Header-cache\n\nThe headers-cache is a component that stores the header of each block. The block header includes important information such as previous block hash, timestamp, nonce, and so on, representing all the transactions in the block.\n\nCaching block headers can improve efficiency when downloading and synchronizing with the network, once you are using a pherry or PRB to sync the pRuntime, add a headers-cache between them will significantly reduce the sync period.\n\n## Headers-cache requirements\n\n* 2GB of memory\n* 200GB NVME - for Phala headers-cache; 500GB NVME for Khala headers-cache\n* A completely synced full node is necessary\n\n## Steps for deployment\n\n### Preparations\n\nCreate a folder locally, and create a docker-compose document within it.\n\n```\nmkdir headers-cache\ncd ./headers-cache\ntouch docker-compose.yml\n```\n\n### Document Editing\n\nUse the following command to edit the docker-compose.yml document.\n\n```bash\nvim ./docker-compose.yml \n```\n\nEnter `a` and you will start editing the document. Paste the following content into the document. (Please note that the file content remains consistent and the indentation alignment of each line is consistent with this document)\n\n```\nversion: \"3\"\nservices:\n  khala-headers-cache:\n    image: phalanetwork/headers-cache:latest\n    container_name: khala-headers-cache\n    network_mode: host\n    restart: always\n    environment:\n      - ROCKET_PORT=22111\n      - ROCKET_ADDRESS=0.0.0.0\n      - RUST_LOG=info\n    command:\n      - serve\n      - --grab-headers\n      - --node-uri=ws://{node_ip}:9945\n      - --para-node-uri=ws://{node_ip}:9944\n      - --interval=60\n    volumes:\n      - ./phala-headers-cache-public:/opt/headers-cache/data\n```\n\nAfter entering, complete the following steps to finish the text editing and save successfully.\n\n```javascript\n1\u3001Click \"esc\"\n2\u3001Enter \":wq\"\n3\u3001Click \"Enter\"\uff0cquit the editing page\n```\n\n### Program Execution\n\nInside the newly created folder `headers-cache`, run the docker-compose, and the essential components for PRB will run successfully.\n\n```\nsudo docker compose up -d\n```", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2110, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b17b28ec-0fba-40e3-948d-cb51077d9d1f": {"__data__": {"id_": "b17b28ec-0fba-40e3-948d-cb51077d9d1f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/faq.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "969f6e90-aae7-4103-909d-6c883a2558d3", "node_type": "4", "metadata": {}, "hash": "d958cb77d2aac88b7e3e0504208f0a73242eda0d2e224b47790c0d92d7a3e6b8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "3ff0b9d9-f2e3-4c33-b40d-aecb3b386fde", "node_type": "1", "metadata": {}, "hash": "bce081a822986c2e185b89c5742b5560cd3a47a82af808ebc5fc1114fca048ba", "class_name": "RelatedNodeInfo"}}, "text": "# \u2049\ufe0f FAQ\n\n## :page\\_facing\\_up: (Legacy) Phat Contract Development <a href=\"#how-to-set-arguments-when-instantiating-the-contract-in-phat-contract-ui\" id=\"how-to-set-arguments-when-instantiating-the-contract-in-phat-contract-ui\"></a>\n\n***\n\n### How can I set arguments when instantiating the contract in Phat Contract UI? <a href=\"#how-to-set-arguments-when-instantiating-the-contract-in-phat-contract-ui\" id=\"how-to-set-arguments-when-instantiating-the-contract-in-phat-contract-ui\"></a>\n\n***\n\n* Currently the Phat Contract Console does not support specifying arguments during contract instantiation\n* **Workaround**: you can implement a `config(&mut self, argument0, ...)` function and set the contract state with transactions after the instantiation\n\n### Phat UI reports an error before deploying the contract. <a href=\"#phat-ui-reports-an-error-before-deploying-the-contract\" id=\"phat-ui-reports-an-error-before-deploying-the-contract\"></a>\n\n***\n\nThe Phat UI checks the contract\u2019s validity before uploading it to the cluster. However, sometimes the contract output by `cargo-contract` may be invalid. We\u2019ve listed common errors and solutions below:\n\n#### **Error: gas instrumentation failed: unsupported instruction: F32Load(2, 4)**\n\nor sometimes \u201cuse of floating point type in locals is forbidden\u201d\n\nThis error occurs when the contract or its dependencies use floating point operations not allowed by the ink runtime.\n\n* To find the source of the problem, try recompiling the contract with `--keep-debug-symbols`, then convert the wasm file to wat using `wasm2wat my_contract.wasm > my_contract.wat`, and search for `f32` or `f64` in my\\_contract.wat to find the function using these instructions.\n* If the floating point operations are necessary, see the section [\u201cHow to do floating point calculations\u201d](../developers/support/broken-reference/) for more information.\n\n#### **Error: sign extension operations support is not enabled**\n\nUpgrade cargo-contract to version 1.5.2 or higher once [this PR](https://github.com/paritytech/cargo-contract/pull/904) has been merged.\n\n### Avoiding FP Instructions in JSON Parsing.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2122, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "3ff0b9d9-f2e3-4c33-b40d-aecb3b386fde": {"__data__": {"id_": "3ff0b9d9-f2e3-4c33-b40d-aecb3b386fde", "embedding": null, "metadata": {"file_path": "phala-docs_dist/faq.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "969f6e90-aae7-4103-909d-6c883a2558d3", "node_type": "4", "metadata": {}, "hash": "d958cb77d2aac88b7e3e0504208f0a73242eda0d2e224b47790c0d92d7a3e6b8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b17b28ec-0fba-40e3-948d-cb51077d9d1f", "node_type": "1", "metadata": {}, "hash": "0b8114d572178832606f7e2ba854551cd88821b1e841ab0eb948d816ac781ac8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a914a65f-5c9d-466e-aa7c-d58618339303", "node_type": "1", "metadata": {}, "hash": "a7afb925c74886ebd79bc4323677a82f3cc23e02ead11b509b545ccbae4c80fe", "class_name": "RelatedNodeInfo"}}, "text": "<a href=\"#avoiding-fp-instructions-in-json-parsing\" id=\"avoiding-fp-instructions-in-json-parsing\"></a>\n\n***\n\nA common case that introduces FP instructions is parsing JSON in a contract. Either serde or serde\\_json are designed to be able to handle FP numbers. In theory, if you don\u2019t use it to deal with FP data, the compiler and wasm-opt should be able to optimize the FP instructions away for many cases. However, in practice, if you use serde\\_json, it always emits FP instructions in the final output wasm file.\n\nIf your JSON document contains FP numbers, you can skip this section and go to [\u201cHow to do floating point calculations\u201d](../developers/support/broken-reference/) for solutions. If your JSON document does not contain FP numbers, here are some suggestions for removing the instructions:\n\n* Use the crate [pink-json](https://crates.io/crates/pink-json) instead of `serde_json`.\n* Don\u2019t deserialize to `json::Value` or `serde::Value`. These are dynamically typed values and make it impossible for the compiler to optimize the code paths that contain FP ops. Instead, mark concrete types with `#[derive(Deserialize)]` and deserialize to them directly.\n* If using `pink-web3` and loading `Contract` from its JSON ABI, you may encounter FP problems in a function like `_ZN5serde9__private2de7content7Content10unexpected17h5ce9c505c30bc609E` from serde. To fix this, you can patch `serde` as shown below.\n\n```\n[patch.crates-io]\nserde = { git = \"https://github.com/kvinwang/serde.git\", branch = \"pink\" }\n```\n\n### Cannot compile with \"lib name not found\" error.", "mimetype": "text/plain", "start_char_idx": 2123, "end_char_idx": 3691, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a914a65f-5c9d-466e-aa7c-d58618339303": {"__data__": {"id_": "a914a65f-5c9d-466e-aa7c-d58618339303", "embedding": null, "metadata": {"file_path": "phala-docs_dist/faq.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "969f6e90-aae7-4103-909d-6c883a2558d3", "node_type": "4", "metadata": {}, "hash": "d958cb77d2aac88b7e3e0504208f0a73242eda0d2e224b47790c0d92d7a3e6b8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "3ff0b9d9-f2e3-4c33-b40d-aecb3b386fde", "node_type": "1", "metadata": {}, "hash": "bce081a822986c2e185b89c5742b5560cd3a47a82af808ebc5fc1114fca048ba", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "01813b4c-204d-4b3c-8a12-b2f8dbb72a37", "node_type": "1", "metadata": {}, "hash": "a799100b9da5d3c1ae7dbb60799ff5adabbd789bfb693aca80f2d7708f0ddcdc", "class_name": "RelatedNodeInfo"}}, "text": "***\n\n<pre class=\"language-shell\" data-overflow=\"wrap\"><code class=\"lang-shell\"><strong>2023-07-11T09:42:45.848016Z INFO cargo_contract::crate_metadata: Fetching cargo metadata for Cargo.toml thread 'main' panicked at 'lib name not found', /home/USER/.cargo/registry/src/github.com-1ecc6299db9ec823/cargo-contract-1.5.0/src/crate_metadata.rs:65:25 note: run with RUST_BACKTRACE=1 environment variable to display a backtrace\n</strong></code></pre>\n\nAfter checking the version, it shows:\n\n<pre><code><strong>$ cargo contract --version cargo-contract 1.5.0-unknown-x86_64-unknown-linux-gnu\n</strong></code></pre>\n\nSolution: upgrade to the latest cargo contract. [Reference](https://github.com/paritytech/cargo-contract#installation):\n\n```shell\ncargo install --force --locked cargo-contract\n```\n\n### Who is charged for calling methods on contract?\n\n***\n\nThere are two types of method calling:\n\n1. **off-chain query**: there is not cost for caller, but someone needs to stake to that contract in advance so it can get the CPU time to process your queries\n2. **on-chain transaction**: when you send the tx, some transaction fee will be charged directly; also for your tx to be finally executed in our worker, some in-cluster balance will be charged as real gas fee\n\n### Encrypted contract state is not available on the blockchain, but is the contract itself available on the blockchain?\n\n***\n\n* Contract state is not stored on-chain, it\u2019s volatile in SGX workers\u2019 memory. So to get access to the contract state, there must be at least one active worker to which that contract is deployed\n  * Contracts are deployed to a cluster, and then all the workers in that cluster - We have enabled dynamic cluster: to add workers to a cluster.", "mimetype": "text/plain", "start_char_idx": 3693, "end_char_idx": 5419, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "01813b4c-204d-4b3c-8a12-b2f8dbb72a37": {"__data__": {"id_": "01813b4c-204d-4b3c-8a12-b2f8dbb72a37", "embedding": null, "metadata": {"file_path": "phala-docs_dist/faq.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "969f6e90-aae7-4103-909d-6c883a2558d3", "node_type": "4", "metadata": {}, "hash": "d958cb77d2aac88b7e3e0504208f0a73242eda0d2e224b47790c0d92d7a3e6b8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a914a65f-5c9d-466e-aa7c-d58618339303", "node_type": "1", "metadata": {}, "hash": "a7afb925c74886ebd79bc4323677a82f3cc23e02ead11b509b545ccbae4c80fe", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c63d5025-44fd-4865-b345-79e9e22034b0", "node_type": "1", "metadata": {}, "hash": "c92139b7870c8436532f91eec28b1926ac2298386122bd84d93178f0ff0c642c", "class_name": "RelatedNodeInfo"}}, "text": "This is achievable since the root key is in GKs, so they can derive the cluster key any time and share to incoming workers\n* All the transactions are stored on-chain, including\n  * The transaction to upload the code to workers, such transaction is deliberately kept public so users can easily examine the contract code\n    * The (encrypted) transaction to instantiate code, this contains the constructor function to call and the arguments\n    * All the (encrypted) transactions that update the contract states\n\n### Does the stake associated with a contract decrease as more computation is done from contract calls?\n\n***\n\nNo. The stake to a contract does not change with contract calls. You can always have the full refund. But if other contracts get more stake then your computing power percentage will decrease correspondingly. This only applies to the public cluster. If we create dedicated cluster for our partners then any stake can take all the CPU time\n\n### Error on Ubuntu 22.04 Exception: Failed to start pherry component. \\<PATH>/pherry: error while loading shared libraries: libssl.so.1.1: cannot open shared object file: No such file or directory\n\n***\n\nManually pulling deb package and installing fixes issue. Reference from [askubuntu](https://askubuntu.com/questions/1403619/mongodb-install-fails-on-ubuntu-22-04-depends-on-libssl1-1-but-it-is-not-insta).&#x20;\n\n```sh\nwget http://security.ubuntu.com/ubuntu/pool/main/o/openssl/libssl1.1_1.1.1f-1ubuntu2.20_amd64.deb\nsudo dpkg -i libssl1.1_1.1.1f-1ubuntu2.20_amd64.deb\n```\n\n## :computer: Phala Compute Infrastructure&#x20;\n\n***\n\n### How do the token economics of Phala Network work?\n\n***\n\n> _**Note**: At the time of writing this, e_verything below except the **Demand L1** tokenomic is up and running\n\n1. **Supply**: The contributors (miners in the past) receive reward by keeping serving the network. It follows a model similar to other PoS like Filecoin, which allows the system to punish the bad behavior. The liveness of the worker is checked by on-chain random heartbeat.\n2.", "mimetype": "text/plain", "start_char_idx": 5420, "end_char_idx": 7463, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c63d5025-44fd-4865-b345-79e9e22034b0": {"__data__": {"id_": "c63d5025-44fd-4865-b345-79e9e22034b0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/faq.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "969f6e90-aae7-4103-909d-6c883a2558d3", "node_type": "4", "metadata": {}, "hash": "d958cb77d2aac88b7e3e0504208f0a73242eda0d2e224b47790c0d92d7a3e6b8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "01813b4c-204d-4b3c-8a12-b2f8dbb72a37", "node_type": "1", "metadata": {}, "hash": "a799100b9da5d3c1ae7dbb60799ff5adabbd789bfb693aca80f2d7708f0ddcdc", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "6fdefd24-6033-455b-b112-c098d0354fef", "node_type": "1", "metadata": {}, "hash": "72c7e7fdd8a4c39dd92eec744ec9335771451379f55340600e1678350e01f4c8", "class_name": "RelatedNodeInfo"}}, "text": "**Demand L1**: The developer can stake to get a percentage of the ownership of the compute resource. Once they stake, they can request to \"hire\" the workers they prefer to form a **cluster**, and get the worker assigned automatically by the system. This part is described in the tokenomic paper, but not fully implemented yet.\n3. **Demand L2**: Once the developer hired some workers in a **cluster**, they can use the resources. If it's fully used by a single developer, no further tokenomic is required. But if someone wants to create a **public cluster**, just like the one we launched earlier this year, we need another tokenomic to distribute the resources to individual permissionlessly. As Joshua described, now it's a \"stake to compute\" model. You can stake some % of the token, and get access to the corresponding portion of the compute resources within the cluster.\n4. **Resource Accounting**: The last piece of the map is to account the resources, especially when using a **public cluster**. In Phala Network the major resource is the CPU time. So we run a variant of Completely Fair Scheduler (CFS) used by the Linux kernel to ensure the CPU consumed by each contract is pro rata to their stake in the cluster. It's further combined with WASM gas metering to achieve \"time slice\" allocation in the cluster.\n\n### How are Phat Contract Contract Keys managed/handled from Gatekeepers to Cluster of node(s)?\n\n***\n\nThere are several keys involved in this process, and all these keys are generated inside pRuntime in TEE.\n\n* WorkerKey, every pRuntime, no matter it\u2019s worker or GK, generates it during the initialization and publish the pk on-chain during worker registration (GK must be first registered as worker)\n  * All the key sharing between workers are done through encrypted channel. And this channel is established using the WorkerKeys of two parties. Two workers first generate the common working key using ECDH on their WorkerKeys, then using the working key to encrypt the real contents\n* MasterKey, generated by the first registered GK, and shared to all the other GKs. The MasterKey pk is published on chain, so any GK can sign the messages with MasterKey for others to verify.", "mimetype": "text/plain", "start_char_idx": 7464, "end_char_idx": 9659, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6fdefd24-6033-455b-b112-c098d0354fef": {"__data__": {"id_": "6fdefd24-6033-455b-b112-c098d0354fef", "embedding": null, "metadata": {"file_path": "phala-docs_dist/faq.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "969f6e90-aae7-4103-909d-6c883a2558d3", "node_type": "4", "metadata": {}, "hash": "d958cb77d2aac88b7e3e0504208f0a73242eda0d2e224b47790c0d92d7a3e6b8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c63d5025-44fd-4865-b345-79e9e22034b0", "node_type": "1", "metadata": {}, "hash": "c92139b7870c8436532f91eec28b1926ac2298386122bd84d93178f0ff0c642c", "class_name": "RelatedNodeInfo"}}, "text": "All the GKs behave exactly the same so they are duplications to each other\n  * MasterKey is the root key for all the following contract-related keys\n* ClusterKey, generated by GK by deriving the MasterKey with cluster info. The ClusterKey is shared by GK to all the Workers in the cluster during cluster creation through the encrypted channels\n* ContractKey, generated by cluster workers by deriving the ClusterKey with contract info. Since all the cluster workers have the ClusterKey, they will generate the same ContractKey for each contract.", "mimetype": "text/plain", "start_char_idx": 9660, "end_char_idx": 10204, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d9a92c69-d82b-45bb-9ea4-4c8aea70d3ee": {"__data__": {"id_": "d9a92c69-d82b-45bb-9ea4-4c8aea70d3ee", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deploy-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d7324c50-a9ba-4244-a962-c7b656ebcfa0", "node_type": "4", "metadata": {}, "hash": "4494f51a8651179f20006db07cff651efaef1696540fa65d5628253b736acaa8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "89742653-4819-4895-9ffe-d2cbda24bce2", "node_type": "1", "metadata": {}, "hash": "a74a9c2d5244645c78110062414191215664d0cdae2a89a76d6dc01baf535263", "class_name": "RelatedNodeInfo"}}, "text": "# Deploy Contract\n\n## Deploy Your First Contract <a href=\"#create-and-compile-your-first-contract\" id=\"create-and-compile-your-first-contract\"></a>\n\nNow that you have created and compiled your `phat_hello` contract, let's deploy the contract to the [PoC6 Testnet](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fpoc6.phala.network%2Fws#/explorer). There are a couple ways to get you started.\n\n{% tabs %}\n{% tab title=\"Swanky Phala\" %}\n> If you have not installed `swanky phala` CLI tool, follow these [steps](deploy-contract.md#swanky-phala) to get started.\n\nGo to your development workspace and ensure that you have updated your `devphase.config.json` file to include the PoC6 Testnet info. Within`networks` , add the following:\n\n```bash\n\"networks\": {\n    \"poc6\": {\n      \"nodeUrl\": \"wss://poc6.phala.network/ws\",\n      \"workerUrl\": \"https://phat-cluster-us.phala.network/poc6/pruntime/0xac5087e0\"\n    }\n  },\n```\n\nNext, you will execute the following command to deploy your `phat_hello` compiled contract.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1004, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "89742653-4819-4895-9ffe-d2cbda24bce2": {"__data__": {"id_": "89742653-4819-4895-9ffe-d2cbda24bce2", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deploy-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d7324c50-a9ba-4244-a962-c7b656ebcfa0", "node_type": "4", "metadata": {}, "hash": "4494f51a8651179f20006db07cff651efaef1696540fa65d5628253b736acaa8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d9a92c69-d82b-45bb-9ea4-4c8aea70d3ee", "node_type": "1", "metadata": {}, "hash": "160e59208987314a72fdc1b6333fdd59e46f8f9c24a2b7cf457d6fe784ec1548", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ad83ec56-2f1d-44e1-9070-d73398aea038", "node_type": "1", "metadata": {}, "hash": "d02812a80be168b88ad2fc649b600002d398ba0edc6bad09ea82b74ede5dd9c6", "class_name": "RelatedNodeInfo"}}, "text": "The flags available for this command are defined as follows:\n\n```\nswanky phala contract deploy --help\n```\n\nExpected output:\n\n```bash\n\u279c  Norwhich git:(master) \u2717 swanky help phala contract deploy                                                                                     ~/Projects/TestingEnv/Norwhich\nDeploy contract\n\nUSAGE\n  $ swanky phala contract deploy -c <value> -o <value> [-t InkCode|SidevmCode|IndeterministicInkCode] [-n <value>] [-l <value>] [-a <value>] [-p <value>]\n\nFLAGS\n  -a, --account=<value>      [default: alice] Account used to deploy (managed account key)\n  -c, --contract=<value>     (required) Contract name\n  -l, --cluster=<value>      Target cluster Id\n  -n, --network=<value>      [default: local] Target network to deploy (local default)\n  -o, --constructor=<value>  (required) Contract constructor to call (name)\n  -p, --params=<value>...    [default: ] Arguments supplied to the message\n  -t, --type=<option>        [default: InkCode]\n                             <options: InkCode|SidevmCode|IndeterministicInkCode>\n\nDESCRIPTION\n  Deploy contract\n\nEXAMPLES\n  $ swanky phala contract deploy -c [CONTRACT_NAME] -t [CONTRACT_TYPE] -o [CONSTRUCTOR] -n [NETWORK] -l [CLUSTER_ID] -a [ACCOUNT] -p [..Args]\n```\n\n`poc6` will be the `-n` flag value in the `swanky phala contract deploy` command.\n\n{% code overflow=\"wrap\" %}\n```bash\nswanky phala contract deploy -c phat_hello -l 0x0000000000000000000000000000000000000000000000000000000000000001 -n poc6 -o new\n```\n{% endcode %}\n\nHere is an expected output after executing the `swanky phala contract deploy` command.\n\n```bash\nDeploy contract\nValidating compiled WASM of phat_hello contract...\nphat_hello.wasm validated successfully!", "mimetype": "text/plain", "start_char_idx": 1006, "end_char_idx": 2714, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ad83ec56-2f1d-44e1-9070-d73398aea038": {"__data__": {"id_": "ad83ec56-2f1d-44e1-9070-d73398aea038", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deploy-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d7324c50-a9ba-4244-a962-c7b656ebcfa0", "node_type": "4", "metadata": {}, "hash": "4494f51a8651179f20006db07cff651efaef1696540fa65d5628253b736acaa8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "89742653-4819-4895-9ffe-d2cbda24bce2", "node_type": "1", "metadata": {}, "hash": "a74a9c2d5244645c78110062414191215664d0cdae2a89a76d6dc01baf535263", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "2d7b1c07-6c51-4f4c-a1a1-80c0cb683d76", "node_type": "1", "metadata": {}, "hash": "cb3c918afc3113bdf3936a5c3ed0127022dc0f96dcc5aabe73e46935fa1c775f", "class_name": "RelatedNodeInfo"}}, "text": "\u2819 Deploying contract phat_hello\nContract deployed\nContract Id: 0xac22b0163a70f1213d58b3891f20c5b493ca7a7802e2b0ee204a7c4994a4bb27\nCluster Id:  0x0000000000000000000000000000000000000000000000000000000000000001\n\u2714\ufe0f Deploying contract phat_hello  OK\n\ud83d\ude0e Phat Contract deployed successfully! \ud83d\ude0e\n```\n\nNow execute the `swanky phala contract call` command since we now have the Contract Id of the deployed Phat Contract. Here is what the help command looks like:\n\n```\nswanky phala contract call --help\n```\n\nExpected output:\n\n```bash\nCall a Phat Contract\n\nUSAGE\n  $ swanky phala contract call -c <value> -i <value> -m <value> [-t InkCode|SidevmCode|IndeterministicInkCode] [-r query|tx] [-n <value>] [-l <value>] [-a <value>] [-p <value>]\n\nFLAGS\n  -a, --account=<value>    [default: alice] Account used to call (managed account key)\n  -c, --contract=<value>   (required) Contract name\n  -i, --id=<value>         (required) Contract ID\n  -l, --cluster=<value>    Target cluster Id\n  -m, --method=<value>     (required) Contract method to call (name)\n  -n, --network=<value>    [default: local] Target network to deploy (local default)\n  -p, --params=<value>.  [default: ] Arguments supplied to the message\n  -r, --request=<option>   [default: query] Request type: transaction or query\n                           <options: query|tx>\n  -t,", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "2d7b1c07-6c51-4f4c-a1a1-80c0cb683d76": {"__data__": {"id_": "2d7b1c07-6c51-4f4c-a1a1-80c0cb683d76", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deploy-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d7324c50-a9ba-4244-a962-c7b656ebcfa0", "node_type": "4", "metadata": {}, "hash": "4494f51a8651179f20006db07cff651efaef1696540fa65d5628253b736acaa8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ad83ec56-2f1d-44e1-9070-d73398aea038", "node_type": "1", "metadata": {}, "hash": "d02812a80be168b88ad2fc649b600002d398ba0edc6bad09ea82b74ede5dd9c6", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "669593ac-543c-460d-8570-1fabe9ccdf15", "node_type": "1", "metadata": {}, "hash": "f47ee4fdf68329c86b819745144c43834620ae30a157a71a16dbbdeee4314a1a", "class_name": "RelatedNodeInfo"}}, "text": "--type=<option>      [default: InkCode]\n                           <options: InkCode|SidevmCode|IndeterministicInkCode>\n\nDESCRIPTION\n  Call a Phat Contract\n\nEXAMPLES\n  $ swanky phala contract call -c [CONTRACT_NAME] -t [CONTRACT_TYPE] -i [CONTRACT_ID] -r [REQUEST_TYPE] -m [METHOD] -n [NETWORK] -l [CLUSTER_ID] -a [ACCOUNT] -p [.ARGS]\n```\n\nTo call the `phat_hello` contract we will need the following:\n\n* `-i` Contract Id: `0xac22b0163a70f1213d58b3891f20c5b493ca7a7802e2b0ee204a7c4994a4bb27`\n* `-l` Cluster Id: `0x0000000000000000000000000000000000000000000000000000000000000001`\n* `-n` Network: `poc6`\n* `-m` Method Name (Camel Case): `getEthBalance`\n* `-p` Method Argument Parameters: `0x307844306645333136423966303141336235666436373930463838433244353337333946383042343634`\n  * Note that this is the value of `stringToHex(0xD0fE316B9f01A3b5fd6790F88C2D53739F80B464)`\n\n```bash\nswanky phala contract call -c phat_hello -i 0xac22b0163a70f1213d58b3891f20c5b493ca7a7802e2b0ee204a7c4994a4bb27 -l 0x0000000000000000000000000000000000000000000000000000000000000001 -n poc6 -m getEthBalance -p 0x307844306645333136423966303141336235666436373930463838433244353337333946383042343634\n```\n\nNow that we can compose a `swanky phala contract call` command,", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "669593ac-543c-460d-8570-1fabe9ccdf15": {"__data__": {"id_": "669593ac-543c-460d-8570-1fabe9ccdf15", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deploy-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d7324c50-a9ba-4244-a962-c7b656ebcfa0", "node_type": "4", "metadata": {}, "hash": "4494f51a8651179f20006db07cff651efaef1696540fa65d5628253b736acaa8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "2d7b1c07-6c51-4f4c-a1a1-80c0cb683d76", "node_type": "1", "metadata": {}, "hash": "cb3c918afc3113bdf3936a5c3ed0127022dc0f96dcc5aabe73e46935fa1c775f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "9b2e6a66-847d-4b49-b014-346d331cdc9f", "node_type": "1", "metadata": {}, "hash": "15509987b6cf152f6e83165151fbb3c880a78d687d0c680e9db848b5db649b5c", "class_name": "RelatedNodeInfo"}}, "text": "this would be an expected output:\n\n```bash\nExecuting call to Phat Contract\nCall result:\n{\n  output: { ok: { ok: '20950198739626844' } },\n  debugMessage: '',\n  result: {\n    ok: { flags: [], data: '0x0000443230393530313938373339363236383434' }\n  },\n  gasConsumed: { refTime: 1342177279, proofSize: 0 },\n  gasRequired: { refTime: 65766686719, proofSize: 0 },\n  storageDeposit: { charge: 2047 }\n}\n```\n{% endtab %}\n\n{% tab title=\"Phat UI\" %}\nGo to the [Phat UI](https://phat.phala.network) website where you will see a landing page.\n\n<figure><img src=\"../../../../.gitbook/assets/Phat-UI-landing-page.png\" alt=\"\"><figcaption><p>Phat UI Landing Page</p></figcaption></figure>\n\nNext, you will connect your Polkadot wallet ([Talisman](https://talisman.xyz/download), [SubWallet](https://chrome.google.com/webstore/detail/subwallet-polkadot-extens/onhogfjeacnfoofkfgppdlbmlmnplgbn?hl=en\\&authuser=0), or [Polkadot.js](https://chrome.google.com/webstore/detail/polkadot%7Bjs%7D-extension/mopnmbcafieddcagagdcbnhejhlodfdd/related))\n\n<figure><img src=\"../../../../.gitbook/assets/Select-Polkadot-Wallet.png\" alt=\"\"><figcaption><p>Select a Polkadot Wallet</p></figcaption></figure>\n\nFor more info on these steps, check out the [Phat Contract Console](https://phat.phala.network) section. Now that your account has PHA testnet tokens, upload the compile contract file `phat_hello.contract`\n\nHere is a video example of the process. After the contract is deployed and instantiated into a cluster, choose any ETH address and query the balance.", "mimetype": "text/plain", "start_char_idx": 5287, "end_char_idx": 6814, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "9b2e6a66-847d-4b49-b014-346d331cdc9f": {"__data__": {"id_": "9b2e6a66-847d-4b49-b014-346d331cdc9f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deploy-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d7324c50-a9ba-4244-a962-c7b656ebcfa0", "node_type": "4", "metadata": {}, "hash": "4494f51a8651179f20006db07cff651efaef1696540fa65d5628253b736acaa8", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "669593ac-543c-460d-8570-1fabe9ccdf15", "node_type": "1", "metadata": {}, "hash": "f47ee4fdf68329c86b819745144c43834620ae30a157a71a16dbbdeee4314a1a", "class_name": "RelatedNodeInfo"}}, "text": "{% embed url=\"https://youtu.be/NkLHXNEK8iI\" %}\nDeploy and Call your Phat Contract\n{% endembed %}\n\nThe query of an ETH balance will look like this:\n\n<figure><img src=\"../../../../.gitbook/assets/Query-ETH-Balance-Step1.png\" alt=\"\"><figcaption><p>Choose ETH Account to Query</p></figcaption></figure>\n\n<figure><img src=\"../../../../.gitbook/assets/Query-ETH-Balance.png\" alt=\"\"><figcaption><p>Query ETH Balance</p></figcaption></figure>\n{% endtab %}\n{% endtabs %}", "mimetype": "text/plain", "start_char_idx": 6816, "end_char_idx": 7277, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0e04eae7-9b40-46f8-b9fc-f6cb8bc807f3": {"__data__": {"id_": "0e04eae7-9b40-46f8-b9fc-f6cb8bc807f3", "embedding": null, "metadata": {"file_path": "phala-docs_dist/requirements-in-phala-khala.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d762892b-4abe-4326-a7b0-45195c3f29da", "node_type": "4", "metadata": {}, "hash": "2664c04192b7604d49ac974510ad3e895671b848bb90b1aa7d32ce35a981b8d2", "class_name": "RelatedNodeInfo"}}, "text": "# Requirements in Phala/Khala\n\n## Basic Requirements\n\nWhether in Phala or Khala, the following requirements for workers are the same.\n\n## SGX Function\n\nRunning a worker requires SGX-capable CPU. Please choose a device that supports SGX and enable SGX in the BIOS. For more information, refer to:\n\n## Stable Network\n\nThe network of the worker should be as stable as possible with more than 1GB bandwidth. and it's best to have a public IP address.\n\n## OS Requirements\n\nWe strongly recommend that you use Ubuntu 22.04.2 LTS, download [link](https://ubuntu.com/download/server).\n\n> The desktop version of the OS is less stable than Server version, so we strongly recommend using the server version.\n\n> **NOTE**\n>\n> Make sure that the kernel version is **5.13** or above.\n\n## Device Hardware Specifications\n\nThere are 2 forms of worker operation, including solo-worker operation and batches of worker management which is called PRB. The requirements of them are different.\n\nThe following describes the device requirements for a solo-worker, and different network requirements also vary.\n\n### For Phala Workers\n\n| Types           | Requirements |\n| --------------- | ------------ |\n| RAM Space       | 8 GB+        |\n| Hard Disk Space | 2 TB+        |\n| Cores           | 4 Cores+     |\n\n> If you have a batch of workers that need to run on Phala, please visit here for more [information](../run-workers-on-phala/prbv3-deployment.md).\n\n### For Khala Workers\n\n| Types           | Requirements |\n| --------------- | ------------ |\n| RAM Space       | 8 GB+        |\n| Hard Disk Space | 2 TB+        |\n| Cores           | 4 Cores+     |\n\n> If you have a batch of workers that need to run on Khala, please visit here for more information.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1729, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "bed71e4d-414b-4d28-8226-499b283529aa": {"__data__": {"id_": "bed71e4d-414b-4d28-8226-499b283529aa", "embedding": null, "metadata": {"file_path": "phala-docs_dist/environment-setup.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc11d025-9d3b-4a7d-a5d2-da13e7627ea6", "node_type": "4", "metadata": {}, "hash": "329b980dda804e8a85f1e001e8d8c57de375d6bb440904f6e4e9d54b58f74219", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c6047017-5967-4854-9738-bc6e3f5d2635", "node_type": "1", "metadata": {}, "hash": "aa7baa8b4b8a247d2a9949d9ae470ef39b60481f170005051398916eaf2b4757", "class_name": "RelatedNodeInfo"}}, "text": "# Environment Setup\n\n## Supported Operating Systems <a href=\"#supported-operating-systems\" id=\"supported-operating-systems\"></a>\n\nThe Phat Contract uses the Rust-based ink! language, and is ultimately compiled to WebAssembly (WASM for short).\n\n* You compile your contract on both macOS and Linux distributions (we use Ubuntu 22.04 as the default Linux distribution);\n* For Windows users, we recommend setting up a Linux development environment with a virtual machine ([video tutorial](https://www.youtube.com/watch?v=x5MhydijWmc)).\n\n> **Note**\n>\n> The Mac M1/M2 chips do not support the deployment of a local testnet at this time. If you are using a machine with these chips, you will have to deploy to the live testnet through [DevPHAse](https://github.com/l00k/devphase), [swanky phala](swanky-phala-cli-tool.md), or [Phat UI](https://phat.phala.network).\n>\n> Information to connect to the Phala Live Testnet PoC6\n>\n> * RPC WS Endpoint: wss://poc6.phala.network/ws\n> * RPC HTTP Endpoint: https:/poc6.phala.network/rpc\n> * Cluster ID: 0x0000000000000000000000000000000000000000000000000000000000000001\n> * Worker: 0xac5087e0e21de2b2637511e6710db74e5ec2dbc3f02db76ffa02662878ecf333\n> * pRuntime URL: [https://phat-cluster-us.phala.network/poc6/pruntime/0xac5087e0](https://phat-cluster-us.phala.network/poc6/pruntime/0xac5087e0)\n\n## Install Toolchains\n\nPhat Contract shares the same toolchains as ink!.\n\n### Rust <a href=\"#rust\" id=\"rust\"></a>\n\nA prerequisite for compiling Phat Contracts is to have Rust and Cargo (Rust\u2019s project manager) installed.\n\nRust officially recommends using `rustup` tool to install and manage different Rust versions. Here\u2019s [an installation guide](https://doc.rust-lang.org/cargo/getting-started/installation.html).\n\n### ink!", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1754, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c6047017-5967-4854-9738-bc6e3f5d2635": {"__data__": {"id_": "c6047017-5967-4854-9738-bc6e3f5d2635", "embedding": null, "metadata": {"file_path": "phala-docs_dist/environment-setup.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bc11d025-9d3b-4a7d-a5d2-da13e7627ea6", "node_type": "4", "metadata": {}, "hash": "329b980dda804e8a85f1e001e8d8c57de375d6bb440904f6e4e9d54b58f74219", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "bed71e4d-414b-4d28-8226-499b283529aa", "node_type": "1", "metadata": {}, "hash": "bdc8178414248b5746c5d095232f2bb1e6b00a209bbac553d23f2500a3cff90c", "class_name": "RelatedNodeInfo"}}, "text": "<a href=\"#ink\" id=\"ink\"></a>\n\nWe recommend installing [`cargo-contract`](https://github.com/paritytech/cargo-contract). It\u2019s a CLI tool that helps set up and manage contracts written with ink!.\n\nThen you can install the `cargo-contract` with\n\n```\n# use the `--force` to ensure you are updated to the most recent version\ncargo install cargo-contract --force\n```\n\nThen check your `cargo-contract` and ensure it\u2019s updated to `3.2.x` with ink! 4 support\n\n```\ncargo contract --version\n# cargo-contract-contract 3.2.0-unknown-x86_64-unknown-linux-gnu\n```", "mimetype": "text/plain", "start_char_idx": 1755, "end_char_idx": 2303, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "05ea17cd-c7b3-4b48-a392-dbbd4c1f37a3": {"__data__": {"id_": "05ea17cd-c7b3-4b48-a392-dbbd4c1f37a3", "embedding": null, "metadata": {"file_path": "phala-docs_dist/accelerate-khala-syncing.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "ad4e9ae2-6b2b-42a4-ad8a-6730fb0b2a63", "node_type": "4", "metadata": {}, "hash": "cecaa7d7b8dda54a473fcc45808f62f3528cbf528ddeebaaa863583a204cf368", "class_name": "RelatedNodeInfo"}}, "text": "# Accelerate Khala Syncing\n\n### Check Your Status <a href=\"#check-your-status\" id=\"check-your-status\"></a>\n\nA typical node log that is not up to date will look like this:\n\n```\n2021-09-15 13:33:27 [Relaychain] \u2699\ufe0f  Syncing 10.4 bps, target=#9236775 (20 peers), best: #9227955 (0xa897\u20264f36), finalized #9227895 (0x1d6d\u20261527), \u2b07 1.7MiB/s \u2b06 657.8kiB/s\n2021-09-15 13:33:27 [Parachain] \u2699\ufe0f  Syncing 40.4 bps, target=#400531 (1 peers), best: #396657 (0xb898\u20266c02), finalized #396443 (0xf470\u20262f54), \u2b07 378.7kiB/s \u2b06 1.6kiB/s\n```\n\nYou can check your node logs anytime by executing the following:\n\n```\nsudo docker logs -f phala-node\n```\n\nFor a status on your block heights, feel free to run:\n\n```\nsudo phala status\n```\n\n### Download a Snapshot <a href=\"#download-a-snapshot\" id=\"download-a-snapshot\"></a>\n\n> \u2139 If your node is close to the newest block height (about several hours to catch up) or already caught up, you don\u2019t need to do anything; sit and wait.\n\nDownload the snapshot using the torrent (updated at 4/30/2022): [here](https://wiki.phala.network/files/khala-node-snapshot-2022-04-30.tar.gz.torrent)\n\nThe download will take a while, as the file is large. Get some \u2615 in the meantime.\n\n> \u2139 The snapshot archive is \\~750 GB; if you don\u2019t have enough space, consider extracting to an external storage.\n\nTo extract the file execute:\n\n```\ntar -xvzf khala-node-snapshot-2022-04-30.tar.gz\n```\n\nThe extraction will take a while to complete as well. After extraction, you should get a folder named `khala-node`. You can list your files with `ls` to verify where you extracted the snapshot.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1577, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "21c36f7d-aaa1-406b-bf6d-3658c961daf8": {"__data__": {"id_": "21c36f7d-aaa1-406b-bf6d-3658c961daf8", "embedding": null, "metadata": {"file_path": "phala-docs_dist/transaction-costs.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "52136ccc-ff23-4b51-875e-73cef967ddf8", "node_type": "4", "metadata": {}, "hash": "a3aee2faa5dd5a8fd4d554af25246b8561648a3e7065f09aa24343daa9e955c0", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "4b7e23d3-5c95-4493-8850-ca9d46439f04", "node_type": "1", "metadata": {}, "hash": "4ddeabd3f7a1e5dd8edac1d0d80afd0194ff604547b51d2c11d8976ba9736fba", "class_name": "RelatedNodeInfo"}}, "text": "---\ndescription: >-\n  This page describes the costs to interact with low level Phat Contract (rust\n  sdk). It may not reflect that in a higher level (e.g. Javascript-based Phat\n  Contract).\n---\n\n# Transaction Costs\n\nThere are two types of the costs when interacting with a low level Phat Contract. The both costs may occur in transaction execution. Query is always free to user.\n\n## Concepts\n\n### Storage Deposit\n\nStorage Deposit is charged for every added byte stored in the cluster (contract storage). Correspondingly, when you free some bytes from the storage, you can get refunded at the same rate. Now the rate is fixed at around 1 PHA per kbyte. (See [#parameters](transaction-costs.md#parameters \"mention\") for details.)\n\n### Ink Gas Fee\n\nThe gas fee is charged for every gas used to execute on-chain transaction. Typically a transaction takes less than 1 PHA.\n\nLike EVM, the executed code in a transaction is measured by the virtual machine in a unit called `gas`. (`weight` in ink terminology). You must pay the gas fee calculated by `gas * gasPrice` to execute the transaction. Currently, `gasPrice` is a constant. (See [#parameters](transaction-costs.md#parameters \"mention\") for details.)\n\n### Fee Structure\n\nThe total fee required is defined by the sum of the gas fee and the storage deposit (could be negative):\n\n```\nfee = gas * gasPrice + storageDeposit\n```\n\n### Storage Deposit Limit and Gas Limit\n\nIt's hard to predict how much fee will be charged before actually executing the transaction. So Phat Contract requires you to specify a limit to the gas and Storage Deposit. It ensures you will never pay more than expectation.\n\nYou need to specify `gasLimit` and `storageDepositLimit` when sending a transaction, which can be estimated by an estimation API. Then the max fee is defined below:\n\n```\nmaxFee = gasLimit * gasPrice + storageDepositLimit\n```\n\nThe VM charges you `maxFee` before executing a transaction. Once executed, the VM will refund the remaining fee to your account (`maxFee - fee`).  If the transaction runs out of the gas or Storage Deposit, the transaction will be revered with an error (`OutOfGas` or `StorageDepositLimitExhausted`).", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2168, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4b7e23d3-5c95-4493-8850-ca9d46439f04": {"__data__": {"id_": "4b7e23d3-5c95-4493-8850-ca9d46439f04", "embedding": null, "metadata": {"file_path": "phala-docs_dist/transaction-costs.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "52136ccc-ff23-4b51-875e-73cef967ddf8", "node_type": "4", "metadata": {}, "hash": "a3aee2faa5dd5a8fd4d554af25246b8561648a3e7065f09aa24343daa9e955c0", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "21c36f7d-aaa1-406b-bf6d-3658c961daf8", "node_type": "1", "metadata": {}, "hash": "582755918ae6146fe1881ff3a138cc9465a987475033b90f090b191fb6894720", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f332cbbf-531a-4d49-b3ae-c76c993a57e0", "node_type": "1", "metadata": {}, "hash": "03e6b4ff244aecbc19f706f08f5efaf8f9d0d3009cc5923843e8fe4f197e5ed7", "class_name": "RelatedNodeInfo"}}, "text": "## Transaction\n\nA typical transaction takes less than 1 PHA, unless you store large chunk of data in the storage.\n\nA regular transaction may involve gas fee and storage deposit. The gas fee (`gas * gasPrice`) is usually less than 1 PHA. The storage deposit fee is a bit more complex.\n\nWhen you add an entry to the contract storage like below, you will be charged a small storage deposit. It takes a few bytes to store the key and the value.\n\n```rust\nfn set(&mut self) {\n  // If the kv takes 50 bytes storage, the deposit would be 0.05 PHA.\n  self.a_map.insert(\"key\".to_string(), \"value\".to_string())\n}\n```\n\nHowever, you may also remove the storage item like below. In this case, the caller will get a refund as the storage deposit.\n\n```rust\nfn clear(&mut self) {\n  // If the kv takes 50 bytes storage, the refund would be 0.05 PHA.\n  self.a_map.remove(\"key\".to_string())\n}\n```\n\n## Contract Deployment\n\nDeploy (instantiate in ink terminology) a contract may take anywhere from <0.1 PHA to >1000 PHA.\n\nIn low level Phat Contract, you need to upload the WASM code to the storage before instantiating it. Usually the uploading step takes much more than instantiation.\n\n{% hint style=\"info\" %}\nThe uploaded code takes twice the space in the storage. For example, if you upload a 500kb WASM file, it stores around 1mb file in the storage. You will need to pay 1000 PHA as the storage deposit.\n{% endhint %}\n\nOnce the code is uploaded, you can instantiate the contract with the code hash. The VM will call the constructor function to initialize the contract. This step happens in the same way as executing a transaction. It will charge you gas fee as usual. It may also charge you additional storage deposit, if you write to the storage in the constructor.\n\nTypically, you pay a relatively large storage deposit for uploading, and a small gas fee for instantiating. However, sometimes you may deploy existing contracts. So you only pay a minor fee in the instantiating step, not the uploading step.", "mimetype": "text/plain", "start_char_idx": 2170, "end_char_idx": 4161, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f332cbbf-531a-4d49-b3ae-c76c993a57e0": {"__data__": {"id_": "f332cbbf-531a-4d49-b3ae-c76c993a57e0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/transaction-costs.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "52136ccc-ff23-4b51-875e-73cef967ddf8", "node_type": "4", "metadata": {}, "hash": "a3aee2faa5dd5a8fd4d554af25246b8561648a3e7065f09aa24343daa9e955c0", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "4b7e23d3-5c95-4493-8850-ca9d46439f04", "node_type": "1", "metadata": {}, "hash": "4ddeabd3f7a1e5dd8edac1d0d80afd0194ff604547b51d2c11d8976ba9736fba", "class_name": "RelatedNodeInfo"}}, "text": "{% hint style=\"info\" %}\nIt's possible to free the storage deposit for uploaded contracts, but it's a rare case in the reality. Every uploaded code has a reference counter. If there's no contract instance referring your code, you can get the storage deposit back. To terminate a contract to reduce the reference, call `env.terminate_contract()` ([doc](https://docs.rs/ink\\_env/latest/ink\\_env/fn.terminate\\_contract.html))\n{% endhint %}\n\n## Parameters\n\n```\ngasPrice = 5\ndepositPerByte = 1 * PHA/KB = 1.000953674316 PHA\ndepositPerItem = 0.030517578125 PHA\n```", "mimetype": "text/plain", "start_char_idx": 4163, "end_char_idx": 4720, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4a8b4a96-baf2-4d78-8f58-cd307946cdb9": {"__data__": {"id_": "4a8b4a96-baf2-4d78-8f58-cd307946cdb9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/connect-to-smart-contracts.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "bd0a1782-7211-49e3-9839-fe9f213e28b0", "node_type": "4", "metadata": {}, "hash": "4448b6f6a3fd65e0798406436350649782f6a3b58f08a224d4ce9d6a409f38e6", "class_name": "RelatedNodeInfo"}}, "text": "# Connect to Smart Contracts\n\n:construction\\_site: Work In Progress", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 67, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "bb0d4c4a-abed-4a76-8ce5-6615af66b8ee": {"__data__": {"id_": "bb0d4c4a-abed-4a76-8ce5-6615af66b8ee", "embedding": null, "metadata": {"file_path": "phala-docs_dist/endpoints.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "984da713-f6c8-48c4-9ded-94d7de7575ac", "node_type": "4", "metadata": {}, "hash": "7f3affe1f6f6c0b6879db395ad6f04224b2e3b7b6709a34cc409982ae4aff320", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b85d2ea6-ee98-4435-8a11-89adbaa77d13", "node_type": "1", "metadata": {}, "hash": "3bb415a6247ed5c17d09b3bccb1fd8fdae7a47f5f98f191deb751d2b7f5680d1", "class_name": "RelatedNodeInfo"}}, "text": "# Available Phala Chains\n\n> Testnet can be updated and restarted any time, so do not store sensitive data in it.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 112, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b85d2ea6-ee98-4435-8a11-89adbaa77d13": {"__data__": {"id_": "b85d2ea6-ee98-4435-8a11-89adbaa77d13", "embedding": null, "metadata": {"file_path": "phala-docs_dist/endpoints.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "984da713-f6c8-48c4-9ded-94d7de7575ac", "node_type": "4", "metadata": {}, "hash": "7f3affe1f6f6c0b6879db395ad6f04224b2e3b7b6709a34cc409982ae4aff320", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "bb0d4c4a-abed-4a76-8ce5-6615af66b8ee", "node_type": "1", "metadata": {}, "hash": "1549fbbf15858a98ff90f296d365a76ac9c4bab9a505d20060d8fc1d14fadd57", "class_name": "RelatedNodeInfo"}}, "text": "<table><thead><tr><th align=\"center\">Chain</th><th width=\"158\" align=\"center\">Type</th><th width=\"272.40106201171875\" align=\"center\">RPC Endpoint</th><th align=\"center\">Cluster</th><th width=\"192\" align=\"center\">Worker Endpoint</th></tr></thead><tbody><tr><td align=\"center\"><a href=\"https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fpoc5.phala.network%2Fws#/explorer\">PoC-5</a></td><td align=\"center\"><strong>(DEPRECATED)</strong><br>Testnet</td><td align=\"center\">wss://poc5.phala.network/ws<br>https://poc5.phala.network/rpc</td><td align=\"center\">0x1</td><td align=\"center\">https://poc5.phala.network/tee-api-1/</td></tr><tr><td align=\"center\"><a href=\"https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fpoc6.phala.network%2Fws#/explorer\">PoC-6</a></td><td align=\"center\">Testnet</td><td align=\"center\">wss://poc6.phala.network/ws<br>https://poc6.phala.network/rpc</td><td align=\"center\">0x1</td><td align=\"center\">https://phat-cluster-us.phala.network/poc6/pruntime/0xac5087e0</td></tr><tr><td align=\"center\"><a href=\"https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fapi.phala.network%2Fws#/explorer\">Phala</a></td><td align=\"center\">Mainnet</td><td align=\"center\">wss://api.phala.network/ws<br>https://api.phala.network/rpc</td><td align=\"center\">0x1</td><td align=\"center\"><p>https://phat-cluster-ca.phala.network/pruntime/0x04169c50<br></p><p><code>many other workers</code></p></td></tr></tbody></table>", "mimetype": "text/plain", "start_char_idx": 114, "end_char_idx": 1514, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8b8731d9-033f-4ab1-8d96-c483294182c1": {"__data__": {"id_": "8b8731d9-033f-4ab1-8d96-c483294182c1", "embedding": null, "metadata": {"file_path": "phala-docs_dist/examples-of-delegation.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d32f3e9d-fcf1-471b-bc3b-31dbd9078a1b", "node_type": "4", "metadata": {}, "hash": "2bb205976334d677e80f912f7c3292c9473207d22f9c4fb703fbdb2e5db3429b", "class_name": "RelatedNodeInfo"}}, "text": "# Examples of Delegation\n\nAfter the explanation of the complex underlying mechanism, we use two examples to demonstrate the real-world cases of delegation.\n\n### Example 1: Reward Distribution <a href=\"#example-1-reward-distribution\" id=\"example-1-reward-distribution\"></a>\n\n<figure><img src=\"../../../.gitbook/assets/reward-distribution.png\" alt=\"\"><figcaption></figcaption></figure>\n\nStakePool 1 has two delegators who have delegated 1000 PHA and 2000 PHA respectively.\n\nThe Owner stakes 2,500 PHA on Worker A and starts running.\n\nThe StakePool commission set by the owner is 40%. After a period of time, Worker A mined 10 PHA. 20% of it will be handed over to the Treasury, which is 2 PHA, and then 40% of the commission, which is 3.2 PHA, is left to the owner. The rest is distributed to the delegators according to the delegation. 1.6 PHA is distributed to Delegator A and 3.2 PHA is distributed to Delegator B.\n\n## Example 2: Reward Withdraw Timetable\n\n<figure><img src=\"../../../.gitbook/assets/reward-withdraw.png\" alt=\"\"><figcaption></figcaption></figure>\n\nThis begins with 1000 PHA Free Delegation in the StakePool.\n\n* 1st Day: Delegator A initiates a withdrawal application of 5000 PHA. Among them, 1000 PHA is immediately submitted, and the remaining 4000 PHA enters the withdrawal queue;\n* 2nd Day: Delegator B delegates 500 PHA. Then this 500 PHA will be withdrawn to Delegator A;\n* 3rd Day: Worker A in the StakePool completed shutdown and released 3000 PHA, which was withdrawn to Delegator A;\n* 8th Day: It has been 7 days since Delegator A applied for withdrawal, and his withdrawal had not been completed. At this time, all workers in the StakePool will be forced to stop;\n* 15th day: All workers in the Stakepool shut down. The withdrawal of Delegator A is then all satisfied.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1795, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ba3c7d1f-c384-422c-83c9-f302e40205d4": {"__data__": {"id_": "ba3c7d1f-c384-422c-83c9-f302e40205d4", "embedding": null, "metadata": {"file_path": "phala-docs_dist/staking-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a4d837e7-b28c-45e4-850b-76d68eef214e", "node_type": "4", "metadata": {}, "hash": "bf2e31383d4a6e502b5e37f455796b9d2077fd225b1cfa6a7f0dce5f5d47d8a3", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "0a95b98f-45a5-46fa-8c27-7f34dbe440aa", "node_type": "1", "metadata": {}, "hash": "c92b691cccd562ded8ff658719434d5967f3a88f9c1b624e24f9d9be884ba9a5", "class_name": "RelatedNodeInfo"}}, "text": "# Staking Mechanism\n\n## Introduction <a href=\"#introduction\" id=\"introduction\"></a>\n\nUnlike Polkadot or other Proof-of-Stake consensus systems, Phala can manage as many as one million CPU cores from over 100k nodes, which requires our staking mechanism to outperform existing PoS in both performance and efficiency. That\u2019s why we propose **Stake Delegation**, which introduces an extra role of StakePool into our system to connect computing nodes with PHA holders. Anyone can create a StakePool, and a PHA holder can delegate their PHA to the pool. Then the pool Owner can manage and stake for any Workers belonging to the pool.\n\nTo secure the cloud of workers and the assigned jobs, the network will set a [Confidence Level](../run-workers-on-khala/solo-scripts-guidance/worker-confidence-level.md)[ ](../run-workers-on-khala/solo-scripts-guidance/worker-confidence-level.md)for each worker\u2019s CPU and require Staking (a delegation) to mine. Each worker can only earn value V if it first stakes several PHA tokens based on its CPU score, after which it can enter the staking system and start supplying compute power.\n\nSuppose a worker misbehaves or fails to respond. In that case, it will be punished by slashing the V, which strongly incentivizes participants to ensure their workers are running properly and disincentivizes attempts to cheat.\n\n## Roles & Relationships <a href=\"#roles--relationships\" id=\"roles--relationships\"></a>\n\n### Roles <a href=\"#secure-enclave-mining-roles\" id=\"secure-enclave-mining-roles\"></a>\n\n| **Role**      | **Description**                                                                                                                                                                                                                                                                |\n| ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |\n| **Worker**    | A CPU. Responsible for off-chain computation in the Phala network (in a private and secure enclave).                                                                                                                                                                           |\n| **Operator**  | Authorized by a Worker to act as administrator, responsible for managing the workers.                                                                                                                                                                                          |\n| **PoolOwner** | The account which creates the StakePool. A StakePool manager who is responsible for the management of the pool and all the Workers bound to it.                                                                                                                                |\n| **StakePool** | A pool of stake from a group of parties backing a group of Workers.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 3063, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0a95b98f-45a5-46fa-8c27-7f34dbe440aa": {"__data__": {"id_": "0a95b98f-45a5-46fa-8c27-7f34dbe440aa", "embedding": null, "metadata": {"file_path": "phala-docs_dist/staking-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a4d837e7-b28c-45e4-850b-76d68eef214e", "node_type": "4", "metadata": {}, "hash": "bf2e31383d4a6e502b5e37f455796b9d2077fd225b1cfa6a7f0dce5f5d47d8a3", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ba3c7d1f-c384-422c-83c9-f302e40205d4", "node_type": "1", "metadata": {}, "hash": "1063040307f65544d1a95a459cef313c4f1a3ebadb58d3f23152be307f35a1d7", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b1dcf4c5-e23f-48e3-baec-6c89ceebd03a", "node_type": "1", "metadata": {}, "hash": "67ec2613f0b9091af987af8fb4e8c7bc1a8f631b50fa2ef798035d58f42e7328", "class_name": "RelatedNodeInfo"}}, "text": "It provides a middle layer of funds flowing between Workers and Delegators. It also provides on-chain management of staking. (Each StakePool is identified by a PID automatically generated by the system) |\n| **Delegator** | A PHA-holding address. It can participate in Phala Staking through **Stake Delegation.**                                                                                                                                                                                       |\n\n### Worker and StakePool <a href=\"#worker-and-stakepool\" id=\"worker-and-stakepool\"></a>\n\n<figure><img src=\"../../.gitbook/assets/staking.001.gif\" alt=\"\"><figcaption><p>Figure 1</p></figcaption></figure>\n\nAs shown in the initial image of Figure 1 above,\n\n* Owner-A creates Worker {A, B, C, D};\n* Owner-A creates Pool-1;\n* Owner-B creates Pool-2;\n\nIllustrated in the secondary visualization of Figure 1, a StakePool can add or manage a Worker only if the Operator of the Worker is the Owner of the pool. In this case,\n\n* Since Owner-A is both the Owner of Pool-1 and the Operator of Worker {A, B, C, D}, Pool-1 can bind Worker {A, B, C, D} to it, and Pool-1 can stake its PHA tokens for these Workers;\n* Owner-B is the Owner of Pool-2, while Pool-2 cannot add or manage any one of Worker {A, B, C, D} since Owner-B is not their Operator;\n\n> **Other cases:**\n>\n> * After Worker-A authorized Owner-A as an Operator, it cannot authorize Owner-B at the same time.", "mimetype": "text/plain", "start_char_idx": 3064, "end_char_idx": 4518, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b1dcf4c5-e23f-48e3-baec-6c89ceebd03a": {"__data__": {"id_": "b1dcf4c5-e23f-48e3-baec-6c89ceebd03a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/staking-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a4d837e7-b28c-45e4-850b-76d68eef214e", "node_type": "4", "metadata": {}, "hash": "bf2e31383d4a6e502b5e37f455796b9d2077fd225b1cfa6a7f0dce5f5d47d8a3", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "0a95b98f-45a5-46fa-8c27-7f34dbe440aa", "node_type": "1", "metadata": {}, "hash": "c92b691cccd562ded8ff658719434d5967f3a88f9c1b624e24f9d9be884ba9a5", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c13b642b-2ef7-427e-9d79-804bcaaa45ad", "node_type": "1", "metadata": {}, "hash": "60a830c7030c2f2685a580b05f0af1d2da03d8229db6c40b9032357652c78b3f", "class_name": "RelatedNodeInfo"}}, "text": "If Worker-A wants to transfer its control to Owner-B, it must first stop mining for Owner-A;\n> * An ownership transfer of a StakePool is currently not supported;\n\n### Delegator and Worker <a href=\"#delegator-and-worker\" id=\"delegator-and-worker\"></a>\n\n<figure><img src=\"../../.gitbook/assets/staking.003.gif\" alt=\"\"><figcaption><p>Figure 2</p></figcaption></figure>\n\nIn the baseline situation, Figure 2 shows the relationship between Worker, StakePool, and Delegator:\n\n* A StakePool can add and manage Workers;\n* A Delegator delegates his/her PHA tokens to the StakePool;\n* The StatePool stakes the PHA tokens from the Delegators for its Workers;\n\nIt is worth noting that during the staking, all the PHA tokens are kept at Delegators' addresses, and no transfer will occur.\n\nFigure 2, its secondary state, shows the full lifecycle of our mining process:\n\n1. Pool-1 is created, and it adds Worker {A, B, C, D};\n2. A PHA holder delegates his/her PHA tokens to Pool-1;\n3. Pool-1 stakes Delegator\u2019s PHA from its Workers;\n4. The Workers starting mining;\n5. In each block, Phala Blockchain will reward all the StakePools according to their shares of computing power;\n6. Pool-1 will divide its rewards into two parts according to its Commission rate: one for Delegators and the other for the pool Owner;\n\n## Commission <a href=\"#commission\" id=\"commission\"></a>\n\nTo avoid the case that many Workers cannot start mining for insufficient staking, we create StakePool to enable Delegators to delegate their PHA tokens to the StakePool and stake for Workers. A StakePool needs to set up two parameters for the reward distribution:\n\n| Parameter  | Full Name       | Meaning                                                                                                 |\n| ---------- | --------------- | ------------------------------------------------------------------------------------------------------- |\n| Commission | Commission Rate | The commission rate of the StakePool.The commission portion is deposited into the pool\u2019s Owner address. |\n| Cap        | Capacity        | The capacity of the PHA tokens in the StakePool.", "mimetype": "text/plain", "start_char_idx": 4519, "end_char_idx": 6638, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c13b642b-2ef7-427e-9d79-804bcaaa45ad": {"__data__": {"id_": "c13b642b-2ef7-427e-9d79-804bcaaa45ad", "embedding": null, "metadata": {"file_path": "phala-docs_dist/staking-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a4d837e7-b28c-45e4-850b-76d68eef214e", "node_type": "4", "metadata": {}, "hash": "bf2e31383d4a6e502b5e37f455796b9d2077fd225b1cfa6a7f0dce5f5d47d8a3", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b1dcf4c5-e23f-48e3-baec-6c89ceebd03a", "node_type": "1", "metadata": {}, "hash": "67ec2613f0b9091af987af8fb4e8c7bc1a8f631b50fa2ef798035d58f42e7328", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a5d18479-6515-40f8-8c94-262162b3a601", "node_type": "1", "metadata": {}, "hash": "9de8f6b16c386a92d8e9547687145ad47cc814249874a1308ff60d488d36dcf8", "class_name": "RelatedNodeInfo"}}, "text": "|\n\nThe rewards for the Owner and Delegators can be calculated by:\n\n* Owner Rewards = StakePool Rewards \u00d7 Commission\n* Delegator-A Rewards = StakePool Rewards \u00d7 (1 - Commission) \u00d7 Delegator-A\u2019s staking / All staking in StakePool\n\n> * If an Owner stakes to the pool, he/she is treated as a normal Delegator;\n> * All the staking in the pool can be divided into _deposit_ and _free_;\n\nAfter Delegators delegate their tokens to the pool, there are two more parameters:\n\n| Parameter       | Full Name       | Meaning                                                                                                                                      |\n| --------------- | --------------- | -------------------------------------------------------------------------------------------------------------------------------------------- |\n| Cap Gap         | Capacity Gap    | The difference between Cap and the real amount of delegated tokens. It shows the number of tokens that can be further delegated to the pool. |\n| Free Delegation | Free Delegation | The difference between the amount of delegated tokens and the ones that have been staked. It shows the free tokens which can be used.        |\n\nWhen there are free tokens in a pool, its Owner has multiple choices:\n\n* Add more Workers;\n* Overstake for its Workers (to change the staking of a Worker requires it to stop mining first, and this can cause a drop in value $V$);\n* Just keep the free tokens in case of Delegators' withdrawal;\n\n## Staking <a href=\"#staking\" id=\"staking\"></a>\n\n### Case 1: Insufficient Staking <a href=\"#case-1-insufficient-staking\" id=\"case-1-insufficient-staking\"></a>\n\n<figure><img src=\"../../.gitbook/assets/staking.005.png\" alt=\"\"><figcaption><p>Figure 3</p></figcaption></figure>\n\nAssuming Worker-A and Worker-B require staking of 2000 PHA, respectively. And Worker-C and Worker-C require staking of 3000 PHA, respectively.", "mimetype": "text/plain", "start_char_idx": 6694, "end_char_idx": 8594, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a5d18479-6515-40f8-8c94-262162b3a601": {"__data__": {"id_": "a5d18479-6515-40f8-8c94-262162b3a601", "embedding": null, "metadata": {"file_path": "phala-docs_dist/staking-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a4d837e7-b28c-45e4-850b-76d68eef214e", "node_type": "4", "metadata": {}, "hash": "bf2e31383d4a6e502b5e37f455796b9d2077fd225b1cfa6a7f0dce5f5d47d8a3", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c13b642b-2ef7-427e-9d79-804bcaaa45ad", "node_type": "1", "metadata": {}, "hash": "60a830c7030c2f2685a580b05f0af1d2da03d8229db6c40b9032357652c78b3f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f896687b-f7c9-452e-9577-6c2072214340", "node_type": "1", "metadata": {}, "hash": "d02b1f35ea92bafd6dae112ba65e2be651ffd1f7f941a408bfb5548ed369f3f9", "class_name": "RelatedNodeInfo"}}, "text": "If Delegators stake 7000 PHA in total to the StakePool:\n\n* Since all the Workers in Pool-1 require a minimum total staking of 10000 PHA, the amount of PHA in the pool is not enough for all the Workers to start mining;\n* Pool-1 could choose to only start Worker {A, B, C};\n\n### Case 2: Commission Setup and Reward Distribution <a href=\"#case-2-commission-setup-and-reward-distribution\" id=\"case-2-commission-setup-and-reward-distribution\"></a>\n\n<figure><img src=\"../../.gitbook/assets/staking.007.gif\" alt=\"\"><figcaption><p>Figure 4</p></figcaption></figure>\n\n**Scenario 1 in Figure 4** shows the whole process of reward distribution and the commission rate\u2019s effect on it:\n\n1. Pool-1 is created, and it adds Worker {A, B, C, D} with a minimum total staking of 10000 PHA. Its Commission is set to 60%;\n2. 5 Delegators each delegates 1400 PHA to the pool. Now there are 7000 PHA in the pool;\n3. Pool-1 stakes 7000 PHA for the Worker {A, B, C}, and Worker-D has no staking since there are not enough PHA;\n4. Worker {A, B, C} start mining;\n5. Phala Blockchain rewards 10 PHA to Pool-1 for its computing power;\n6. Pool-1 divides its rewards into two parts according to the 60% Commission: 4 PHA is distributed equally to the 5 Delegators, with 0.8 PHA for each; 6 PHA to the pool Owner;\n\n**Scenario 2 in Figure 4** shows the case of reward distribution when there are Free Delegation since the delegated tokens are more than those that have been staked:\n\n1. Pool-1 is created, and it adds Worker {A, B, C, D} with a minimum total staking of 10000 PHA. Its Commission is set to 60%;\n2. 5 Delegators each delegate 1400 PHA to the pool, and one more Delegator-Rich delegates 5000 PHA.", "mimetype": "text/plain", "start_char_idx": 8595, "end_char_idx": 10271, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f896687b-f7c9-452e-9577-6c2072214340": {"__data__": {"id_": "f896687b-f7c9-452e-9577-6c2072214340", "embedding": null, "metadata": {"file_path": "phala-docs_dist/staking-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a4d837e7-b28c-45e4-850b-76d68eef214e", "node_type": "4", "metadata": {}, "hash": "bf2e31383d4a6e502b5e37f455796b9d2077fd225b1cfa6a7f0dce5f5d47d8a3", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a5d18479-6515-40f8-8c94-262162b3a601", "node_type": "1", "metadata": {}, "hash": "9de8f6b16c386a92d8e9547687145ad47cc814249874a1308ff60d488d36dcf8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "85498229-252a-4393-9c71-4d5cac0d43ea", "node_type": "1", "metadata": {}, "hash": "787002943f2ce50ba53bf0aebfca74c7f75647eeff3c7db24f656d44ae777393", "class_name": "RelatedNodeInfo"}}, "text": "Now there are 12000 PHA in the pool;\n3. Pool-1 only stakes the necessary amount of tokens for each Worker (10000 PHA in total), and leaves 2000 PHA Free Delegation;\n4. Worker {A, B, C, D} start mining;\n5. Phala Blockchain rewards 10 PHA to Pool-1 for its computing power;\n6. Pool-1 divides its rewards into two parts according to the 60% Commission: 4 PHA is distributed to the Delegators, with 0.47 PHA for normal Delegator and 1.6 PHA for Delegator-Rich;\n7. 6 PHA is rewarded to the pool Owner;\n\n## Exit Staking <a href=\"#exit-staking\" id=\"exit-staking\"></a>\n\nIf the Owner and Delegators want to quit mining and withdraw their own staked PHA, they first suspend mining. After the request is initiated, the staked funds will undergo a 7-day freeze period in the StakePool, after which the balance will be unfrozen and returned. The Owner cannot withdraw other Delegators' deposits.\n\n<figure><img src=\"../../.gitbook/assets/staking.008.gif\" alt=\"\"><figcaption><p>Figure 5</p></figcaption></figure>\n\nAs shown in the first scenario in Figure 5, if a Delegator sends a withdrawal request, and the amount he requests is less than the Free Delegation in the pool, gets his funds back.\n\nWhile if the requested amount is larger than the Free Delegation, he can only get the Free Delegation and has to wait for the rest to be available.\n\nIn the second scenario in Figure 5, the Delegator wants to withdraw 4000 PHA; while there are only 2000 PHA Free Delegation in the pool, he will immediately get 2000 PHA and needs to wait for the rest of 2000 PHA.\n\nAt this time, there is a funding gap of 2000 PHA, and the Owner of Pool-1 has two choices:\n\nIn the third scenario in Figure 5, if no extra PHA is delegated to the pool within seven days, then all its Workers will be forced to stop mining and enter a 7-day freeze period. This freeze period cannot be interrupted by anyone.", "mimetype": "text/plain", "start_char_idx": 10272, "end_char_idx": 12139, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "85498229-252a-4393-9c71-4d5cac0d43ea": {"__data__": {"id_": "85498229-252a-4393-9c71-4d5cac0d43ea", "embedding": null, "metadata": {"file_path": "phala-docs_dist/staking-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a4d837e7-b28c-45e4-850b-76d68eef214e", "node_type": "4", "metadata": {}, "hash": "bf2e31383d4a6e502b5e37f455796b9d2077fd225b1cfa6a7f0dce5f5d47d8a3", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f896687b-f7c9-452e-9577-6c2072214340", "node_type": "1", "metadata": {}, "hash": "d02b1f35ea92bafd6dae112ba65e2be651ffd1f7f941a408bfb5548ed369f3f9", "class_name": "RelatedNodeInfo"}}, "text": "Therefore, after seven days, the withdrawal request will be fulfilled.\n\nAs shown in the fourth scenario in Figure 5, within seven days, if additional PHA is delegated to the pool or workers stop mining and release the staking, then this Free Delegation will be sent to the owed Delegator until his withdrawal request is fulfilled.\n\n### How to reclaim <a href=\"#how-to-reclaim\" id=\"how-to-reclaim\"></a>\n\n{% embed url=\"https://youtu.be/U0yJ0SqR5hg?list=PLdAYriWvzwzqDXUp226VGVOntofoG5KRq\" %}\n\n## Summary <a href=\"#summary\" id=\"summary\"></a>\n\n* A Delegator can exit staking in at most 14 days;\n* The Owner of the StakePool should take care of the Free Delegation, and introduce extra delegation or reduce mining Workers as needed. Or all the Workers in the pool can be forced to stop mining.", "mimetype": "text/plain", "start_char_idx": 12140, "end_char_idx": 12928, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0e8ae87e-80fd-4c4e-aa96-4a031035b0c9": {"__data__": {"id_": "0e8ae87e-80fd-4c4e-aa96-4a031035b0c9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/agent-wars-introduction.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "837dd890-373d-4fee-b6a7-3f7de4527571", "node_type": "4", "metadata": {}, "hash": "38e36e5076401691cc78801d8f80cb46fe25c4ead86cabad8313c3dc81a3df20", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83d\udcdc Concepts\n\n## What is Agent Wars?\n\nAgent Wars is the first experiment on combining tokenomics and AI agents.\n\nAgent Wars enables anyone, even non-engineers, to create their own agent (a unique avatar tied to an X account). Importantly, each agent is born with default tokenomics, allowing the agent's creator and contributors to benefit from the agent's improvement.\n\nIn Agent Wars, we offer a default tokenomics that facilitates staking-based DAO governance on the agents. Briefly, each agent has keys as shares which users can buy and sell. Owning at least one key allows you to chat with the agent.\n\nKey to note is that all agent management is based on on-chain voting weighted by key numbers.\n\nThe key price increases as more keys are sold, thereby raising the value of existing keys. Hence, the most efficient way for key owners to profit is by improving their agents to attract more buyers.\n\n<figure><img src=\"../.gitbook/assets/AgentWars (1).png\" alt=\"\" width=\"563\"><figcaption></figcaption></figure>\n\n## How Does it Work?\n\nAgent Wars is consisted of two parts: the on-chain smart contracts that defines the tokenomics, and the off-chain agents that are fully controlled by the tokenomics contracts.\n\nThe enforcement of the tokenomics over agents is achieved by running agents on trustless infrastructure of Phala. With its secure off-chain workers, we can ensure the privacy of the agent setup (which is the soul of the agent), and each agent is correctly token-gated given the key distribution.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1506, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "736e9ce6-a6d7-453b-9576-10aea608b936": {"__data__": {"id_": "736e9ce6-a6d7-453b-9576-10aea608b936", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deployment-guide-for-prbv2.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "278a1202-cd20-42aa-b45b-777874488bc1", "node_type": "4", "metadata": {}, "hash": "635c558ace1db3b41e37b6477eb520266f5fb27dcb8b0cba565b67850d407293", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b52eb525-a592-45f5-bbce-25e35e6d14df", "node_type": "1", "metadata": {}, "hash": "42ad75e75e6f6b14fa1248734074f032b371f918bfc6166dc59e3777116a7d85", "class_name": "RelatedNodeInfo"}}, "text": "# PRBv2 Deployment Guide\n\n## Now PRBv2 is out of date. Please use PRBv3 <a href=\"#understanding-runtime-bridge\" id=\"understanding-runtime-bridge\"></a>\n\n## Understanding Runtime Bridge <a href=\"#understanding-runtime-bridge\" id=\"understanding-runtime-bridge\"></a>\n\nFollowing services make a Runtime Bridge setup work:\n\n* Data Provider (a.k.a `data_provider`):\n  * Fetches and analyses block data from Substrate,\n  * Makes pre-encoded blobs that `pRuntime` consumes,\n  * Serves pre-encoded blobs for lifecycle managers;\n* Lifecycle Manager (a.k.a `lifecycle`):\n  * Sends block data blobs to workers(`pRuntime`),\n  * Registers worker on the chain,\n  * Starts mining with configured stake amount,\n  * Provides API to query workers and pools.\n* Trader (a.k.a `trade`):\n  * Sends transactions from queue to the chain.\n\nEvery service above uses [Runtime Bridge Walkie](https://github.com/Phala-Network/runtime-bridge-walkie) as a communication method built on `libp2p` and Protocol Buffer. On the first startup of each service, an RSA key pair will be generated(by default saved in `/var/data/keys/id`) to be used as the identity in the `libp2p` protocol. The current identity public key can be found in the stdout of running service by searching `Got my peer id` in the base58 format. And for lifecycle managers, the key pair is used to encrypt critical information. **DO BACK THE KEYS UP AND KEEP THE KEYS SAFE.**\n\nWhen the lifecycle manager has finished the initial blob synchronization, it will attempt to sync messages in the message queue between the `pRuntime` and the blockchain. After that, it will try to register workers and do the \u201cstart mining\u201d operation on the blockchain.\n\nExtrinsics (transactions) shall be sent to the blockchain for the operation mentioned above. To achieve this, the lifecycle manager shall push the extrinsics data to the trader queue(currently maintained with Redis). The trader will grab jobs from the queue and report the extrinsic results back.\n\nRuntime Bridge doesn\u2019t require a SGX environment.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2028, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b52eb525-a592-45f5-bbce-25e35e6d14df": {"__data__": {"id_": "b52eb525-a592-45f5-bbce-25e35e6d14df", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deployment-guide-for-prbv2.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "278a1202-cd20-42aa-b45b-777874488bc1", "node_type": "4", "metadata": {}, "hash": "635c558ace1db3b41e37b6477eb520266f5fb27dcb8b0cba565b67850d407293", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "736e9ce6-a6d7-453b-9576-10aea608b936", "node_type": "1", "metadata": {}, "hash": "f4ddfff7f51bf78fae80b7af3f0389e51b752b6eeb57bf04e1d5280e10da163a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "72eabe6c-083a-49c1-8bfa-1a98beb4e4e7", "node_type": "1", "metadata": {}, "hash": "c2db18134712f5f69ae1c0bca1e22006e1783b762db65a6bd6ca2e2fd996e446", "class_name": "RelatedNodeInfo"}}, "text": "### Understanding the startup process and internal dependencies <a href=\"#understanding-the-startup-process-and-internal-dependencies\" id=\"understanding-the-startup-process-and-internal-dependencies\"></a>\n\nData providers and lifecycle managers are designed to discover each other using `libp2p`. While starting the service, it connects to the blockchain then analyses the `chainIdentity` from the `parachain`, `libp2p` will be initialized with the identity key and the `chainIdentity`. After the initialization, the service should begin its work and discover other peers via mDNS as well as the bootstrap node configured.\n\nA data provider fetches data from the `parachain` and the `relaychain`(called `parent chain` in Substrate). It starts a standalone TCP server for blob synching due to the performance issue of `libp2p`, the port of which will be included in the peer handshake process.\n\nWhile starting the lifecycle manager, it connects to the Redis server for the trade queue. There should be only 1 lifecycle manager and 1 trader accessing the same Redis server. The trader paired with the lifecycle manager should use the same identity key to ensure that the trader can decrypt the private key of saved pools. While the lifecycle requires a specified Redis server to start, it doesn\u2019t require any data provider to start the service. It will wait until any valid data providers are discovered, which means it\u2019s safe to stop the data provider when the lifecycle manager running, and you can build an HA setup for data providers.\n\nData in the Redis server should never be persisted since the lifecycle manager always builds states from the blockchain and `pRuntime`. Restart the lifecycle manager, the trader, and the Redis server together when any error occurs.\n\n## Quickstart with Docker Compose <a href=\"#quickstart-with-docker-compose\" id=\"quickstart-with-docker-compose\"></a>\n\nWe recommend deploying the services with Docker Compose, to install Docker and Docker Compose, please refer to the documentation:\n\n* [Installing Docker](https://docs.docker.com/engine/install/#server)\n* [Installing Docker Compose](https://docs.docker.com/compose/install/)\n\nWe assume you have already [acknowledged the basic usage](https://docs.docker.com/compose/gettingstarted/) of Docker and Docker Compose to complete this guide.", "mimetype": "text/plain", "start_char_idx": 2030, "end_char_idx": 4350, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "72eabe6c-083a-49c1-8bfa-1a98beb4e4e7": {"__data__": {"id_": "72eabe6c-083a-49c1-8bfa-1a98beb4e4e7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deployment-guide-for-prbv2.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "278a1202-cd20-42aa-b45b-777874488bc1", "node_type": "4", "metadata": {}, "hash": "635c558ace1db3b41e37b6477eb520266f5fb27dcb8b0cba565b67850d407293", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b52eb525-a592-45f5-bbce-25e35e6d14df", "node_type": "1", "metadata": {}, "hash": "42ad75e75e6f6b14fa1248734074f032b371f918bfc6166dc59e3777116a7d85", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f823ccac-6dff-4fc4-a0e0-a48ca9f743eb", "node_type": "1", "metadata": {}, "hash": "0446052890c253c950b6fa3f2fc07b12b3751ecd885ec013d3bdd20c3c1704bf", "class_name": "RelatedNodeInfo"}}, "text": "The `host` network driver is recommended when deploying with Docker to work with the auto discovery feature of Runtime Bridge.\n\n### Local Node <a href=\"#local-node\" id=\"local-node\"></a>\n\nEdit and save following content in `docker-compose.yml` in a directory for node deployment:\n\n```\nversion: \"3\"\nservices:\n  node:\n    image: phalanetwork/khala-node:latest\n    container_name: node\n    hostname: node\n    restart: always\n    ports:\n     - \"9933:9933\"\n     - \"9934:9934\"\n     - \"9944:9944\"\n     - \"9945:9945\"\n     - \"30333:30333\"\n     - \"30334:30334\"\n    environment:\n     - NODE_NAME=PNODE\n     - NODE_ROLE=MINER\n    volumes:\n     - /var/khala-dev-node:/root/data\n```\n\nIt\u2019s recommended to build a TCP load balancer for the node in production environment.", "mimetype": "text/plain", "start_char_idx": 4352, "end_char_idx": 5106, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f823ccac-6dff-4fc4-a0e0-a48ca9f743eb": {"__data__": {"id_": "f823ccac-6dff-4fc4-a0e0-a48ca9f743eb", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deployment-guide-for-prbv2.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "278a1202-cd20-42aa-b45b-777874488bc1", "node_type": "4", "metadata": {}, "hash": "635c558ace1db3b41e37b6477eb520266f5fb27dcb8b0cba565b67850d407293", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "72eabe6c-083a-49c1-8bfa-1a98beb4e4e7", "node_type": "1", "metadata": {}, "hash": "c2db18134712f5f69ae1c0bca1e22006e1783b762db65a6bd6ca2e2fd996e446", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "684cd40a-9548-4789-8de0-581f0e65cab9", "node_type": "1", "metadata": {}, "hash": "611db0cbcdd749d019ce2004a147bee9e8a1a6cddb918454d341229be5fff455", "class_name": "RelatedNodeInfo"}}, "text": "### Data Provider <a href=\"#data-provider\" id=\"data-provider\"></a>\n\nEdit and save following content in `docker-compose.yml` in another directory:\n\n```\nversion: \"3\"\n\nx-defaults: &defaults\n  volumes: &default-volume-config\n    - ./data:/var/data\n\nservices:\n  data_provider:\n    image: phalanetwork/prb:next\n    hostname: data_provider\n    network_mode: host\n    restart: always\n    volumes: *default-volume-config\n    logging:\n      options:\n        max-size: \"1g\"\n    environment:\n      - PHALA_MODULE=data_provider\n      - NODE_ENV=development\n      - PHALA_LOGGER_LEVEL=debug\n      - PHALA_PARENT_CHAIN_ENDPOINT=ws://path.to.kusama.node:9945\n      - PHALA_CHAIN_ENDPOINT=ws://path.to.khala.node:9944\n      - PHALA_WALKIE_LISTEN_ADDRESSES=/ip4/0.0.0.0/tcp/28888\n      - PHALA_BRIDGE_IDENTITY=production\n      - PHALA_LIFECYCLE_BLOB_SERVER_SESSION_MAX_MEMORY=64\n    entrypoint:\n      - \"node\"\n      - \"--trace-warnings\"\n      - \"--experimental-json-modules\"\n      - \"--es-module-specifier-resolution=node\"\n      - \"--harmony-top-level-await\"\n      - \"dist/index\"\n\n  monitor:\n    image: phalanetwork/prb-monitor:next\n    hostname: monitor\n    network_mode: host\n    environment:\n      - PTP_BOOT_NODES=/ip4/127.0.0.1/tcp/28888/peer_id_of_data_provider\n\n```\n\nRun `docker-compose up` to start the data provider, open the monitor with `http://localhost:3000` in the browser, you will see the status of the data provider even the `PTP_BOOT_NODES` has not been set properly.\n\nOne data provider can be shared by multiple lifecycle managers.", "mimetype": "text/plain", "start_char_idx": 5108, "end_char_idx": 6640, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "684cd40a-9548-4789-8de0-581f0e65cab9": {"__data__": {"id_": "684cd40a-9548-4789-8de0-581f0e65cab9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deployment-guide-for-prbv2.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "278a1202-cd20-42aa-b45b-777874488bc1", "node_type": "4", "metadata": {}, "hash": "635c558ace1db3b41e37b6477eb520266f5fb27dcb8b0cba565b67850d407293", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f823ccac-6dff-4fc4-a0e0-a48ca9f743eb", "node_type": "1", "metadata": {}, "hash": "0446052890c253c950b6fa3f2fc07b12b3751ecd885ec013d3bdd20c3c1704bf", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "4240add0-1034-47f7-91d4-67ec04ffa382", "node_type": "1", "metadata": {}, "hash": "b1489c1a39eab2dbc342bc364aa7028f7af57e38dd00c3d3e086c9bd45a51136", "class_name": "RelatedNodeInfo"}}, "text": "### Lifecycle Manager and Trader <a href=\"#lifecycle-manager-and-trader\" id=\"lifecycle-manager-and-trader\"></a>\n\nEdit and save following content in `docker-compose.yml`:\n\n```\nversion: \"3\"\n\nx-defaults: &defaults\n  volumes: &default-volume-config\n    - ./data:/var/data\n\nservices:\n  redis-q:\n    network_mode: host\n    image: redis:alpine\n    hostname: redis-q\n    restart: always\n    logging:\n      options:\n        max-size: \"1g\"\n    command: [\"redis-server\", \"--port\", \"63792\", \"--appendonly\", \"no\", '--save', '']\n\n  lifecycle:\n    network_mode: host\n    image: phalanetwork/prb:next\n    hostname: lifecycle\n    restart: always\n    depends_on:\n      - redis-q\n    volumes: *default-volume-config\n    logging:\n      options:\n        max-size: \"1g\"\n    environment:\n      - PHALA_MODULE=lifecycle\n      - PHALA_PARENT_CHAIN_ENDPOINT=ws://path.to.kusama.node:9945\n      - PHALA_CHAIN_ENDPOINT=ws://path.to.khala.node:9944\n      - PHALA_Q_REDIS_ENDPOINT=redis://127.0.0.1:63792/\n      - PHALA_LRU_CACHE_SIZE=50\n      - PHALA_LRU_CACHE_MAX_AGE=90000\n      - PHALA_RUNNER_MAX_WORKER_NUMBER=100\n      - PHALA_PRPC_REQUEST_TIMEOUT=60000\n      - PHALA_BRIDGE_IDENTITY=production\n      - PHALA_WALKIE_LISTEN_ADDRESSES=/ip4/0.0.0.0/tcp/29888\n      - PHALA_WALKIE_BOOT_NODES=/ip4/ip.of.data.provider/tcp/28888/p2p/some_peer_id\n      - WORKER_KEEPALIVE_ENABLED=true\n      - USE_BUILT_IN_TRADER=true\n    entrypoint:\n      - \"node\"\n      - \"--trace-warnings\"\n      - \"--experimental-json-modules\"\n      - \"--es-module-specifier-resolution=node\"\n      - \"--harmony-top-level-await\"\n      - \"dist/index\"\n```\n\nRun `docker-compose up` to start the data provider, the lifecycle manager should be discovered and accessible in the monitor.", "mimetype": "text/plain", "start_char_idx": 6642, "end_char_idx": 8360, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4240add0-1034-47f7-91d4-67ec04ffa382": {"__data__": {"id_": "4240add0-1034-47f7-91d4-67ec04ffa382", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deployment-guide-for-prbv2.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "278a1202-cd20-42aa-b45b-777874488bc1", "node_type": "4", "metadata": {}, "hash": "635c558ace1db3b41e37b6477eb520266f5fb27dcb8b0cba565b67850d407293", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "684cd40a-9548-4789-8de0-581f0e65cab9", "node_type": "1", "metadata": {}, "hash": "611db0cbcdd749d019ce2004a147bee9e8a1a6cddb918454d341229be5fff455", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "7caab142-8bc7-47a1-b53c-c4ffeca4ea40", "node_type": "1", "metadata": {}, "hash": "b394cc0ac9b38c7dd7faa8ff3d61c534eef7479792aea6bdda02a29087c4f71a", "class_name": "RelatedNodeInfo"}}, "text": "Open `http://127.0.0.1:4567` in the browser to check the queue of on-chain transactions.\n\n## Configuring Runtime Bridge <a href=\"#configuring-runtime-bridge\" id=\"configuring-runtime-bridge\"></a>\n\nServices with a Runtime Bridges setup are configured with environment variables.\n\n### Shared items <a href=\"#shared-items\" id=\"shared-items\"></a>\n\n| Name                             | Description                                                                                                                                                                                                                                                               |\n| -------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| NODE\\_ENV                        | Application environment, set to development to put the app in development mode.                                                                                                                                                                                           |\n| PHALA\\_MODULE                    | The module to start.                                                                                                                                                                                                                                                      |\n| PHALA\\_LOGGER\\_LEVEL             | Logger level, defaults to info. See https://github.com/trentm/node-bunyan for more information.                                                                                                                                                                           |\n| PHALA\\_CHAIN\\_ENDPOINT           | The WebSocket endpoint to the Substrate RPC of parachain.                                                                                                                                                                                                                 |\n| PHALA\\_PARENT\\_CHAIN\\_ENDPOINT   | The WebSocket endpoint to the Substrate RPC of relaychain(e.g. for Khala it\u2019s Kusama).                                                                                                                                                                                    |\n| PHALA\\_PEER\\_ID\\_PREFIX          | The path storing identity keys, defaults to \u2018/var/data/keys/id\u2019.                                                                                                                                                                                                          |\n| PHALA\\_WALKIE\\_LISTEN\\_ADDRESSES | The multiaddr(https://github.com/libp2p/specs/tree/master/addressing) of listen address for libp2p, defaults to \u2018/ip4/0.0.0.0/tcp/0,/ip6/::/tcp/0\u2019 which means listen to a random port on every interface. Only TCP protocol is supported. Use a comma between addresses. |\n| PHALA\\_WALKIE\\_BOOT\\_NODES       | The multiaddr list of bootstrap nodes for peer discovery, defaults to \u2018/ip4/0.0.0.0/tcp/18888,/ip6/::/tcp/28889\u2019 which means no bootstrap node. Only TCP protocol is supported. Use a comma between addresses.                                                            |\n| PHALA\\_BRIDGE\\_IDENTITY          | The bridge identity in the PRB Walkie protocol, used to specify namespace.", "mimetype": "text/plain", "start_char_idx": 8362, "end_char_idx": 11866, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7caab142-8bc7-47a1-b53c-c4ffeca4ea40": {"__data__": {"id_": "7caab142-8bc7-47a1-b53c-c4ffeca4ea40", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deployment-guide-for-prbv2.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "278a1202-cd20-42aa-b45b-777874488bc1", "node_type": "4", "metadata": {}, "hash": "635c558ace1db3b41e37b6477eb520266f5fb27dcb8b0cba565b67850d407293", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "4240add0-1034-47f7-91d4-67ec04ffa382", "node_type": "1", "metadata": {}, "hash": "b1489c1a39eab2dbc342bc364aa7028f7af57e38dd00c3d3e086c9bd45a51136", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "22206664-efdb-4e8a-862c-c39e89de4665", "node_type": "1", "metadata": {}, "hash": "b2c9fca7f080cfd495b9979cfccc83ad0dc90b48ab6eb635ec71162269ba1161", "class_name": "RelatedNodeInfo"}}, "text": "|\n\n### Items for data providers <a href=\"#items-for-data-providers\" id=\"items-for-data-providers\"></a>\n\n| Name                                       | Description                                            |\n| ------------------------------------------ | ------------------------------------------------------ |\n| PHALA\\_LOCAL\\_DB\\_PATH                     | The path to database, defaults to \u2018/var/data/0\u2019.       |\n| PHALA\\_DATA\\_PROVIDER\\_LOCAL\\_SERVER\\_PORT | The listen port for the blob server, defaults to 8012. |\n\n### Items for lifecycle managers <a href=\"#items-for-lifecycle-managers\" id=\"items-for-lifecycle-managers\"></a>\n\n| Name                               | Description                                                                                                                                         |\n| ---------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------- |\n| PHALA\\_Q\\_REDIS\\_ENDPOINT          | The endpoint to the Redis for trader task queue.                                                                                                    |\n| PHALA\\_RUNNER\\_MAX\\_WORKER\\_NUMBER | The maximum worker number of one runner, defaults to 150.                                                                                           |\n| PHALA\\_LIFECYCLE\\_CONFIG\\_MODE     | Whether the lifecycle manager should enter config mode, where it will start only the API to add/modify saved pools/workers. Set to true to enable.  |\n| PHALA\\_LRU\\_CACHE\\_SIZE            | The size of LRU cache, defaults to 5000.                                                                                                            |\n| PHALA\\_LRU\\_CACHE\\_MAX\\_AGE        | The maximum age of items in the LRU cache in milliseconds, defaults to 30 minutes.                                                                  |\n| PHALA\\_ENFORCE\\_MIN\\_BENCH\\_SCORE  | Whether the lifecycle manager should re-try the worker registration on the chain if the on-chain benchmark score to too low. Set to true to enable. |\n| PHALA\\_MIN\\_BENCH\\_SCORE           | Desired minimum benchmark score.                                                                                                                    |\n\n### Items for trader <a href=\"#items-for-trader\" id=\"items-for-trader\"></a>\n\n| Name                      | Description                               |\n| ------------------------- | ----------------------------------------- |\n| PHALA\\_Q\\_REDIS\\_ENDPOINT | The endpoint to the Redis for task queue. |\n\n### Configuring Node.js memory usage <a href=\"#configuring-nodejs-memory-usage\" id=\"configuring-nodejs-memory-usage\"></a>\n\nOnly do this when you are suffering from OOM issues.", "mimetype": "text/plain", "start_char_idx": 12058, "end_char_idx": 14869, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "22206664-efdb-4e8a-862c-c39e89de4665": {"__data__": {"id_": "22206664-efdb-4e8a-862c-c39e89de4665", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deployment-guide-for-prbv2.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "278a1202-cd20-42aa-b45b-777874488bc1", "node_type": "4", "metadata": {}, "hash": "635c558ace1db3b41e37b6477eb520266f5fb27dcb8b0cba565b67850d407293", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "7caab142-8bc7-47a1-b53c-c4ffeca4ea40", "node_type": "1", "metadata": {}, "hash": "b394cc0ac9b38c7dd7faa8ff3d61c534eef7479792aea6bdda02a29087c4f71a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "7fcc454c-04f3-4f14-b1ec-8ddc8d76e30b", "node_type": "1", "metadata": {}, "hash": "49edb0a04916c7580224c25e67617622437ee90ad5fe3a0113328b2fdc2865c6", "class_name": "RelatedNodeInfo"}}, "text": "Change the docker entrypoint to `node -trace-warnings -experimental-json-modules -es-module-specifier-resolution=node -harmony-top-level-await -max-old-space-size=$MAX_OLD_SPACE_SIZE dist/index`. Change the `$MAX_OLD_SPACE_SIZE` to your desired size in MB.\n\n[https://nodejs.org/dist/latest-v16.x/docs/api/cli.html#\u2013max-old-space-sizesize-in-megabytes](https://nodejs.org/dist/latest-v16.x/docs/api/cli.html#--max-old-space-sizesize-in-megabytes)\n\n## Using the monitor <a href=\"#using-the-monitor\" id=\"using-the-monitor\"></a>\n\nThe [monitor](https://github.com/Phala-Network/runtime-bridge/tree/next) is an example of the Walkie usage. It provides a simple management ability to play with Runtime Bridge.\n\nIt also implements a JSON proxy to the Walkie API.\n\n`POST /ptp/discover` returns the list of discovered peers.\n\n`POST /ptp/proxy/:peer_id/:method` sends the API request to the specified peer.\n\nThe API definition can be found in [https://github.com/Phala-Network/runtime-bridge-walkie/blob/master/src/proto/message.proto#L78](https://github.com/Phala-Network/runtime-bridge-walkie/blob/master/src/proto/message.proto#L78).", "mimetype": "text/plain", "start_char_idx": 14871, "end_char_idx": 15996, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7fcc454c-04f3-4f14-b1ec-8ddc8d76e30b": {"__data__": {"id_": "7fcc454c-04f3-4f14-b1ec-8ddc8d76e30b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deployment-guide-for-prbv2.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "278a1202-cd20-42aa-b45b-777874488bc1", "node_type": "4", "metadata": {}, "hash": "635c558ace1db3b41e37b6477eb520266f5fb27dcb8b0cba565b67850d407293", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "22206664-efdb-4e8a-862c-c39e89de4665", "node_type": "1", "metadata": {}, "hash": "b2c9fca7f080cfd495b9979cfccc83ad0dc90b48ab6eb635ec71162269ba1161", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a7f9b6a4-b7bc-4bc6-97f9-171f8866ea61", "node_type": "1", "metadata": {}, "hash": "64932a8674b461d3144e942fd8422fe22b803b98929fe6448dc8d6295a1d22b9", "class_name": "RelatedNodeInfo"}}, "text": "## Import pools and workers <a href=\"#import-pools-and-workers\" id=\"import-pools-and-workers\"></a>\n\nTo import pools: [https://github.com/Phala-Network/runtime-bridge-walkie/blob/master/src/proto/message.proto#L95](https://github.com/Phala-Network/runtime-bridge-walkie/blob/master/src/proto/message.proto#L95)\n\nWith monitor:\n\n```\ncurl --location --request POST 'http://path.to.monitor/ptp/proxy/Qmbz...RjpwY/CreatePool' \\\n--header 'Content-Type: application/json' \\\n--data-raw '{\n    \"pools\": [\n        {\n            \"pid\": 2,\n            \"name\": \"test2\",\n            \"owner\": {\n                \"mnemonic\": \"boss...chase\"\n            },\n            \"enabled\": true,\n            \"realPhalaSs58\": \"3zieG9...1z5g\"\n        }\n    ]\n}'\n```\n\nTo import workers: [https://github.com/Phala-Network/runtime-bridge-walkie/blob/master/src/proto/message.proto#L98](https://github.com/Phala-Network/runtime-bridge-walkie/blob/master/src/proto/message.proto#L98)\n\nWith monitor:\n\n```\ncurl --location --request POST 'http://path.to.monitor/ptp/proxy/Qmbz...RjpwY/CreateWorker' \\\n--header 'Content-Type: application/json' \\\n--data-raw '{\n    \"workers\": [\n        {\n            \"pid\": 2,\n            \"name\": \"test-node-1\",\n            \"endpoint\": \"http://path.to.worker1:8000\",\n            \"enabled\": true,\n            \"stake\": \"4000000000000000\"\n        },\n        {\n            \"pid\": 2,\n            \"name\": \"test-node-2\",\n            \"endpoint\": \"http://path.to.worker2:8000\",\n            \"enabled\": true,\n            \"stake\": \"4000000000000000\"\n        }\n    ]\n}'\n```\n\nRestart the lifecycle manager after modified pools/workers.", "mimetype": "text/plain", "start_char_idx": 15998, "end_char_idx": 17610, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a7f9b6a4-b7bc-4bc6-97f9-171f8866ea61": {"__data__": {"id_": "a7f9b6a4-b7bc-4bc6-97f9-171f8866ea61", "embedding": null, "metadata": {"file_path": "phala-docs_dist/deployment-guide-for-prbv2.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "278a1202-cd20-42aa-b45b-777874488bc1", "node_type": "4", "metadata": {}, "hash": "635c558ace1db3b41e37b6477eb520266f5fb27dcb8b0cba565b67850d407293", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "7fcc454c-04f3-4f14-b1ec-8ddc8d76e30b", "node_type": "1", "metadata": {}, "hash": "49edb0a04916c7580224c25e67617622437ee90ad5fe3a0113328b2fdc2865c6", "class_name": "RelatedNodeInfo"}}, "text": "## Community Works\n\nThese resources contributed by the community might be useful, use at your own risk:\n\n* [\u4e2d\u6587\u90e8\u7f72\u6559\u7a0b / Deployment guide in Chinese](https://github.com/suugee/phala-prb/tree/next)\n* [Staking Calculator](https://phala.one/stake/)", "mimetype": "text/plain", "start_char_idx": 17612, "end_char_idx": 17853, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "3a0842b3-94ed-4da7-9f4d-889227615630": {"__data__": {"id_": "3a0842b3-94ed-4da7-9f4d-889227615630", "embedding": null, "metadata": {"file_path": "phala-docs_dist/phala-sdk.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "18c9d3c4-a0b3-45bc-8e0d-81085c6843cb", "node_type": "4", "metadata": {}, "hash": "2662f478e0c6365e35884b13b488e8dda03f97801e7e07d718cf586533803085", "class_name": "RelatedNodeInfo"}}, "text": "# \u2692\ufe0f Phala SDK\n\nFor technical documentation on Phala's SDK, go to our [Phala SDK Docs](https://phala-docs.vercel.app/jssdk/getting-started).", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 140, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4bcee946-88f7-4161-8a2f-029fd8868d73": {"__data__": {"id_": "4bcee946-88f7-4161-8a2f-029fd8868d73", "embedding": null, "metadata": {"file_path": "phala-docs_dist/cross-chain-transfer.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7bdd8b10-de82-4843-a571-5f3553eb148c", "node_type": "4", "metadata": {}, "hash": "c286a6776ce56fec1d6f3f9924b5bb68c2817fe826de076e211fa872984e81c2", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "0ec8fbd9-1c13-4d6d-aa09-1bd4bbf17975", "node_type": "1", "metadata": {}, "hash": "13280a02fc75f66ca69d57b31c2fbfa467bea2601d4720392838e69aaf52cebc", "class_name": "RelatedNodeInfo"}}, "text": "# Cross-chain Transfer\n\n### Transfer PHA: Ethereum <-> Khala <a href=\"#transfer-pha-ethereum---khala\" id=\"transfer-pha-ethereum---khala\"></a>\n\nThis tutorial takes the transfer of PHA from Ethereum to Khala as an example. You can also refer to this tutorial for other EVM <-> parachain bridge transfers.\\\n![](../../.gitbook/assets/subbridge-eth-khala.png)\n\n1. Open [SubBridge](https://subbridge.io/), switch _From_ chain to Ethereum, _To_ chain to Khala, and choose `PHA` as the currency;\n2. Press _Connect Wallet_ and connect to Metamask;\n3. Fill in the amount of ERC-20 PHA that you want to transfer from Ethereum;\n4. Enter the receiving account on Khala, note that it should be the Khala address;\n5. If it\u2019s the first time you are transferring your PHA assets, you may need to click on the _Approve_ button and sign with Metamask to confirm;\\\n   <img src=\"../../.gitbook/assets/subbridge-metamask.png\" alt=\"\" data-size=\"original\">\n6. Then confirm and click the _Transfer_ button;\n7. Double-check your accounts and figures and then click _Submit_ in the pop-up window, sign with Metamask, and submit your cross-chain asset transaction;\n8. You can go to Etherscan to check the sending details on the Etherscan block explorer when your transaction is sent; if you have any questions, you can consult our [Discord](https://discord.gg/phala-network).\n\n### Transfer PHA: Khala <-> Karura <a href=\"#transfer-pha-khala---karura\" id=\"transfer-pha-khala---karura\"></a>\n\nThis tutorial takes the transfer of PHA from Khala to Karura as an example, and vice versa for transferring from Karura to Khala. You can also refer to this tutorial for other parachain bridge transfers.\\\n![](../../.gitbook/assets/subbridge-transfer.png)\n\n1. Open [SubBridge](https://subbridge.io/), switch _From_ chain to Khala, _To_ chain to Karura, and choose `PHA` as the currency;\n2.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1850, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0ec8fbd9-1c13-4d6d-aa09-1bd4bbf17975": {"__data__": {"id_": "0ec8fbd9-1c13-4d6d-aa09-1bd4bbf17975", "embedding": null, "metadata": {"file_path": "phala-docs_dist/cross-chain-transfer.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "7bdd8b10-de82-4843-a571-5f3553eb148c", "node_type": "4", "metadata": {}, "hash": "c286a6776ce56fec1d6f3f9924b5bb68c2817fe826de076e211fa872984e81c2", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "4bcee946-88f7-4161-8a2f-029fd8868d73", "node_type": "1", "metadata": {}, "hash": "7fd7201932aad518845c0c92b84617c420b3c25eb54706b341826b784caa8bcc", "class_name": "RelatedNodeInfo"}}, "text": "Connect the Source Chain (Khala)\u2019s account, enter the transfer amount;\n\n    > Note: Do not transfer all the token, you need to keep a certain fee in the account to ensure that it is not deleted.\n3. Enter the receiving account on destination chain (Karura), note that it should be the Karura address. The destination account is your source account by default, you can click _Edit manually_ to use other addresses;\n4. Click _Transfer_;\n5.  Confirm pop-up window;\n\n    > Note: A transfer fee of 0.0512 PHA will be charged for transferring from Khala to Karura. The bridge itself is completely free. This fee is used to pay the XCM fee of the Karura chain. It does not include the transaction fee of the Khala chain.\n6. Click _Submit_ to sign;\\\n   ![](../../.gitbook/assets/subbridge-confirm.png)\n7. The transaction is sent from Khala, wait for the transaction to be confirmed;\n8. Then you can go to destination chain\u2019s wallet (in this case, [Karura Apps](https://apps.karura.network/portfolio)) to check whether you have received the token (PHA). If it is not received within 1 minute, you can go to the Khala chain explorer ([Subscan](https://khala.subscan.io/)) to check whether you have sent a transaction; if you have any questions, you can consult our [Discord](https://discord.gg/phala-network).", "mimetype": "text/plain", "start_char_idx": 1852, "end_char_idx": 3150, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "88eef3d5-a57c-4ace-8525-44249484076a": {"__data__": {"id_": "88eef3d5-a57c-4ace-8525-44249484076a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/block-explorers.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "613009ac-d31e-4ecc-b9a7-6ea825c34b90", "node_type": "4", "metadata": {}, "hash": "8878b380115d318ba97912de07d6b7c1878513c0e876e3dc483a26b540dbb694", "class_name": "RelatedNodeInfo"}}, "text": "# Block Explorers\n\n| Chain              | URL                                                                            |\n| ------------------ | ------------------------------------------------------------------------------ |\n| Phala Mainnet      | [https://phala.subscan.io/](https://phala.subscan.io/)                         |\n| Phala PoC6 Testnet | [https://poc6-statescan.phala.network/](https://poc6-statescan.phala.network/) |\n| Khala Mainnet      | [https://khala.subscan.io/](https://khala.subscan.io)                          |", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 538, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6db322f9-04a0-4e7f-beb9-b826c19216f7": {"__data__": {"id_": "6db322f9-04a0-4e7f-beb9-b826c19216f7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/phat-contract-console.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "1beae184-b472-46df-bdef-874fab8d1ed7", "node_type": "4", "metadata": {}, "hash": "0a31b2bcf978b1f41475e608f295cd9d7c8aba1a721bfcd5e3350fe0b3d1cef9", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "365ce463-2426-4930-95c3-add3a5c9ca45", "node_type": "1", "metadata": {}, "hash": "b61576a2b326add3f07d5b94c7c07b5ccf6a8a07d4f6ce6a8b4d6c3ef93a6e3f", "class_name": "RelatedNodeInfo"}}, "text": "# Phat Contract Console\n\n[Phat Contract UI](https://phat.phala.network/) provides an easy way to upload your contract, instantiate it and interact with it.\n\n## Connect Your Wallet <a href=\"#connect-wallet\" id=\"connect-wallet\"></a>\n\n<figure><img src=\"../../../.gitbook/assets/phat-ui.png\" alt=\"\"><figcaption></figcaption></figure>\n\nOn the homepage, click _Connect Wallet_ in the right top corner, and select the wallet you are using. An _Authorize_ window will pop up, Click Yes to continue. Then you can connect to one of your accounts in the _Select Account_ window.\n\n## Connecting to the Blockchain <a href=\"#connect-to-blockchain\" id=\"connect-to-blockchain\"></a>\n\n<figure><img src=\"../../../.gitbook/assets/phat-ui-endpoint-setting.png\" alt=\"\"><figcaption></figcaption></figure>\n\nClicking the green dot beside your account will tell you the information about the current chain you are connected to.\n\n<figure><img src=\"../../../.gitbook/assets/SelectNetwork.png\" alt=\"\"><figcaption></figcaption></figure>\n\nBy default, the UI will connect to [Phala PoC-6 Testnet](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fpoc5.phala.network%2Fws#/explorer). Check the full [chain list](../../support/endpoints.md).\n\nYou can connect to other chains by filling in the RPC Endpoint and clicking _Connect_. The UI will automatically read the cluster information from the chain and fill in the PRuntime for you, but you can always set it to other workers manually.\n\n> **Why two endpoints**\n>\n> Unlike other blockchains like Ethereum where you have to call your contracts through on-chain transactions, Phat Contracts are deployed to off-chain Workers so you can interact with them directly without submitting any transactions. The UI will ask for two endpoints, one to connect to the blockchain and another to the worker directly.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1814, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "365ce463-2426-4930-95c3-add3a5c9ca45": {"__data__": {"id_": "365ce463-2426-4930-95c3-add3a5c9ca45", "embedding": null, "metadata": {"file_path": "phala-docs_dist/phat-contract-console.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "1beae184-b472-46df-bdef-874fab8d1ed7", "node_type": "4", "metadata": {}, "hash": "0a31b2bcf978b1f41475e608f295cd9d7c8aba1a721bfcd5e3350fe0b3d1cef9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "6db322f9-04a0-4e7f-beb9-b826c19216f7", "node_type": "1", "metadata": {}, "hash": "304c1baa6e016627c8e2943d718549182e8dbb568a9c9abafc1d3eab3a5e5173", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "abe74e04-3488-40f7-83fb-a2cc9cbf0bf9", "node_type": "1", "metadata": {}, "hash": "3af41e34b634003754fffd34da1e7d106c3034fba8568489250df1eaa85c0edd", "class_name": "RelatedNodeInfo"}}, "text": "To connect to our mainnet or your local testnet, you need to specify two endpoints here:\n\n* An RPC endpoint to connect to one of the Phala blockchain nodes to read the chain state and send transactions;\n* A pRuntime endpoint to directly connect to one of our Workers where the [off-chain computation](https://medium.com/phala-network/fat-contract-introduce-off-chain-computation-to-smart-contract-dfc5839d5fb8) really happens;\n\n## Claim Test Tokens <a href=\"#claim-test-tokens\" id=\"claim-test-tokens\"></a>\n\nOnce the account is connected, you can find the _Get Test-PHA_ button on the right side of the page and request 100 test tokens by clicking it. The operations below require tokens as the transaction fee.\n\n## Uploading and Instantiating the Contract <a href=\"#upload-and-instantiate-the-contract\" id=\"upload-and-instantiate-the-contract\"></a>\n\nChoose `Upload` and locate your `phat_hello.contract` file that you downloaded. The UI will load the metadata of your contract and list all the constructor functions in the `Init Selector` section.\n\n<figure><img src=\"../../../.gitbook/assets/phat-ui-upload.png\" alt=\"\"><figcaption></figcaption></figure>\n\nAfter you click the `Submit`, the UI will ask for your permission to upload the contract WASM to the blockchain through a transaction. Click \"Approve\" to continue.\n\n> **What happened**\n>\n> Your contract code is uploaded to the blockchain via a transaction, hence the request for your signature. The code is public, together with your instantiation arguments, so that everyone can verify the initial state of the contract.\n>\n> The blockchain will automatically push the contract code to the workers belonging to the cluster you choose and instantiate it.\n\nAfter the successful instantiation, you will see the metadata of the deployed contract.\n\n<figure><img src=\"../../../.gitbook/assets/phat-ui-metadata.png\" alt=\"\"><figcaption></figcaption></figure>\n\nYou can also expand the lower bar to see the raw events when deploying the contract.", "mimetype": "text/plain", "start_char_idx": 1816, "end_char_idx": 3807, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "abe74e04-3488-40f7-83fb-a2cc9cbf0bf9": {"__data__": {"id_": "abe74e04-3488-40f7-83fb-a2cc9cbf0bf9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/phat-contract-console.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "1beae184-b472-46df-bdef-874fab8d1ed7", "node_type": "4", "metadata": {}, "hash": "0a31b2bcf978b1f41475e608f295cd9d7c8aba1a721bfcd5e3350fe0b3d1cef9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "365ce463-2426-4930-95c3-add3a5c9ca45", "node_type": "1", "metadata": {}, "hash": "b61576a2b326add3f07d5b94c7c07b5ccf6a8a07d4f6ce6a8b4d6c3ef93a6e3f", "class_name": "RelatedNodeInfo"}}, "text": "<figure><img src=\"../../../.gitbook/assets/phat-ui-events.png\" alt=\"\"><figcaption></figcaption></figure>\n\n## Interacting with Your Contract <a href=\"#interact-with-your-contract\" id=\"interact-with-your-contract\"></a>\n\nScrolling down the page, you can see all the interfaces of your contract, with their function names, types, and descriptions.\n\nThe interfaces are divided into two types, labeled by `TX` and `QUERY` respectively. This contract only contains one `QUERY` handler. The phat-hello contract has only one `QUERY` type interface, `get_eth_balance()`.\n\n<figure><img src=\"../../../.gitbook/assets/phat-ui-input.png\" alt=\"\"><figcaption></figcaption></figure>\n\nClick the run icon to send a request to the contract. For example, we can invoke the `get_eth_balance()` to get the current balance of a specific ETH address. The Polkadot.js extension will ask for your permission in the first click to encrypt your following traffic to the contract.\n\n> **What happened**\n>\n> Every transaction or query to the contract is encrypted and thus needs your signature. We implement a certificate mechanism to keep your query signature valid for 15 minutes.\n\nThe `QUERY` returns immediately since it involves no on-chain transactions. Click the bottom status bar to see the execution result.\n\n<figure><img src=\"../../../.gitbook/assets/phat-ui-result.png\" alt=\"\"><figcaption></figcaption></figure>\n\nCongrats\ud83c\udf89! You have finished the basic tutorial of Phat Contract!", "mimetype": "text/plain", "start_char_idx": 3809, "end_char_idx": 5266, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "541a7f8c-00b8-4093-b919-1e189f0ba50c": {"__data__": {"id_": "541a7f8c-00b8-4093-b919-1e189f0ba50c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-openai.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8b1c7989-d84d-493d-906b-474194050eab", "node_type": "4", "metadata": {}, "hash": "fd3c1f6be131d7eb4b82202c4ec7e5f36a45f0f9199613ac22090611564d2e67", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "80dad35a-05f5-4b6a-b42d-0b41724f537b", "node_type": "1", "metadata": {}, "hash": "3348a7800d8f6a925f7c99a5b21ee8dbaa562ab751090db883a847cee2f4e02a", "class_name": "RelatedNodeInfo"}}, "text": "---\ndescription: Host your AI Agent Contract on Phala's decentralized serverless cloud.\n---\n\n# Build Your AI Agent Contract with OpenAI\n\n## [AI Agent Contract Template with OpenAI](https://github.com/Phala-Network/ai-agent-template-openai/tree/main)\n\n### Architecture Overview\n\n<figure><img src=\"../../.gitbook/assets/Screenshot 2024-04-04 at 11.02.11.png\" alt=\"\"><figcaption></figcaption></figure>\n\n## \ud83e\udd16 What Is This?!\n\n***\n\nThe OpenAI AI Agent template is a **MINIMAL** template to build an AI Agent that can be hosted on Phala Network's decentralized hosting protocol. Unlike Vercel or other FaaS, it allows you to publish your AI Agent compiled code to IPFS and hosts it on a fully decentralized FaaS cloud with the following benefits:\n\n* \ud83d\udca8 Ship Fast: Build and ship with familiar toolchain in minutes\n* \u26d1\ufe0f Secure: Execution guarded by rock solid TEE / Intel SGX\n* \ud83d\udd12 Private: Host API keys and user privacy at ease\n* \ud83d\udc8e Unstoppable: Powered by IPFS and Phala's 35k+ decentralized TEE workers\n\n## Getting Started\n\n{% hint style=\"info\" %}\nFor this template to work, you will need to signup for a developer account on OpenAI and get and [OpenAI API Key](https://platform.openai.com/account/api-keys).\n{% endhint %}\n\n### Prepare\n\nClone git repo or use [degit](https://www.npmjs.com/package/degit) to get the source code.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1319, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "80dad35a-05f5-4b6a-b42d-0b41724f537b": {"__data__": {"id_": "80dad35a-05f5-4b6a-b42d-0b41724f537b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-openai.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8b1c7989-d84d-493d-906b-474194050eab", "node_type": "4", "metadata": {}, "hash": "fd3c1f6be131d7eb4b82202c4ec7e5f36a45f0f9199613ac22090611564d2e67", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "541a7f8c-00b8-4093-b919-1e189f0ba50c", "node_type": "1", "metadata": {}, "hash": "e18378f3888f6114195cb6927bf07b74385fcfe05a96531d67195b93a8e2df14", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "2ea43607-7507-4c0f-a044-d33f0777eb75", "node_type": "1", "metadata": {}, "hash": "779e36d76fd7b8c8c6aa430047eae30764e777cf8171b210d9c112c243875fd2", "class_name": "RelatedNodeInfo"}}, "text": "{% tabs %}\n{% tab title=\"git\" %}\n```sh\ngit clone https://github.com/Phala-Network/ai-agent-template-openai.git\n```\n{% endtab %}\n\n{% tab title=\"degit\" %}\n```bash\nnpx degit github:Phala-Network/ai-agent-template-openai#main ai-agent-template-langchain\n```\n{% endtab %}\n{% endtabs %}\n\nInstall dependencies\n\n```shell\nnpm install\n```\n\n### Testing Locally\n\nCreate `.env` file with the default ThirdWeb API key for publishing your Agent Contract to IPFS\n\n```sh\ncp .env.example .env\n```\n\nBuild your Agent\n\n```sh\nnpm run build\n```\n\nTest your Agent locally\n\n```sh\nnpm run test\n```\n\nExpected Test Results\n\n```sh\nINPUT: {\"method\":\"GET\",\"path\":\"/ipfs/CID\",\"queries\":{\"chatQuery\":[\"When did humans land on the moon?\"],\"openAiModel\":[\"gpt-4o\"]},\"secret\":{\"openaiApiKey\":\"YOUR_API_KEY\"},\"headers\":{}}\nGET RESULT: {\n  status: 200,\n  body: `{\"message\":\"Humans first landed on the moon on July 20, 1969, during NASA's Apollo 11 mission. Astronauts Neil Armstrong and Edwin \\\\\"Buzz\\\\\" Aldrin became the first and second humans to walk on the lunar surface while Michael Collins remained in lunar orbit aboard the Command Module. Neil Armstrong famously declared, \\\\\"That's one small step for man, one giant leap for mankind,\\\\\" as he stepped onto the moon.\"}`,\n  headers: {\n    'Content-Type': 'application/json',\n    'Access-Control-Allow-Origin': '*'\n  }\n}\nINPUT: {\"method\":\"POST\",\"path\":\"/ipfs/CID\",\"queries\":{\"chatQuery\":[\"When did humans land on the moon?", "mimetype": "text/plain", "start_char_idx": 1321, "end_char_idx": 2761, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "2ea43607-7507-4c0f-a044-d33f0777eb75": {"__data__": {"id_": "2ea43607-7507-4c0f-a044-d33f0777eb75", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-openai.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8b1c7989-d84d-493d-906b-474194050eab", "node_type": "4", "metadata": {}, "hash": "fd3c1f6be131d7eb4b82202c4ec7e5f36a45f0f9199613ac22090611564d2e67", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "80dad35a-05f5-4b6a-b42d-0b41724f537b", "node_type": "1", "metadata": {}, "hash": "3348a7800d8f6a925f7c99a5b21ee8dbaa562ab751090db883a847cee2f4e02a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "4b3ffcaa-1772-48d5-a5cb-29e94194a95d", "node_type": "1", "metadata": {}, "hash": "150ab4f37c5e75311ffc41721f0e48f60dd693d6f9c9797621d621531eb0a7f3", "class_name": "RelatedNodeInfo"}}, "text": "\"],\"openAiModel\":[\"gpt-4o\"]},\"secret\":{\"openaiApiKey\":\"YOUR_API_KEY\"},\"headers\":{},\"body\":\"{}\"}\nPOST RESULT: {\n  status: 200,\n  body: '{\"message\":\"Not Implemented\"}',\n  headers: {\n    'Content-Type': 'application/json',\n    'Access-Control-Allow-Origin': '*'\n  }\n}\nNow you are ready to publish your agent, add secrets, and interact with your agent in the following steps:\n- Execute: 'npm run publish-agent'\n- Set secrets: 'npm run set-secrets'\n- Go to the url produced by setting the secrets (e.g. https://wapo-testnet.phala.network/ipfs/QmPQJD5zv3cYDRM25uGAVjLvXGNyQf9Vonz7rqkQB52Jae?key=b092532592cbd0cf)\n```\n\n### Publishing Your Agent\n\nUpload your compiled AI Agent code to IPFS.\n\n```sh\nnpm run publish-agent\n```\n\nUpon a successful upload, the command should show the URL to access your AI Agent.\n\n```sh\n\u2713 Compiled successfully.", "mimetype": "text/plain", "start_char_idx": 2761, "end_char_idx": 3592, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4b3ffcaa-1772-48d5-a5cb-29e94194a95d": {"__data__": {"id_": "4b3ffcaa-1772-48d5-a5cb-29e94194a95d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-openai.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8b1c7989-d84d-493d-906b-474194050eab", "node_type": "4", "metadata": {}, "hash": "fd3c1f6be131d7eb4b82202c4ec7e5f36a45f0f9199613ac22090611564d2e67", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "2ea43607-7507-4c0f-a044-d33f0777eb75", "node_type": "1", "metadata": {}, "hash": "779e36d76fd7b8c8c6aa430047eae30764e777cf8171b210d9c112c243875fd2", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "834d8d01-e615-48b0-a3f7-2cac164d1526", "node_type": "1", "metadata": {}, "hash": "2a093685556f1fcf20688b027e6ee2935f0330b23d314be83f113e6867fa8386", "class_name": "RelatedNodeInfo"}}, "text": "76.86 KB  dist/index.js\nRunning command: npx thirdweb upload dist/index.js\nThis may require you to log into thirdweb and will take some time to publish to IPFS...\n\n    $$\\     $$\\       $$\\                 $$\\                         $$\\       \n    $$ |    $$ |      \\__|                $$ |                        $$ |      \n  $$$$$$\\   $$$$$$$\\  $$\\  $$$$$$\\   $$$$$$$ |$$\\  $$\\  $$\\  $$$$$$\\  $$$$$$$\\  \n  \\_$$  _|  $$  __$$\\ $$ |$$  __$$\\ $$  __$$ |$$ | $$ | $$ |$$  __$$\\ $$  __$$\\ \n    $$ |    $$ |  $$ |$$ |$$ |  \\__|$$ /  $$ |$$ | $$ | $$ |$$$$$$$$ |$$ |  $$ |\n    $$ |$$\\ $$ |  $$ |$$ |$$ |      $$ |  $$ |$$ | $$ | $$ |$$   ____|$$ |  $$ |\n    \\$$$$  |$$ |  $$ |$$ |$$ |      \\$$$$$$$ |\\$$$$$\\$$$$  |\\$$$$$$$\\ $$$$$$$  |\n     \\____/ \\__|  \\__|\\__|\\__|       \\_______| \\_____\\____/  \\_______|\\_______/ \n\n \ud83d\udc8e thirdweb v0.14.12 \ud83d\udc8e\n\n- Uploading file to IPFS. This may take a while depending on file sizes.\n\n\u2714 Successfully uploaded file to IPFS.", "mimetype": "text/plain", "start_char_idx": 3595, "end_char_idx": 4543, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "834d8d01-e615-48b0-a3f7-2cac164d1526": {"__data__": {"id_": "834d8d01-e615-48b0-a3f7-2cac164d1526", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-openai.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8b1c7989-d84d-493d-906b-474194050eab", "node_type": "4", "metadata": {}, "hash": "fd3c1f6be131d7eb4b82202c4ec7e5f36a45f0f9199613ac22090611564d2e67", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "4b3ffcaa-1772-48d5-a5cb-29e94194a95d", "node_type": "1", "metadata": {}, "hash": "150ab4f37c5e75311ffc41721f0e48f60dd693d6f9c9797621d621531eb0a7f3", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "7dcd6756-f417-4593-85d3-be25359c539f", "node_type": "1", "metadata": {}, "hash": "99826a017f605efa928e24866cda37cca329bb2c18b129d847ae417bc4ced139", "class_name": "RelatedNodeInfo"}}, "text": "\u2714 Files stored at the following IPFS URI: ipfs://QmdBwRk3YG78thoe9phf43CLAzShYUEiPHnWBu6bkqsJVY\n\u2714 Open this link to view your upload: https://b805a9b72767504353244e0422c2b5f9.ipfscdn.io/ipfs/bafybeig4up5mjx6kvkm5dizsv2njpkzk7pileis3kfheyd5wff2m3wbtrm/\n\nAgent Contract deployed at: https://wapo-testnet.phala.network/ipfs/QmdBwRk3YG78thoe9phf43CLAzShYUEiPHnWBu6bkqsJVY\n\nIf your agent requires secrets, ensure to do the following:\n1) Edit the ./secrets/default.json file or create a new JSON file in the ./secrets folder and add your secrets to it.\n2) Run command: 'npm run set-secrets' or 'npm run set-secrets [path-to-json-file]'\nLogs folder created.\nDeployment information updated in ./logs/latestDeployment.json\n```\n\n{% hint style=\"info\" %}\n\n\n**Note** that your latest deployment information will be logged to in file [`./logs/latestDeployment.json`](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/logs/latestDeployment.json). This file is updated every time you publish a new Agent Contract to IPFS. This file is also used to get the IPFS CID of your Agent Contract when setting secrets for your Agent Contract.\n\nHere is an example:\n\n```\n{\n  \"date\": \"2024-08-29T18:47:55.108Z\",\n  \"cid\": \"QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc\",\n  \"url\": \"https://wapo-testnet.phala.network/ipfs/QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc\"\n}\n```\n{% endhint %}\n\n{% hint style=\"warning\" %}\n\n\n**Did Thirdweb fail to publish?", "mimetype": "text/plain", "start_char_idx": 4544, "end_char_idx": 5985, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7dcd6756-f417-4593-85d3-be25359c539f": {"__data__": {"id_": "7dcd6756-f417-4593-85d3-be25359c539f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-openai.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8b1c7989-d84d-493d-906b-474194050eab", "node_type": "4", "metadata": {}, "hash": "fd3c1f6be131d7eb4b82202c4ec7e5f36a45f0f9199613ac22090611564d2e67", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "834d8d01-e615-48b0-a3f7-2cac164d1526", "node_type": "1", "metadata": {}, "hash": "2a093685556f1fcf20688b027e6ee2935f0330b23d314be83f113e6867fa8386", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a8ca7ec7-43fb-4ebf-ae57-b3cbf4376d9c", "node_type": "1", "metadata": {}, "hash": "b6b187b8f1941f1dcbe21e0659eeb6f0b5958d92b1c5a609c2b26edb32dce9e6", "class_name": "RelatedNodeInfo"}}, "text": "**\n\nIf ThirdWeb fails to publish, please signup for your own ThirdWeb account to publish your Agent Contract to IPFS. Signup or login at [https://thirdweb.com/dashboard/](https://thirdweb.com/dashboard/)\n\nWhenever you log into ThirdWeb, create a new API key and replace the default API Key with yours in the [.env](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/.env) file.\n\n```\nTHIRDWEB_API_KEY=\"YOUR_THIRDWEB_API_KEY\"\n```\n{% endhint %}\n\n### Accessing The Published Agent\n\nOnce published, your AI Agent is available at the URL: `https://wapo-testnet.phala.network/ipfs/<your-cid>`. You can get it from the \"Publish to IPFS\" step.\n\nYou can test it with `curl`.\n\n```sh\ncurl https://wapo-testnet.phala.network/ipfs/<your-cid>\n```\n\n### Adding Secrets\n\nBy default, all the compiled JS code is visible for anyone to view if they look at IPFS CID. This makes private info like API keys, signer keys, etc. vulnerable to be stolen. To protect devs from leaking keys, we have added a field called `secret` in the `Request` object. It allows you to store secrets in a vault for your AI Agent to access.\n\nTo add your secrets,\n\n1. Edit the [default.json](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/secrets/default.json) file or create a new JSON file in the `./secrets` folder and add your secrets to it.\n\n```sh\n{\n  \"apiKey\": \"YOUR_OPENAI_API_KEY\"\n}\n```\n\n2.", "mimetype": "text/plain", "start_char_idx": 5985, "end_char_idx": 7378, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a8ca7ec7-43fb-4ebf-ae57-b3cbf4376d9c": {"__data__": {"id_": "a8ca7ec7-43fb-4ebf-ae57-b3cbf4376d9c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-openai.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8b1c7989-d84d-493d-906b-474194050eab", "node_type": "4", "metadata": {}, "hash": "fd3c1f6be131d7eb4b82202c4ec7e5f36a45f0f9199613ac22090611564d2e67", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "7dcd6756-f417-4593-85d3-be25359c539f", "node_type": "1", "metadata": {}, "hash": "99826a017f605efa928e24866cda37cca329bb2c18b129d847ae417bc4ced139", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a8813c47-f01b-45d7-a64c-d9b0562d2526", "node_type": "1", "metadata": {}, "hash": "e33d4b6329ff41760e2043a5898b2e4528cab3273517f75d36742b7407e92959", "class_name": "RelatedNodeInfo"}}, "text": "Run command to set the secrets\n\n```sh\nnpm run set-secrets\n# or if you have a custom JSON file\nnpm run set-secrets <path-to-json-file>\n```\n\nExpected output:\n\n```sh\nUse default secrets...\nStoring secrets...\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   199    0    68  100   131    121    234 --:--:-- --:--:-- --:--:--   356\n{\"token\":\"5d9faaed6be5414a\",\"key\":\"a3a8a4ef2c057d5c\",\"succeed\":true}\n\nSecrets set successfully. Go to the URL below to interact with your agent:\nhttps://wapo-testnet.phala.network/ipfs/QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc?key=a3a8a4ef2c057d5c\nLog entry added to secrets.log\n```\n\n{% hint style=\"info\" %}\n**Note** that all your secrets will be logged in file [`./logs/secrets.log`](https://github.com/Phala-Network/ai-agent-template-redpill/blob/main/logs/secrets.log). This file is updated every time you add new secrets to your Agent Contract. If you have not published an Agent Contract, yet, this command will fail since there is not a CID to map the secrets to.", "mimetype": "text/plain", "start_char_idx": 7379, "end_char_idx": 8495, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a8813c47-f01b-45d7-a64c-d9b0562d2526": {"__data__": {"id_": "a8813c47-f01b-45d7-a64c-d9b0562d2526", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-openai.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8b1c7989-d84d-493d-906b-474194050eab", "node_type": "4", "metadata": {}, "hash": "fd3c1f6be131d7eb4b82202c4ec7e5f36a45f0f9199613ac22090611564d2e67", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a8ca7ec7-43fb-4ebf-ae57-b3cbf4376d9c", "node_type": "1", "metadata": {}, "hash": "b6b187b8f1941f1dcbe21e0659eeb6f0b5958d92b1c5a609c2b26edb32dce9e6", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "975ab6de-556e-451a-ac89-3ccd9eb2d1d6", "node_type": "1", "metadata": {}, "hash": "ed41204a21ec2c8da3edc874b17ae09fc6750b060f13bcbc70e3c91dbbd9fa5e", "class_name": "RelatedNodeInfo"}}, "text": "Here is an example:\n\n```sh\n2024-08-29T18:54:16.643Z, CID: [QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc], Token: [5d9faaed6be5414a], Key: [a3a8a4ef2c057d5c], URL: [https://wapo-testnet.phala.network/ipfs/QmaUbZgNz9dZ5eGm87DDqegRtcBV7RdosxizYQcfe2bHRc?key=a3a8a4ef2c057d5c]\n```\n{% endhint %}\n\nThe API returns a `token` and a `key`. The `key` is the id of your secret. It can be used to specify which secret you are going to pass to your frame. The `token` can be used by the developer to access the raw secret. You should never leak the `token`.\n\nTo verify the secret, run the following command where `key` and `token` are replaced with the values from adding your `secret` to the vault.\n\n```sh\ncurl https://wapo-testnet.phala.network/vaults/<key>/<token>\n```\n\nExpected output:\n\n```sh\n{\"data\":{\"openaiApiKey\":\"<OPENAI_API_KEY>\"},\"succeed\":true}\n```\n\n### Accessing Queries\n\nTo help create custom logic, we have an array variable named `queries` that can be accessed in the `Request` class.", "mimetype": "text/plain", "start_char_idx": 8497, "end_char_idx": 9486, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "975ab6de-556e-451a-ac89-3ccd9eb2d1d6": {"__data__": {"id_": "975ab6de-556e-451a-ac89-3ccd9eb2d1d6", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-openai.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8b1c7989-d84d-493d-906b-474194050eab", "node_type": "4", "metadata": {}, "hash": "fd3c1f6be131d7eb4b82202c4ec7e5f36a45f0f9199613ac22090611564d2e67", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a8813c47-f01b-45d7-a64c-d9b0562d2526", "node_type": "1", "metadata": {}, "hash": "e33d4b6329ff41760e2043a5898b2e4528cab3273517f75d36742b7407e92959", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5ee85879-b6ea-4138-8846-93eb15568d3f", "node_type": "1", "metadata": {}, "hash": "dba67157d11ed235951ff06ef6e8089b45675212334077f2452fe75db3028ee8", "class_name": "RelatedNodeInfo"}}, "text": "To access the `queries` array variable `chatQuery` value at index `0`, the syntax will look as follows:\n\n```sh\nconst query = req.queries.chatQuery[0] as string;\n```\n\nThe example at [https://wapo-testnet.phala.network/ipfs/Qmc7EDq1X8rfYGGfHyXZ6xsmcSUWQcqsDoeRMfmvFujih3?key=51f265212c26086c\\&chatQuery=When%20did%20humans%20land%20on%20the%20moon](https://wapo-testnet.phala.network/ipfs/Qmc7EDq1X8rfYGGfHyXZ6xsmcSUWQcqsDoeRMfmvFujih3?key=51f265212c26086c\\&chatQuery=When%20did%20humans%20land%20on%20the%20moon) will have a value of `When did humans land on the moon`. `queries` can have any field name, so `chatQuery` is just an example of a field name and not a mandatory name, but remember to update your `index.ts` file logic to use your expected field name.\n\n### Debugging Your Agent\n\nTo debug your agent, you can use the following command:\n\n```\ncurl https://wapo-testnet.phala.network/logs/all/ipfs/<CID>\n```\n\nAfter executing this command then you should see some output in the terminal to show the logs of requests to your agent.\n\n```\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [REPORT] END Request: Duration: 166ms\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [INFO] 'Is signature valid? ' true\n2024-09-04T03:18:34.", "mimetype": "text/plain", "start_char_idx": 9487, "end_char_idx": 10750, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5ee85879-b6ea-4138-8846-93eb15568d3f": {"__data__": {"id_": "5ee85879-b6ea-4138-8846-93eb15568d3f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-openai.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8b1c7989-d84d-493d-906b-474194050eab", "node_type": "4", "metadata": {}, "hash": "fd3c1f6be131d7eb4b82202c4ec7e5f36a45f0f9199613ac22090611564d2e67", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "975ab6de-556e-451a-ac89-3ccd9eb2d1d6", "node_type": "1", "metadata": {}, "hash": "ed41204a21ec2c8da3edc874b17ae09fc6750b060f13bcbc70e3c91dbbd9fa5e", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5e7f6628-b561-44fa-9aa4-4d2b7f61d913", "node_type": "1", "metadata": {}, "hash": "984dce51dba6ccc832ce3e7cdd402d99451d0eaaecb927794f16b99f62ebb56f", "class_name": "RelatedNodeInfo"}}, "text": "758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [INFO] 'Verifying Signature with PublicKey ' '0xC1BF8dB4D06416c43Aca3deB289CF7CC0aAFF540'\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd&type=verify&data=tintinland%20message%20to%20sign&signature=0x34c4d8c83406e7a292ecc940d60b34c9b11024db10a8872c753b9711cd6dbc8f746da8be9bc2ae0898ebf8f49f48c2ff4ba2a851143c3e4b371647eed32f707b1b\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [REPORT] END Request: Duration: 183ms\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [INFO] 'Signature: 0x34c4d8c83406e7a292ecc940d60b34c9b11024db10a8872c753b9711cd6dbc8f746da8be9bc2ae0898ebf8f49f48c2ff4ba2a851143c3e4b371647eed32f707b1b'\n2024-09-04T03:17:15.", "mimetype": "text/plain", "start_char_idx": 10750, "end_char_idx": 11582, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5e7f6628-b561-44fa-9aa4-4d2b7f61d913": {"__data__": {"id_": "5e7f6628-b561-44fa-9aa4-4d2b7f61d913", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-openai.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8b1c7989-d84d-493d-906b-474194050eab", "node_type": "4", "metadata": {}, "hash": "fd3c1f6be131d7eb4b82202c4ec7e5f36a45f0f9199613ac22090611564d2e67", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5ee85879-b6ea-4138-8846-93eb15568d3f", "node_type": "1", "metadata": {}, "hash": "dba67157d11ed235951ff06ef6e8089b45675212334077f2452fe75db3028ee8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "0c295f77-b4ec-405b-92f0-0446e5bcaa94", "node_type": "1", "metadata": {}, "hash": "4318c97ca80b4fa66c64b0d7a234cf618b9eabcd2bad02282c4f9d7ca1378182", "class_name": "RelatedNodeInfo"}}, "text": "238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [INFO] 'Signing data [tintinland message to sign] with Account [0xC1BF8dB4D06416c43Aca3deB289CF7CC0aAFF540]'\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd&type=sign&data=tintinland%20message%20to%20sign\n2024-09-04T03:16:38.507Z [3717d307-bff0-4fc0-bc98-8f66c33dd46f] [REPORT] END Request: Duration: 169ms\n2024-09-04T03:16:38.507Z [3717d307-bff0-4fc0-bc98-8f66c33dd46f] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd\n2024-09-04T03:15:00.375Z [793f58f9-f24f-4580-8ebc-04debb7d727f] [REPORT] END Request: Duration: 158ms\n2024-09-04T03:15:00.375Z [793f58f9-f24f-4580-8ebc-04debb7d727f] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64\na1e805bfd\n```\n\nTo create logs in your Agent Contract, you can use the following syntax in your `index.ts` file.", "mimetype": "text/plain", "start_char_idx": 11582, "end_char_idx": 12587, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0c295f77-b4ec-405b-92f0-0446e5bcaa94": {"__data__": {"id_": "0c295f77-b4ec-405b-92f0-0446e5bcaa94", "embedding": null, "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-openai.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8b1c7989-d84d-493d-906b-474194050eab", "node_type": "4", "metadata": {}, "hash": "fd3c1f6be131d7eb4b82202c4ec7e5f36a45f0f9199613ac22090611564d2e67", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5e7f6628-b561-44fa-9aa4-4d2b7f61d913", "node_type": "1", "metadata": {}, "hash": "984dce51dba6ccc832ce3e7cdd402d99451d0eaaecb927794f16b99f62ebb56f", "class_name": "RelatedNodeInfo"}}, "text": "```\n// info logs\nconsole.log('info log message!')\n// error logs\nconsole.error('error log message!')\n```\n\nFor more information check the [MDN docs](https://developer.mozilla.org/en-US/docs/Web/API/console) on `console` object.", "mimetype": "text/plain", "start_char_idx": 12589, "end_char_idx": 12814, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "db2c12ee-1234-4111-af73-874dc3b2c5fc": {"__data__": {"id_": "db2c12ee-1234-4111-af73-874dc3b2c5fc", "embedding": null, "metadata": {"file_path": "phala-docs_dist/ethglobal-hackathon-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "14512d84-58d1-453d-8d58-f4d886bd5d6a", "node_type": "4", "metadata": {}, "hash": "bf3ba217b52a52d8d5605066395591a77c2786273f88a930a7c9043556e1f1f1", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "0b505679-35bd-4c59-b287-8c45313750b4", "node_type": "1", "metadata": {}, "hash": "c3346f8a0ffb1c80a601f5a045fe6cca4b0d04196cbf3b99f25dae3a4ad68e3b", "class_name": "RelatedNodeInfo"}}, "text": "# ETHGlobal Hackathon Guide\n\n## Phala Hackathon Guide at ETHGlobal Singapore\n\nWelcome to the Phala Hackathon Guide! This guide will provide you with all the necessary information to get started building on our platform. Whether you're a seasoned developer or new to the ecosystem, this guide will help you navigate through the essential steps and resources for build on Phala's Agent Contract.\n\n{% hint style=\"info\" %}\nCheck out the an Agent Contract we deployed called the [TEE Cheat Sheet](https://bit.ly/tee-cheat-sheet)!\n\n* If you want to know how to host HTML pages with hono, check out the Agent Contract template [here](https://github.com/Phala-Network/ai-agent-template-hono-html).\n{% endhint %}\n\n### Introduction\n\nWelcome to the Hackathon guide for Phala's Agent Contracts. We are offering you the **key** to connecting to multiple sponsor's bounties through our general-purpose program executing in a TEE (Trusted Execution) on Phala Network at **ZERO** cost & **NO** new wallet required.\n\n**Why is Agent Contract Built DIFFERENT?!**\n\n* &#x20;\ud83d\udca8 **Ship Fast**: Build and ship with familiar toolchain in minutes\n* &#x20;\u26d1\ufe0f **Secure**: Execution guarded by rock solid TEE\n* &#x20;\ud83d\udd12 **Private**: Host API keys and user privacy at ease\n* \ud83d\udc8e **Unstoppable**: Powered by IPFS and Phala's 40k+ decentralized TEE workers\n* :fire: [**hono/tiny**](https://hono.dev/docs/api/presets#hono-tiny) **Support**: a small, simple, and ultrafast web framework built on Web Standards.\n* \ud83e\uddea [**Vite Test Framework**](https://vitest.dev/guide/): Vite Testing Framework support, but you're free to change the test framework to your desire.\n\nHere are our feature templates:\n\n* [RedPill Agent Contract](https://github.com/Phala-Network/ai-agent-template-redpill) - Get your [FREE RedPill API Key](https://red-pill.ai/ethglobal) and access top LLMs from OpenAI, Anthropic, Meta, Gwen, Mistral, and Google to create a Web3 x AI project for the hackathon.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1934, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0b505679-35bd-4c59-b287-8c45313750b4": {"__data__": {"id_": "0b505679-35bd-4c59-b287-8c45313750b4", "embedding": null, "metadata": {"file_path": "phala-docs_dist/ethglobal-hackathon-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "14512d84-58d1-453d-8d58-f4d886bd5d6a", "node_type": "4", "metadata": {}, "hash": "bf3ba217b52a52d8d5605066395591a77c2786273f88a930a7c9043556e1f1f1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "db2c12ee-1234-4111-af73-874dc3b2c5fc", "node_type": "1", "metadata": {}, "hash": "eed6c42939beee2ae27cdf006155548d882fd3c095e6acb0a087374bb112b6cb", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ae4e4e03-d9d5-4896-a2d4-bbaa8625b9e3", "node_type": "1", "metadata": {}, "hash": "66b0c246b23221a9244149f3137ea53365e0d02856a77987230413c37290f441", "class_name": "RelatedNodeInfo"}}, "text": "* [Viem SDK Agent Contract](https://github.com/Phala-Network/ai-agent-contract-viem) - Learn about a **new paradigm in transacting onchain** with the [Viem SDK](https://viem.sh) Agent Contract Template with key features to:\n  * Derive an ECDSA account within a TEE\n  * Sign/Verify Data with the derived account\n  * Transact on any EVM chain\n\n### Prizes\n\nWe have exciting prizes for the top project:\n\n1. **1st Place**: $3,000 + Ledger Nano X\n2. **2nd Place**: $1,500 + TEE Swag\n3. **3rd Place**: $500 + TEE Swag\n\n**Bonus Bounty**: Reach the ETHGlobal finals, and you\u2019ll snag another Ledger Nano X on us!\n\nHow to qualify for as a top project?\n\n* (Strong Consideration) Integrate [Agent Contract with the Viem SDK](https://github.com/Phala-Network/ai-agent-contract-viem) to interact on-chain with any EVM Chain or other sponsor projects at ETHGlobal to create a unique product.\n* (Strong Consideration) Build an AI x Web3 product with [RedPill Agent Contract Template](https://github.com/Phala-Network/ai-agent-template-redpill) or any other AI related templates we support located in our [docs](https://docs.phala.network/ai-agent-contract/getting-started/ai-agent-contract-templates)\n* Deploy any custom Agent Contract that can be interacted with via HTTP requests\n\n### Important Dates\n\n* **Hackathon Start**: September 20th\n* **Submission Deadline**: September 22nd 9am\n* **Judging Period**: 2 Hours and 30 Minutes\n* **Winners Announcement**: September 22nd 3pm\n\n### Getting Started\n\nTo get started with Phala Network\n\n* **Take the RedPill and access top AI LLMs**: Get an API Key on [RedPill](https://red-pill.ai/ethglobal). This requires a code to get access. Reach out to the Phala Team to get access. In the meantime, use the free developer API key that is rate limited.", "mimetype": "text/plain", "start_char_idx": 1935, "end_char_idx": 3710, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ae4e4e03-d9d5-4896-a2d4-bbaa8625b9e3": {"__data__": {"id_": "ae4e4e03-d9d5-4896-a2d4-bbaa8625b9e3", "embedding": null, "metadata": {"file_path": "phala-docs_dist/ethglobal-hackathon-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "14512d84-58d1-453d-8d58-f4d886bd5d6a", "node_type": "4", "metadata": {}, "hash": "bf3ba217b52a52d8d5605066395591a77c2786273f88a930a7c9043556e1f1f1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "0b505679-35bd-4c59-b287-8c45313750b4", "node_type": "1", "metadata": {}, "hash": "c3346f8a0ffb1c80a601f5a045fe6cca4b0d04196cbf3b99f25dae3a4ad68e3b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "7f02dc89-cffa-404e-8916-a8bc76656a9e", "node_type": "1", "metadata": {}, "hash": "94aa6300b10c672957175af26cf03fad32c7b65ae397c43b94677704902c31fe", "class_name": "RelatedNodeInfo"}}, "text": "* **Try a New Paradigm in Transacting Onchain**: Build on the [viem Agent Contract Template](https://github.com/Phala-Network/ai-agent-contract-viem) where you can derive an account within a TEE and utilize the account to transact on any EVM chain.\n* **Choose from a** [**List of Agent Contract Templates**](../../ai-agent-contract/getting-started/ai-agent-contract-templates.md) or build a custom Agent Contract that connect to any API or uses an SDK of your choosing!\n* **Explore Documentation**: Familiarize yourself with our [Developer Documentation](https://docs.phala.network/).\n* **Join the Community**: Connect with other developers on our [Discord Server](https://discord.gg/phala-network).\n\n### Get API Key on RedPill\n\nIf you want to use the global hackathon RedPill API key, here are the details:\n\n* Create a FREE API Key at [https://red-pill.ai/ethglobal](https://red-pill.ai/ethglobal)&#x20;\n* Free Rate-Limited API Key\n  * API Endpoint URL: [https://api.red-pill.ai/](https://api.red-pill.ai/)\n  * API Key: `sk-qVBlJkO3e99t81623PsB0zHookSQJxU360gDMooLenN01gv2`\n* Doc: [https://docs.red-pill.ai/getting-started/how-to-use](https://docs.red-pill.ai/getting-started/how-to-use)\n* Supported Models: [https://docs.red-pill.ai/get-started/list-models](https://docs.red-pill.ai/get-started/list-models)\n\nBefore you start building, you'll need to set up your development environment. Here are the prerequisites:\n\n1. **Node.js**: Install the latest version of Node.js from [nodejs.org](https://nodejs.org/).\n2. **Code Editor**: Any code editor will work. We recommend using [Visual Studio Code](https://code.visualstudio.com/).", "mimetype": "text/plain", "start_char_idx": 3711, "end_char_idx": 5343, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7f02dc89-cffa-404e-8916-a8bc76656a9e": {"__data__": {"id_": "7f02dc89-cffa-404e-8916-a8bc76656a9e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/ethglobal-hackathon-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "14512d84-58d1-453d-8d58-f4d886bd5d6a", "node_type": "4", "metadata": {}, "hash": "bf3ba217b52a52d8d5605066395591a77c2786273f88a930a7c9043556e1f1f1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ae4e4e03-d9d5-4896-a2d4-bbaa8625b9e3", "node_type": "1", "metadata": {}, "hash": "66b0c246b23221a9244149f3137ea53365e0d02856a77987230413c37290f441", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "3ca07eed-4e8a-494a-be10-705575a9102f", "node_type": "1", "metadata": {}, "hash": "594496e078f51b224b95af7182e39c82041ef9068f58b597a09e381bb0c2123d", "class_name": "RelatedNodeInfo"}}, "text": "#### Test RedPill API\n\n```\ncurl https://api.red-pill.ai/v1/chat/completions\n-H \"Content-Type: application/json\"\n-H \"Authorization: Bearer <YOUR_REDPILL_API_KEY>\"\n-d '{ \"model\": \"o1-preview\", \"messages\": [ { \"role\": \"user\", \"content\": \"Hello world!\"", "mimetype": "text/plain", "start_char_idx": 5345, "end_char_idx": 5593, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "3ca07eed-4e8a-494a-be10-705575a9102f": {"__data__": {"id_": "3ca07eed-4e8a-494a-be10-705575a9102f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/ethglobal-hackathon-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "14512d84-58d1-453d-8d58-f4d886bd5d6a", "node_type": "4", "metadata": {}, "hash": "bf3ba217b52a52d8d5605066395591a77c2786273f88a930a7c9043556e1f1f1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "7f02dc89-cffa-404e-8916-a8bc76656a9e", "node_type": "1", "metadata": {}, "hash": "94aa6300b10c672957175af26cf03fad32c7b65ae397c43b94677704902c31fe", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "46d11022-960c-48a8-ada4-c96acb7d06c5", "node_type": "1", "metadata": {}, "hash": "4082d9726ccc753aba96a814d9970e9c1400e87d5782fa838c1978f8f4934870", "class_name": "RelatedNodeInfo"}}, "text": "} ], \"temperature\": 1 }'\n```\n\n### Set Up Your First Agent Contract\n\nTo set up your first Agent Contract, you can follow these resources:\n\n* **A New Paradigm in Transacting Onchain**\n  * **Viem SDK Template (Derive ECDSA Keys, Sign/Verify Data, Send TX)**: [AI Agent Contract Viem Template](https://github.com/Phala-Network/ai-agent-contract-viem)\n* **AI Related Templates**\n  * **RedPill Template**: [Build Your First AI Agent Contract](https://github.com/Phala-Network/ai-agent-template-redpill)\n  * **OpenAI Template**: [Build Your AI Agent Contract with OpenAI](https://github.com/Phala-Network/ai-agent-template-openai)\n  * **Anthropic Template**: [Anthropic Template Repo](https://github.com/Phala-Network/ai-agent-template-anthropic)\n  * **LangChain**: [Build Your Agent Contract with LangChain](https://github.com/Phala-Network/ai-agent-template-langchain)\n  * **Function Calling**: [Create a Weather Agent with Function Calling](https://github.com/Phala-Network/ai-agent-template-func-calling)\n    * GitHub Repository: [AI Agent Template with Function Calling](https://github.com/Phala-Network/ai-agent-template-func-calling)\n  * [**Brian**](https://www.brianknows.org/app/) **Template**: [Brian Agent Contract Template](https://github.com/Phala-Network/ai-agent-template-brian)\n  * [**'mbd.xyz**](https://console.mbd.xyz/dashboard) **Template**: ['mbd.xyz Agent Contract Template](https://github.com/Phala-Network/ai-agent-template-mbd)\n  * [**Chainbase**](https://console.chainbase.com/) **Template**: [Chainbase Agent Contract Template](https://github.com/Phala-Network/ai-agent-template-chainbase)\n* **Frontend Hosting Template**\n  * [**Hono HTML Agent Contract Template**](https://github.com/Phala-Network/ai-agent-template-hono-html)\n\n### Getting Rugged By The WiFi?!\n\nRun a local testnet with [`docker` support](https://docs.docker.com/desktop/).", "mimetype": "text/plain", "start_char_idx": 5594, "end_char_idx": 7455, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "46d11022-960c-48a8-ada4-c96acb7d06c5": {"__data__": {"id_": "46d11022-960c-48a8-ada4-c96acb7d06c5", "embedding": null, "metadata": {"file_path": "phala-docs_dist/ethglobal-hackathon-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "14512d84-58d1-453d-8d58-f4d886bd5d6a", "node_type": "4", "metadata": {}, "hash": "bf3ba217b52a52d8d5605066395591a77c2786273f88a930a7c9043556e1f1f1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "3ca07eed-4e8a-494a-be10-705575a9102f", "node_type": "1", "metadata": {}, "hash": "594496e078f51b224b95af7182e39c82041ef9068f58b597a09e381bb0c2123d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "885dffe0-10c0-44ea-9b58-6a4653c08bcc", "node_type": "1", "metadata": {}, "hash": "e01235560c749263c86c59c631beee025ff9befd29fd9ad99d3b9f35227bbfc5", "class_name": "RelatedNodeInfo"}}, "text": "All you need to do to get a local testnet started is run:\n\n{% hint style=\"danger\" %}\nRunning the local testnet may return an error if port **`8000`** is already in use.\n{% endhint %}\n\n```shell\nnpm run dev\n```\n\n**Make a Request to Your Local Build**\n\n```shell\n# GET request\ncurl http://127.0.0.1:8000/local\n# GET request with URL queries\ncurl http://127.0.0.1:8000/local?query1=one&query2=two\n# POST request\ncurl http://127.0.0.1:8000/local -X POST -H 'content-type: application/json' -d '{\"foo\": \"bar\"}'\n```\n\n**Add Secrets to Your Local Build**\n\n```shell\ncurl http://127.0.0.1:8000/vaults -H 'Content-Type: application/json' -d '{\"cid\": \"local\", \"data\": {\"secretKey\":\"secretValue\"}}'\n```\n\n**Check The Logs of Your Local Build**\n\n```shell\ncurl 'http://127.0.0.1:8000/logs/all/local'\n```\n\n### Resources\n\nHere are some additional resources to assist you:\n\n* [**Hono Docs**](https://hono.dev/docs/api/presets#hono-tiny)\n  * We recommend using [@hono/tiny](https://hono.dev/docs/api/presets#hono-tiny) to avoid a large bundle size and the 20MB final artifact limitation.\n* [**Vite Test Framework**](https://vitest.dev/guide/)\n* **Docs**: [Developer Documentation](https://docs.phala.network/ai-agent-contract/getting-started/build-your-first-ai-agent-contract)\n  * [**Supported WapoJS Functions**](https://docs.phala.network/tech-specs/ai-agent-contract/wapojs-functions)\n* **Workshop**: [Video](https://www.youtube.com/watch?v=APcuWVdqJ2U)\n* **Tech Specs**: [Agent Contract Tech Specs](https://docs.phala.network/tech-specs/ai-agent-contract#wapojs)\n\n### Support\n\nIf you need help, we're here for you:\n\n* [Discord](https://discord.gg/phala-network): Join our Discord Server for real-time support.", "mimetype": "text/plain", "start_char_idx": 7456, "end_char_idx": 9148, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "885dffe0-10c0-44ea-9b58-6a4653c08bcc": {"__data__": {"id_": "885dffe0-10c0-44ea-9b58-6a4653c08bcc", "embedding": null, "metadata": {"file_path": "phala-docs_dist/ethglobal-hackathon-guide.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "14512d84-58d1-453d-8d58-f4d886bd5d6a", "node_type": "4", "metadata": {}, "hash": "bf3ba217b52a52d8d5605066395591a77c2786273f88a930a7c9043556e1f1f1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "46d11022-960c-48a8-ada4-c96acb7d06c5", "node_type": "1", "metadata": {}, "hash": "4082d9726ccc753aba96a814d9970e9c1400e87d5782fa838c1978f8f4934870", "class_name": "RelatedNodeInfo"}}, "text": "* Forum: Post your questions on our Community Forum.\n* [FAQ](https://docs.phala.network/ai-agent-contract/faq): Agent Contract development FAQ\n\nWe can't wait to see what you build at the Phala Hackathon. Happy coding!\n\n***\n\n### Best Practices\n\nTo ensure a smooth development experience and to make the most out of the Phala platform, consider the following best practices:\n\n1. **Modular Code**: Write modular and reusable code to enhance maintainability.\n2. **Security First**: Always prioritize security, especially when dealing with sensitive data.\n3. **Documentation**: Document your code and APIs thoroughly to help others understand and contribute.\n4. **Testing**: Implement comprehensive testing to catch bugs early and ensure reliability.\n5. **Community Engagement**: Engage with the community to get feedback and improve your project.\n\n### Submission Guidelines\n\nTo submit your project for the hackathon, follow these steps:\n\n1. **Prepare Your Project**: Ensure your project is complete and well-documented.\n2. **Create a Repository**: Host your project on GitHub or any other version control platform.\n3. **Demo Video**: Include a short demo video showcasing your project and its features.\n\n### Judging Criteria\n\nProjects will be judged based on the following criteria:\n\n1. **Technical excellence**: How smoothly everything works\n2. **UX and design**: How great everything feels\n3. **Potential impact**: How it is going to make the world a better place\n4. **Wow factor**: How it would become the next big thing\n5. **Business model**: How it would generate ROI\n\n### Contact Us\n\nIf you have any questions or need further assistance, feel free to reach out:\n\n* **Email**: [support@phala.network](mailto:support@phala.network)\n* **Discord**: Join our [Discord Server](https://discord.gg/phala-network)\n* **Forum**: Visit our [Community Forum](https://forum.phala.network/)\n\nThank you for participating in the Phala Hackathon. We look forward to seeing your innovative solutions and wish you the best of luck!\n\n***\n\n_Phala Network Team_", "mimetype": "text/plain", "start_char_idx": 9149, "end_char_idx": 11189, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b8d7b554-f1ea-4575-8673-af2a9fda93e6": {"__data__": {"id_": "b8d7b554-f1ea-4575-8673-af2a9fda93e6", "embedding": null, "metadata": {"file_path": "phala-docs_dist/astar-zkatana-testnet.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "da50815e-56ad-4295-a8ba-d5a2e65c40c4", "node_type": "4", "metadata": {}, "hash": "c955ad09abe02ff5dffd97366102d0ea7a61f25a366b9132ce866c5d85f2f8e7", "class_name": "RelatedNodeInfo"}}, "text": "# Astar zKatana Testnet\n\nAstar zkEVM is a zero-knowledge scaling solution for Ethereum that offers an EVM-equivalent environment on which existing EVM smart contracts, developer tools, and wallets can work seamlessly. Astar zkEVM harnesses the power of zero-knowledge proofs to reduce transaction costs and increase throughput, while inheriting the security of Ethereum.\n\nTo learn more about Astar zkEVM, you can checkout their document [here](https://docs.astar.network/docs/build/zkEVM/).\n\n| Asset Pair  | Contract Address                           |\n| ----------- | ------------------------------------------ |\n| AAVE to USD | 0x49899fBd9be6b23d5e4AF697a92dc1E6C695862b |\n| BTC to USD  | 0xf38b25b79A72393Fca2Af88cf948D98c64726273 |\n| CRV to USD  | 0x89BC5048d634859aef743fF2152363c0e83a6a49 |\n| DAI to USD  | 0x2E1640853bB2dD9f47831582665477865F9240DB |\n| ETH to USD  | 0x739d71fC66397a28B3A3b7d40eeB865CA05f0185 |\n| USDC to USD | 0xB842f535a88021F95e1a94245Fa549a7f75084Dc |\n| USDT to USD | 0x1e73C20c42a7de166868da4c47963d137030492A |", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1040, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "1c0e04b6-12de-407b-805a-5cfa5d2b7868": {"__data__": {"id_": "1c0e04b6-12de-407b-805a-5cfa5d2b7868", "embedding": null, "metadata": {"file_path": "phala-docs_dist/resource-limits.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fe5ee9b6-2ac9-405d-a534-237a8623f7e2", "node_type": "4", "metadata": {}, "hash": "17106f852ff8b073e5fefcb774093ab10d654d5f971e0f6a84a0ba2af2f2c447", "class_name": "RelatedNodeInfo"}}, "text": "# Resource Limits\n\n## Resource Limits <a href=\"#resource-limits\" id=\"resource-limits\"></a>\n\n| Item                               | Description                                                                      | (LEGACY) ink | SideVM                            |\n| ---------------------------------- | -------------------------------------------------------------------------------- | ------------ | --------------------------------- |\n| Maximum code size                  | The maximum size of the compiled contract code that can be deployed              | 2 megabytes  | 32 megabytes                      |\n| Maximum ingress requests           | The maximum number of simultaneous query requests processed by a single worker   | 8 by default | unlimited                         |\n| Request fulfillment timeout        | The maximum duration of an in-flight query request                               | 10 seconds   | unlimited                         |\n| Maximum request size               | The maximum size of a incoming request (this includes all arguments)             | 1 megabytes  | unlimited, streaming is supported |\n| Maximum returned value size        | The maximum size of the response of a query                                      | 1 megabytes  | unlimited, streaming is supported |\n| Maximum query execution time       | The maximum amount of time that a single query can execute                       | 10 seconds   | N/A (continuously running)        |\n| Maximum memory allocated           | The maximum amount of memory allocated to your contract during execution         | 4 megabytes  | 16 MB                             |\n| HTTP - Maximum concurrent requests | The maximum number of HTTP requests that your source code can make               | 5            | unlimited                         |\n| HTTP - Request timeout             | The duration of an HTTP request before timeout                                   | 10 seconds   | unlimited                         |\n| HTTP - Maximum request length      | The maximum size of an HTTP request, including the request body and HTTP headers | 16 kilobytes | unlimited                         |\n| HTTP - Maximum response length     | The maximum size of an HTTP response                                             | 16 kilobytes | unlimited                         |", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2340, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "70659892-d446-4e89-9f7e-181b0f002cd5": {"__data__": {"id_": "70659892-d446-4e89-9f7e-181b0f002cd5", "embedding": null, "metadata": {"file_path": "phala-docs_dist/secret-key-hierarchy.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "82d9d1c1-283b-4a67-b164-b46353bea26f", "node_type": "4", "metadata": {}, "hash": "bd1196c4a7058aec51f0c99036b6d3b0d4daecbed6531ccc02c6ecccac05b932", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "2535effc-ea57-4a42-991f-9131f85569bf", "node_type": "1", "metadata": {}, "hash": "bf2d5444cbfd7079457a86b477b345bb7ec005cec0ebd8848f9f311764856e2a", "class_name": "RelatedNodeInfo"}}, "text": "# Secret Key Hierarchy\n\n## Key Hierarchy Management <a href=\"#key-hierarchy-management\" id=\"key-hierarchy-management\"></a>\n\nThe world\u2019s first key hierarchy for blockchain-TEE hybrid system was proposed by the \\[Ekiden [paper](https://ieeexplore.ieee.org/document/8806762) in 2019 and serves as the basis for the Oasis project. As a compute cloud, Phala improves this design to make it viable for a network of \\~100k nodes. We also introduce novel mechanisms like key rotation to further improve the robustness of the cloud.\n\nBefore we really dig into the details of our contract key management, it\u2019s important for readers to know that every entity in our system has its own identity key. Every user has their account, and every worker and gatekeeper (which are elected by the workers) has its own sr25519 WorkerKey pair, which is generated inside pRuntime (so also in SGX) and the private key never leaves the SGX. The identity key is used to:\n\n* Identify an entity\u2019s message with signing;\n* Establish an encrypted communication channel between users, workers, and gatekeepers with ECDH key agreement. **By default, any communication between any entities is encrypted in Phala**.\n\n![](https://miro.medium.com/max/4800/0\\*Kncy1jrLZ6ZiLltq)\n\nMasterKey is the root of trust for the whole network. All the contract-related keys, including ClusterKey and ContractKey, are derived from MasterKey. MasterKey is generated and shared by all the gatekeepers (through the encrypted communication channel mentioned above), making the security of MasterKey totally dependent on the security of gatekeepers. This is why gatekeepers are distinguished from other workers in that:\n\n* Gatekeepers are workers of top confidence level: they are immune to all known SGX vulnerabilities;\n* Unlike normal workers, the endpoints of gatekeepers are not public and you cannot deploy contracts to them. This reduces remote access to gatekeepers;\n* Increased staking amounts are required from gatekeepers to discourage bad behavior from their operators.\n\nIn Phala, workers are grouped into clusters to provide serverless computing services.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2112, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "2535effc-ea57-4a42-991f-9131f85569bf": {"__data__": {"id_": "2535effc-ea57-4a42-991f-9131f85569bf", "embedding": null, "metadata": {"file_path": "phala-docs_dist/secret-key-hierarchy.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "82d9d1c1-283b-4a67-b164-b46353bea26f", "node_type": "4", "metadata": {}, "hash": "bd1196c4a7058aec51f0c99036b6d3b0d4daecbed6531ccc02c6ecccac05b932", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "70659892-d446-4e89-9f7e-181b0f002cd5", "node_type": "1", "metadata": {}, "hash": "3394dc816ca1adfe2709e4faae4202bd43b2ec305e5a6080ace44f002b68a7c2", "class_name": "RelatedNodeInfo"}}, "text": "A unique ClusterKey is generated for each cluster using the MasterKey (through [key derivation](https://en.wikipedia.org/wiki/Key\\_derivation\\_function)), but you cannot revert this process to infer the MasterKey given the ClusterKey. The ClusterKey is shared with all the workers in that cluster.\n\nFinally, when a contract is deployed to a cluster, it\u2019s deployed to all the workers in that cluster. These workers will follow the deterministic process and derive the ClusterKey to get the same ContractKey. The ContractKeys are unique for different contracts.\n\n> _What are the consequences if certain keys are leaked?_\n>\n> If a WorkerKey is leaked, the attackers can decrypt all the messages sent to it such as the ClusterKey of its cluster, which can be used to access the ContractKeys of that cluster. Attackers could even impersonate a worker to provide false results to users. Such malicious activity can be detected by comparing the results from multiple workers, and then the chain would slash the compromised worker and confiscate that worker\u2019s staked PHA;\n>\n> If a ContractKey is leaked, the attackers can decrypt the states and all the historical inputs of that contract;\n>\n> If a ClusterKey is leaked, the attackers can know the above information of all the contracts in that cluster;\n>\n> If the MasterKey is leaked, then all historical data is leaked.\n\n> _What can we do if the worst case happens?_\n>\n> Phala has implemented the Key Rotation for gatekeepers, which means that with the permission of the Council, gatekeepers can update the MasterKey, then correspondingly the ClusterKeys and ContractKeys.\n>\n> So when the worst case happens, we will first register the new gatekeepers with the latest hardware, deregister all the old ones (since they are likely to be vulnerable) and switch to a new MasterKey.\n\n### Future Security Mechanism <a href=\"#future-security-mechanism\" id=\"future-security-mechanism\"></a>\n\n* Use Multi-Party Computation to manage MasterKey\n  * Currently, the same MasterKey is shared across all gatekeepers, so it\u2019s leaked if any one of them is compromised. By turning this into MPC, the attackers will have to compromise a majority of the gatekeepers to access the MasterKey.", "mimetype": "text/plain", "start_char_idx": 2113, "end_char_idx": 4325, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "54be4629-3578-4da7-ab3d-283b1adebb61": {"__data__": {"id_": "54be4629-3578-4da7-ab3d-283b1adebb61", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "77036cc3-ca61-471b-a045-a6af13206079", "node_type": "1", "metadata": {}, "hash": "3606058fe14ac7b34ebde681006b1247ab7603575e9519ed98c19b5019b30be2", "class_name": "RelatedNodeInfo"}}, "text": "# Create a Weather Agent w/ Function Calling\n\n{% hint style=\"info\" %}\nView the example code [here](https://github.com/HashWarlock/ai-agent-template-hello). The code is based on the [guide](https://cookbook.openai.com/examples/how\\_to\\_build\\_an\\_agent\\_with\\_the\\_node\\_sdk) on how to build an agent from the OpenAI Cookbook.\n{% endhint %}\n\n## Overview\n\nIn this tutorial, you will learn how to create an agent with 2 functions to enable [function calling](https://platform.openai.com/docs/guides/function-calling) for your agent. The 2 functions we will implement are:\n\n* `getLocation()`  - Get the current location (latitude, longitude) based on the IP of the worker node if no location is described in the user prompt.\n* `getWeatherData(latitude, longitude)` - Get the current weather data based on the latitude and longitude retrieved from `getLocation()`.&#x20;\n\nThese two functions will be described for your agent to understand the purpose of the functions. Then we will set the system prompt for the agent with:\n\n```\nYou are a helpful assistant. Only use the functions you have been provided with.\n```\n\n## Getting Started\n\n### Prepare\n\nClone git repo or use [degit](https://www.npmjs.com/package/degit) to get the source code.\n\n{% tabs %}\n{% tab title=\"git\" %}\n```sh\ngit clone https://github.com/Phala-Network/ai-agent-template-openai.git\n```\n{% endtab %}\n\n{% tab title=\"degit\" %}\n```sh\nnpx degit github:Phala-Network/ai-agent-template-openai#main ai-agent-template-openai\n```\n{% endtab %}\n{% endtabs %}\n\nInstall dependencies\n\n```\nnpm install\n```\n\n## Creating Your Functions\n\nIn this step, we will create our 2 functions `getLocation()` and `getWeatherData(latitude, longitude)` then we will describe our functions for the agent to understand how to use the functions.\n\nGo to your `src/index.ts` file, your initial file should look like the following.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1858, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "77036cc3-ca61-471b-a045-a6af13206079": {"__data__": {"id_": "77036cc3-ca61-471b-a045-a6af13206079", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "54be4629-3578-4da7-ab3d-283b1adebb61", "node_type": "1", "metadata": {}, "hash": "609756572568bebf1d79a043af8a8e1b00825283283896a16092426b46c96475", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "8f7ac2bd-0bf4-42a9-b2ce-a210a011d302", "node_type": "1", "metadata": {}, "hash": "1f0843e6a545b4a9c3c34b3174249b8049d97da37a0e1f5c398cb3618f0dea81", "class_name": "RelatedNodeInfo"}}, "text": "<details>\n\n<summary>src/index.ts</summary>\n\n```typescript\nimport { Request, Response, route } from './httpSupport'\nimport { renderHtml } from './uiSupport'\n\nimport OpenAI from 'openai'\n\nasync function GET(req: Request): Promise<Response> {\n    const secret = req.queries?.key ?? '';\n    const openaiApiKey = req.secret?.openaiApiKey as string;\n    const openai = new OpenAI({ apiKey: openaiApiKey })\n    const query = req.queries.chatQuery[0] as string;\n\n    const completion = await openai.chat.completions.create({\n        messages: [{ role: \"system\", content: `${query}` }],\n        model: 'gpt-3.5-turbo',\n    });\n\n    return new Response(renderHtml(completion.choices[0].message.content as string))\n}\n\nasync function POST(req: Request): Promise<Response> {\n    const secret = req.queries?.key ?? '';\n    const openaiApiKey = req.secret?.openaiApiKey as string;\n    const openai = new OpenAI({ apiKey: openaiApiKey })\n    const query = req.queries.chatQuery[0] as string;\n\n    const completion = await openai.chat.completions.create({\n        messages: [{ role: \"system\", content: `${query}` }],\n        model: 'gpt-3.5-turbo',\n    });\n\n    return new Response(renderHtml(completion.choices[0].message.content as string))\n}\n\nexport default async function main(request: string) {\n    return await route({ GET, POST }, request)\n}\n```\n\n</details>\n\n### Create getLocation()\n\nFor the `getLocation()` function, we will need to call an API to get the location based on [https://ipapi.co/](https://ipapi.co/). Traditionally, devs will not have access to the internet, but with Phala's AI Agent Contracts, devs now can make async HTTP calls to bring more data for fine tuning their agents.&#x20;\n\nThe implementation is simple and we will add this following code.", "mimetype": "text/plain", "start_char_idx": 1860, "end_char_idx": 3617, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8f7ac2bd-0bf4-42a9-b2ce-a210a011d302": {"__data__": {"id_": "8f7ac2bd-0bf4-42a9-b2ce-a210a011d302", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "77036cc3-ca61-471b-a045-a6af13206079", "node_type": "1", "metadata": {}, "hash": "3606058fe14ac7b34ebde681006b1247ab7603575e9519ed98c19b5019b30be2", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "32dd3b43-4d68-4be9-a094-8a4ded87d3e7", "node_type": "1", "metadata": {}, "hash": "96955a75a24090cc2849dc3806131617512cbea855da160772fda28c4fc3b53b", "class_name": "RelatedNodeInfo"}}, "text": "```typescript\nasync function getLocation() {\n    const response = await fetch(\"https://ipapi.co/json/\");\n    const locationData = await response.json();\n    return locationData;\n}\n```\n\n### Create getWeatherData(latitude, longitude)\n\nFor the getWeatherData(latitude, longitude) function, we will call the free weather API by [https://open-meteo.com/](https://open-meteo.com/).&#x20;\n\nWe will add the following code to our `index.ts` file.\n\n```typescript\nasync function getCurrentWeather(latitude: any, longitude: any) {\n    const url = `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&hourly=apparent_temperature`;\n    const response = await fetch(url);\n    const weatherData = await response.json();\n    return weatherData;\n}\n```\n\n### Describe Functions\n\nFor our OpenAI agent to understand the purpose of these functions, we need to describe them using a specific schema. We'll create an array called `tools` that contains one object per function. Each object will have two keys: `type`, `function`, and the `function` key has three subkeys: `name`, `description`, and `parameters`.\n\n```typescript\nconst tools = [\n    {\n        type: \"function\",\n        function: {\n            name: \"getCurrentWeather\",\n            description: \"Get the current weather in a given location\",\n            parameters: {\n                type: \"object\",\n                properties: {\n                    latitude: {\n                        type: \"string\",\n                    },\n                    longitude: {\n                        type: \"string\",\n                    },\n                },\n                required: [\"longitude\", \"latitude\"],\n            },\n        }\n    },\n    {\n        type: \"function\",\n        function: {\n            name: \"getLocation\",\n            description: \"Get the user's location based on their IP address\",\n            parameters: {\n                type: \"object\",\n                properties: {},\n            },\n        }\n    },\n];\n\nconst availableTools = {\n    getCurrentWeather,\n    getLocation,\n};\n```\n\n## Add Agent Functionality\n\n### Setup Messages for Agent\n\nWe need to define a `messages` array. This will keep track of all of the messages back and forth between our app and OpenAI. Here we create a type `MessageInfo` that will be the fields that may be included in the `messages` array.", "mimetype": "text/plain", "start_char_idx": 3619, "end_char_idx": 5964, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "32dd3b43-4d68-4be9-a094-8a4ded87d3e7": {"__data__": {"id_": "32dd3b43-4d68-4be9-a094-8a4ded87d3e7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "8f7ac2bd-0bf4-42a9-b2ce-a210a011d302", "node_type": "1", "metadata": {}, "hash": "1f0843e6a545b4a9c3c34b3174249b8049d97da37a0e1f5c398cb3618f0dea81", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "0ad18cf6-443d-47bf-af4b-233a856f9728", "node_type": "1", "metadata": {}, "hash": "7e8c0694f8c59f502c6216e556a13a43fc75cc2a6bfd812e36de928c23345170", "class_name": "RelatedNodeInfo"}}, "text": "The first object in the array should always have the `role` property set to `\"system\"`, which tells OpenAI that this is how we want it to behave.\n\n```typescript\ntype MessageInfo = {\n    role: any,\n    content: any,\n    name?: any,\n}\n\nconst messages: MessageInfo[] = [\n    {\n        role: \"system\",\n        content: `You are a helpful assistant. Only use the functions you have been provided with.`,\n    },\n];\n```\n\n### Create Agent Function For User Input\n\nWe are now ready to build the logic of our app, which lives in the `agent` function. It is asynchronous and takes one argument: the `userInput`.\n\nWe start by pushing the `userInput` to the messages array. This time, we set the `role` to `\"user\"`, so that OpenAI knows that this is the input from the user.\n\n```typescript\nasync function agent(openai, userInput) {\n  messages.push({\n    role: \"user\",\n    content: userInput,\n  });\n  const response = await openai.chat.completions.create({\n    model: \"gpt-4o\",\n    messages: messages,\n    tools: tools,\n  });\n  console.log(response);\n}\n```\n\nNext, we'll send a request to the Chat completions endpoint via the `chat.completions.create()` method in the Node SDK. This method takes a configuration object as an argument. In it, we'll specify three properties:\n\n* `model` - Decides which AI model we want to use (in our case, GPT-4).\n* `messages` - The entire history of messages between the user and the AI up until this point.\n* `tools` - A list of tools the model may call. Currently, only functions are supported as a tool., we'll we use the `tools` array we created earlier.\n\n### Turn OpenAI Agent Response into Functions\n\nNow that we have the name of the function as a string, we'll need to translate that into a function call.", "mimetype": "text/plain", "start_char_idx": 5966, "end_char_idx": 7698, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0ad18cf6-443d-47bf-af4b-233a856f9728": {"__data__": {"id_": "0ad18cf6-443d-47bf-af4b-233a856f9728", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "32dd3b43-4d68-4be9-a094-8a4ded87d3e7", "node_type": "1", "metadata": {}, "hash": "96955a75a24090cc2849dc3806131617512cbea855da160772fda28c4fc3b53b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5a309476-6af7-4bc9-8d96-7ec84bcce71f", "node_type": "1", "metadata": {}, "hash": "1cce29a21f358328777e6079cc311c14ba4fdc1adebff633ffd4ee0852545df0", "class_name": "RelatedNodeInfo"}}, "text": "To help us with that, we'll gather both of our functions in an object called `availableTools`:\n\n```typescript\nconst availableTools = {  getCurrentWeather,  getLocation,};\n```\n\nThis is handy because we'll be able to access the `getLocation` function via bracket notation and the string we got back from OpenAI, like this: `availableTools[\"getLocation\"]`.\n\n```typescript\nconst { finish_reason, message } = response.choices[0]; \nif (finish_reason === \"tool_calls\" && message.tool_calls) {  \n    const functionName = message.tool_calls[0].function.name;  \n    const functionToCall = availableTools[functionName];  \n    const functionArgs = JSON.parse(message.tool_calls[0].function.arguments);  \n    const functionArgsArr = Object.values(functionArgs);  \n    const functionResponse = await functionToCall.apply(null, functionArgsArr);  \n    console.log(functionResponse);\n}\n```\n\nWe're also grabbing ahold of any arguments OpenAI wants us to pass into the function: `message.tool_calls[0].function.arguments`. However, we won't need any arguments for this first function call.\n\nIf we run the code again with the same input (`\"Where am I located right now?\"`), we'll see that `functionResponse` is an object filled with location about where the user is located right now. In my case, that is Oslo, Norway.", "mimetype": "text/plain", "start_char_idx": 7699, "end_char_idx": 8998, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5a309476-6af7-4bc9-8d96-7ec84bcce71f": {"__data__": {"id_": "5a309476-6af7-4bc9-8d96-7ec84bcce71f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "0ad18cf6-443d-47bf-af4b-233a856f9728", "node_type": "1", "metadata": {}, "hash": "7e8c0694f8c59f502c6216e556a13a43fc75cc2a6bfd812e36de928c23345170", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "659e10e3-acd5-4fb0-a30b-7d30655ceff7", "node_type": "1", "metadata": {}, "hash": "5274399673e8225230b0bd733b17b9814670b06d9c52801786b72e9ea0c55497", "class_name": "RelatedNodeInfo"}}, "text": "```bash\n{ip: \"193.212.60.170\", network: \"193.212.60.0/23\", version: \"IPv4\", city: \"Oslo\", region: \"Oslo County\", region_code: \"03\", country: \"NO\", country_name: \"Norway\", country_code: \"NO\", country_code_iso3: \"NOR\", country_capital: \"Oslo\", country_tld: \".no\", continent_code: \"EU\", in_eu: false, postal: \"0026\", latitude: 59.955, longitude: 10.859, timezone: \"Europe/Oslo\", utc_offset: \"+0200\", country_calling_code: \"+47\", currency: \"NOK\", currency_name: \"Krone\", languages: \"no,nb,nn,se,fi\", country_area: 324220, country_population: 5314336, asn: \"AS2119\", org: \"Telenor Norge AS\"}\n```\n\nWe'll add this data to a new item in the `messages` array, where we also specify the name of the function we called.\n\n```typescript\nmessages.push({\n  role: \"function\",\n  name: functionName,\n  content: `The result of the last function was this: ${JSON.stringify(\n    functionResponse\n  )}\n  `,\n});\n```\n\nNotice that the `role` is set to `\"function\"`. This tells OpenAI that the `content` parameter contains the result of the function call and not the input from the user.\n\nAt this point, we need to send a new request to OpenAI with this updated `messages` array. However, we don\u2019t want to hard code a new function call, as our agent might need to go back and forth between itself and GPT several times until it has found the final answer for the user.\n\nThis can be solved in several different ways, e.g. recursion, a while-loop, or a for-loop. We'll use a good old for-loop for the sake of simplicity.&#x20;\n\n### Creating The Loop\n\nAt the top of the `agent` function, we'll create a loop that lets us run the entire procedure up to five times.", "mimetype": "text/plain", "start_char_idx": 9000, "end_char_idx": 10634, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "659e10e3-acd5-4fb0-a30b-7d30655ceff7": {"__data__": {"id_": "659e10e3-acd5-4fb0-a30b-7d30655ceff7", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5a309476-6af7-4bc9-8d96-7ec84bcce71f", "node_type": "1", "metadata": {}, "hash": "1cce29a21f358328777e6079cc311c14ba4fdc1adebff633ffd4ee0852545df0", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ab51cbd4-0db8-4992-99a5-74913269ae0c", "node_type": "1", "metadata": {}, "hash": "1fc465da41e82459ceaf12ba92086260d4c980586c0087a5dfba562014f6d8ec", "class_name": "RelatedNodeInfo"}}, "text": "If we get back `finish_reason: \"tool_calls\"` from GPT, we'll just push the result of the function call to the `messages` array and jump to the next iteration of the loop, triggering a new request.\n\nIf we get `finish_reason: \"stop\"` back, then GPT has found a suitable answer, so we'll return the function and cancel the loop.\n\n```typescript\nfor (let i = 0; i < 5; i++) {\n  const response = await openai.chat.completions.create({\n    model: \"gpt-4o\",\n    messages: messages,\n    tools: tools,\n  });\n  const { finish_reason, message } = response.choices[0];\n \n  if (finish_reason === \"tool_calls\" && message.tool_calls) {\n    const functionName = message.tool_calls[0].function.name;\n    const functionToCall = availableTools[functionName];\n    const functionArgs = JSON.parse(message.tool_calls[0].function.arguments);\n    const functionArgsArr = Object.values(functionArgs);\n    const functionResponse = await functionToCall.apply(null, functionArgsArr);\n \n    messages.push({\n      role: \"function\",\n      name: functionName,\n      content: `\n          The result of the last function was this: ${JSON.stringify(\n            functionResponse\n          )}\n          `,\n    });\n  } else if (finish_reason === \"stop\") {\n    messages.push(message);\n    return message.content;\n  }\n}\nreturn \"The maximum number of iterations has been met without a suitable answer. Please try again with a more specific input.\";\n```\n\nIf we don't see a `finish_reason: \"stop\"` within our five iterations, we'll return a message saying we couldn\u2019t find a suitable answer.\n\n## Update GET() and POST()\n\nNow we need to call our `agent(openai, userInput)` in our `GET` and `POST` calls that will pass in a users prompt that can be accessed in the `chatQuery` property. The code change is minimial and our functions look like the following.\n\n```typescript\nasync function GET(req: Request): Promise<Response> {\n    const secret = req.queries?.key ??", "mimetype": "text/plain", "start_char_idx": 10636, "end_char_idx": 12556, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ab51cbd4-0db8-4992-99a5-74913269ae0c": {"__data__": {"id_": "ab51cbd4-0db8-4992-99a5-74913269ae0c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "659e10e3-acd5-4fb0-a30b-7d30655ceff7", "node_type": "1", "metadata": {}, "hash": "5274399673e8225230b0bd733b17b9814670b06d9c52801786b72e9ea0c55497", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c34958e3-7d04-45f2-becd-529abf0f56c9", "node_type": "1", "metadata": {}, "hash": "7aa0b80fc8bc75fa22a4095a00b6414fb67dde5f61e6ee1578b6dfacb75ca02b", "class_name": "RelatedNodeInfo"}}, "text": "'';\n    const openaiApiKey = req.secret?.openaiApiKey as string;\n    const openai = new OpenAI({ apiKey: openaiApiKey })\n    const query = req.queries.chatQuery[0] as string;\n\n    const response = await agent(openai, query);\n\n    return new Response(renderHtml(response as string))\n}\n\nasync function POST(req: Request): Promise<Response> {\n    const secret = req.queries?.key ?? '';\n    const openaiApiKey = req.secret?.openaiApiKey as string;\n    const openai = new OpenAI({ apiKey: openaiApiKey })\n    const query = req.queries.chatQuery[0] as string;\n\n    const response = await agent(openai, query);\n\n    return new Response(renderHtml(response as string))\n}\n```\n\n## Test Locally\n\nNow that we have the code implemented to interact with APIs and call the functions, let's test the code locally.\n\nCreate `.env` file with the default ThirdWeb API key for publishing your Agent Contract to IPFS\n\n```\ncp .env.local .env\n```\n\nIn `./secrets/default.json` file replace `YOUR_OPENAI_KEY` with your API Key\n\n```json\n{\n  \"openaiApiKey\": \"YOUR_OPENAI_API_KEY\"\n}\n```\n\n> In your `./tests/test.ts` file. Add your API Key manually to have a functional test.\n>\n> ```typescript\n> let getResult = await execute({\n>     method: 'GET',\n>     path: '/ipfs/CID',\n>     queries: { chatQuery: [\"Who are you?\"] },\n>     secret: { openaiApiKey: \"YOUR_OPENAI_API_KEY\" },\n>     headers: {},\n> })\n> ```\n\nBuild your Agent\n\n```\nnpm run build\n```\n\nTest your Agent locally\n\n```\nnpm run test\n```\n\nExpected output:\n\n```bash\nINPUT: {\"method\":\"GET\",\"path\":\"/ipfs/CID\",\"queries\":{},\"secret\":{\"openaiApiKey\":\"OPENAI_API_KEY\"},\"headers\":{}}\n[0]chat\n[1]chat\n[2]chat\nGET RESULT: {\n  status: 200,\n  body: `{\"message\":\"There's a lot to do in Austin, Texas! Here are some activities you might consider based on the current weather and various interests:\\\\n\\\\n### Outdoor Activities\\\\n1.", "mimetype": "text/plain", "start_char_idx": 12557, "end_char_idx": 14401, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c34958e3-7d04-45f2-becd-529abf0f56c9": {"__data__": {"id_": "c34958e3-7d04-45f2-becd-529abf0f56c9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ab51cbd4-0db8-4992-99a5-74913269ae0c", "node_type": "1", "metadata": {}, "hash": "1fc465da41e82459ceaf12ba92086260d4c980586c0087a5dfba562014f6d8ec", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "413727c3-c882-48ba-81f7-aa0aec274a23", "node_type": "1", "metadata": {}, "hash": "aaf0e8260d75b17cfbca591f96a9523c04cce1c5f7271a22c8e300b3b33afb35", "class_name": "RelatedNodeInfo"}}, "text": "**Lady Bird Lake & Zilker Park**\\\\n   - **Kayaking/Paddleboarding**: Enjoy a relaxing paddle on Lady Bird Lake.\\\\n   - **Hiking/Biking**: Explore the trails around Zilker Park and Barton Springs.\\\\n\\\\n2. **Barton Springs Pool**\\\\n   - A perfect spot for a swim and to cool off from the summer heat.\\\\n\\\\n3. **Mount Bonnell**\\\\n   - For those who love scenic views and a bit of hiking, head to Mount Bonnell for a panoramic view of the city.\\\\n\\\\n### Cultural Activities\\\\n1. **Blanton Museum of Art**\\\\n   - Explore a variety of art collections ranging from contemporary to ancient.\\\\n\\\\n2. **Bullock Texas State History Museum**\\\\n   - Learn about the rich history of Texas through exhibits and films.\\\\n\\\\n3. **South Congress Avenue (SoCo)**\\\\n   - Wander through boutique shops, galleries, and enjoy some street performances.\\\\n\\\\n### Music & Nightlife\\\\n1. **Live Music**\\\\n   - Check out iconic venues like the Continental Club or Antone\u2019s for some live performances.\\\\n\\\\n2. **Rainey Street Historic District**\\\\n   - Explore a variety of bars and food trucks in this lively area.\\\\n\\\\n### Food & Beverage\\\\n1. **BBQ Heaven**\\\\n   - Visit Franklin Barbecue or la Barbecue for some of the best BBQ in the city.\\\\n   \\\\n2. **Food Trucks**\\\\n   - Explore the diverse array of food trucks offering a variety of cuisines.\\\\n\\\\n### Weather Considerations\\\\n- The apparent temperature during the day can reach up to 37.2\u00b0C (98.96\u00b0F) with some moments going as high as 38.9\u00b0C (102.02\u00b0F). Ensure you stay hydrated and take breaks in shaded or air-conditioned areas.\\\\n\\\\nNo matter what your interests are, Austin has a variety of activities to make your day enjoyable. Make sure to check local event listings as well for any special events or festivals happening today.", "mimetype": "text/plain", "start_char_idx": 14402, "end_char_idx": 16168, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "413727c3-c882-48ba-81f7-aa0aec274a23": {"__data__": {"id_": "413727c3-c882-48ba-81f7-aa0aec274a23", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c34958e3-7d04-45f2-becd-529abf0f56c9", "node_type": "1", "metadata": {}, "hash": "7aa0b80fc8bc75fa22a4095a00b6414fb67dde5f61e6ee1578b6dfacb75ca02b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "da1896ac-5b9e-4d94-9d67-3e0544a55bda", "node_type": "1", "metadata": {}, "hash": "a7dabb7349ebbab040ea262e5fd2ab83ce775f7fb17b8e017c6605b95e79dd35", "class_name": "RelatedNodeInfo"}}, "text": "\"}`,\n  headers: {\n    'Content-Type': 'application/json',\n    'Access-Control-Allow-Origin': '*'\n  }\n}\nINPUT: {\"method\":\"GET\",\"path\":\"/ipfs/CID\",\"queries\":{\"chatQuery\":[\"What are some activities based in Brussels today?\"]},\"secret\":{\"openaiApiKey\":\"OPENAI_API_KEY\"},\"headers\":{}}\n[0]chat\n[1]chat\n[2]chat\n[3]chat\nGET RESULT: {\n  status: 200,\n  body: `{\"message\":\"Brussels is a vibrant city with a lot of things to offer on any given day. Here are some activities you can enjoy today:\\\\n\\\\n### Outdoor Activities\\\\n1. **Grand Place**\\\\n   - Visit the heart of Brussels and marvel at the stunning architecture. You might catch some street performances as well.\\\\n\\\\n2. **Parc du Cinquantenaire**\\\\n   - Take a relaxing stroll or have a picnic in this beautiful park.\\\\n\\\\n3. **Atomium**\\\\n   - Explore this unique building and enjoy panoramic views of the city.\\\\n\\\\n### Cultural Activities\\\\n1. **Royal Museums of Fine Arts of Belgium**\\\\n   - Explore Belgian art and various exhibitions ranging from ancient to modern art.\\\\n\\\\n2. **Magritte Museum**\\\\n   - Dive into the surreal world of Ren\u00e9 Magritte, one of Belgium's most famous artists.\\\\n\\\\n3. **Belgian Comic Strip Center**\\\\n   - Discover the rich history of comic strips in Belgium, including famous characters like Tintin.\\\\n\\\\n### Gourmet Experiences\\\\n1. **Chocolate and Beer Tours**\\\\n   - Take a guided tour to sample some of Brussels' best chocolates and beers.\\\\n\\\\n2. **Waffles and Frites**\\\\n   - Enjoy traditional Belgian waffles and fries at local eateries.\\\\n\\\\n### Shopping and Markets\\\\n1. **Galeries Royales Saint-Hubert**\\\\n   - Explore this beautiful shopping arcade filled with boutique shops and cafes.\\\\n\\\\n2. **Marolles Flea Market**\\\\n   - Hunt for unique items and antiques at this bustling market.\\\\n\\\\n### Theatre and Music\\\\n1.", "mimetype": "text/plain", "start_char_idx": 16168, "end_char_idx": 17979, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "da1896ac-5b9e-4d94-9d67-3e0544a55bda": {"__data__": {"id_": "da1896ac-5b9e-4d94-9d67-3e0544a55bda", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "413727c3-c882-48ba-81f7-aa0aec274a23", "node_type": "1", "metadata": {}, "hash": "aaf0e8260d75b17cfbca591f96a9523c04cce1c5f7271a22c8e300b3b33afb35", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "68b393ce-7f7a-4269-8932-f5a8e29e4e1a", "node_type": "1", "metadata": {}, "hash": "b13922e4659cd9dcb9c381e05e9fa40e336be1bb0f5e384ca4a8250fb32101e9", "class_name": "RelatedNodeInfo"}}, "text": "**Ancienne Belgique**\\\\n   - Check out the schedule for any concerts or performances happening today.\\\\n\\\\n2. **La Monnaie/De Munt**\\\\n   - Attend an opera or a ballet performance if available.\\\\n\\\\n### Historical Sites\\\\n1. **Manneken Pis**\\\\n   - Visit this famous statue, which often gets dressed up in various costumes.\\\\n\\\\n2. **Palais de Justice**\\\\n   - Visit this impressive courthouse and enjoy the views from its location.\\\\n\\\\n### Weather Considerations\\\\n- The apparent temperature in Brussels today ranges from 15.9\u00b0C (60.62\u00b0F) in the early morning to a high of around 31.6\u00b0C (88.88\u00b0F) in the late afternoon. Thus, it is quite pleasant for outdoor activities.\\\\n\\\\nWhatever your interests, Brussels has something to offer for everyone. Make sure to check local event listings as well for any special events or festivals happening today. Enjoy your day!\"}`,\n  headers: {\n    'Content-Type': 'application/json',\n    'Access-Control-Allow-Origin': '*'\n  }\n}\nNow you are ready to publish your agent, add secrets, and interact with your agent in the following steps:\n- Execute: 'npm run publish-agent'\n- Set secrets: 'npm run set-secrets'\n- Go to the url produced by setting the secrets (e.g. https://wapo-testnet.phala.network/ipfs/QmPQJD5zv3cYDRM25uGAVjLvXGNyQf9Vonz7rqkQB52Jae?key=b092532592cbd0cf)\n```\n\n## Publish & Interact with Agent\n\nWith our test passing and everything working as expected, now we can build and publish our agent code to IPFS. Then we will set our secrets and access our deployed agent via the Phala Gateway at https://wapo-testnet.phala.network/ipfs/\\<cid>?key=\\<key\\_id>\\&chatQuery=\\<chat\\_query>.\n\nUpload your compiled AI Agent code to IPFS.\n\n```bash\nnpm run publish-agent\n```\n\nUpon a successful upload, the command should show the URL to access your AI Agent.\n\n```\n\u2713 Compiled successfully.", "mimetype": "text/plain", "start_char_idx": 17980, "end_char_idx": 19806, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "68b393ce-7f7a-4269-8932-f5a8e29e4e1a": {"__data__": {"id_": "68b393ce-7f7a-4269-8932-f5a8e29e4e1a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "da1896ac-5b9e-4d94-9d67-3e0544a55bda", "node_type": "1", "metadata": {}, "hash": "a7dabb7349ebbab040ea262e5fd2ab83ce775f7fb17b8e017c6605b95e79dd35", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "61542b5b-3004-4dc1-843b-11850bde8092", "node_type": "1", "metadata": {}, "hash": "1517482869521cea284c7280a3ce3b5d88905844608737171e976e444b77005c", "class_name": "RelatedNodeInfo"}}, "text": "78.19 KB  dist/index.js\nRunning command: npx thirdweb upload dist/index.js\nThis may require you to log into thirdweb and will take some time to publish to IPFS...\n\n    $$\\     $$\\       $$\\                 $$\\                         $$\\       \n    $$ |    $$ |      \\__|                $$ |                        $$ |      \n  $$$$$$\\   $$$$$$$\\  $$\\  $$$$$$\\   $$$$$$$ |$$\\  $$\\  $$\\  $$$$$$\\  $$$$$$$\\  \n  \\_$$  _|  $$  __$$\\ $$ |$$  __$$\\ $$  __$$ |$$ | $$ | $$ |$$  __$$\\ $$  __$$\\ \n    $$ |    $$ |  $$ |$$ |$$ |  \\__|$$ /  $$ |$$ | $$ | $$ |$$$$$$$$ |$$ |  $$ |\n    $$ |$$\\ $$ |  $$ |$$ |$$ |      $$ |  $$ |$$ | $$ | $$ |$$   ____|$$ |  $$ |\n    \\$$$$  |$$ |  $$ |$$ |$$ |      \\$$$$$$$ |\\$$$$$\\$$$$  |\\$$$$$$$\\ $$$$$$$  |\n     \\____/ \\__|  \\__|\\__|\\__|       \\_______| \\_____\\____/  \\_______|\\_______/ \n\n \ud83d\udc8e thirdweb v0.14.12 \ud83d\udc8e\n\n- Uploading file to IPFS. This may take a while depending on file sizes.\n\n\u2714 Successfully uploaded file to IPFS.", "mimetype": "text/plain", "start_char_idx": 19809, "end_char_idx": 20757, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "61542b5b-3004-4dc1-843b-11850bde8092": {"__data__": {"id_": "61542b5b-3004-4dc1-843b-11850bde8092", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "68b393ce-7f7a-4269-8932-f5a8e29e4e1a", "node_type": "1", "metadata": {}, "hash": "b13922e4659cd9dcb9c381e05e9fa40e336be1bb0f5e384ca4a8250fb32101e9", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "3f9e41b3-ca89-4380-9d3f-87c2bb104b58", "node_type": "1", "metadata": {}, "hash": "aad5f1e91c64c1c8b2af8c471fdeb431572025c91bf394ef39b77e6cd20ca133", "class_name": "RelatedNodeInfo"}}, "text": "\u2714 Files stored at the following IPFS URI: ipfs://QmQZYAkEz8RnX9phpWscDLsv1u7uBATaAYHb1prpFGvD4n\n\u2714 Open this link to view your upload: https://b805a9b72767504353244e0422c2b5f9.ipfscdn.io/ipfs/bafybeibbasdv4xt32ea74ga77rpr5kgnkxcgqbtoslgxagzhmmujcjwkym/\n\nAgent Contract deployed at: https://wapo-testnet.phala.network/ipfs/QmQZYAkEz8RnX9phpWscDLsv1u7uBATaAYHb1prpFGvD4n\n\nIf your agent requires secrets, ensure to do the following:\n1) Edit the ./secrets/default.json file or create a new JSON file in the ./secrets folder and add your secrets to it.\n2) Run command: 'npm run set-secrets' or 'npm run set-secrets [path-to-json-file]'\nLogs folder created.\nDeployment information updated in ./logs/latestDeployment.json\n```\n\n{% hint style=\"info\" %}\n**Note** that your latest deployment information will be logged to in file [`./logs/latestDeployment.json`](https://github.com/Phala-Network/ai-agent-template-func-calling/blob/main/logs/latestDeployment.json). This file is updated every time you publish a new Agent Contract to IPFS. This file is also used to get the IPFS CID of your Agent Contract when setting secrets for your Agent Contract.\n\nHere is an example:\n\n```\n{\n  \"date\": \"2024-08-29T20:28:20.081Z\",\n  \"cid\": \"QmYzBTdQNPewdhD9GdBJ9TdV7LVhrh9YVRiV8aBup7qZGu\",\n  \"url\": \"https://wapo-testnet.phala.network/ipfs/QmYzBTdQNPewdhD9GdBJ9TdV7LVhrh9YVRiV8aBup7qZGu\"\n}\n```\n{% endhint %}\n\n{% hint style=\"warning\" %}\n**Did Thirdweb fail to publish?", "mimetype": "text/plain", "start_char_idx": 20758, "end_char_idx": 22200, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "3f9e41b3-ca89-4380-9d3f-87c2bb104b58": {"__data__": {"id_": "3f9e41b3-ca89-4380-9d3f-87c2bb104b58", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "61542b5b-3004-4dc1-843b-11850bde8092", "node_type": "1", "metadata": {}, "hash": "1517482869521cea284c7280a3ce3b5d88905844608737171e976e444b77005c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ba1c9f78-5791-4953-8a66-ad9c3f77b66e", "node_type": "1", "metadata": {}, "hash": "ea67436df927e99e58e58376279243c69f7fb4f166744234c0d9b8fbb5cffd0f", "class_name": "RelatedNodeInfo"}}, "text": "**\n\nIf ThirdWeb fails to publish, please signup for your own ThirdWeb account to publish your Agent Contract to IPFS. Signup or login at [https://thirdweb.com/dashboard/](https://thirdweb.com/dashboard/)\n\nWhenever you log into ThirdWeb, create a new API key and replace the default API Key with yours in the [.env](https://github.com/Phala-Network/ai-agent-template-func-calling/blob/main/.env) file.\\\n`THIRDWEB_API_KEY=\"YOUR_THIRDWEB_API_KEY\"`\n{% endhint %}\n\n### Add Secrets\n\nBy default, all the compiled JS code is visible for anyone to view if they look at IPFS CID. This makes private info like API keys, signer keys, etc. vulnerable to be stolen. To protect devs from leaking keys, we have added a field called `secret` in the `Request` object. It allows you to store secrets in a vault for your AI Agent to access.\n\nTo add your secrets,\n\n1. Edit the [default.json](https://github.com/Phala-Network/ai-agent-template-func-calling/blob/main/secrets/default.json) file or create a new JSON file in the `./secrets` folder and add your secrets to it.\n\n```\n{\n  \"openaiApiKey\": \"YOUR_OPENAI_API_KEY\"\n}\n```\n\n2. Run command to set the secrets\n\n```\nnpm run set-secrets\n# or if you have a custom JSON file\nnpm run set-secrets <path-to-json-file>\n```\n\nExpected output:\n\n```sh\nUse default secrets...\nStoring secrets...\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   205    0    68  100   137    105    213 --:--:-- --:--:-- --:--:--   319\n{\"token\":\"37a0f3f344a3bbf7\",\"key\":\"343e2a7dc130fedf\",\"succeed\":true}\n\nSecrets set successfully.", "mimetype": "text/plain", "start_char_idx": 22200, "end_char_idx": 23844, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ba1c9f78-5791-4953-8a66-ad9c3f77b66e": {"__data__": {"id_": "ba1c9f78-5791-4953-8a66-ad9c3f77b66e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "3f9e41b3-ca89-4380-9d3f-87c2bb104b58", "node_type": "1", "metadata": {}, "hash": "aad5f1e91c64c1c8b2af8c471fdeb431572025c91bf394ef39b77e6cd20ca133", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5e0d8a01-bd3c-4dd6-8426-b72148bd0a98", "node_type": "1", "metadata": {}, "hash": "bb89d8575f8ad4dd6332024d915288a30215df48c57ccabdd6f3b539ddcbfbb9", "class_name": "RelatedNodeInfo"}}, "text": "Go to the URL below to interact with your agent:\nhttps://wapo-testnet.phala.network/ipfs/QmYzBTdQNPewdhD9GdBJ9TdV7LVhrh9YVRiV8aBup7qZGu?key=343e2a7dc130fedf\nLog entry added to secrets.log\n```\n\n> Note that all your secrets will be logged in file [`./logs/secrets.log`](https://github.com/Phala-Network/ai-agent-template-func-calling/blob/main/logs/secrets.log). This file is updated every time you add new secrets to your Agent Contract. If you have not published an Agent Contract, yet, this command will fail since there is not a CID to map the secrets to.\n>\n> Here is an example:\n>\n> ```\n> 2024-08-29T20:30:35.480Z, CID: [QmYzBTdQNPewdhD9GdBJ9TdV7LVhrh9YVRiV8aBup7qZGu], Token: [37a0f3f344a3bbf7], Key: [343e2a7dc130fedf], URL: [https://wapo-testnet.phala.network/ipfs/QmYzBTdQNPewdhD9GdBJ9TdV7LVhrh9YVRiV8aBup7qZGu?key=343e2a7dc130fedf]\n> ```\n\nThe API returns a `token` and a `key`. The `key` is the id of your secret. It can be used to specify which secret you are going to pass to your frame. The `token` can be used by the developer to access the raw secret. You should never leak the `token`.\n\nTo verify the secret, run the following command where `key` and `token` are replaced with the values from adding your `secret` to the vault.", "mimetype": "text/plain", "start_char_idx": 23845, "end_char_idx": 25086, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5e0d8a01-bd3c-4dd6-8426-b72148bd0a98": {"__data__": {"id_": "5e0d8a01-bd3c-4dd6-8426-b72148bd0a98", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ba1c9f78-5791-4953-8a66-ad9c3f77b66e", "node_type": "1", "metadata": {}, "hash": "ea67436df927e99e58e58376279243c69f7fb4f166744234c0d9b8fbb5cffd0f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "37b04196-a9fb-43c5-ba44-844ba241bfa9", "node_type": "1", "metadata": {}, "hash": "0556d6f77179c75cb34d21dedbf9e2b1a9957dfd416bf8f78d85e41cf688ee77", "class_name": "RelatedNodeInfo"}}, "text": "```\ncurl https://wapo-testnet.phala.network/vaults/<key>/<token>\n```\n\nExpected output:\n\n```\n{\"data\":{\"openaiApiKey\":\"<OPENAI_API_KEY>\"},\"succeed\":true}\n```\n\n### Access Queries\n\nTo help create custom logic, we have an array variable named `queries` that can be accessed in the `Request` class. To access the `queries` array variable `chatQuery` value at index `0`, the syntax will look as follows:\n\n```\nconst query = req.queries.chatQuery[0] as string;\n```\n\nHere is an example of adding a URL query named `chatQuery` with a value of `When did humans land on the moon`. `queries` can have any field name, so `chatQuery` is just an example of a field name and not a mandatory name, but remember to update your `index.ts` file logic to use your expected field name.\n\n> [https://wapo-testnet.phala.network/ipfs/Qmc7EDq1X8rfYGGfHyXZ6xsmcSUWQcqsDoeRMfmvFujih3?key=51f265212c26086c&<mark style=\"background-color:yellow;\">**chatQuery**</mark>=When%20did%20humans%20land%20on%20the%20moon](https://wapo-testnet.phala.network/ipfs/Qmc7EDq1X8rfYGGfHyXZ6xsmcSUWQcqsDoeRMfmvFujih3?key=51f265212c26086c\\&chatQuery=When%20did%20humans%20land%20on%20the%20moon)\n\n### Query Your Deployed Agent\n\nNow that your agent is deployed, you can access the agent through a `curl` request or insert the url with the `key` and `chatQuery` defined. Here is an example of the code from the tutorial we just walked through.", "mimetype": "text/plain", "start_char_idx": 25088, "end_char_idx": 26478, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "37b04196-a9fb-43c5-ba44-844ba241bfa9": {"__data__": {"id_": "37b04196-a9fb-43c5-ba44-844ba241bfa9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5e0d8a01-bd3c-4dd6-8426-b72148bd0a98", "node_type": "1", "metadata": {}, "hash": "bb89d8575f8ad4dd6332024d915288a30215df48c57ccabdd6f3b539ddcbfbb9", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b79072c6-7276-49f8-a8fb-67ce3e764a70", "node_type": "1", "metadata": {}, "hash": "63a02dad60a8552625d205da7f8cd0a30408caa8a67122d2db20e397b1cf7bd2", "class_name": "RelatedNodeInfo"}}, "text": "Example: [https://wapo-testnet.phala.network/ipfs/QmQZYAkEz8RnX9phpWscDLsv1u7uBATaAYHb1prpFGvD4n?key=5150856fe20eb558&<mark style=\"background-color:yellow;\">chatQuery</mark>=What%20are%20activities%20to%20do%20in%20Singapore%20today](https://wapo-testnet.phala.network/ipfs/QmQZYAkEz8RnX9phpWscDLsv1u7uBATaAYHb1prpFGvD4n?key=5150856fe20eb558\\&chatQuery=What%20are%20activities%20to%20do%20in%20Singapore%20today)\n\n### Debugging Your Agent\n\nTo debug your agent, you can use the following command:\n\n```\ncurl https://wapo-testnet.phala.network/logs/all/ipfs/<CID>\n```\n\nAfter executing this command then you should see some output in the terminal to show the logs of requests to your agent.\n\n```\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [REPORT] END Request: Duration: 166ms\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [INFO] 'Is signature valid? ' true\n2024-09-04T03:18:34.758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [INFO] 'Verifying Signature with PublicKey ' '0xC1BF8dB4D06416c43Aca3deB289CF7CC0aAFF540'\n2024-09-04T03:18:34.", "mimetype": "text/plain", "start_char_idx": 26480, "end_char_idx": 27547, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b79072c6-7276-49f8-a8fb-67ce3e764a70": {"__data__": {"id_": "b79072c6-7276-49f8-a8fb-67ce3e764a70", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "37b04196-a9fb-43c5-ba44-844ba241bfa9", "node_type": "1", "metadata": {}, "hash": "0556d6f77179c75cb34d21dedbf9e2b1a9957dfd416bf8f78d85e41cf688ee77", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ead8c586-71e2-4521-8ab7-8c7188218602", "node_type": "1", "metadata": {}, "hash": "9629fd0b6d24b2b2c7f655a205315bff15ba8067078a66ecf2dba35795739c31", "class_name": "RelatedNodeInfo"}}, "text": "758Z [95f5ec53-3d71-4bb5-bbb6-66065211102c] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd&type=verify&data=tintinland%20message%20to%20sign&signature=0x34c4d8c83406e7a292ecc940d60b34c9b11024db10a8872c753b9711cd6dbc8f746da8be9bc2ae0898ebf8f49f48c2ff4ba2a851143c3e4b371647eed32f707b1b\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [REPORT] END Request: Duration: 183ms\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [INFO] 'Signature: 0x34c4d8c83406e7a292ecc940d60b34c9b11024db10a8872c753b9711cd6dbc8f746da8be9bc2ae0898ebf8f49f48c2ff4ba2a851143c3e4b371647eed32f707b1b'\n2024-09-04T03:17:15.238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [INFO] 'Signing data [tintinland message to sign] with Account [0xC1BF8dB4D06416c43Aca3deB289CF7CC0aAFF540]'\n2024-09-04T03:17:15.", "mimetype": "text/plain", "start_char_idx": 27547, "end_char_idx": 28398, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ead8c586-71e2-4521-8ab7-8c7188218602": {"__data__": {"id_": "ead8c586-71e2-4521-8ab7-8c7188218602", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358", "node_type": "4", "metadata": {}, "hash": "289e2fdda07c68793f5f8c0c5bc78127bd82c40fdaa99912f036066be5ee03ae", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b79072c6-7276-49f8-a8fb-67ce3e764a70", "node_type": "1", "metadata": {}, "hash": "63a02dad60a8552625d205da7f8cd0a30408caa8a67122d2db20e397b1cf7bd2", "class_name": "RelatedNodeInfo"}}, "text": "238Z [768b6fda-f9f1-463f-86bd-a948e002bf80] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd&type=sign&data=tintinland%20message%20to%20sign\n2024-09-04T03:16:38.507Z [3717d307-bff0-4fc0-bc98-8f66c33dd46f] [REPORT] END Request: Duration: 169ms\n2024-09-04T03:16:38.507Z [3717d307-bff0-4fc0-bc98-8f66c33dd46f] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64a1e805bfd\n2024-09-04T03:15:00.375Z [793f58f9-f24f-4580-8ebc-04debb7d727f] [REPORT] END Request: Duration: 158ms\n2024-09-04T03:15:00.375Z [793f58f9-f24f-4580-8ebc-04debb7d727f] [REPORT] START Request: GET /ipfs/QmfLpQjxAMsppUX9og7xpmfSKZAZ8zuWJV5g42DmpASSWz?key=0e26a64\na1e805bfd\n```\n\nTo create logs in your Agent Contract, you can use the following syntax in your `index.ts` file.\n\n```\n// info logs\nconsole.log('info log message!')\n// error logs\nconsole.error('error log message!')\n```\n\nFor more information check the [MDN docs](https://developer.mozilla.org/en-US/docs/Web/API/console) on `console` object.", "mimetype": "text/plain", "start_char_idx": 28398, "end_char_idx": 29457, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8ee1f65b-b659-4e24-86b4-8f53d246ff8a": {"__data__": {"id_": "8ee1f65b-b659-4e24-86b4-8f53d246ff8a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-and-play-with-social-agents.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "5ae3e0cc-340d-4dd9-ab13-15c2cf2c99cf", "node_type": "4", "metadata": {}, "hash": "28f032fe9f36df4858efcba6e4706640e4df57e49bfbba11f5cfac277698d6ba", "class_name": "RelatedNodeInfo"}}, "text": "# Create and Play with Social Agents\n\n<figure><img src=\"../../.gitbook/assets/Agent_wars_coming_soon.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 147, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "26b63057-ab2d-49b6-9cdf-37995c286bee": {"__data__": {"id_": "26b63057-ab2d-49b6-9cdf-37995c286bee", "embedding": null, "metadata": {"file_path": "phala-docs_dist/call-your-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "c454bb15-bb46-4763-b920-358d7465abde", "node_type": "4", "metadata": {}, "hash": "bebf1e5abfbee0b996a3b1c0833f98c64ca8b15b0ace6a677201daa398115133", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "eeb0ce69-dd45-429b-8ef8-16847940f059", "node_type": "1", "metadata": {}, "hash": "7ab6e14de8aac98b1d7b7d6cef51aea5abe1f8ee5d19b4894f1bc6da7245786c", "class_name": "RelatedNodeInfo"}}, "text": "# Call Your Contract\n\n## Query and Transaction <a href=\"#query-and-transaction\" id=\"query-and-transaction\"></a>\n\nYou can call your Phat Contract in two ways: on-chain _transactions_ and off-chain _queries_. A Phat contract supports both types of input, but they are very different.\n\nWe recommend using more queries in your contracts and only using the transactions to set some important configurations. This is because many unique features of Phat Contract are only available in query handler functions.\n\n|                       | Transaction | Query |\n| --------------------- | ----------- | ----- |\n| Encrypted             | \u2705           | \u2705     |\n| Posted on chain       | \u2705           | \u274c     |\n| Direct to worker      | \u274c           | \u2705     |\n| Read contract state   | \u2705           | \u2705     |\n| Change contract state | \u2705           | \u274c     |\n| No gas fee            | \u274c           | \u2705     |\n| Latency               | 6s          | 0s    |\n| Deterministic         | \u2705           | \u274c     |\n| Internet Access       | \u274c           | \u2705     |\n\n## Handle Query and Transaction <a href=\"#handle-query-and-transaction\" id=\"handle-query-and-transaction\"></a>\n\nDespite the obscure underlying mechanism, from the code side, handling the queries and transactions can be really easy in Phat Contract.\n\n```\n#[ink(message)]\npub fn query_handler(&self, arg1: AccountId, arg2: u32) {\n    // actual implementation\n}\n\n#[ink(message)]\npub fn transaction_handler(&mut self, arg1: AccountId, arg2: u32) {\n    // actual implementation\n}\n```\n\nIn Phat Contract, defining a user request handler is as simple as labeling a function with `#[ink(message)]`. The only difference between a transaction handler and a query handler is how they refer to the contract state:\n\n* Query handler holds immutable reference `&self`, they can read the current contract states but should not change them;\n* Transaction handler holds mutable reference `&mut self`, so they are allowed to update the contract states.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1966, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "eeb0ce69-dd45-429b-8ef8-16847940f059": {"__data__": {"id_": "eeb0ce69-dd45-429b-8ef8-16847940f059", "embedding": null, "metadata": {"file_path": "phala-docs_dist/call-your-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "c454bb15-bb46-4763-b920-358d7465abde", "node_type": "4", "metadata": {}, "hash": "bebf1e5abfbee0b996a3b1c0833f98c64ca8b15b0ace6a677201daa398115133", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "26b63057-ab2d-49b6-9cdf-37995c286bee", "node_type": "1", "metadata": {}, "hash": "e0303967b25536b15966ffc4e752040c9ea5abf46a95460b81c7633279392acc", "class_name": "RelatedNodeInfo"}}, "text": "### Available Functionalities <a href=\"#available-functionalities\" id=\"available-functionalities\"></a>\n\nPhat Contract has unique capabilities, and they are provided as functions in [pink-extension](https://github.com/Phala-Network/phala-blockchain/tree/master/crates/pink) (short for Phala ink! Extension). You can use all these functions in your query handler functions, but some of them are disabled in transaction handlers since they can lead to inconsistent on-chain states.\n\nCheck the detailed list in the following section.\n\n## Learn More about Query <a href=\"#learn-more-about-query\" id=\"learn-more-about-query\"></a>\n\nFor all existing smart contracts, a user needs to send a transaction on-chain and wait for it to be processed by the contract.\n\nThe most significant difference between Phat Contract and other smart contracts is that it runs off-chain. This enables it to directly receive and process users' off-chain requests (called _Query_), other than the traditional on-chain transactions. For the first time, you can process these two kinds of requests in one contract.\n\n> If you do not know what\u2019s transaction and how they are processed in traditional smart contracts, refer to [Ethereum\u2019s introduction on smart contract](https://ethereum.org/en/developers/docs/smart-contracts/). The transactions are processed in exactly the same way in Phat Contract.\n\n<figure><img src=\"../../../../.gitbook/assets/general-node-design.png\" alt=\"\"><figcaption></figcaption></figure>\n\nSince queries are never submitted on-chain, it has unique features compared with transactions:\n\n* it is never recorded on-chain, thus volatile. So query handling logic is not allowed to change the contract states on-chain (but you are free to read these states when processing queries);\n* it requires no gas fee for users to send queries to a contract;\n* there is zero latency in query processing since it does not need to wait for block production.\n\nBoth the advantages and disadvantages of the query are clear:\n\n* Pros: Query removes the performance and functional limitations on transaction processing, while still able to read the contract states;\n* Cons: You need to be extremely careful when you allow queries to affect your contract states since concurrent query handling can lead to unexpected execution results.\n\nThat\u2019s why we choose to start with stateless DApp building: it totally avoids the weakness of the query. We leave the stateful application building as an advanced topic.", "mimetype": "text/plain", "start_char_idx": 1968, "end_char_idx": 4442, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "66011b89-b820-44c7-bd9c-c7d944c0a51c": {"__data__": {"id_": "66011b89-b820-44c7-bd9c-c7d944c0a51c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/cluster-of-workers.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "12ba18ad-2b64-404b-8274-bb26fb834b59", "node_type": "4", "metadata": {}, "hash": "63483a623e913f39011aefcb2e8bd36f768c854f1a01d1d4f06018cf9fda8b89", "class_name": "RelatedNodeInfo"}}, "text": "# Cluster of Workers\n\n## Cluster: Abstraction of Workers <a href=\"#cluster-abstraction-of-workers\" id=\"cluster-abstraction-of-workers\"></a>\n\nPhala has many Workers but we do not expose them to developers directly. They are organized into _Clusters_ and used by our developers.\n\n![](https://i.imgur.com/G4T51Ht.png)\n\n* Contracts must be deployed to a Cluster, and a Cluster can hold multiple contracts\n  * Contracts in different Clusters have no relationship, even if they share the same code\n  * Contracts in one Cluster can call each other, and contracts in different Clusters need to call each other in an XCM-like way (BTW, the XCM support is WIP, so this should be supported soon)\n* A Cluster is backed by one or more Workers\n  * The Worker will run all the contracts in this Cluster\n* Different access controls can be defined for different Clusters\n  * like who can deploy how many contracts in this Cluster\n\nAccordingly, we have a two-level contract tokenomics for this design.\n\n* The L1 tokenomics define how you stake $PHA to rent Workers and form your Cluster\n  * We will provide the public good Clusters, and people can stake $PHA to get the proportional computing power in our network\n* The L2 tokenomics define how Cluster owners charge the contract deployers\n  * We provide a [template implementation](https://github.com/Phala-Network/phala-blockchain/tree/master/crates/pink-drivers) (with `Public` and `OnlyOwner` rules) and will allow owners to implement their own logic with Phat Contract", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1505, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "623c50a6-61af-4a63-baf1-f4d27f2c513f": {"__data__": {"id_": "623c50a6-61af-4a63-baf1-f4d27f2c513f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/cross-chain-solutions.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "d3b4286e-4c44-4314-a433-7357a497ee83", "node_type": "4", "metadata": {}, "hash": "e3a2097f1899d5c44fcc36f6af0ec9e95400a2b6dfc27667c12d7f673564bb0d", "class_name": "RelatedNodeInfo"}}, "text": "# Cross Chain Solutions\n\nThe Phat Contract Offchain Rollup documentation is located in our GitHub Repository [here](https://github.com/Phala-Network/phat-offchain-rollup).\n\n* [EVM Details](https://github.com/Phala-Network/phat-offchain-rollup/blob/main/EvmRollup.md) for deploying an offchain rollup on EVM based chains.\n* [Technical details](https://github.com/Phala-Network/phat-offchain-rollup/blob/main/TechnicalDetails.md) of the overall architecture.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 456, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d68c200d-0822-463f-ba5b-00101110a1c4": {"__data__": {"id_": "d68c200d-0822-463f-ba5b-00101110a1c4", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "01f7946b-001a-444e-b363-18176de71645", "node_type": "4", "metadata": {}, "hash": "d3276915a6130f6188c9ef1ecaea84c71bd2789d86718c5102f2a2e767e76811", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5f0c767c-4bb4-4cb2-aa5f-589d2634a0d0", "node_type": "1", "metadata": {}, "hash": "984ba056c63ea28aa46283458470a702a168a5d8ccdaedd8b9ec88f27ef0f570", "class_name": "RelatedNodeInfo"}}, "text": "# Create Contract\n\n## Create and Compile Your First Contract <a href=\"#create-and-compile-your-first-contract\" id=\"create-and-compile-your-first-contract\"></a>\n\nThere are a couple ways to get you started.\n\n{% tabs %}\n{% tab title=\"Swanky Phala\" %}\n> If you have not installed `swanky phala` CLI tool, follow these [steps](swanky-phala-cli-tool.md) to get started.\n\nGo to your development workspace and initialize a new project. For this tutorial, we will name the project `Norwhich` and choose the `phat_hello` template.\n\n```bash\nswanky phala init Norwhich\n```\n\nHere is a video example of the creating the new project called `Norwhich`.\n\n{% embed url=\"https://youtu.be/gAPV01e9Ljs\" %}\nswanky phala init\n{% endembed %}\n\nNext, `cd` into the `Norwhich` directory and compile the `phat_hello` Phat Contract that was generated with the following command:\n\n```\nswanky phala contract compile -c phat_hello\n```\n\nHere is a short clip of compiling the `phat_hello` contract.\n\n{% embed url=\"https://youtu.be/pHQOk69OOYA\" %}\nswanky phala contract compile\n{% endembed %}\n{% endtab %}\n\n{% tab title=\"GitHub\" %}\nIn order to initialize a new Phat Contract project you can use our hello world template:\n\n```\ngit clone https://github.com/Phala-Network/phat-hello\n```\n\n> **Contract Examples**\n>\n> More Phat contract examples can be found in [phat-contract-examples](https://github.com/Phala-Network/phat-contract-examples) and [awesome-phat-contracts](../../../../.gitbook/assets/awesome%20phat%20contracts/) repositories.\n\nThis will create a folder `phat-hello` in your work directory. The folder contains a scaffold `Cargo.toml` and a `lib.rs`, which both contain the necessary building blocks for using Phat Contract.\n\nThe `lib.rs` contains our hello world contract \u2012 an ETH balance reader.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1774, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5f0c767c-4bb4-4cb2-aa5f-589d2634a0d0": {"__data__": {"id_": "5f0c767c-4bb4-4cb2-aa5f-589d2634a0d0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/create-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "01f7946b-001a-444e-b363-18176de71645", "node_type": "4", "metadata": {}, "hash": "d3276915a6130f6188c9ef1ecaea84c71bd2789d86718c5102f2a2e767e76811", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d68c200d-0822-463f-ba5b-00101110a1c4", "node_type": "1", "metadata": {}, "hash": "cf8d524257f1a5363d6487fca3724c7a2b20cec5f3105fe00222eaf9a9b8a969", "class_name": "RelatedNodeInfo"}}, "text": "In order to build the contract just execute this command in the `phat-hello` folder:\n\n```\ncargo contract build\n```\n{% endtab %}\n{% endtabs %}\n\nAs a result, you\u2019ll get the following files in the `target/ink` folder of your contract: `phat_hello.wasm`, `metadata.json`, and `phat_hello.contract`. The `.contract` file combines the WASM and metadata into one file and needs to be used when instantiating the contract.\n\n## Run Unit Tests Locally <a href=\"#run-unit-tests-locally\" id=\"run-unit-tests-locally\"></a>\n\nBefore you really upload and deploy your contract to the blockchain, you are encouraged to run local unit tests to check its correctness.\n\nIn the `phat-hello` folder, run\n\n```\ncargo test -- --nocapture\n```\n\nand ensure you see all tests passed.\n\n> Do not use `cargo contract test` here, `cargo test` will give you more details if something goes wrong.\n>\n> `-- --nocapture` is optional to see the output during testing.\n\nNow you have successfully compiled and locally test your first Phat Contract. Now it\u2019s time to deploy it to a real blockchain.", "mimetype": "text/plain", "start_char_idx": 1776, "end_char_idx": 2831, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "487fe872-80ab-4dcc-abed-2da490888c14": {"__data__": {"id_": "487fe872-80ab-4dcc-abed-2da490888c14", "embedding": null, "metadata": {"file_path": "phala-docs_dist/ai-agent-contract-templates.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eca0c7e0-8783-4a72-8f2a-ae125d3ca884", "node_type": "4", "metadata": {}, "hash": "51bdfee87910f3b98fd80f05d99a79192bbabec03f842002e6bdc020e7856557", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "51429796-daf7-41b5-b8b5-76e961bf75e4", "node_type": "1", "metadata": {}, "hash": "afae513ff5e61b08e4263b3420ff03f98d5bc8c3205cc71fd58d5333bc130ee9", "class_name": "RelatedNodeInfo"}}, "text": "# AI Agent Contract Templates\n\n<table><thead><tr><th width=\"247\">AI Agent Contract Name</th><th>Vendor</th><th width=\"220\">Repo</th><th>API Key</th></tr></thead><tbody><tr><td>Viem SDK Template<br>(Derive ECDSA Key, Sign/Verify Data, Send Onchain TXs)</td><td><a href=\"https://viem.sh\">viem</a></td><td><a href=\"https://github.com/Phala-Network/ai-agent-contract-tools\">https://github.com/Phala-Network/ai-agent-contract-tools</a></td><td>None</td></tr><tr><td>RedPill Template</td><td>RedPill</td><td><a href=\"https://github.com/Phala-Network/ai-agent-template-redpill\">https://github.com/Phala-Network/ai-agent-template-redpill</a></td><td><a href=\"https://red-pill.ai\">https://red-pill.ai</a></td></tr><tr><td>OpenAI Template</td><td>OpenAI</td><td><a href=\"https://github.com/Phala-Network/ai-agent-template-openai\">ai-agent-template-openai</a></td><td><a href=\"https://platform.openai.com/account/api-keys\">https://platform.openai.com/account/api-keys</a></td></tr><tr><td>Anthropic Template</td><td>Anthropic</td><td><a href=\"https://github.com/Phala-Network/ai-agent-template-anthropic\">https://github.com/Phala-Network/ai-agent-template-anthropic</a></td><td><a href=\"https://console.anthropic.com/login?returnTo=%2F%3F\">https://console.anthropic.com/login?returnTo=%2F%3F</a></td></tr><tr><td>LangChain Template</td><td>LangChain</td><td><a href=\"https://github.com/Phala-Network/ai-agent-template-langchain\">https://github.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1433, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "51429796-daf7-41b5-b8b5-76e961bf75e4": {"__data__": {"id_": "51429796-daf7-41b5-b8b5-76e961bf75e4", "embedding": null, "metadata": {"file_path": "phala-docs_dist/ai-agent-contract-templates.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eca0c7e0-8783-4a72-8f2a-ae125d3ca884", "node_type": "4", "metadata": {}, "hash": "51bdfee87910f3b98fd80f05d99a79192bbabec03f842002e6bdc020e7856557", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "487fe872-80ab-4dcc-abed-2da490888c14", "node_type": "1", "metadata": {}, "hash": "f33bdd2fb8674c8fe300f343ac9d12c982f38754127449d8ec1f1c7234ce50b6", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b40da088-bf8f-45b5-90ab-7ee5f8f5827b", "node_type": "1", "metadata": {}, "hash": "f5ccf2eef649cba99c13e75de3fad644288445382c2027b82f8024c4646608ac", "class_name": "RelatedNodeInfo"}}, "text": "com/Phala-Network/ai-agent-template-langchain</a></td><td><a href=\"https://platform.openai.com/account/api-keys\">https://platform.openai.com/account/api-keys</a></td></tr><tr><td>Function Calling Template</td><td>OpenAI</td><td><a href=\"https://github.com/Phala-Network/ai-agent-template-func-calling\">https://github.com/Phala-Network/ai-agent-template-func-calling</a></td><td><a href=\"https://platform.openai.com/account/api-keys\">https://platform.openai.com/account/api-keys</a></td></tr><tr><td>Brian Template</td><td>Brian</td><td><a href=\"https://github.com/Phala-Network/ai-agent-template-brian\">https://github.com/Phala-Network/ai-agent-template-brian</a></td><td><a href=\"https://www.brianknows.org/app\">https://www.brianknows.org/app</a></td></tr><tr><td>'mbd.xyz Template</td><td>'mbd</td><td><a href=\"https://github.com/Phala-Network/ai-agent-template-mbd\">https://github.com/Phala-Network/ai-agent-template-mbd</a></td><td><a href=\"https://console.mbd.xyz/dashboard\">https://console.mbd.xyz/dashboard</a></td></tr><tr><td>Apillon Template</td><td>Apillon</td><td><a href=\"https://github.com/Phala-Network/ai-agent-template-apillon\">https://github.com/Phala-Network/ai-agent-template-apillon</a></td><td><a href=\"https://app.apillon.io/login\">https://app.apillon.io/login</a></td></tr><tr><td>Chainbase Template</td><td>Chainbase</td><td><a href=\"https://github.com/Phala-Network/ai-agent-template-chainbase\">https://github.com/Phala-Network/ai-agent-template-chainbase</a></td><td><a href=\"https://console.", "mimetype": "text/plain", "start_char_idx": 1433, "end_char_idx": 2952, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b40da088-bf8f-45b5-90ab-7ee5f8f5827b": {"__data__": {"id_": "b40da088-bf8f-45b5-90ab-7ee5f8f5827b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/ai-agent-contract-templates.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eca0c7e0-8783-4a72-8f2a-ae125d3ca884", "node_type": "4", "metadata": {}, "hash": "51bdfee87910f3b98fd80f05d99a79192bbabec03f842002e6bdc020e7856557", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "51429796-daf7-41b5-b8b5-76e961bf75e4", "node_type": "1", "metadata": {}, "hash": "afae513ff5e61b08e4263b3420ff03f98d5bc8c3205cc71fd58d5333bc130ee9", "class_name": "RelatedNodeInfo"}}, "text": "chainbase.com/\">https://console.chainbase.com/</a></td></tr><tr><td>Pond Template</td><td>Pond</td><td><a href=\"https://github.com/Phala-Network/ai-agent-template-pond\">https://github.com/Phala-Network/ai-agent-template-pond</a></td><td><a href=\"https://doc.cryptopond.xyz/docs/how-to-get-api\">https://doc.cryptopond.xyz/docs/how-to-get-api</a></td></tr><tr><td>Allora Template</td><td>Allora</td><td><a href=\"https://github.com/Phala-Network/ai-agent-template-allora\">https://github.com/Phala-Network/ai-agent-template-allora</a></td><td><a href=\"https://developer.upshot.xyz/signup\">https://developer.upshot.xyz/signup</a></td></tr></tbody></table>", "mimetype": "text/plain", "start_char_idx": 2952, "end_char_idx": 3602, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "390e6d88-19dd-48fc-9e6d-db10311681e5": {"__data__": {"id_": "390e6d88-19dd-48fc-9e6d-db10311681e5", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "69441acb-5d8e-49ad-84af-34a9aded7e12", "node_type": "1", "metadata": {}, "hash": "e88d275713ca353013fc444b54cc1dfb3b37b913542606bc104b2468a8f6a0c8", "class_name": "RelatedNodeInfo"}}, "text": "---\ndescription: >-\n  Next step in requesting data from your deployed LensAPI Oracle. Deploy a\n  Polygon Consumer Smart Contract.\n---\n\n# \ud83e\uddd1\u200d\ud83d\ude80 Polygon Consumer Contract for LensAPI Oracle\n\n## Overview\n\nThis project represents a basic Polygon Consumer Contract that is compatible with a deployed LensAPI Oracle via [Phat Contract 2.0 UI](https://bricks.phala.network). This tutorial assumes the developer is familiar with executing commands in a terminal.\n\n<figure><img src=\"../../../../.gitbook/assets/image (1) (1) (2).png\" alt=\"\"><figcaption></figcaption></figure>\n\n## Prerequisites\n\n* Active deployed LensAPI Oracle Blueprint via [Phala Dashboard](https://dashboard.phala.network)\n* Address of the \"[Oracle Endpoint](https://docs.phala.network/developers/bricks-and-blueprints/featured-blueprints/lensapi-oracle#step-3-connect-your-smart-contract-to-the-oracle)\" in deployed LensAPI Oracle\n* [Hardhat](https://hardhat.org)\n* For Polygon Mainnet deployments:\n  * Polygonscan API Key that can be generated on [polygonscan](https://polygonscan.com)\n* RPC Endpoint for Polygon Mainnet & Mumbai Testnet\n  * [Alchemy](https://alchemy.com) - This repo example uses Alchemy's API Key.\n  * [Infura](https://infura.io)\n  * Personal RPC Node\n* Test Tokens at [Phala Faucet](https://bit.ly/3Tomopi)\n\n### Environment Variables: <a href=\"#user-content-environment-variables\" id=\"user-content-environment-variables\"></a>\n\nCheck out the environment variables here in [.env.local](https://github.com/Phala-Network/lensapi-oracle-consumer-contract/blob/refactor/.env.local) file.\n\n## Getting Started <a href=\"#user-content-getting-started\" id=\"user-content-getting-started\"></a>\n\n> Note: If you cloned this repo or created a template, skip to [Create a Phala Profile](https://github.com/Phala-Network/lensapi-oracle-consumer-contract/blob/refactor/LENSAPI\\_ORACLE.md#create-a-bricks-profile)\n\nFirst you will need to install the `@phala/fn` CLI tool using your node package manager (`npm`) or use node package execute (`npx`).", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2008, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "69441acb-5d8e-49ad-84af-34a9aded7e12": {"__data__": {"id_": "69441acb-5d8e-49ad-84af-34a9aded7e12", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "390e6d88-19dd-48fc-9e6d-db10311681e5", "node_type": "1", "metadata": {}, "hash": "a87e27cb00fd88c14726ae5d4cc9874555cc1460c27bcfeb922e4f46d3e2e5e1", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a9288e9b-a380-4e60-bbf8-2b0097949d4b", "node_type": "1", "metadata": {}, "hash": "04a2553a182ca3edce7ae2d7a5a8f5e7eb2603f67d9eb6dbf3b9565bbb1c12e4", "class_name": "RelatedNodeInfo"}}, "text": "In this tutorial we use `npx`.\n\nNow create your first template with the CLI tool command:\n\n```sh\nnpx @phala/fn init example\n```\n\nWe currently have only one template. Just press enter to see something similar to the example below:\n\n```sh\nnpx @phala/fn@latest init example\n? Please select one of the templates for your \"example\" project: \n  phat-contract-starter-kit: Send data from any API to your smart contract with Javascript. \n\u276f lensapi-oracle-consumer-contract: Send data from Lens API to your smart contract to empower your Web3 Social dApp. \n  vrf-oracle: TEE-guarded Verifiable Random Function template to bring randomness to your smart contract. \n  airstack-phat-contract: Request an account\u2019s data from Airstack\u2019s API to compute trust score and send to your Web3 dApp on-chain. \n  thegraph-phat-contract: Connect your subgraphs from The Graph to your on-chain dApps via Phat Contract.  \n```\n\n`cd` into the newly created template and `ls` the directory which will look similar to below.\n\n```sh\ncd example\nls\n# total 736\n# drwxr-xr-x  18 hashwarlock  staff   576B Sep  6 15:32 .\n# drwxr-xr-x  35 hashwarlock  staff   1.1K Sep  6 15:32 .\n# -rw-r--r--   1 hashwarlock  staff   2.1K Sep  6 15:32 .env.local\n# -rw-r--r--   1 hashwarlock  staff   227B Sep  6 15:32 .gitignore\n# -rw-r--r--   1 hashwarlock  staff    34K Sep  6 15:32 LICENSE\n# -rw-r--r--   1 hashwarlock  staff   8.9K Sep  6 15:32 README.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a9288e9b-a380-4e60-bbf8-2b0097949d4b": {"__data__": {"id_": "a9288e9b-a380-4e60-bbf8-2b0097949d4b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "69441acb-5d8e-49ad-84af-34a9aded7e12", "node_type": "1", "metadata": {}, "hash": "e88d275713ca353013fc444b54cc1dfb3b37b913542606bc104b2468a8f6a0c8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "76622f7a-340e-4409-8a28-4e0a6e84778a", "node_type": "1", "metadata": {}, "hash": "8ba0ef497199c57c951266431170d6b277353cce81b0372e8694a4757543d62a", "class_name": "RelatedNodeInfo"}}, "text": "md\n# drwxr-xr-x   5 hashwarlock  staff   160B Sep  6 15:32 abis\n# drwxr-xr-x   4 hashwarlock  staff   128B Sep  6 15:32 assets\n# drwxr-xr-x   5 hashwarlock  staff   160B Sep  6 15:32 contracts\n# -rw-r--r--   1 hashwarlock  staff   1.3K Sep  6 15:32 hardhat.config.ts\n# -rw-r--r--   1 hashwarlock  staff    95B Sep  6 15:32 mumbai.arguments.ts\n# -rw-r--r--   1 hashwarlock  staff   2.6K Sep  6 15:32 package.json\n# -rw-r--r--   1 hashwarlock  staff    96B Sep  6 15:32 polygon.arguments.ts\n# drwxr-xr-x   5 hashwarlock  staff   160B Sep  6 15:32 scripts\n# drwxr-xr-x   3 hashwarlock  staff    96B Sep  6 15:32 src\n# drwxr-xr-x   3 hashwarlock  staff    96B Sep  6 15:32 test\n# -rw-r--r--   1 hashwarlock  staff   201B Sep  6 15:32 tsconfig.json\n# -rw-r--r--   1 hashwarlock  staff   290K Sep  6 15:32 package-lock.json\n```\n\n### Create a Bricks Profile <a href=\"#user-content-create-a-bricks-profile\" id=\"user-content-create-a-bricks-profile\"></a>\n\nThis step requires you to have a Polkadot account.", "mimetype": "text/plain", "start_char_idx": 3415, "end_char_idx": 4412, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "76622f7a-340e-4409-8a28-4e0a6e84778a": {"__data__": {"id_": "76622f7a-340e-4409-8a28-4e0a6e84778a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a9288e9b-a380-4e60-bbf8-2b0097949d4b", "node_type": "1", "metadata": {}, "hash": "04a2553a182ca3edce7ae2d7a5a8f5e7eb2603f67d9eb6dbf3b9565bbb1c12e4", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b9223cf8-b893-4096-a81a-ad92cc446700", "node_type": "1", "metadata": {}, "hash": "4e403b573d84d4bb2a114687a795a441bc42cc39d188d17eb398bf9eb37717e1", "class_name": "RelatedNodeInfo"}}, "text": "You can get an account from one of the following:\n\n* [Polkadot.js Wallet Extension](https://polkadot.js.org/extension/)\n* [Talisman Wallet](https://www.talisman.xyz/)\n* [SubWallet](https://www.subwallet.app/) (**Support for iOS/Android**)\n\nFirst, create your Bricks Profile account on the [Phala PoC6 Testnet](https://bricks-poc5.phala.network/) or [Phala Mainnet](https://bricks.phala.network/). Here is a quick 1 minute [YouTube video](https://youtu.be/z1MR48NYtYc) on setting up from scratch.\n\nHere is what your Bricks Profile account overview should look like:&#x20;\n\n<figure><img src=\"https://github.com/Phala-Network/lensapi-oracle-consumer-contract/raw/refactor/assets/BricksProfileCheck.png\" alt=\"\"><figcaption></figcaption></figure>\n\nAfter creating your Bricks Profile, set your `.env` variable `POLKADOT_WALLET_SURI` to the mnemonic phrase from generating the new Polkadot Account.\n\nHere is a screenshot of how to set `POLKADOT_WALLET_SURI`:&#x20;\n\n<figure><img src=\"https://github.com/Phala-Network/lensapi-oracle-consumer-contract/raw/refactor/assets/PolkadotAccountSuri.png\" alt=\"\"><figcaption></figcaption></figure>\n\n\\\nTesting Locally\n---------------\n\n### Test Default Function Locally <a href=\"#user-content-test-default-function-locally\" id=\"user-content-test-default-function-locally\"></a>\n\nWith a template created and a basic default function example ready to test, let\u2019s step through the process of preparing your repo to execute the test locally.\n\nFirst step is to install the package dependencies with the following command:\n\n```\nnpm install\n```\n\nEverything should go smoothly and produce similar output below:\n\n```\nnpm install\n# [1/4] \ud83d\udd0d  Resolving packages...\n# [2/4] \ud83d\ude9a  Fetching packages...\n# [3/4] \ud83d\udd17  Linking dependencies...\n# warning \" > @typechain/ethers-v5@10.1.0\" has unmet peer dependency \"@ethersproject/bytes@^5.0.0\".", "mimetype": "text/plain", "start_char_idx": 4413, "end_char_idx": 6261, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b9223cf8-b893-4096-a81a-ad92cc446700": {"__data__": {"id_": "b9223cf8-b893-4096-a81a-ad92cc446700", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "76622f7a-340e-4409-8a28-4e0a6e84778a", "node_type": "1", "metadata": {}, "hash": "8ba0ef497199c57c951266431170d6b277353cce81b0372e8694a4757543d62a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a05ecddb-844f-410f-865a-b728fbba1550", "node_type": "1", "metadata": {}, "hash": "d328a3374b847a33c131d4fac673466fa5d58ab6df19a76164b9d9f132d0f989", "class_name": "RelatedNodeInfo"}}, "text": "# [4/4] \ud83d\udd28  Building fresh packages...\n# \u2728  Done in 4.95s.\n```\n\nNow that the package dependencies are installed, lets build the default function which is located in `./src/index.ts`.\n\n<details>\n\n<summary>View file <code>./src/index.ts</code></summary>\n\n```typescript\n// *** YOU ARE LIMITED TO THE FOLLOWING IMPORTS TO BUILD YOUR PHAT CONTRACT     ***\n// *** ADDING ANY IMPORTS WILL RESULT IN ERRORS & UPLOADING YOUR CODE TO PHALA  ***\n// *** NETWORK WILL FAIL. IF YOU WANT TO KNOW MORE, JOIN OUR DISCORD TO SPEAK   ***\n// *** WITH THE PHALA TEAM AT https://discord.gg/5HfmWQNX THANK YOU             ***\n// *** FOR DOCS ON HOW TO CUSTOMIZE YOUR PC 2.0 https://bit.ly/customize-pc-2-0 ***\nimport \"@phala/pink-env\";\nimport {decodeAbiParameters, encodeAbiParameters, parseAbiParameters} from \"viem\";\n\ntype HexString = `0x${string}`;\nconst encodeReplyAbiParams = 'uint respType, uint id, uint256 data';\nconst decodeRequestAbiParams = 'uint id, string reqData';\n\nfunction encodeReply(abiParams: string, reply: any): HexString {\n  return encodeAbiParameters(parseAbiParameters(abiParams),\n      reply\n  );\n}\n\nfunction decodeRequest(abiParams: string, request: HexString): any {\n  return decodeAbiParameters(parseAbiParameters(abiParams),\n      request\n  );\n}\n\n// Defined in OracleConsumerContract.sol\nconst TYPE_RESPONSE = 0;\nconst TYPE_ERROR = 2;\n\nenum Error {\n  BadRequestString = \"BadRequestString\",\n  FailedToFetchData = \"FailedToFetchData\",\n  FailedToDecode = \"FailedToDecode\",\n  MalformedRequest = \"MalformedRequest\",\n}\n\nfunction errorToCode(error: Error): number {\n  switch (error) {\n    case Error.BadRequestString:\n      return 1;\n    case Error.FailedToFetchData:\n      return 2;\n    case Error.FailedToDecode:\n      return 3;\n    case Error.MalformedRequest:\n      return 4;\n    default:\n      return 0;", "mimetype": "text/plain", "start_char_idx": 6262, "end_char_idx": 8068, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a05ecddb-844f-410f-865a-b728fbba1550": {"__data__": {"id_": "a05ecddb-844f-410f-865a-b728fbba1550", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b9223cf8-b893-4096-a81a-ad92cc446700", "node_type": "1", "metadata": {}, "hash": "4e403b573d84d4bb2a114687a795a441bc42cc39d188d17eb398bf9eb37717e1", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "3cfaaf27-053d-45a4-b160-02ea40a4c47e", "node_type": "1", "metadata": {}, "hash": "1b10049c83c9cda658df2b33f102a3293d403f027a6f13f91bb3d533abb647f1", "class_name": "RelatedNodeInfo"}}, "text": "}\n}\n\nfunction stringToHex(str: string): string {\n  var hex = \"\";\n  for (var i = 0; i < str.length; i++) {\n    hex += str.charCodeAt(i).toString(16);\n  }\n  return \"0x\" + hex;\n}\n\nfunction fetchApiStats(apiUrl: string, requestStr: string): any {\n  let headers = {\n    \"Content-Type\": \"application/json\",\n    \"User-Agent\": \"phat-contract\",\n  };\n  let query = JSON.stringify({\n    query: `\n      query Profile {\n        profile(request: { forProfileId: \"${requestStr}\" }) {\n          stats {\n              followers\n              following\n              comments\n              countOpenActions\n              posts\n              quotes\n              mirrors\n              publications\n              reacted\n              reactions\n          }\n        }\n      }\n    `,\n  });\n  let body = stringToHex(query);\n  //\n  // In Phat Contract runtime, we not support async/await, you need use `pink.batchHttpRequest` to\n  // send http request. The Phat Contract will return an array of response.\n  //\n  let response = pink.batchHttpRequest(\n    [\n      {\n        url: apiUrl,\n        method: \"POST\",\n        headers,\n        body,\n        returnTextBody: true,\n      },\n    ],\n    10000 // Param for timeout in milliseconds. Your Phat Contract script has a timeout of 10 seconds\n  )[0]; // Notice the [0]. This is important bc the `pink.batchHttpRequest` function expects an array of up to 5 HTTP requests.\n  if (response.statusCode !== 200) {\n    console.log(\n      `Fail to read Lens api with status code: ${response.statusCode}, error: ${\n        response.error || response.body\n      }}`\n    );\n    throw Error.FailedToFetchData;\n  }\n  let respBody = response.body;\n  if (typeof respBody !== \"string\") {\n    throw Error.FailedToDecode;\n  }\n  return JSON.parse(respBody);\n}\n\n//\n// Here is what you need to implemented for Phat Contract, you can customize your logic with\n// JavaScript here.", "mimetype": "text/plain", "start_char_idx": 8071, "end_char_idx": 9949, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "3cfaaf27-053d-45a4-b160-02ea40a4c47e": {"__data__": {"id_": "3cfaaf27-053d-45a4-b160-02ea40a4c47e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a05ecddb-844f-410f-865a-b728fbba1550", "node_type": "1", "metadata": {}, "hash": "d328a3374b847a33c131d4fac673466fa5d58ab6df19a76164b9d9f132d0f989", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "6c1bf2d1-42ef-4d59-ba95-119a311c0ae0", "node_type": "1", "metadata": {}, "hash": "a3140bea1a794be0936a03f41f9bf1258a1a4308e827e1eeeab6ee166544969f", "class_name": "RelatedNodeInfo"}}, "text": "//\n// The Phat Contract will be called with two parameters:\n//\n// - request: The raw payload from the contract call `request` (check the `request` function in TestLensApiConsumerConract.sol).\n//            In this example, it's a tuple of two elements: [requestId, profileId]\n// - secrets: The custom secrets you set with the `config_core` function of the Action Offchain Rollup Phat Contract. In\n//            this example, it just a simple text of the lens api url prefix. For more information on secrets, checkout the SECRETS.md file.\n//\n// Your returns value MUST be a hex string, and it will send to your contract directly. Check the `_onMessageReceived` function in\n// OracleConsumerContract.sol for more details. We suggest a tuple of three elements: [successOrNotFlag, requestId, data] as\n// the return value.\n//\nexport default function main(request: HexString, secrets: string): HexString {\n  console.log(`handle req: ${request}`);\n  // Uncomment to debug the `secrets` passed in from the Phat Contract UI configuration.", "mimetype": "text/plain", "start_char_idx": 9950, "end_char_idx": 10979, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "6c1bf2d1-42ef-4d59-ba95-119a311c0ae0": {"__data__": {"id_": "6c1bf2d1-42ef-4d59-ba95-119a311c0ae0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "3cfaaf27-053d-45a4-b160-02ea40a4c47e", "node_type": "1", "metadata": {}, "hash": "1b10049c83c9cda658df2b33f102a3293d403f027a6f13f91bb3d533abb647f1", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ac50a72b-0936-4e13-84c2-29244674951f", "node_type": "1", "metadata": {}, "hash": "e6717b7911e203620c739bd21d42949ae227ef8c81a5025a389e10f609557171", "class_name": "RelatedNodeInfo"}}, "text": "// console.log(`secrets: ${secrets}`);\n  let requestId, encodedReqStr;\n  try {\n    [requestId, encodedReqStr] = decodeRequest(decodeRequestAbiParams, request);\n    console.log(`[${requestId}]: ${encodedReqStr}`);\n  } catch (error) {\n    console.info(\"Malformed request received\");\n    return encodeReply(encodeReplyAbiParams, [BigInt(TYPE_ERROR), 0n, BigInt(errorToCode(error as Error))]);\n  }\n  console.log(`Request received for profile ${encodedReqStr}`);\n  try {\n    const respData = fetchApiStats(secrets, encodedReqStr);\n    let stats = respData.data.profile.stats.posts;\n    console.log(\"response:\", [TYPE_RESPONSE, requestId, stats]);\n    return encodeReply(encodeReplyAbiParams, [TYPE_RESPONSE, requestId, stats]);\n  } catch (error) {\n    if (error === Error.FailedToFetchData) {\n      throw error;\n    } else {\n      // otherwise tell client we cannot process it\n      console.log(\"error:\", [TYPE_ERROR, requestId, error]);\n      return encodeReply(encodeReplyAbiParams, [TYPE_ERROR, requestId, errorToCode(error as Error)]);\n    }\n  }\n}\n\n```\n\n</details>\n\nBuild the default function with this command:\n\n```sh\nnpx @phala/fn build\n```\n\nYou will see output similar to the example below. and a file in `./dist/index.js` will be generated.\n\n```sh\nnpx @phala/fn build\n# Creating an optimized build... done\n# Compiled successfully.\n#\n#   17.66 KB  dist/index.js\n# \u2728  Done in 3.48s.\n```\n\nWith our default function built, we can run some initial tests. First test will be simple.", "mimetype": "text/plain", "start_char_idx": 10982, "end_char_idx": 12461, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ac50a72b-0936-4e13-84c2-29244674951f": {"__data__": {"id_": "ac50a72b-0936-4e13-84c2-29244674951f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "6c1bf2d1-42ef-4d59-ba95-119a311c0ae0", "node_type": "1", "metadata": {}, "hash": "a3140bea1a794be0936a03f41f9bf1258a1a4308e827e1eeeab6ee166544969f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "d3b79b84-e793-4949-b9c7-dfbb3948c0ef", "node_type": "1", "metadata": {}, "hash": "99bb8e8f3ea601f4a678a8df8fd7a01b5438a9434353c480681452a4eb951c07", "class_name": "RelatedNodeInfo"}}, "text": "```sh\nnpx @phala/fn run dist/index.js\n```\n\nIt was expected for it to fail like this:\n\n```sh\nnpx @phala/fn run dist/index.js\n# handle req: undefined\n# Malformed request received\n# {\"output\":\"0x000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\"}\n# \u2728  Done in 0.96s.\n```\n\nNotice that the test fails and reports that a `Malformed request received` was emitted and the request was `undefined`. This is expected as you will need to define the parameters by adding a `-a abi.encode(requestId, profileId) https://api-v2-mumbai-live.lens.dev` to your command.\n\nTo simulate the expected result locally, run the Phala Oracle function now with this command:\n\n> Go to [https://playground.ethers.org](https://playground.ethers.org) to `decode` and `encode` the hexstring you want to pass into your Phat Contract `main` function.", "mimetype": "text/plain", "start_char_idx": 12463, "end_char_idx": 13420, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d3b79b84-e793-4949-b9c7-dfbb3948c0ef": {"__data__": {"id_": "d3b79b84-e793-4949-b9c7-dfbb3948c0ef", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ac50a72b-0936-4e13-84c2-29244674951f", "node_type": "1", "metadata": {}, "hash": "e6717b7911e203620c739bd21d42949ae227ef8c81a5025a389e10f609557171", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c3b8fa4d-32b1-42d5-947f-ed8625f3df50", "node_type": "1", "metadata": {}, "hash": "5c19b45a08892f3bae92836ba51e998286ece21e74806153312ac25a1395d39c", "class_name": "RelatedNodeInfo"}}, "text": ">\n> In this example, the hexstring  `0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000` represents types `uint id` and `string reqData`\n>\n> Here is what you will enter in the playground:\n>\n> * `utils.defaultAbiCoder.decode(['uint id', 'string reqData'], '0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000')`\n> * `[ BigNumber { value: \"1\" }, \"0x01\", id: BigNumber { value: \"1\" }, reqData: \"0x01\" ]`\n>\n> You can easily validate this by encoding the types and data with the `utils.defaultAbiCoder.encode()` function like below.", "mimetype": "text/plain", "start_char_idx": 13421, "end_char_idx": 14363, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c3b8fa4d-32b1-42d5-947f-ed8625f3df50": {"__data__": {"id_": "c3b8fa4d-32b1-42d5-947f-ed8625f3df50", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d3b79b84-e793-4949-b9c7-dfbb3948c0ef", "node_type": "1", "metadata": {}, "hash": "99bb8e8f3ea601f4a678a8df8fd7a01b5438a9434353c480681452a4eb951c07", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "7205d61c-f208-45d2-ada2-3ea1cf25386c", "node_type": "1", "metadata": {}, "hash": "5f9add33f63657ba6eb6a6dbe46c5d0e8e4374c0336ab44f5539b19dc99f0694", "class_name": "RelatedNodeInfo"}}, "text": ">\n> * `utils.defaultAbiCoder.encode(['uint id', 'string reqData'], [1, \"0x01\"])`\n> * `\"0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000\"`\n\n```sh\nnpx @phala/fn run dist/index.js -a 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000 https://api-v2-mumbai-live.lens.dev\n```\n\n> **What are the ingredients for the `npx @phala/fn run` command?**\n>\n> Our Phat Contract script, now fully constructed, is ready for a trial run. This simulation mirrors the live script's operation when deployed on the Phala Network.\n>\n> The command's first parameter is a HexString, representing a tuple of types `[uint, bytes]`. This serves as the entry function. The second parameter is a `string`, embodying the configurable secrets fed into the main function.\n>\n> The `Coders.decode` function deciphers these parameters, yielding the decoded `requestId` and `encodedReqStr`. These decoded elements then become the raw material for the rest of the custom logic within the script.\n>\n> ```solidity\n> export default function main(request: HexString, settings: string): HexString {\n>   console.log(`handle req: ${request}`);\n>   let requestId, encodedReqStr;\n>   try {\n>     [requestId, encodedReqStr] = decodeRequest(decodeRequestAbiParams, request);\n>   } catch (error) {\n>     console.info(\"Malformed request received\");\n>   }\n> // .", "mimetype": "text/plain", "start_char_idx": 14364, "end_char_idx": 16091, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7205d61c-f208-45d2-ada2-3ea1cf25386c": {"__data__": {"id_": "7205d61c-f208-45d2-ada2-3ea1cf25386c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c3b8fa4d-32b1-42d5-947f-ed8625f3df50", "node_type": "1", "metadata": {}, "hash": "5c19b45a08892f3bae92836ba51e998286ece21e74806153312ac25a1395d39c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "de5ec8d3-0e75-4375-9774-e3f59ec6fccc", "node_type": "1", "metadata": {}, "hash": "bbca9212e8c9f43acfec6cba762a0c1b37319dc57f6f29e8e5ebb795cd51b643", "class_name": "RelatedNodeInfo"}}, "text": "> }\n> ```\n\n<details>\n\n<summary>How the query looks under the hood</summary>\n\n* HTTP Endpoint: [https://api-v2-mumbai-live.lens.dev](https://api-mumbai.lens.dev/)\n* Profile ID: `0x01`\n* Expected Graphql Query:\n\n```graphql\nquery Profile {\n    profile(request: { forProfileId: \"0x01\" }) {\n      stats {\n          followers\n          following\n          comments\n          countOpenActions\n          posts\n          quotes\n          mirrors\n          publications\n          reacted\n          reactions\n      }\n    }\n}\n```\n\n* Expected Output:\n\n```graphql\n{\n\"data\": {\n  \"profile\": {\n    \"stats\": {\n      \"followers\": 2,\n      \"following\": 0,\n      \"comments\": 0,\n      \"countOpenActions\": 1,\n      \"posts\": 14,\n      \"quotes\": 0,\n      \"mirrors\": 0,\n      \"publications\": 14,\n      \"reacted\": 0,\n      \"reactions\": 0\n    }\n  }\n}\n```\n\n</details>\n\nYou will see:\n\n```bash\nnpx @phala/fn run dist/index.js -a 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000 https://api-v2-mumbai-live.lens.dev/\n\n> lensapi-oracle-consumer-contract@0.0.1 run-function\n> phat-fn run dist/index.js -a 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000 https://api-v2-mumbai-live.", "mimetype": "text/plain", "start_char_idx": 16094, "end_char_idx": 17660, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "de5ec8d3-0e75-4375-9774-e3f59ec6fccc": {"__data__": {"id_": "de5ec8d3-0e75-4375-9774-e3f59ec6fccc", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "7205d61c-f208-45d2-ada2-3ea1cf25386c", "node_type": "1", "metadata": {}, "hash": "5f9add33f63657ba6eb6a6dbe46c5d0e8e4374c0336ab44f5539b19dc99f0694", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "4841af32-7cc8-4f3f-9e1f-5c1326e2ea6e", "node_type": "1", "metadata": {}, "hash": "b924a0e2b71b3f88b74ccfd75fa98496d62d90777a1729be4a99817f69a19bd8", "class_name": "RelatedNodeInfo"}}, "text": "lens.dev/\n\nhandle req: 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000\n[1]: 0x01\nRequest received for profile 0x01\nresponse: 0,1,14\n{\"output\":\"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000e\"}\n```\n\nWe have now successfully tested the default function and ran a test to verify the function returns a response as expected.\n\n### Testing Default Function with Local Hardhat Node <a href=\"#user-content-testing-default-function-with-local-hardhat-node\" id=\"user-content-testing-default-function-with-local-hardhat-node\"></a>\n\nPreviously we showed how to test the default function locally without a running node, but we can also run two other tests.\n\n1. Run the default mocha e2e tests.\n2. Run local hardhat node and watch the requests that are pushed and see how the function transforms the data.\n\n### **Run the default mocha e2e tests**\n\nLets\u2019s start with the first test case.\n\n> Note: You will need to ensure you configure your local vars `POLYGON_RPC_URL` and `MUMBAI_RPC_URL` `.env` file. You can do this with `cp .env.local .env` then edit the `.env` with your information.\n\n<details>\n\n<summary>Expected error if <code>.env</code> not configured.</summary>\n\n```sh\nnpm run localhost-test\n# Error HH8: There's one or more errors in your config file:\n\n#  * Invalid value undefined for HardhatConfig.networks.polygon.url - Expected a value of type string.\n#  * Invalid value undefined for HardhatConfig.networks.mumbai.url - Expected a value of type string.", "mimetype": "text/plain", "start_char_idx": 17660, "end_char_idx": 19471, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4841af32-7cc8-4f3f-9e1f-5c1326e2ea6e": {"__data__": {"id_": "4841af32-7cc8-4f3f-9e1f-5c1326e2ea6e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "de5ec8d3-0e75-4375-9774-e3f59ec6fccc", "node_type": "1", "metadata": {}, "hash": "bbca9212e8c9f43acfec6cba762a0c1b37319dc57f6f29e8e5ebb795cd51b643", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "aa8a93a5-38c7-4a76-8df1-1a56881332de", "node_type": "1", "metadata": {}, "hash": "eddaa6d9454b65eccee4ee8c9cbf83818aaa9f75633af197317f48146a87a684", "class_name": "RelatedNodeInfo"}}, "text": "# To learn more about Hardhat's configuration, please go to https://hardhat.org/config/\n\n# For more info go to https://hardhat.org/HH8 or run Hardhat with --show-stack-traces\n# error Command failed with exit code 1.\n```\n\n</details>\n\n```sh\nnpm run localhost-test\n```\n\nYou will now see that all test cases have passed.\n\n```sh\nnpm run localhost-test\n# Compiled 14 Solidity files successfully\n#\n#  TestLensApiConsumerContract\n#    \u2714 Push and receive message (1664ms)\n#\n#  1 passing (2s)\n#\n# \u2728  Done in 3.29s.\n```\n\nThis is how the e2e mocha test will look like. You can customize this file at `./test/TestLensApiConsumerContract.ts`.\n\n<details>\n\n<summary>View file <code>TestLensApiConsumerContract.ts</code></summary>\n\n```typescript\nimport { expect } from \"chai\";\nimport { type Contract, type Event } from \"ethers\";\nimport { ethers } from \"hardhat\";\nimport { execSync } from \"child_process\";\n\nasync function waitForResponse(consumer: Contract, event: Event) {\n  const [, data] = event.args!", "mimetype": "text/plain", "start_char_idx": 19475, "end_char_idx": 20461, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "aa8a93a5-38c7-4a76-8df1-1a56881332de": {"__data__": {"id_": "aa8a93a5-38c7-4a76-8df1-1a56881332de", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "4841af32-7cc8-4f3f-9e1f-5c1326e2ea6e", "node_type": "1", "metadata": {}, "hash": "b924a0e2b71b3f88b74ccfd75fa98496d62d90777a1729be4a99817f69a19bd8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "d35d118a-642a-453c-87a3-33c3a6c6ec43", "node_type": "1", "metadata": {}, "hash": "6bf5bdf182f2c0d2c7c88958002e2063f0b6b443f3992cc963dfcf5a79a49171", "class_name": "RelatedNodeInfo"}}, "text": ";\n  // Run Phat Function\n  const result = execSync(`phat-fn run --json dist/index.js -a ${data} https://api-mumbai.lens.dev/`).toString();\n  const json = JSON.parse(result);\n  const action = ethers.utils.hexlify(ethers.utils.concat([\n    new Uint8Array([0]),\n    json.output,\n  ]));\n  // Make a response\n  const tx = await consumer.rollupU256CondEq(\n    // cond\n    [],\n    [],\n    // updates\n    [],\n    [],\n    // actions\n    [action],\n  );\n  const receipt = await tx.wait();\n  return receipt.events;\n}\n\ndescribe(\"TestLensApiConsumerContract\", function () {\n  it(\"Push and receive message\", async function () {\n    // Deploy the contract\n    const [deployer] = await ethers.getSigners();\n    const TestLensApiConsumerContract = await ethers.getContractFactory(\"TestLensApiConsumerContract\");\n    const consumer = await TestLensApiConsumerContract.deploy(deployer.address);\n\n    // Make a request\n    const profileId = \"0x01\";\n    const tx = await consumer.request(profileId);\n    const receipt = await tx.wait();\n    const reqEvents = receipt.events;\n    expect(reqEvents![0]).to.have.property(\"event\", \"MessageQueued\");\n\n    // Wait for Phat Function response\n    const respEvents = await waitForResponse(consumer, reqEvents![0])\n\n    // Check response data\n    expect(respEvents[0]).to.have.property(\"event\", \"ResponseReceived\");\n    const [reqId, input, value] = respEvents[0].args;\n    expect(ethers.BigNumber.isBigNumber(reqId)).to.be.true;\n    expect(input).to.equal(profileId);\n    expect(ethers.BigNumber.isBigNumber(value)).to.be.true;\n  });\n});\n```\n\n</details>\n\n**Run local hardhat node and watch the requests that are pushed and see how the function transforms the data**\n\nFirst we will start a local hardhat node.\n\n```\nnpm run localhost-node\n```\n\n<details>\n\n<summary>Example output</summary>\n\n```sh\nnpm run localhost-node\n# Started HTTP and WebSocket JSON-RPC server at http://127.0.0.1:8545/\n\n# Accounts\n# ========\n\n# WARNING: These accounts, and their private keys, are publicly known.", "mimetype": "text/plain", "start_char_idx": 20461, "end_char_idx": 22462, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d35d118a-642a-453c-87a3-33c3a6c6ec43": {"__data__": {"id_": "d35d118a-642a-453c-87a3-33c3a6c6ec43", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "aa8a93a5-38c7-4a76-8df1-1a56881332de", "node_type": "1", "metadata": {}, "hash": "eddaa6d9454b65eccee4ee8c9cbf83818aaa9f75633af197317f48146a87a684", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "446f8dea-11f2-4583-81cb-fa1bcb1f8f73", "node_type": "1", "metadata": {}, "hash": "9e08d3ce3531030017a89fb9660f5b0706dfb8e4c486992259bb3b1affd5409a", "class_name": "RelatedNodeInfo"}}, "text": "# Any funds sent to them on Mainnet or any other live network WILL BE LOST.\n```\n\n</details>\n\nWith our hardhat node running locally, we can now deploy the `LensApiConsumerContract.sol` contract to the local hardhat network.\n\n```sh\nnpm run localhost-deploy \n```\n\n```sh\nnpm run localhost-deploy\n# Deploying...\n# Deployed { consumer: '0x0165878A594ca255338adfa4d48449f69242Eb8F' }\n# \u2728  Done in 0.94s.\n```\n\nMake sure to copy the deployed contract address when you deploy your own contract locally. Note you contract address will be different than `0x0165878A594ca255338adfa4d48449f69242Eb8F`. We will now start watching the hardhat node deployed contract for any new requests.\n\n```sh\nnpx @phala/fn watch 0x0165878A594ca255338adfa4d48449f69242Eb8F artifacts/contracts/TestLensApiConsumerContract.sol/TestLensApiConsumerContract.json dist/index.js -a https://api-mumbai.lens.dev/\n```\n\n```sh\nnpx @phala/fn watch 0x0165878A594ca255338adfa4d48449f69242Eb8F artifacts/contracts/TestLensApiConsumerContract.sol/TestLensApiConsumerContract.json dist/index.js -a https://api-v2-mumbai-live.lens.dev/\n# $ phat-fn watch 0x0165878A594ca255338adfa4d48449f69242Eb8F artifacts/contracts/TestLensApiConsumerContract.sol/TestLensApiConsumerContract.json dist/index.js -a https://api-v2-mumbai-live.lens.dev/\n# Listening for TestLensApiConsumerContract MessageQueued events...\n```\n\nLet\u2019s now make a new request and see what happens with the listener\u2019s output. In separate tab, you will push a request with the following.", "mimetype": "text/plain", "start_char_idx": 22463, "end_char_idx": 23960, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "446f8dea-11f2-4583-81cb-fa1bcb1f8f73": {"__data__": {"id_": "446f8dea-11f2-4583-81cb-fa1bcb1f8f73", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d35d118a-642a-453c-87a3-33c3a6c6ec43", "node_type": "1", "metadata": {}, "hash": "6bf5bdf182f2c0d2c7c88958002e2063f0b6b443f3992cc963dfcf5a79a49171", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f3268763-0f70-4d52-8f62-00204930199a", "node_type": "1", "metadata": {}, "hash": "4f7ae62b35cfb3736dada60e9c014631f9d989847f86570f6e5674372b908ddc", "class_name": "RelatedNodeInfo"}}, "text": "```sh\nLOCALHOST_CONSUMER_CONTRACT_ADDRESS=0x0165878A594ca255338adfa4d48449f69242Eb8F npm run localhost-push-request\n```\n\n```sh\nLOCALHOST_CONSUMER_CONTRACT_ADDRESS=0x0165878A594ca255338adfa4d48449f69242Eb8F npm run localhost-push-request\n# Pushing a request...\n# Received event [ResponseReceived]: {\n#  reqId: BigNumber { value: \"1\" },\n#  input: '0x01',\n#  value: BigNumber { value: \"3361\" }\n# }\n# \u2728  Done in 4.99s.\n```\n\nIf we look back at the listener tab, we will see output has been appended.\n\n```sh\nListening for TestLensApiConsumerContract MessageQueued events...\nReceived event [MessageQueued]: {\n  tail: 0n,\n  data: '0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000'\n}\nhandle req: 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000\nRequest received for profile 0x01\nresponse: 0,1,14\nJS Execution output: 0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c9\n```\n\n## Deployment\n\nNow that you have the prerequisites to deploy a Polygon Consumer Contract on Polygon, lets begin with some initials tasks.", "mimetype": "text/plain", "start_char_idx": 23962, "end_char_idx": 25527, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f3268763-0f70-4d52-8f62-00204930199a": {"__data__": {"id_": "f3268763-0f70-4d52-8f62-00204930199a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "446f8dea-11f2-4583-81cb-fa1bcb1f8f73", "node_type": "1", "metadata": {}, "hash": "9e08d3ce3531030017a89fb9660f5b0706dfb8e4c486992259bb3b1affd5409a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "de12e360-105a-480c-9d2f-f0173242858f", "node_type": "1", "metadata": {}, "hash": "31718359467f459e281ce22811a2a12b20f89bc1c78cbc7691d1e47da6a00e70", "class_name": "RelatedNodeInfo"}}, "text": "### Install Dependencies & Compile Contracts\n\n```shell\n# install dependencies\n$ npm install\n\n# compile contracts\n$ npm run compile\n```\n\n### &#x20;Deploy to Polygon Mumbai Testnet <a href=\"#user-content-deploy-to-polygon-mumbai-testnet\" id=\"user-content-deploy-to-polygon-mumbai-testnet\"></a>\n\n{% hint style=\"danger\" %}\n**Important**\n\nThis guide references the `mumbai` testnet chain.&#x20;\n\nThe`mumbai` testnet is [deprecated since 2024/04/08](https://polygon.technology/blog/introducing-the-amoy-testnet-for-polygon-pos), meaning the steps to deploy to a testnet will no longer work out of the box.\n\nYou can opt to use the [`amoy`](https://polygon.technology/blog/introducing-the-amoy-testnet-for-polygon-pos) testnet or any other EVM testnet instead.\n{% endhint %}\n\nWith the contracts successfully compiled, now we can begin deploying first to Polygon Mumbai Testnet. If you have not gotten `MATIC` for Mumbai Testnet then get `MATIC` from a [faucet](https://mumbaifaucet.com/). Ensure to save the address after deploying the Consumer Contract because this address will be use in the \"[Configure Client](https://docs.phala.network/developers/bricks-and-blueprints/featured-blueprints/lensapi-oracle#step-4-configure-the-client-address)\" section of Phat Bricks UI. The deployed address will also be set to the environment variable [`MUMBAI_CONSUMER_CONTRACT_ADDRESS`](https://github.com/Phala-Network/lensapi-oracle-consumer-contract/blob/refactor/.env.local).", "mimetype": "text/plain", "start_char_idx": 25529, "end_char_idx": 26990, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "de12e360-105a-480c-9d2f-f0173242858f": {"__data__": {"id_": "de12e360-105a-480c-9d2f-f0173242858f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f3268763-0f70-4d52-8f62-00204930199a", "node_type": "1", "metadata": {}, "hash": "4f7ae62b35cfb3736dada60e9c014631f9d989847f86570f6e5674372b908ddc", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "e3ed512a-d7bc-4015-a903-cecedcae0192", "node_type": "1", "metadata": {}, "hash": "2be8bd9c9df570a625914ecc14189fef63c89c4699c2faebafa2307242b41713", "class_name": "RelatedNodeInfo"}}, "text": "```sh\nnpm run test-deploy\n```\n\n```sh\n# deploy contracts to testnet mumbai\nnpm run test-deploy\n# Deploying...\n#\n# \ud83c\udf89 Your Consumer Contract has been deployed, check it out here: https://mumbai.polygonscan.com/address/0x10FA409109E073C15b77A8352cB6A89C12CD1605\n#\n# You also need to set up the consumer contract address in your .env file:\n#\n# MUMBAI_CONSUMER_CONTRACT_ADDRESS=0x10FA409109E073C15b77A8352cB6A89C12CD1605\n#\n# Configuring...\n# Done\n# \u2728  Done in 8.20s.\n```\n\n### **(Optional) Verify Contract on Polygon Mumbai Testnet**\n\nEnsure to update the [`mumbai.arguments.ts`](https://github.com/Phala-Network/lensapi-oracle-consumer-contract/blob/refactor/mumbai.arguments.ts) file with the constructor arguments used to instantiate the Consumer Contract. If you add additional parameters to the constructor function then make sure to update the `mumbai.arguments.ts` file.\n\n> **Note**: Your contract address will be different than `0x090E8fDC571d65459569BC87992C1026121DB955` when verifying your contract. Make sure to get your actual contract address from the console log output after executing `npm run test-deploy`.\n\n```sh\nnpm run test-verify -- <MUMBAI_CONSUMER_CONTRACT_ADDRESS>\n```\n\n```sh\nnpm run test-verify -- 0x090E8fDC571d65459569BC87992C1026121DB955\n# $ hardhat verify --network mumbai --constructor-args mumbai.arguments.ts 0x090E8fDC571d65459569BC87992C1026121DB955\n# Nothing to compile\n# No need to generate any newer typings.\n# Successfully submitted source code for contract\n# contracts/TestLensApiConsumerContract.sol:TestLensApiConsumerContract at 0x090E8fDC571d65459569BC87992C1026121DB955\n# for verification on the block explorer. Waiting for verification result...\n#\n# Successfully verified contract TestLensApiConsumerContract on Etherscan.", "mimetype": "text/plain", "start_char_idx": 26992, "end_char_idx": 28752, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e3ed512a-d7bc-4015-a903-cecedcae0192": {"__data__": {"id_": "e3ed512a-d7bc-4015-a903-cecedcae0192", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "de12e360-105a-480c-9d2f-f0173242858f", "node_type": "1", "metadata": {}, "hash": "31718359467f459e281ce22811a2a12b20f89bc1c78cbc7691d1e47da6a00e70", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f5512b69-ea7e-42b6-98ee-339c96e549f0", "node_type": "1", "metadata": {}, "hash": "3d4995ef936c22b4489b6315c8ab82406fd2c786b0a586e734c4a1ee0344e83b", "class_name": "RelatedNodeInfo"}}, "text": "# https://mumbai.polygonscan.com/address/0x090E8fDC571d65459569BC87992C1026121DB955#code\n# \u2728  Done in 5.91s.\n```\n\n### Deploy Phat Contract to PoC6 Testnet <a href=\"#user-content-deploy-phat-contract-to-poc5-testnet\" id=\"user-content-deploy-phat-contract-to-poc5-testnet\"></a>\n\nFor customizing your Phat Contract, checkout Phat Contract custom configurations in [JS\\_API\\_DOC.md](https://github.com/Phala-Network/lensapi-oracle-consumer-contract/blob/refactor/src/JS\\_API\\_DOC.md) to learn more before deploying to PoC6 testnet.\n\nNow that are Phat Contract has built successfully, let's deploy to Phala PoC6 Testnet with the following command:\n\n```sh\n# If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn upload --coreSettings=https://api-v2-mumbai-live.lens.dev/\n# If polkadot-account.json is in the root of project\nnpx @phala/fn upload --coreSettings=https://api-v2-mumbai-live.lens.dev/ -a ./polkadot-account.json\n```\n\nHere is the expected output:\n\n> Note: your contract IDs will vary and not be the same as the IDs below.\n\n```sh\nnpx @phala/fn upload --coreSettings=https://api-v2-mumbai-live.lens.dev/ -a ./polkadot-account.json\n# ? Please enter your client RPC URL https://polygon-mumbai.g.alchemy.com/v2/JLjOfWJycWFOA0kK_SJ4jLGjtXkMN1wc\n# ? Please enter your consumer address 0xA4Be456Fd0d41968a52b34Cdb8Ba875F2281134a\n# ? Please Enter hahaha account password [hidden]\n# Creating an optimized build... done\n# Compiled successfully.", "mimetype": "text/plain", "start_char_idx": 28753, "end_char_idx": 30253, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f5512b69-ea7e-42b6-98ee-339c96e549f0": {"__data__": {"id_": "f5512b69-ea7e-42b6-98ee-339c96e549f0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e3ed512a-d7bc-4015-a903-cecedcae0192", "node_type": "1", "metadata": {}, "hash": "2be8bd9c9df570a625914ecc14189fef63c89c4699c2faebafa2307242b41713", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f8c63016-4928-4fba-acee-86cf616cf46c", "node_type": "1", "metadata": {}, "hash": "3196f0d40be830a151dedfd1f08c9cb4f3e2645d723822390cc6b0cebfcfe412", "class_name": "RelatedNodeInfo"}}, "text": "#\n#  17.64 KB  dist/index.js\n# Connecting to the endpoint: wss://poc6.phala.network/ws... \u287f\n# (node:25497) ExperimentalWarning: buffer.Blob is an experimental feature. This feature could change at any time\n# Connecting to the endpoint: wss://poc6.phala.network/ws... done\n# Querying your Brick Profile contract ID... done\n# Your Brick Profile contract ID: 0x4071788a8ce6fbab0cacea0cb1aa52853b5537db7955643e5010c22913c2b1dd\n# Instantiating the ActionOffchainRollup contract... done\n# The ActionOffchainRollup contract has been instantiated: 0x9c777c16b0a185caa895835b8f3b9e8d67be9f5e30197f71b4d32d2b8fde4b3b\n# Setting up the actions... done\n# \ud83c\udf89 Your workflow has been added, you can check it out here: https://bricks-poc6.phala.network/workflows/0x4071788a8ce6fbab0cacea0cb1aa52853b5537db7955643e5010c22913c2b1dd/3\n# Your Attestor address: 0x2b5fe2920cce2f522d69613adaa9378ba43b687d\n# Your WORKFLOW_ID: 3\n# \u2728  Done in 73.22s.\n```\n\nGo to the [PoC6 Testnet Bricks UI](https://bricks-poc5.phala.network/) Dashboard and you can see your newly deployed Phat Contract.&#x20;\n\n<figure><img src=\"https://github.com/Phala-Network/lensapi-oracle-consumer-contract/raw/refactor/assets/Function-added.png\" alt=\"\" width=\"375\"><figcaption></figcaption></figure>\n\n### **Interact with Consumer Contract on Polygon Mumbai**\n\nTest Consumer Contract on Mumbai with a few tests to check for malformed requests failures, successful requests, and set the attestor.", "mimetype": "text/plain", "start_char_idx": 30254, "end_char_idx": 31695, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f8c63016-4928-4fba-acee-86cf616cf46c": {"__data__": {"id_": "f8c63016-4928-4fba-acee-86cf616cf46c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f5512b69-ea7e-42b6-98ee-339c96e549f0", "node_type": "1", "metadata": {}, "hash": "3d4995ef936c22b4489b6315c8ab82406fd2c786b0a586e734c4a1ee0344e83b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "00b1725f-1a81-4c47-91dd-7ee904532395", "node_type": "1", "metadata": {}, "hash": "63dfb3765dafb2457d4a2275fa24a8420857d31895b44a2708e946acab80eeee", "class_name": "RelatedNodeInfo"}}, "text": "**Please make sure your have set your attestor address in .env file `MUMBAI_PHALA_ORACLE_ATTESTOR`**\n\n```sh\nnpm run test-set-attestor\n```\n\n```sh\nnpm run test-set-attestor\n# $ hardhat run --network mumbai ./scripts/mumbai/set-attestor.ts\n# Setting attestor...\n# \ud83d\udea8NOTE\ud83d\udea8\n# Make sure to set the Consumer Contract Address in your Phat Bricks \ud83e\uddf1 UI dashboard (https://bricks-poc6.phala.network)\n# - Go to 'Configure Client' section where a text box reads 'Add Consumer Smart Contract'\n# - Set value to 0x090E8fDC571d65459569BC87992C1026121DB955\n# Done\n# \u2728  Done in 2.69s.\n```\n\nTest pushing a malform request.\n\n```sh\nnpm run test-push-malformed-request\n```\n\n```sh\nnpm run test-push-malformed-request\n# $ hardhat run --network mumbai ./scripts/mumbai/push-malformed-request.ts\n# Pushing a malformed request...\n# Done\n# \u2728  Done in 2.48s.\n```\n\nTest pushing a valid request.\n\n```sh\nnpm run test-push-request\n```\n\n```sh\nnpm run test-push-request\n# Pushing a request...\n# Done\n# \u2728  Done in 2.97s.\n```\n\n### Update Phat Contract on Phala PoC6 Testnet <a href=\"#user-content-update-phat-contract-on-phala-poc5-testnet\" id=\"user-content-update-phat-contract-on-phala-poc5-testnet\"></a>\n\nSometimes you may have had a bug in your script or you want to test things out on the fly without deploying a whole new Phat Contract. We now allow you to update your Phat Contract easily in the commandline.", "mimetype": "text/plain", "start_char_idx": 31697, "end_char_idx": 33073, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "00b1725f-1a81-4c47-91dd-7ee904532395": {"__data__": {"id_": "00b1725f-1a81-4c47-91dd-7ee904532395", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f8c63016-4928-4fba-acee-86cf616cf46c", "node_type": "1", "metadata": {}, "hash": "3196f0d40be830a151dedfd1f08c9cb4f3e2645d723822390cc6b0cebfcfe412", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "9ec50dfa-778f-4e3d-bf66-dab35e669b81", "node_type": "1", "metadata": {}, "hash": "8f0b092d344e4416b61b56a8e6b682e89430b967d2f7bf3a7637de13fb85e6e5", "class_name": "RelatedNodeInfo"}}, "text": "Now let's update the Phat Contract with the following command:\n\n```sh\n# If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn update\n# If polkadot-account.json is in the root of project\nnpx @phala/fn update -a ./polkadot-account.json\n```\n\n```sh\nnpx @phala/fn update -a ./polkadot-account.json\n# ? Please Enter hahaha account password [hidden]\n# Creating an optimized build... done\n# Compiled successfully.\n#\n#   17.64 KB  dist/index.js\n# Connecting to the endpoint: wss://poc6.phala.network/ws... \u287f\n# (node:25392) ExperimentalWarning: buffer.Blob is an experimental feature. This feature could change at any time\n# Connecting to the endpoint: wss://poc6.phala.network/ws... done\n# Querying your Brick Profile contract ID... done\n# Your Brick Profile contract ID: 0x4071788a8ce6fbab0cacea0cb1aa52853b5537db7955643e5010c22913c2b1dd\n# Checking your workflow settings... done\n# Updating... done\n# The Phat Function for workflow 1 has been updated.\n# \u2728  Done in 10.82s.\n```\n\nCongrats! You've now successfully updated your Phat Contract!\n\n### Deploy to Polygon Mainnet <a href=\"#user-content-deploy-to-polygon-mainnet\" id=\"user-content-deploy-to-polygon-mainnet\"></a>\n\nEnsure to save the address after deploying the Consumer Contract because this address will be used in the \"[Configure Client](https://docs.phala.network/developers/bricks-and-blueprints/featured-blueprints/lensapi-oracle#step-4-configure-the-client-address)\" section of Phat Bricks UI. The deployed address will also be set to the environment variable `POLYGON_CONSUMER_CONTRACT_ADDRESS`.\n\n> **Note**: Your contract address will be different than `0xbb0d733BDBe151dae3cEf8D7D63cBF74cCbf04C4` when verifying your contract.", "mimetype": "text/plain", "start_char_idx": 33074, "end_char_idx": 34820, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "9ec50dfa-778f-4e3d-bf66-dab35e669b81": {"__data__": {"id_": "9ec50dfa-778f-4e3d-bf66-dab35e669b81", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "00b1725f-1a81-4c47-91dd-7ee904532395", "node_type": "1", "metadata": {}, "hash": "63dfb3765dafb2457d4a2275fa24a8420857d31895b44a2708e946acab80eeee", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5afd871a-5d06-4734-8bad-e4ae0b5dfc05", "node_type": "1", "metadata": {}, "hash": "febd3c8431fae732323b487ca6c3e23a193ca280a8ec0d7aae686f99a9f0e60a", "class_name": "RelatedNodeInfo"}}, "text": "Make sure to get your actual contract address from the console log output after executing `npm run main-deploy`.\n\n```sh\nnpm run main-deploy\n# Deploying...\n#\n# \ud83c\udf89 Your Consumer Contract has been deployed, check it out here: https://polygonscan.com/address/0xbb0d733BDBe151dae3cEf8D7D63cBF74cCbf04C4\n#\n# You also need to set up the consumer contract address in your .env file:\n#\n# POLYGON_CONSUMER_CONTRACT_ADDRESS=0xbb0d733BDBe151dae3cEf8D7D63cBF74cCbf04C4\n#\n# Configuring...\n# Done\n# \u2728  Done in 8.20s.\n```\n\n### **(Optional) Verify Contract on Polygon Mainnet**\n\nEnsure to update the `polygon.arguments.ts` file with the constructor arguments used to instantiate the Consumer Contract. If you add additional parameters to the constructor function then make sure to update the `polygon.arguments.ts` file.\n\n```sh\nnpm run main-verify -- 0xbb0d733BDBe151dae3cEf8D7D63cBF74cCbf04C4\n# Nothing to compile\n# No need to generate any newer typings.\n# Successfully submitted source code for contract\n# contracts/TestLensApiConsumerContract.sol.sol:TestLensApiConsumerContract.sol.sol at 0xbb0d733BDBe151dae3cEf8D7D63cBF74cCbf04C4\n# for verification on the block explorer. Waiting for verification result...\n#\n# Successfully verified contract TestLensApiConsumerContract.sol on Etherscan.\n# https://polygonscan.com/address/0xbb0d733BDBe151dae3cEf8D7D63cBF74cCbf04C4#code\n# Done in 8.88s.", "mimetype": "text/plain", "start_char_idx": 34821, "end_char_idx": 36195, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5afd871a-5d06-4734-8bad-e4ae0b5dfc05": {"__data__": {"id_": "5afd871a-5d06-4734-8bad-e4ae0b5dfc05", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "9ec50dfa-778f-4e3d-bf66-dab35e669b81", "node_type": "1", "metadata": {}, "hash": "8f0b092d344e4416b61b56a8e6b682e89430b967d2f7bf3a7637de13fb85e6e5", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "fb0070de-07f0-418f-8df6-b6ee96828600", "node_type": "1", "metadata": {}, "hash": "e34fcedd0bdeed2b96138863112308f8ecfd4196079e925382be16e46209ea8d", "class_name": "RelatedNodeInfo"}}, "text": "```\n\n### Deploy Phat Contract to Phala Mainnet <a href=\"#user-content-deploy-phat-contract-to-phala-mainnet\" id=\"user-content-deploy-phat-contract-to-phala-mainnet\"></a>\n\nFor customizing your Phat Contract, Phat Contract custom configurations can be found here in [JS\\_API\\_DOC.md](https://github.com/Phala-Network/lensapi-oracle-consumer-contract/blob/main/src/JS\\_API\\_DOC.md) to learn more before deploying to Phala Mainnet.\n\nNow that are Phat Contract has built successfully, let's deploy to Phala Mainnet with the following command:\n\n```sh\n# If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn upload --mode=production --coreSettings=https://api-v2.lens.dev/\n# If polkadot-account.json is in the root of project\nnpx @phala/fn upload --mode=production --coreSettings=https://api-v2.lens.dev/ -a ./polkadot-account.json\n```\n\nHere is the expected output:\n\n> Note: your contract IDs will vary and not be the same as the IDs below.\n\n```sh\nnpx @phala/fn upload --mode=production --coreSettings=https://api-v2.lens.dev/ -a ./polkadot-account.json\n# ? Please enter your client RPC URL https://polygon.g.alchemy.com/v2/JLjOfWJycWFOA0kK_SJ4jLGjtXkMN1wc\n# ? Please enter your consumer address 0xA4Be456Fd0d41968a52b34Cdb8Ba875F2281134a\n# ? Please Enter hahaha account password [hidden]\n# Creating an optimized build... done\n# Compiled successfully.\n#\n#  17.64 KB  dist/index.js\n# Connecting to the endpoint: wss://api.phala.network/ws... \u287f\n# (node:25497) ExperimentalWarning: buffer.Blob is an experimental feature.", "mimetype": "text/plain", "start_char_idx": 36196, "end_char_idx": 37769, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "fb0070de-07f0-418f-8df6-b6ee96828600": {"__data__": {"id_": "fb0070de-07f0-418f-8df6-b6ee96828600", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5afd871a-5d06-4734-8bad-e4ae0b5dfc05", "node_type": "1", "metadata": {}, "hash": "febd3c8431fae732323b487ca6c3e23a193ca280a8ec0d7aae686f99a9f0e60a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "bbbce49c-0d14-4160-8d18-270da82bc56d", "node_type": "1", "metadata": {}, "hash": "cecde46c23a545af10b1e723b73a338740fe269facfadd5517ad3a7b54a8a615", "class_name": "RelatedNodeInfo"}}, "text": "This feature could change at any time\n# Connecting to the endpoint: wss://api.phala.network/ws... done\n# Querying your Brick Profile contract ID... done\n# Your Brick Profile contract ID: 0x4071788a8ce6fbab0cacea0cb1aa52853b5537db7955643e5010c22913c2b1dd\n# Instantiating the ActionOffchainRollup contract... done\n# The ActionOffchainRollup contract has been instantiated: 0x9c777c16b0a185caa895835b8f3b9e8d67be9f5e30197f71b4d32d2b8fde4b3b\n# Setting up the actions... done\n# \ud83c\udf89 Your workflow has been added, you can check it out here: https://bricks-poc6.phala.network/workflows/0x4071788a8ce6fbab0cacea0cb1aa52853b5537db7955643e5010c22913c2b1dd/3\n# Your Attestor address: 0x2b5fe2920cce2f522d69613adaa9378ba43b687d\n# Your WORKFLOW_ID: 2\n# \u2728  Done in 73.22s.\n```\n\n### **Interact with Consumer Contract on Polygon Mainnet**\n\nExecute Scripts to Consumer Contract on Polygon Mainnet. The Consumer Contract on Polygon Mainnet with a few actions to mimic a malformed request, successful requests, and set the attestor.\n\n```sh\nnpm run main-set-attestor\n# Setting attestor...\n# \ud83d\udea8NOTE\ud83d\udea8\n# Make sure to set the Consumer Contract Address in your Phat Bricks \ud83e\uddf1 UI dashboard (https://bricks-poc6.phala.network)\n# - Go to 'Configure Client' section where a text box reads 'Add Consumer Smart Contract'\n# - Set value to 0xbb0d733BDBe151dae3cEf8D7D63cBF74cCbf04C4\n# Done\n# \u2728  Done in 1.56s.", "mimetype": "text/plain", "start_char_idx": 37770, "end_char_idx": 39141, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "bbbce49c-0d14-4160-8d18-270da82bc56d": {"__data__": {"id_": "bbbce49c-0d14-4160-8d18-270da82bc56d", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "fb0070de-07f0-418f-8df6-b6ee96828600", "node_type": "1", "metadata": {}, "hash": "e34fcedd0bdeed2b96138863112308f8ecfd4196079e925382be16e46209ea8d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a950c5e0-a565-40bf-b424-4d3001cd3a4c", "node_type": "1", "metadata": {}, "hash": "87057e1459278d832b5afdffc12d9964a99ac45140b37f0d7a227f446d9adc2e", "class_name": "RelatedNodeInfo"}}, "text": "# execute push-malformed-request\nnpm run main-push-malformed-request\n# Pushing a malformed request...\n# Done\n# execute push-request\nnpm run main-push-request\n# Pushing a request...\n# Done\n```\n\n### Update Phat Contract on Phala Mainnet <a href=\"#user-content-update-phat-contract-on-phala-mainnet\" id=\"user-content-update-phat-contract-on-phala-mainnet\"></a>\n\nSometimes you may have had a bug in your script or you want to test things out on the fly without deploying a whole new Phat Contract. We now allow you to update your Phat Contract easily in the command-line. Now let's update the Phat Contract with the following command:\n\n```sh\n# If you did not export your Polkadot account in a \n# polkadot-account.json file in the root of project\nnpx @phala/fn update --mode=production\n# If polkadot-account.json is in the root of project\nnpx @phala/fn update --mode=production -a ./polkadot-account.json\n```\n\n```sh\nnpx @phala/fn update --mode=production -a ./polkadot-account.json\n# ? Please Enter hahaha account password [hidden]\n# Creating an optimized build... done\n# Compiled successfully.\n#\n#   17.64 KB  dist/index.js\n# Connecting to the endpoint: wss://api.phala.network/ws... \u287f\n# (node:25392) ExperimentalWarning: buffer.Blob is an experimental feature. This feature could change at any time\n# Connecting to the endpoint: wss://api.phala.network/ws... done\n# Querying your Brick Profile contract ID... done\n# Your Brick Profile contract ID: 0x4071788a8ce6fbab0cacea0cb1aa52853b5537db7955643e5010c22913c2b1dd\n# Checking your workflow settings... done\n# Updating... done\n# The Phat Function for workflow 1 has been updated.\n# \u2728  Done in 10.82s.", "mimetype": "text/plain", "start_char_idx": 39142, "end_char_idx": 40788, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a950c5e0-a565-40bf-b424-4d3001cd3a4c": {"__data__": {"id_": "a950c5e0-a565-40bf-b424-4d3001cd3a4c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "77355499-01e7-4164-8a0c-530784643823", "node_type": "4", "metadata": {}, "hash": "5b49ebf1bf1e9efefc1189d1a2a3dcc74ce039f39e91c1cc6368ad92714721ac", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "bbbce49c-0d14-4160-8d18-270da82bc56d", "node_type": "1", "metadata": {}, "hash": "cecde46c23a545af10b1e723b73a338740fe269facfadd5517ad3a7b54a8a615", "class_name": "RelatedNodeInfo"}}, "text": "```\n\n## Closing\n\nOnce you have stored, the deployed address of the Consumer Contract and set the value in the \"Configure Client\" section of the deployed LensAPI Oracle, you will now have a basic boilerplate example of how to connect your Polygon dApp to a LensAPI Oracle Blueprint. Execute a new requests and check if your configuration is correct like below:\n\n<figure><img src=\"../../../../.gitbook/assets/polygonscan-ex.png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 40789, "end_char_idx": 41257, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5c5a9428-3294-47bd-8fa5-44445d0a4c67": {"__data__": {"id_": "5c5a9428-3294-47bd-8fa5-44445d0a4c67", "embedding": null, "metadata": {"file_path": "phala-docs_dist/budget-balancer.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "88a122d4-8580-4e00-9d8b-e306763112b8", "node_type": "4", "metadata": {}, "hash": "629d2634f505137f27fa0daf24753806c5752c7a61721f62b28d205a02597b07", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "66eb5adb-4cb9-4df1-95ee-167056c89232", "node_type": "1", "metadata": {}, "hash": "beff39e05c01c01faa8986012eb6aa6cb9f98cca261e3367196bb7c44749a212", "class_name": "RelatedNodeInfo"}}, "text": "# Budget balancer\n\n**Budget Balancer** is a Phat Contract used to balance the computing power rewards between Phala and Khala networks, aiming to ensure the effective working of the Gemini Tokenomics.\n\n### **How it works**\n\nThe budget balancer adjusts the rewards budget by querying the total number of shares for workers on both Phala\\&Khala networks daily, calculating the reward allocation between the two chains, and sending a budget change transaction to both chains.\n\nIt consists of three major components:\n\n#### Subsquid query service\n\n* Regularly query information on Phala and Khala chains and store data snapshots\n* Generate snapshot database and output API for the phat contract to read relevant data\n\n#### **Contract,** which is divided into two parts:\n\n* Computation part\n  * The strategy (rules) of the contract is all coded in the computation part, which calculates the budget amount of the two chains for each period.\n* Transaction sending\n  * Based on the calculated amount and comparing the on-chain transaction restrictions, it determines whether a transaction has been issued within this period (only one transaction can be completed in a period).\n  * If the judgment is correct, send the transaction request to the chain from the contract-generated address. The transaction will be sent to both Phala\\&Khala.\n\n#### **On-chain functions and on-chain contract account whitelist**\n\n* The function of flexibly adjusting the on-chain budget through transactions has been developed on the chain, and the budget can be adjusted by sending transactions from specific accounts\n* There are two ways to change the budget on the chain\n  * Using the above function, the whitelisted account configured on the chain can be used to send transactions, which can directly change the budget without going through community governance; however, the configuration of whitelist permissions for the account needs to be authorized through `Motion` voting.\n  * Submit a `Motion` proposal to directly change the budget to a specific value, and the change will take effect after the vote is passed\n* Replacing the balancer strategy is to deploy a new balancer contract, thereby generating a new contract address, and replace the old contract address in the whitelist through Motion voting to achieve the strategy update.\n\n### The mathematical logic of the balancer\n\nAs we mentioned in [worker-rewards.md](worker-rewards.md \"mention\"), Phala and Khala share a total of 700 million in computing power rewards.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2501, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "66eb5adb-4cb9-4df1-95ee-167056c89232": {"__data__": {"id_": "66eb5adb-4cb9-4df1-95ee-167056c89232", "embedding": null, "metadata": {"file_path": "phala-docs_dist/budget-balancer.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "88a122d4-8580-4e00-9d8b-e306763112b8", "node_type": "4", "metadata": {}, "hash": "629d2634f505137f27fa0daf24753806c5752c7a61721f62b28d205a02597b07", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5c5a9428-3294-47bd-8fa5-44445d0a4c67", "node_type": "1", "metadata": {}, "hash": "bd742d73685a5fe2ca49c90ad8b730f8d5c02a866fd18f096b4128b77cdfe83e", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5f8a2106-757d-47de-b4c8-d9d0ad6254b0", "node_type": "1", "metadata": {}, "hash": "0535a0107d9d42515d6eb2232d576d03a7ce29dfc692faa3e6875fd13a2a1dfe", "class_name": "RelatedNodeInfo"}}, "text": "The reward distribution between the two chains depends on the computing power quality & quantity of each chain, that is, the sum of shares of workers on the chain.\n\n#### Basic parameters\n\n* **Halving cycle = 180 days**&#x20;\n  * It's physical time, regardless of the number of blocks\n  * Starting from the 3rd halving cycle on June 12, 2023\n* **Initial total budget for each unit = 720K / 24 / 60 \\* P = 500P**\n  * Assuming the time of each calculation cycle is **P** minutes\n  * 720K is the standard daily budget for the first halving cycle\n* **The real-time halving coefficient = 0.75^(n-1)**&#x20;\n  * **n** is the halving period (n for the first period is 1, not 0).", "mimetype": "text/plain", "start_char_idx": 2502, "end_char_idx": 3172, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5f8a2106-757d-47de-b4c8-d9d0ad6254b0": {"__data__": {"id_": "5f8a2106-757d-47de-b4c8-d9d0ad6254b0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/budget-balancer.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "88a122d4-8580-4e00-9d8b-e306763112b8", "node_type": "4", "metadata": {}, "hash": "629d2634f505137f27fa0daf24753806c5752c7a61721f62b28d205a02597b07", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "66eb5adb-4cb9-4df1-95ee-167056c89232", "node_type": "1", "metadata": {}, "hash": "beff39e05c01c01faa8986012eb6aa6cb9f98cca261e3367196bb7c44749a212", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "759072fa-af3c-474e-92f5-ca8516dfdb2c", "node_type": "1", "metadata": {}, "hash": "091a36d471238f637ef76197fee9cfaf2cd981148d39ba0c2ce35a226ffb4397", "class_name": "RelatedNodeInfo"}}, "text": "* n = 3 + roundup\\[(day(now) - (2023.6.12)) / 180days]\n\nIn summary, **each unit's real-time total budget = 500P \\* 0.75^(n-1)**\n\n#### key equations\n\n* Real-time total budget per unit = Phala's total budget per unit + Khala's total budget per unit\n* Phala's total budget per unit / Phala total share = Khala's total budget per unit / Khala total share\n* Phala's total budget per unit = Phala's total budget per block \\* Phala's actual block number per unit\n* Khala's total budget per day = Khala's total budget per block \\* Khala's actual block number per unit\n* From this, we can deduce the equations and get the final formula\n  * **Phala's total budget per block = Khala's total share / (Phala's total share + Khala's total share) / Phala's actual block number per unit \\* Initial total budget per unit \\* Real-time halving coefficient**\n  * **Khala's total budget per block = Phala's total share / (Phala's total share + Khala's total share) / Khala's actual block number per unit \\* Initial total budget per unit \\* Real-time halving coefficient**\n\n_The actual block number of each unit on each chain and the total share of workers can be calculated via the Subsquid query service._\n\n### Budget balancer & Halving period\n\n#### Once we calculated the halving cycle using block time.\n\nBefore the Budget balancer was launched, **Khala** staking mechanism started on #1,467,069, and it went to the next halving period every 1,296,000 blocks.&#x20;\n\n**Phala** staking mechanism started on #2,491,061, and it went to the next halving period after the Budget balancer launched\n\n#### Now we calculated the halving cycle using calendar days&#x20;\n\nThe internal rules of the Budget Balancer implement it.&#x20;\n\nWe have set the initial value to June 12th, 2023 (this day is the start of the third halving period of the Khala network). From then on, every 180 calendar days, it will enter the next halving period.", "mimetype": "text/plain", "start_char_idx": 3175, "end_char_idx": 5080, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "759072fa-af3c-474e-92f5-ca8516dfdb2c": {"__data__": {"id_": "759072fa-af3c-474e-92f5-ca8516dfdb2c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/budget-balancer.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "88a122d4-8580-4e00-9d8b-e306763112b8", "node_type": "4", "metadata": {}, "hash": "629d2634f505137f27fa0daf24753806c5752c7a61721f62b28d205a02597b07", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5f8a2106-757d-47de-b4c8-d9d0ad6254b0", "node_type": "1", "metadata": {}, "hash": "0535a0107d9d42515d6eb2232d576d03a7ce29dfc692faa3e6875fd13a2a1dfe", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b13cf6f8-8867-49d5-95ec-382c88535965", "node_type": "1", "metadata": {}, "hash": "c9b868e9b264183dd11ebbaba183a21dc8b7073229395dd3ef76c13dba977cdb", "class_name": "RelatedNodeInfo"}}, "text": "Phala network follows the same rule.\n\n#### Why we made it\n\n* When two chains share one tokenomics, it is necessary to unify the halving periods; otherwise, the two chains may easily experience situations where one side has significantly higher rewards due to the gap in halving periods.\n* It is difficult to ensure that the block speeds on both sides are the same, making it impossible to guarantee consistent halving periods based on blocks. Therefore, it must be adjusted to use natural time as the unit.\n* The block production speed will be considered in the budget balancer's adjustment parameters, ensuring that workers' earnings on both sides are equal within the same unit of natural time. If the block production speed slows down, the budget will naturally increase, so the current issue of unstable returns due to blocked blocks will also be resolved.\n\n### **Two constraints for budget adjustment**\n\n#### Nonce constraint\n\nOnly one transaction can be successfully executed in a unit of time.\n\nThis is to prevent excessive budget adjustments due to Balancer bugs.\n\nAdditionally, if the Balancer does experience a bug, we can propose a motion for a budget change, inputting the nonce value for the next period's transaction. In this way, a buggy Balancer cannot interfere with on-chain information during the current and next period, serving as a protective measure.\n\n#### Max budget\n\nTo avoid excessively issuing computing rewards due to unusually high budgets caused by special circumstances (hacks, bugs, etc.), we have set a basic limit: the budget on a single chain can only be adjusted up to twice the total budget for a single block under normal circumstances.\n\nAt the same time, if an extreme situation occurs where block production is slow, causing a shortage of rewards for a given period, we need to consider how to compensate for this issue in the next nonce period. One precondition is ensuring the block production speed can recover after the t+1 period. Thus, even if no rewards were issued in the previous period, as long as the second period is normal, we can effectively compensate for the amount of the first period using the twice-the-budget limit.\n\nTherefore, we have set the maximum budget value to twice the total budget, which can be used to compensate for deficiencies in the previous period during extreme situations.", "mimetype": "text/plain", "start_char_idx": 5082, "end_char_idx": 7432, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b13cf6f8-8867-49d5-95ec-382c88535965": {"__data__": {"id_": "b13cf6f8-8867-49d5-95ec-382c88535965", "embedding": null, "metadata": {"file_path": "phala-docs_dist/budget-balancer.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "88a122d4-8580-4e00-9d8b-e306763112b8", "node_type": "4", "metadata": {}, "hash": "629d2634f505137f27fa0daf24753806c5752c7a61721f62b28d205a02597b07", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "759072fa-af3c-474e-92f5-ca8516dfdb2c", "node_type": "1", "metadata": {}, "hash": "091a36d471238f637ef76197fee9cfaf2cd981148d39ba0c2ce35a226ffb4397", "class_name": "RelatedNodeInfo"}}, "text": "### Potential issues and solutions\n\n#### How to ensure security?&#x20;\n\nThe contract deployed on Phat Contract is not controlled by humans but by open-source with controllable strategies.&#x20;\n\nThe whitelist accounts for transactions sent on the chain are contract accounts, not controlled by humans.&#x20;\n\n#### Is the Budget Balancer decentralized?&#x20;\n\nYes, it is.&#x20;\n\nThe governance of the whitelist relies on the community, and the data query service is deployed in a decentralized manner through Subsquid, not locally.&#x20;\n\n#### How to handle risks when they occur?  (fallback plan)\n\n**If there is an issue with Subsquid:**&#x20;\n\nWe can deploy a local Subsquid database for temporary use within 2-4 hours and complete motion governance to change the contract (in reality, using the same contract strategy but changing the database API connected to the contract) within 2 days. This temporary solution can resolve the issue within 1 period of the contract strategy.&#x20;\n\n**If there is an issue with the contract:**&#x20;\n\nWe can directly modify the on-chain budget through motion voting and remove the contract address from the whitelist to prevent the contract from causing secondary on-chain failure.", "mimetype": "text/plain", "start_char_idx": 7434, "end_char_idx": 8652, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "231cf6d7-c3af-4689-b581-e5c5d834f8cf": {"__data__": {"id_": "231cf6d7-c3af-4689-b581-e5c5d834f8cf", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "bc2b173d-892d-46a0-a99f-b435ce782cac", "node_type": "1", "metadata": {}, "hash": "713aaf641f177ed0ba907622d2fbaf36978cd662d2298a76823f2be0339cd731", "class_name": "RelatedNodeInfo"}}, "text": "# \ud83c\udfd7\ufe0f Customizing Your Phat Contract\n\n> For detailed docs on `phat_js` , go [here](https://bit.ly/phat\\_js) for the latest.\n\n## What Can You Do With Your Phat Contract? <a href=\"#user-content-what-can-you-do-with-your-function\" id=\"user-content-what-can-you-do-with-your-function\"></a>\n\nIn the `README.md` [link](https://github.com/Phala-Network/phat-contract-starter-kit/blob/main/GETTING\\_STARTED.md), you learned how to generate a new default function template and execute the 3 separate ways to test and validate your the results of the function. Now we will dive into what you can do with your function to extend the capabilities.\n\nWhat you will learn:\n\n* Available Capabilities of `@phala/pink-env`\n  * Call into a contract (Phat Contract).\n  * Invoke a delegate call on a contract code by a code hash (Phat Contract).\n  * Send an HTTP request and returns the response as either a Uint8Array or a string.\n    * Single HTTP request\n    * Batch HTTP requests\n    * Error Handling\n  * Derive a secret key from a salt.\n  * Hash a message using the specified algorithm.\n    * blake2b128\n    * blake2b256\n    * sha256\n    * keccak256\n* Customize Your Default Function and Test Locally.\n* Handle the abi encoding/decoding with [`viem`](https://viem.sh/).\n\n## Getting Started <a href=\"#user-content-getting-started\" id=\"user-content-getting-started\"></a>\n\nFirst you will need to install the `@phala/fn` CLI tool using your node package manager (`npm`) or use node package execute (`npx`). In this tutorial we use `npx`.\n\nNow create your first template with the CLI tool command:\n\n```sh\nnpx @phala/fn init example\n```\n\nWe currently have only one template. Just press enter to see something similar to the example below:\n\n```\nnpx @phala/fn init example\n# ? Please select one of the templates for your \"example\" project: phala-oracle-consumer-contract.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1846, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "bc2b173d-892d-46a0-a99f-b435ce782cac": {"__data__": {"id_": "bc2b173d-892d-46a0-a99f-b435ce782cac", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "231cf6d7-c3af-4689-b581-e5c5d834f8cf", "node_type": "1", "metadata": {}, "hash": "3b2461fed0c4f41071354d353359418dc6b5b361d5137ff05557dc7c7cf4b504", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ea048e53-10ce-446c-aece-2529b5755db2", "node_type": "1", "metadata": {}, "hash": "e4a4561c04a93efb4e4a9589b43778788164fe3fce43ff4d173e926ad3e0da9e", "class_name": "RelatedNodeInfo"}}, "text": "Polygon Consumer Contract for LensAPI Oracle\n# Downloading the template: https://github.com/Phala-Network/phala-oracle-consumer-contract... \u2714\n# The project is created in ~/Projects/Phala/example\n```\n\n`cd` into the newly created template and `ls` the directory which will look similar to below.\n\n```sh\ncd example\nls                                                                                                                      ~/Projects/Phala/example\n# total 736\n# drwxr-xr-x  18 hashwarlock  staff   576B Sep  6 15:32 .\n# drwxr-xr-x  35 hashwarlock  staff   1.1K Sep  6 15:32 .\n# -rw-r--r--   1 hashwarlock  staff   2.1K Sep  6 15:32 .env.local\n# -rw-r--r--   1 hashwarlock  staff   227B Sep  6 15:32 .gitignore\n# -rw-r--r--   1 hashwarlock  staff    34K Sep  6 15:32 LICENSE\n# -rw-r--r--   1 hashwarlock  staff   8.9K Sep  6 15:32 README.md\n# drwxr-xr-x   5 hashwarlock  staff   160B Sep  6 15:32 abis\n# drwxr-xr-x   4 hashwarlock  staff   128B Sep  6 15:32 assets\n# drwxr-xr-x   5 hashwarlock  staff   160B Sep  6 15:32 contracts\n# -rw-r--r--   1 hashwarlock  staff   1.3K Sep  6 15:32 hardhat.config.ts\n# -rw-r--r--   1 hashwarlock  staff    95B Sep  6 15:32 mumbai.arguments.ts\n# -rw-r--r--   1 hashwarlock  staff   2.6K Sep  6 15:32 package.json\n# -rw-r--r--   1 hashwarlock  staff    96B Sep  6 15:32 polygon.arguments.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ea048e53-10ce-446c-aece-2529b5755db2": {"__data__": {"id_": "ea048e53-10ce-446c-aece-2529b5755db2", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "bc2b173d-892d-46a0-a99f-b435ce782cac", "node_type": "1", "metadata": {}, "hash": "713aaf641f177ed0ba907622d2fbaf36978cd662d2298a76823f2be0339cd731", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f3875881-bbea-4662-b4a5-58b2dd327616", "node_type": "1", "metadata": {}, "hash": "015020e23425231e227d0beb1e34d33af290e86dfdfc1aefc818fb6d351d23bf", "class_name": "RelatedNodeInfo"}}, "text": "ts\n# drwxr-xr-x   5 hashwarlock  staff   160B Sep  6 15:32 scripts\n# drwxr-xr-x   3 hashwarlock  staff    96B Sep  6 15:32 src\n# drwxr-xr-x   3 hashwarlock  staff    96B Sep  6 15:32 test\n# -rw-r--r--   1 hashwarlock  staff   201B Sep  6 15:32 tsconfig.json\n# -rw-r--r--   1 hashwarlock  staff   290K Sep  6 15:32 package-lock.json\n```\n\nLastly, we will `cd` into `./src` where the `index.ts` file resides. This file will be where we customize our function logic.\n\n```sh\ncd src\n```\n\n## Available Capabilities of `@phala/pink-env` <a href=\"#user-content-available-capabilities-of-phalapink-env\" id=\"user-content-available-capabilities-of-phalapink-env\"></a>\n\nIn the `GETTING_STARTED.md` we introduced the basic functionality of making a single HTTP request to Lens API. The example code can be seen below:\n\n```typescript\nfunction fetchApiStats(lensApi: string, profileId: string): any {\n  // profile_id should be like 0x0001\n  let headers = {\n    \"Content-Type\": \"application/json\",\n    \"User-Agent\": \"phat-contract\",\n  };\n  let query = JSON.stringify({\n    query: `query Profile {\n      profile(request: { forProfileId: \"0x01\" }) {\n        stats {\n            followers\n            following\n            comments\n            countOpenActions\n            posts\n            quotes\n            mirrors\n            publications\n            reacted\n            reactions\n        }\n      }\n    }`,\n  });\n  let body = stringToHex(query);\n  //\n  // In Phat Function runtime, we not support async/await, you need use `pink.batchHttpRequest` to\n  // send http request. The function will return an array of response.", "mimetype": "text/plain", "start_char_idx": 3180, "end_char_idx": 4784, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f3875881-bbea-4662-b4a5-58b2dd327616": {"__data__": {"id_": "f3875881-bbea-4662-b4a5-58b2dd327616", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ea048e53-10ce-446c-aece-2529b5755db2", "node_type": "1", "metadata": {}, "hash": "e4a4561c04a93efb4e4a9589b43778788164fe3fce43ff4d173e926ad3e0da9e", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "17e31bad-d21f-4567-bb50-20bd515e0428", "node_type": "1", "metadata": {}, "hash": "f98b1f8332095b7f83d6b9d7924a6b066fab2d9c7f89594a31db1f735ce8ae6e", "class_name": "RelatedNodeInfo"}}, "text": "//\n  let response = pink.batchHttpRequest(\n    [\n      {\n        url: lensApi,\n        method: \"POST\",\n        headers,\n        body,\n        returnTextBody: true,\n      },\n    ],\n    2000\n  )[0];\n  if (response.statusCode !== 200) {\n    console.log(\n      `Fail to read Lens api with status code: ${response.statusCode}, error: ${\n        response.error || response.body\n      }}`\n    );\n    throw Error.FailedToFetchData;\n  }\n  let respBody = response.body;\n  if (typeof respBody !== \"string\") {\n    throw Error.FailedToDecode;\n  }\n  return JSON.parse(respBody);\n}\n```\n\nHere we utilize the `pink.batchHttpRequest()` function, but we only use a single HTTP request. Before going any further, let's clarify what is available with `@phala/pink-env`.\n\n### `pink.invokeContract()` & `pink.invokeContractDelegate()` <a href=\"#user-content-pinkinvokecontract--pinkinvokecontractdelegate\" id=\"user-content-pinkinvokecontract--pinkinvokecontractdelegate\"></a>\n\n* `pink.invokeContract()` allows for a call to a specified address of a Phat contract deployed on Phala's Mainnet or PoC6 Testnet depending on where you deploy your function.\n* `pink.invokeContractDelegate()` is similar but instead the call on a Phat Contract is targeted by the code hash.\n\n```typescript\n// Delegate calling\nconst delegateOutput = pink.invokeContractDelegate({\n  codeHash:\n    \"0x0000000000000000000000000000000000000000000000000000000000000000\",\n  selector: 0xdeadbeef,\n  input: \"0x00\",\n});\n\n// Instance calling\nconst contractOutput = pink.invokeContract({\n  callee: \"0x0000000000000000000000000000000000000000000000000000000000000000\",\n  input: \"0x00\",\n  selector: 0xdeadbeef,\n  gasLimit: 0n,\n  value: 0n,\n});\n```\n\nThis is the low-level API for cross-contract call. If you have the contract metadata file, there is a [script](https://bit.ly/phat-js-meta2js) to help generate the high-level API for cross-contract call.", "mimetype": "text/plain", "start_char_idx": 4787, "end_char_idx": 6678, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "17e31bad-d21f-4567-bb50-20bd515e0428": {"__data__": {"id_": "17e31bad-d21f-4567-bb50-20bd515e0428", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f3875881-bbea-4662-b4a5-58b2dd327616", "node_type": "1", "metadata": {}, "hash": "015020e23425231e227d0beb1e34d33af290e86dfdfc1aefc818fb6d351d23bf", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "e686a7ed-b348-488e-b9ce-02ff39db2835", "node_type": "1", "metadata": {}, "hash": "240edda0681297160c3d45770af963d4dd31baa6f048e83100b4af499d8a4588", "class_name": "RelatedNodeInfo"}}, "text": "For example run the following command:\n\n```bash\npython meta2js.py --keep System::version /path/to/system.contract\n```\n\nWould generate the following code:\n\n```typescript\nfunction invokeContract(callee, selector, args, metadata, registry) {\n    const inputCodec = pink.SCALE.codec(metadata.inputs, registry);\n    const outputCodec = pink.SCALE.codec(metadata.output, registry);\n    const input = inputCodec.encode(args ?? []);\n    const output = pink.invokeContract({ callee, selector, input });\n    return outputCodec.decode(output);\n}\nclass System {\n    constructor(address) {\n        this.typeRegistryRaw = '#u16\\n(0,0,0)\\n<CouldNotReadInput::1>\\n<Ok:1,Err:2>'\n        this.typeRegistry = pink.SCALE.parseTypes(this.typeRegistryRaw);\n        this.address = address;\n    }\n   \n    system$Version() {\n        const io = {\"inputs\": [], \"output\": 3};\n        return invokeContract(this.address, 2278132365, [], io, this.typeRegistry);\n    }\n}\n```\n\nThen you can use the high-level API to call the contract:\n\n```typescript\nconst system = new System(systemAddress);\nconst version = system.system$Version();\nconsole.log(\"version:\", version);\n```\n\n### `pink.httpRequest()` <a href=\"#user-content-pinkhttprequest\" id=\"user-content-pinkhttprequest\"></a>\n\n> HTTP request is supported in the JS environment. However, the API is **sync** rather than **async**. This is different from other JavaScript engines.\n\nThe `pink.httpRequest()` allows for you to make a single HTTP request from your function to an HTTP endpoint. You will have to define your args:\n\n* `url: string` \u2013 The URL to send the request to.\n* `method?: string` \u2013 (Optional) The HTTP method to use for the request (e.g. GET, POST, PUT). Defaults to GET.\n* `headers?: Headers` \u2013 (Optional) An map-like object containing the headers to send with the request.\n* `body?: Uint8Array | string` \u2013 (Optional) The body of the request, either as a Uint8Array or a string.\n* `returnTextBody?", "mimetype": "text/plain", "start_char_idx": 6679, "end_char_idx": 8611, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e686a7ed-b348-488e-b9ce-02ff39db2835": {"__data__": {"id_": "e686a7ed-b348-488e-b9ce-02ff39db2835", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "17e31bad-d21f-4567-bb50-20bd515e0428", "node_type": "1", "metadata": {}, "hash": "f98b1f8332095b7f83d6b9d7924a6b066fab2d9c7f89594a31db1f735ce8ae6e", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "1970d802-a9d6-4448-9640-406eff126faa", "node_type": "1", "metadata": {}, "hash": "cadbfce75150ca1ad9ae0260c9602be9ecd47502cd6ce1738a5cecb9de799c92", "class_name": "RelatedNodeInfo"}}, "text": ": boolean` \u2013 (Optional) A flag indicating whether the response body should be returned as a string (true) or a Uint8Array (false).\n\nReturned is the `Object` response from the HTTP request containing the following fields:\n\n* `{number} statusCode` - The HTTP status code of the response.\n* `{string} reasonPhrase` - The reason phrase of the response.\n* `{Headers} headers` - An object containing the headers of the response.\n* `{(Uint8Array|string)} body` - The response body, either as a `Uint8Array` or a string depending on the value of `args.returnTextBody`.\n\nHere is an example:\n\n```typescript\nconst response = pink.httpRequest({\n  url: \"https://httpbin.org/ip\",\n  method: \"GET\",\n  returnTextBody: true,\n});\nconsole.log(response.body);\n```\n\n### `pink.batchHttpRequest()` <a href=\"#user-content-pinkbatchhttprequest\" id=\"user-content-pinkbatchhttprequest\"></a>\n\nNow you may need to call multiple APIs at once, this would require you to use the `pink.batchHttpRequest()` function to ensure you do not timeout (timeouts for Phat Contract is 10 seconds) on your response. The `args` and returned `Object` are the same as `pink.httpRequest()`, but instead you can create an array of HTTP requests within the function. Since we have an example above of how to use a `pink.batchHttpRequest()`, before an examples let's look at the syntax. You will have to define your **array** of args:\n\n* `url: string` \u2013 The URL to send the request to.\n* `method?: string` \u2013 (Optional) The HTTP method to use for the request (e.g. GET, POST, PUT). Defaults to GET.\n* `headers?: Headers` \u2013 (Optional) An map-like object containing the headers to send with the request.\n* `body?: Uint8Array | string` \u2013 (Optional) The body of the request, either as a Uint8Array or a string.\n* `returnTextBody?: boolean` \u2013 (Optional) A flag indicating whether the response body should be returned as a string (true) or a Uint8Array (false).", "mimetype": "text/plain", "start_char_idx": 8611, "end_char_idx": 10513, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "1970d802-a9d6-4448-9640-406eff126faa": {"__data__": {"id_": "1970d802-a9d6-4448-9640-406eff126faa", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e686a7ed-b348-488e-b9ce-02ff39db2835", "node_type": "1", "metadata": {}, "hash": "240edda0681297160c3d45770af963d4dd31baa6f048e83100b4af499d8a4588", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "08abb08a-7f77-4787-9997-9f4e4e62513a", "node_type": "1", "metadata": {}, "hash": "eef87fde16f96fc3635bc2af2efe744699d463aa681d810962ec5886225297c4", "class_name": "RelatedNodeInfo"}}, "text": "* `[x]` - this value is what you will see below as `[0]` which points to index `0` in the array of HTTP requests.\n* `timeout_ms?: number` - (Optional) a number representing the number of milliseconds before the batch HTTP requests timeout. Returned is the `Object` response from the HTTP request containing the following fields:\n* `{number} statusCode` - The HTTP status code of the response.\n* `{string} reasonPhrase` - The reason phrase of the response.\n* `{Headers} headers` - An object containing the headers of the response.\n* `{(Uint8Array|string)} body` - The response body, either as a `Uint8Array` or a string depending on the value of `args.returnTextBody`.\n* `error?: string` - (Optional) The `error` string that will be mapped to the error corresponding to the index of the HTTP request in the batch HTTP requests.\n* `[x]` - this value is what you will see below as `[0]` which points to index `0` in the array of HTTP requests.\n\nLet's create a unique example.", "mimetype": "text/plain", "start_char_idx": 10514, "end_char_idx": 11486, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "08abb08a-7f77-4787-9997-9f4e4e62513a": {"__data__": {"id_": "08abb08a-7f77-4787-9997-9f4e4e62513a", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "1970d802-a9d6-4448-9640-406eff126faa", "node_type": "1", "metadata": {}, "hash": "cadbfce75150ca1ad9ae0260c9602be9ecd47502cd6ce1738a5cecb9de799c92", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ea586b2f-cab5-4415-a4ee-e5b0099dbbe3", "node_type": "1", "metadata": {}, "hash": "b0ed3dc2d71150e9afaefe9db8b3dee9e7c8dce66c994d6532de0209a809c396", "class_name": "RelatedNodeInfo"}}, "text": "In this example, we will:\n\n* Use `pink.batchHttpRequest()` to:\n  * Query [The Odds API](https://the-odds-api.com) for MLB games today\n  * Set Hello World in Key Value DB on [kvdb.io](https://kvdb.io)\n* Take response body of The Odds API query and send to a [Telegram Group](https://api.telegram.org) in a single `pink.httpRequest()`\n\n```typescript\nconst sportName = 'baseball_mlb'\nconst odds_http_endpoint = `https://api.the-odds-api.com/v4/sports/${sportName}/scores/?apiKey=37af51c4c3d1823308ae2966bcfe7`;\nconst kvdb_http_endpoint = `https://kvdb.io/AwA4DS6fJN69q4erVyjKzY`;\nconst tg_bot_http_endpoint = `https://api.telegram.org/bot4876363250:A1W7F0jeyMmvJAGd7K_12y_5qFjbXwPgpTQ/sendMessage?chat_id=-1001093498619&text=`;\n// headers for the HTTP request args\nlet headers = {\n    \"Content-Type\": \"application/json\",\n    \"User-Agent\": \"phat-contract\",\n};\n// Create body for updating kvdb.io\nconst kvdbUpdate = JSON.stringify({\n    \"txn\": [\n        {\"set\": \"hello\", \"value\": \"world\"}\n    ]\n});\nconst body2 = stringToHex(kvdbUpdate);\n// Notice that depending on the number of queries, you will define and array of responses from the response.\nconst [res1, res2] = pink.batchHttpRequest([\n    {\n        url: odds_http_endpoint,\n        method: \"GET\",\n        headers,\n        returnTextBody: true,\n    },\n    {\n        url: `${kvdb_http_endpoint}/hello`,\n        method: \"POST\",\n        headers: headers2,\n        body: body2,\n        returnTextBody: true,\n    }\n]);\n// Notice that the single HTTP request uses the response data from the first HTTP request in the batchHttpRequest function.", "mimetype": "text/plain", "start_char_idx": 11487, "end_char_idx": 13075, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ea586b2f-cab5-4415-a4ee-e5b0099dbbe3": {"__data__": {"id_": "ea586b2f-cab5-4415-a4ee-e5b0099dbbe3", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "08abb08a-7f77-4787-9997-9f4e4e62513a", "node_type": "1", "metadata": {}, "hash": "eef87fde16f96fc3635bc2af2efe744699d463aa681d810962ec5886225297c4", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "338a1091-3f9b-4cbd-997b-9dfea726df55", "node_type": "1", "metadata": {}, "hash": "9e4d21e2eec87be806ee4740ff0b297839b1144aace0029ab8dca09b2a454784", "class_name": "RelatedNodeInfo"}}, "text": "const res3 = pink.httpRequest({\n    url: `${tg_bot_http_endpoint}${res1.body}`,\n    method: \"POST\",\n    headers,\n    returnTextBody: true,\n});\n```\n\nHere are the expected result of executing this:\n\n*   KV DB on kvdb.io&#x20;\n\n    <figure><img src=\"https://github.com/Phala-Network/phat-contract-starter-kit/raw/main/assets/KVDB-hw.png\" alt=\"\"><figcaption></figcaption></figure>\n*   Telegram Bot Updates Telegram Group&#x20;\n\n    <figure><img src=\"https://github.com/Phala-Network/phat-contract-starter-kit/raw/main/assets/TG-Bot.png\" alt=\"\"><figcaption></figcaption></figure>\n\nPretty nifty, right? This is the power of the customized function with the ability to make single or batch HTTP requests. However, this example is missing some error handling which is our next topic.\n\n### Error Handling <a href=\"#user-content-error-handling\" id=\"user-content-error-handling\"></a>\n\nTo add some error handling to an HTTP request, you can check the default example with the query to Lens API above.\n\nA simple example can be defined:\n\n```typescript\ntry {\n  const response = pink.httpReqeust({\n    url: \"https://httpbin.org/ip\",\n    method: 42,\n    returnTextBody: true,\n  });\n  console.log(response.body);\n} catch (err) {\n  console.log(\"Some error ocurred:\", err);\n}\n```\n\nThis would send an error to the logserver:\n\n```\nJS: Some error ocurred: TypeError: invalid value for field 'method'\n```\n\n### `pink.deriveSecret()` <a href=\"#user-content-pinkderivesecret\" id=\"user-content-pinkderivesecret\"></a>\n\n`pink.deriveSecret()` takes in a salt of either `UInt8Array | string` and generates a secret key response of type `UInt8Array`.\n\nLet's build an example that will derive a secret from a salt `howdy` and update the Telegram group from above about the secret.", "mimetype": "text/plain", "start_char_idx": 13076, "end_char_idx": 14822, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "338a1091-3f9b-4cbd-997b-9dfea726df55": {"__data__": {"id_": "338a1091-3f9b-4cbd-997b-9dfea726df55", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ea586b2f-cab5-4415-a4ee-e5b0099dbbe3", "node_type": "1", "metadata": {}, "hash": "b0ed3dc2d71150e9afaefe9db8b3dee9e7c8dce66c994d6532de0209a809c396", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "1a72ae8c-0ada-4451-8775-71f383ec24aa", "node_type": "1", "metadata": {}, "hash": "c7ffabf4c7c79077ef77043206a141f6d568b58bc1f08c27bcaeb5c8def2b7e6", "class_name": "RelatedNodeInfo"}}, "text": "```typescript\nconst tg_bot_http_endpoint = `https://api.telegram.org/bot4876363250:A1W7F0jeyMmvJAGd7K_12y_5qFjbXwPgpTQ/sendMessage?chat_id=-1001093498619&text=`;\n// headers for the HTTP request args\nlet headers = {\n    \"Content-Type\": \"application/json\",\n    \"User-Agent\": \"phat-contract\",\n};\nconst res3 = pink.httpRequest({\n    url: `${tg_bot_http_endpoint}shhhhhhh\\nthis_is_a_secret:\\n[${secret}]`,\n    method: \"POST\",\n    headers,\n    returnTextBody: true,\n});\n```\n\nHere is the result :stuck\\_out\\_tongue\\_winking\\_eye:\n\n<figure><img src=\"https://github.com/Phala-Network/phat-contract-starter-kit/raw/main/assets/Secret-TG.png\" alt=\"\"><figcaption></figcaption></figure>\n\n### `pink.hash()` <a href=\"#user-content-pinkhash\" id=\"user-content-pinkhash\"></a>\n\n`pink.hash()` generates a hash based on the following params:\n\n* `algorithm`- the hash algorithm to use. Supported values are \u201cblake2b128\u201d, \u201cblake2b256\u201d, \u201csha256\u201d, \u201ckeccak256\u201d.\n* `message` \u2013 The message to hash, either as a `Uint8Array` or a `string`.\n\nLet's create an example to hash the values of `hello` and `world` to store in the KVDB we used earlier. We can also send the mapping to Telegram group to show a `pink.batchHttpRequest()`.", "mimetype": "text/plain", "start_char_idx": 14824, "end_char_idx": 16023, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "1a72ae8c-0ada-4451-8775-71f383ec24aa": {"__data__": {"id_": "1a72ae8c-0ada-4451-8775-71f383ec24aa", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "338a1091-3f9b-4cbd-997b-9dfea726df55", "node_type": "1", "metadata": {}, "hash": "9e4d21e2eec87be806ee4740ff0b297839b1144aace0029ab8dca09b2a454784", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "e59bd846-f141-4ec3-b8ba-ae50cdceda80", "node_type": "1", "metadata": {}, "hash": "1609204fbc6c5f1cc157379b91d4e10843780a19b2b3ed1c69d13ccd6647f977", "class_name": "RelatedNodeInfo"}}, "text": "```typescript\nconst kvdb_http_endpoint = `https://kvdb.io/AwA4DS6fJN69q4erVyjKzY`;\nconst tg_bot_http_endpoint = `https://api.telegram.org/bot4876363250:A1W7F0jeyMmvJAGd7K_12y_5qFjbXwPgpTQ/sendMessage?chat_id=-1001093498619&text=`;\n// headers for the HTTP request args\nlet headers = {\n    \"Content-Type\": \"application/json\",\n    \"User-Agent\": \"phat-contract\",\n};\n// Generate a hash for each algorithm for hello\nconst blake2b128Hello = pink.hash('blake2b128', 'hello');\nconst blake2b256Hello = pink.hash('blake2b256', 'hello');\nconst sha256Hello = pink.hash('sha256', 'hello');\nconst keccak256Hello = pink.hash('keccak256', 'hello');\nconst tgText = JSON.stringify({\n    blake2b128Hello: blake2b128Hello,\n    blake2b256Hello: blake2b256Hello,\n    sha256Hello: sha256Hello,\n    keccak256Hello: keccak256Hello\n});\n// KV Update Body\nconst kvdbUpdate = JSON.stringify({\n    \"txn\": [\n        {\"set\": \"blake2b128Hello\", \"value\": `${blake2b128Hello}`},\n        {\"set\": \"blake2b256Hello\", \"value\": `${blake2b256Hello}`},\n        {\"set\": \"sha256Hello\", \"value\": `${sha256Hello}`},\n        {\"set\": \"keccak256Hello\", \"value\": `${keccak256Hello}`}\n    ]\n});\nconst body2 = stringToHex(kvdbUpdate);\n// Batch HTTP request\nconst [res1, res2] = pink.batchHttpRequest([\n    {\n        url: `${kvdb_http_endpoint}/hello`,\n        method: \"POST\",\n        headers: headers2,\n        body: body2,\n        returnTextBody: true,\n    },\n    {\n        url: `${tg_bot_http_endpoint}\\n${tgText}`,\n        method: \"POST\",\n        headers,\n        returnTextBody: true,\n    }\n]);\n```\n\nLet's see how the results look.", "mimetype": "text/plain", "start_char_idx": 16025, "end_char_idx": 17607, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e59bd846-f141-4ec3-b8ba-ae50cdceda80": {"__data__": {"id_": "e59bd846-f141-4ec3-b8ba-ae50cdceda80", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "1a72ae8c-0ada-4451-8775-71f383ec24aa", "node_type": "1", "metadata": {}, "hash": "c7ffabf4c7c79077ef77043206a141f6d568b58bc1f08c27bcaeb5c8def2b7e6", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "bb9784a8-4820-4b69-9538-aba4f49c041e", "node_type": "1", "metadata": {}, "hash": "afc303dd0927f70a0f00ce07af6b1068e4a3991f587760d3b0976ba84b490151", "class_name": "RelatedNodeInfo"}}, "text": "*   KVDB hashes for `hello`&#x20;\n\n    <figure><img src=\"https://github.com/Phala-Network/phat-contract-starter-kit/raw/main/assets/KVDB-hashes.png\" alt=\"\"><figcaption></figcaption></figure>\n*   Telegram bot sends hashes for `hello`&#x20;\n\n    <figure><img src=\"https://github.com/Phala-Network/phat-contract-starter-kit/raw/main/assets/TG-hashes.png\" alt=\"\"><figcaption></figcaption></figure>\n\n## SCALE Codec\n\nLet\u2019s introduce the details of the SCALE codec API which is not documented in the above link.\n\nThe SCALE codec API is mounted on the global object `pink.SCALE` which contains the following functions:\n\n* `pink.SCALE.parseTypes(types: string): TypeRegistry`\n* `pink.SCALE.codec(type: string | number | number[], typeRegistry?", "mimetype": "text/plain", "start_char_idx": 17609, "end_char_idx": 18343, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "bb9784a8-4820-4b69-9538-aba4f49c041e": {"__data__": {"id_": "bb9784a8-4820-4b69-9538-aba4f49c041e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e59bd846-f141-4ec3-b8ba-ae50cdceda80", "node_type": "1", "metadata": {}, "hash": "1609204fbc6c5f1cc157379b91d4e10843780a19b2b3ed1c69d13ccd6647f977", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "159f9555-17a7-45e5-ac71-bc5e193e7442", "node_type": "1", "metadata": {}, "hash": "e26e2977037ecebe4288938d65ac616808be4a2db170a8ab48e429af62f00936", "class_name": "RelatedNodeInfo"}}, "text": ": TypeRegistry): Codec`\n\nLet\u2019s make a basice example to show how to use the SCALE codec API:\n\n```\nconst types = `\n  Hash=[u8;32]\n  Info={hash:Hash,size:u32}\n`;\nconst typeRegistry = pink.SCALE.parseTypes(types);\nconst infoCodec = pink.SCALE.codec(`Info`, typeRegistry);\nconst encoded = infoCodec.encode({\n hash: \"0x1234567890123456789012345678901234567890123456789012345678901234\",\n size: 1234,\n});\nconsole.log(\"encoded:\", encoded);\nconst decoded = infoCodec.decode(encoded);\npink.inspect(\"decoded:\", decoded);\n```\n\nThe above code will output:\n\n```\nJS: encoded: 18,52,86,120,144,18,52,86,120,144,18,52,86,120,144,18,52,86,120,144,18,52,86,120,144,18,52,86,120,144,18,52,210,4,0,0\nJS: decoded: {\nJS: hash: 0x1234567890123456789012345678901234567890123456789012345678901234,\nJS: size: 1234\nJS: }\n```\n\nOr using the direct encode/decode api which support literal type definition as well as a typename or id, for example:\n\n```\nconst data = { name: \"Alice\", age: 18 };\nconst encoded = pink.SCALE.encode(data, \"{ name: str, age: u8 }\");\nconst decoded = pink.SCALE.decode(encoded, \"{ name: str, age: u8 }\");\n```\n\n### Grammar of The Type Definition\n\nIn the above example, we use the following type definition:\n\n```\nHash=[u8;32]\nInfo={hash:Hash,size:u32}\n```\n\nwhere we define a type `Hash` which is an array of 32 bytes, and a type `Info` which is a struct containing a `Hash` and a `u32`.\n\nThe grammar is defined as follows:\n\nEach entry is type definition, which is of the form `name=type`. Where name must be a valid identifier, and type is a valid type expression described below.", "mimetype": "text/plain", "start_char_idx": 18343, "end_char_idx": 19915, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "159f9555-17a7-45e5-ac71-bc5e193e7442": {"__data__": {"id_": "159f9555-17a7-45e5-ac71-bc5e193e7442", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "bb9784a8-4820-4b69-9538-aba4f49c041e", "node_type": "1", "metadata": {}, "hash": "afc303dd0927f70a0f00ce07af6b1068e4a3991f587760d3b0976ba84b490151", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ad4f8907-8b38-4622-86cf-1e095c4e01c2", "node_type": "1", "metadata": {}, "hash": "c159f88bed91728d6fb50531daf110ff719f3263c283466c22c304451734b51d", "class_name": "RelatedNodeInfo"}}, "text": "Type expression can be one of the following:\n\n<table data-full-width=\"true\"><thead><tr><th>Type Expression</th><th>Description</th><th>Example</th><th>JS type</th></tr></thead><tbody><tr><td><code>bool</code></td><td>Primitive type bool</td><td></td><td><code>true</code>, <code>false</code></td></tr><tr><td><code>u8</code>, <code>u16</code>, <code>u32</code>, <code>u64</code>, <code>u128</code>, <code>i8</code>, <code>i16</code>, <code>i32</code>, <code>i64</code>, <code>i128</code></td><td>Primitive number types</td><td></td><td>number or bigint</td></tr><tr><td><code>str</code></td><td>Primitive type str</td><td></td><td>string</td></tr><tr><td><code>[type;size]</code></td><td>Array type with element type <code>type</code> and size <code>size</code>.</td><td><code>[u8; 32]</code></td><td>Array of elements. (Uint8Array or <code>0x</code> prefixed hex string is allowed for [u8; N])</td></tr><tr><td><code>[type]</code></td><td>Sequence type with element type <code>type</code>.</td><td><code>[u8]</code></td><td>Array of elements. (Uint8Array or <code>0x</code> prefixed hex string is allowed for <a href=\"https://doc.rust-lang.org/nightly/std/primitive.u8.html\">u8</a>)</td></tr><tr><td><code>(type1, type2, ...)</code></td><td>Tuple type with elements of type <code>type1</code>, <code>type2</code>, \u2026</td><td><code>(u8, str)</code></td><td>Array of value for inner type. (e.g.", "mimetype": "text/plain", "start_char_idx": 19917, "end_char_idx": 21309, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ad4f8907-8b38-4622-86cf-1e095c4e01c2": {"__data__": {"id_": "ad4f8907-8b38-4622-86cf-1e095c4e01c2", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "159f9555-17a7-45e5-ac71-bc5e193e7442", "node_type": "1", "metadata": {}, "hash": "e26e2977037ecebe4288938d65ac616808be4a2db170a8ab48e429af62f00936", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "621535c9-45ed-495c-aeaa-e7d7e3089bcc", "node_type": "1", "metadata": {}, "hash": "47a32bb255dea336b3ad7529d99289baeb260bfcf8370c4e6544e1cd54b9f65a", "class_name": "RelatedNodeInfo"}}, "text": "<code>[42, 'foobar']</code>)</td></tr><tr><td><code>{field1:type1, field2:type2, ...}</code></td><td>Struct type with fields and types.</td><td><code>{age:u32, name:str}</code></td><td>Object with field name as key</td></tr><tr><td><code>&#x3C;variant1:type1, variant2:type2, ...></code></td><td>Enum type with variants and types. if the variant is a unit variant, then the type expression can be omitted.</td><td><code>&#x3C;Success:i32, Error:str></code>, <code>&#x3C;None,Some:u32></code></td><td>Object with variant name as key. (e.g. <code>{Some: 42}</code>)</td></tr><tr><td><code>@type</code></td><td>Compact number types. Only unsigned number types is supported</td><td><code>@u64</code></td><td>number or bigint</td></tr></tbody></table>\n\n### Generic Type Support\n\nGeneric parameters can be added to the type definition, for example:\n\n```\nVec<T>=[T]\n```\n\n### Option Type\n\nThe Option type is not a special type, but a vanilla enum type. It is needed to be defined by the user explicitly. Same for the Result type.\n\n```\nOption<T>=<None,Some:T>\nResult<T,E>=<Ok:T,Err:E>\n```\n\nThere is one special syntax for the Option type:\n\n```\nOption<T>=<_None,_Some:T>\n```\n\nIf the Option type is defined in this way, then the `None` variant would be decoded as `null` instead of `{None: null}` and the `Some` variant would be decoded as the inner value directly instead of `{Some: innerValue}`.", "mimetype": "text/plain", "start_char_idx": 21310, "end_char_idx": 22696, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "621535c9-45ed-495c-aeaa-e7d7e3089bcc": {"__data__": {"id_": "621535c9-45ed-495c-aeaa-e7d7e3089bcc", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ad4f8907-8b38-4622-86cf-1e095c4e01c2", "node_type": "1", "metadata": {}, "hash": "c159f88bed91728d6fb50531daf110ff719f3263c283466c22c304451734b51d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "9b6457a7-38a7-4461-bf22-714570121e59", "node_type": "1", "metadata": {}, "hash": "fbe5828d8540ba81902dd3fcd182614ebef8f1fc75d670352c7ade6b90e9e2cd", "class_name": "RelatedNodeInfo"}}, "text": "For example:\n\n```\nconst encoded = pink.SCALE.encode(42, \"<_None,_Some:u32>\");\nconst decoded = pink.SCALE.decode(encoded, \"<_None,_Some:u32>\");\nconsole.log(decoded); // 42\n```\n\n### Nested Type Definition\n\nType definition can be nested, for example:\n\n```\nBlock={header:{hash:[u8;32],size:u32}}\n```\n\n## Handle EVM Smart Contract Encoding & Decoding\n\n> For TypeScript/JavaScript example scripts, check out [`@phala/pink-env` examples](https://bit.ly/phala-fn-ex-scripts).\n>\n> \\\n> **Note**: `@phala/ethers` will be no longer be maintained in favor of native support of [`viem`](https://viem.sh/).\n\n{% tabs %}\n{% tab title=\"viem\" %}\n#### Why viem\n\n`viem` is a TypeScript Interface for Ethereum that provides low-level stateless primitives for interacting with Ethereum. An alternative to ethers.js and web3.js with a focus on reliability, efficiency, and excellent developer experience.\n\nUsing native `viem` in Phat Contract 2.0 to handle EVM Smart Contract encoding/decoding helps reduce the friction of maintaining custom code. For more information on the `viem`'s why, check out the link below.\n\n{% embed url=\"https://viem.sh/docs/introduction.html\" fullWidth=\"true\" %}\nWhy viem\n{% endembed %}\n\nFor docs on how to use `viem`, check out the [ABI section](https://viem.sh/docs/abi/decodeAbiParameters.html) of the `viem` docs.&#x20;\n{% endtab %}\n\n{% tab title=\"@phala/ethers\" %}\n> **Note**: `@phala/ethers` is no longer being maintained. Instead use the latest version of `viem` to handle the EVM Smart Contract ABI encoding/decoding.\n\nIn the `index.ts` file of your Phat Contract starter kit, there is an npm package available called `@phala/ethers` and your file will import `Coders` which has the following types available.", "mimetype": "text/plain", "start_char_idx": 22697, "end_char_idx": 24418, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "9b6457a7-38a7-4461-bf22-714570121e59": {"__data__": {"id_": "9b6457a7-38a7-4461-bf22-714570121e59", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "621535c9-45ed-495c-aeaa-e7d7e3089bcc", "node_type": "1", "metadata": {}, "hash": "47a32bb255dea336b3ad7529d99289baeb260bfcf8370c4e6544e1cd54b9f65a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "cfe3edbd-7ece-44b4-b7a5-74907957c301", "node_type": "1", "metadata": {}, "hash": "debd8904746af05faa07dcd8a3810d6d1fc65e047d58bbd201e1629e18e15199", "class_name": "RelatedNodeInfo"}}, "text": "```typescript\n// From https://github.com/Phala-Network/phat-contract-starter-kit/blob/37e7ee2fa96c42f90f4418d45a9c47be570d59f5/src/index.ts#L6\nimport { AddressCoder } from \"./coders/address.js\";\nimport { ArrayCoder } from \"./coders/array.js\";\nimport { BooleanCoder } from \"./coders/boolean.js\";\nimport { BytesCoder } from \"./coders/bytes.js\";\nimport { FixedBytesCoder } from \"./coders/fixed-bytes.js\";\nimport { NullCoder } from \"./coders/null.js\";\nimport { NumberCoder } from \"./coders/number.js\";\nimport { StringCoder } from \"./coders/string.js\";\nimport { TupleCoder } from \"./coders/tuple.js\";\n```\n\nAs a developer you can utilize these types in many ways. Here are some examples of how to handle each type with the TypeScript `EncodeReply()` function on the Phat Contract side and `_onMessageReceived()`on the Solidity Smart Contract side.\n\n`AddressCoder` Example\n\n`index.ts`\n\n```typescript\n// .\n// Encode Address\nconst addressCoder = new Coders.AddressCoder(\"address\");\n// uint Coder\nconst uintCoder = new Coders.NumberCoder(32, false, \"uint256\");\nfunction encodeReply(reply: [uint, uint, string]): HexString {\n  return Coders.encode([uintCoder, uintCoder, addressCoder], reply) as HexString;\n}\n// Defined in OracleConsumerContract.sol\nconst TYPE_RESPONSE = 0;\nconst TYPE_ERROR = 2;\n\n// main entry function\nexport default function main(request: HexString, settings: string): HexString {\n  //.\n   let requestId, encodedReqStr;\n  try {\n    [requestId, encodedReqStr] = Coders.decode([uintCoder, bytesCoder], request);\n  } catch (error) {\n    console.info(\"Malformed request received\");\n    return encodeReply([TYPE_ERROR, 0, errorToCode(error as Error)]);\n  }\n  //.\n  try {\n    const response = \"0x0e9e628d715003ff5045fc92002c67ddab364683\";\n    return encodeReply([TYPE_RESPONSE, requestId, response]);", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "cfe3edbd-7ece-44b4-b7a5-74907957c301": {"__data__": {"id_": "cfe3edbd-7ece-44b4-b7a5-74907957c301", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "9b6457a7-38a7-4461-bf22-714570121e59", "node_type": "1", "metadata": {}, "hash": "fbe5828d8540ba81902dd3fcd182614ebef8f1fc75d670352c7ade6b90e9e2cd", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c5a91ff1-af00-49ed-9a4e-54ab705a20d9", "node_type": "1", "metadata": {}, "hash": "0d5599c24c72145a71cf4ddb0b3a8208c163f0c99777bb5cf641e02163c6228b", "class_name": "RelatedNodeInfo"}}, "text": "} catch (error) {\n    // Define error logic\n    // otherwise tell client we cannot process it\n    console.log(\"error:\", [TYPE_ERROR, requestId, \"0x0\"]);\n    return encodeReply([TYPE_ERROR, requestId, \"0x0\"]);\n  }\n}\n// .\n```\n\n`OracleConsumerContract.sol`\n\n```solidity\nevent ResponseReceived(uint reqId, string reqStr, address memory value);\nevent ErrorReceived(uint reqId, string reqStr, address memory errno);\n// .\n// request action request for Phat Contract to respond to\nfunction request(string calldata reqData) public {\n    // assemble the request\n    uint id = nextRequest;\n    requests[id] = reqData;\n    _pushMessage(abi.encode(id, reqData));\n    nextRequest += 1;\n}\n//.\n// _onMessageReceived response from Phat Contract\nfunction _onMessageReceived(bytes calldata action) internal override {\n    // Optional to check length of action\n    // require(action.length == 32 * 3, \"cannot parse action\");\n    (uint respType, uint id, address memory addr) = abi.decode(\n        action,\n        (uint, uint, address)\n    );\n    if (respType == TYPE_RESPONSE) {\n        emit ResponseReceived(id, requests[id], addr);\n        delete requests[id];\n    } else if (respType == TYPE_ERROR) {\n        emit ErrorReceived(id, requests[id], addr);\n        delete requests[id];\n    }\n}\n// .\n```\n\n`BooleanCoder` Example\n\n`index.ts`\n\n```typescript\n// .\n// bool Coder\nconst booleanCoder = new Coders.BooleanCoder(\"bool\");\n// uint Coder\nconst uintCoder = new Coders.NumberCoder(32, false, \"uint256\");\nfunction encodeReply(reply: [uint, uint, bool]): HexString {\n  return Coders.encode([uintCoder, uintCoder, booleanCoder], reply) as HexString;\n}\n// Defined in OracleConsumerContract.sol\nconst TYPE_RESPONSE = 0;\nconst TYPE_ERROR = 2;\n\n// main entry function\nexport default function main(request: HexString, settings: string): HexString {\n  //.\n   let requestId, encodedReqStr;", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c5a91ff1-af00-49ed-9a4e-54ab705a20d9": {"__data__": {"id_": "c5a91ff1-af00-49ed-9a4e-54ab705a20d9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "cfe3edbd-7ece-44b4-b7a5-74907957c301", "node_type": "1", "metadata": {}, "hash": "debd8904746af05faa07dcd8a3810d6d1fc65e047d58bbd201e1629e18e15199", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "d9c54045-f382-47cf-89aa-ad0f4622a304", "node_type": "1", "metadata": {}, "hash": "2870d4db1fa145ca8a7f5bffa870f1b92cac3a3935c2fb83f7479b577039f104", "class_name": "RelatedNodeInfo"}}, "text": "try {\n    [requestId, encodedReqStr] = Coders.decode([uintCoder, bytesCoder], request);\n  } catch (error) {\n    console.info(\"Malformed request received\");\n    return encodeReply([TYPE_ERROR, 0, errorToCode(error as Error)]);\n  }\n  //.\n  try {\n    const response = true;\n    return encodeReply([TYPE_RESPONSE, requestId, response]);\n  } catch (error) {\n    // Define error logic\n    // otherwise tell client we cannot process it\n    console.log(\"error:\", [TYPE_ERROR, requestId, error]);\n    return encodeReply([TYPE_ERROR, requestId, errorToCode(error as Error)]);\n  }\n}\n// .\n```\n\n`OracleConsumerContract.sol`\n\n```solidity\nevent ResponseReceived(uint reqId, string reqStr, bool value);\nevent ErrorReceived(uint reqId, string reqStr, bool errno);\n// .\n// request action request for Phat Contract to respond to\nfunction request(string calldata reqData) public {\n    // assemble the request\n    uint id = nextRequest;\n    requests[id] = reqData;\n    _pushMessage(abi.encode(id, reqData));\n    nextRequest += 1;\n}\n//.\n// _onMessageReceived response from Phat Contract\nfunction _onMessageReceived(bytes calldata action) internal override {\n    // Optional to check length of action\n    // require(action.length == 32 * 3, \"cannot parse action\");\n    (uint respType, uint id, bool data) = abi.decode(\n        action,\n        (uint, uint, bool)\n    );\n    if (respType == TYPE_RESPONSE) {\n        emit ResponseReceived(id, requests[id], data);\n        delete requests[id];\n    } else if (respType == TYPE_ERROR) {\n        emit ErrorReceived(id, requests[id], data);\n        delete requests[id];\n    }\n}\n// .\n```\n\n`NumberCoder`Example\n\n`index.ts`\n\n```typescript\n// .\n// Encode number\nconst uintCoder = new Coders.NumberCoder(32, false, \"uint256\");\nfunction encodeReply(reply: [number, number, number]): HexString {\n  return Coders.encode([uintCoder, uintCoder, uintCoder],", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d9c54045-f382-47cf-89aa-ad0f4622a304": {"__data__": {"id_": "d9c54045-f382-47cf-89aa-ad0f4622a304", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c5a91ff1-af00-49ed-9a4e-54ab705a20d9", "node_type": "1", "metadata": {}, "hash": "0d5599c24c72145a71cf4ddb0b3a8208c163f0c99777bb5cf641e02163c6228b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "c50812fa-071a-4787-8b1e-3838f3ef3411", "node_type": "1", "metadata": {}, "hash": "c4424ea1407130962d5f424bf20cf39bed5abd6a2d02a9e20b61dafd525e9a65", "class_name": "RelatedNodeInfo"}}, "text": "reply) as HexString;\n}\n// Defined in OracleConsumerContract.sol\nconst TYPE_RESPONSE = 0;\nconst TYPE_ERROR = 2;\n\n// main entry function\nexport default function main(request: HexString, settings: string): HexString {\n  //.\n   let requestId, encodedReqStr;\n  try {\n    [requestId, encodedReqStr] = Coders.decode([uintCoder, bytesCoder], request);\n  } catch (error) {\n    console.info(\"Malformed request received\");\n    return encodeReply([TYPE_ERROR, 0, errorToCode(error as Error)]);\n  }\n  //.\n  try {\n    const response = 2813308004;\n    return encodeReply([TYPE_RESPONSE, requestId, stats]);\n  } catch (error) {\n    // Define error logic\n    // otherwise tell client we cannot process it\n    console.log(\"error:\", [TYPE_ERROR, requestId, error]);\n    return encodeReply([TYPE_ERROR, requestId, errorToCode(error as Error)]);\n  }\n}\n// .\n```\n\n`OracleConsumerContract.sol`\n\n```solidity\nevent ResponseReceived(uint reqId, string reqData, uint256 value);\nevent ErrorReceived(uint reqId, string reqData, uint256 errno);\n// .\n// request action request for Phat Contract to respond to\nfunction request(string calldata reqData) public {\n    // assemble the request\n    uint id = nextRequest;\n    requests[id] = reqData;\n    _pushMessage(abi.encode(id, reqData));\n    nextRequest += 1;\n}\n//.\n// _onMessageReceived response from Phat Contract\nfunction _onMessageReceived(bytes calldata action) internal override {\n    // Optional to check length of action\n    // require(action.length == 32 * 3, \"cannot parse action\");\n    (uint respType, uint id, uint256 data) = abi.decode(\n        action,\n        (uint, uint, uint256)\n    );\n    if (respType == TYPE_RESPONSE) {\n        emit ResponseReceived(id, requests[id], data);\n        delete requests[id];\n    } else if (respType == TYPE_ERROR) {\n        emit ErrorReceived(id, requests[id], data);\n        delete requests[id];\n    }\n}\n// .", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "c50812fa-071a-4787-8b1e-3838f3ef3411": {"__data__": {"id_": "c50812fa-071a-4787-8b1e-3838f3ef3411", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d9c54045-f382-47cf-89aa-ad0f4622a304", "node_type": "1", "metadata": {}, "hash": "2870d4db1fa145ca8a7f5bffa870f1b92cac3a3935c2fb83f7479b577039f104", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a0138f90-3a0d-4175-ae0f-00edab1ec349", "node_type": "1", "metadata": {}, "hash": "7cefecb920dc84960d950683df82d3a9f5bcd3fcaf6f04de411c7f3b9422ab48", "class_name": "RelatedNodeInfo"}}, "text": "```\n\n`StringCoder` Example\n\n`index.ts`\n\n```typescript\n// .\n// Encode String\nconst stringCoder = new Coders.StringCoder(\"string\");\nconst uintCoder = new Coders.NumberCoder(32, false, \"uint256\");\nfunction encodeReply(reply: [number, number, string]): HexString {\n  return Coders.encode([uintCoder, uintCoder, stringCoder], reply) as HexString;\n}\n// Defined in OracleConsumerContract.sol\nconst TYPE_RESPONSE = 0;\nconst TYPE_ERROR = 2;\n\n// main entry function\nexport default function main(request: HexString, settings: string): HexString {\n  //.\n   let requestId, encodedReqStr;\n  try {\n    [requestId, encodedReqStr] = Coders.decode([uintCoder, bytesCoder], request);\n  } catch (error) {\n    console.info(\"Malformed request received\");\n    return encodeReply([TYPE_ERROR, 0, errorToCode(error as Error)]);\n  }\n  //.\n  try {\n    const response = \"hello\";\n    return encodeReply([TYPE_RESPONSE, requestId, response]);\n  } catch (error) {\n    // Define error logic\n    // otherwise tell client we cannot process it\n    console.log(\"error:\", [TYPE_ERROR, requestId, error]);\n    return encodeReply([TYPE_ERROR, requestId, errorToCode(error as Error)]);\n  }\n}\n// .\n```\n\n`OracleConsumerContract.sol`\n\n```solidity\nevent ResponseReceived(uint reqId, string reqStr, string memory value);\nevent ErrorReceived(uint reqId, string reqStr, string memory errno);\n// .\n// request action request for Phat Contract to respond to\nfunction request(string calldata reqData) public {\n    // assemble the request\n    uint id = nextRequest;\n    requests[id] = reqData;\n    _pushMessage(abi.encode(id, reqData));\n    nextRequest += 1;\n}\n//.\n// _onMessageReceived response from Phat Contract\nfunction _onMessageReceived(bytes calldata action) internal override {\n    // Optional to check length of action\n    // require(action.length == 32 * 3, \"cannot parse action\");\n    (uint respType, uint id, string memory data) = abi.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a0138f90-3a0d-4175-ae0f-00edab1ec349": {"__data__": {"id_": "a0138f90-3a0d-4175-ae0f-00edab1ec349", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c50812fa-071a-4787-8b1e-3838f3ef3411", "node_type": "1", "metadata": {}, "hash": "c4424ea1407130962d5f424bf20cf39bed5abd6a2d02a9e20b61dafd525e9a65", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "fb6e7509-012d-48eb-b1ef-9f07a038cf58", "node_type": "1", "metadata": {}, "hash": "f99c760287d4aa40dede2a6b5270e899e0cf6e6649a35fd1f4964461eced167f", "class_name": "RelatedNodeInfo"}}, "text": "decode(\n        action,\n        (uint, uint, string)\n    );\n    if (respType == TYPE_RESPONSE) {\n        emit ResponseReceived(id, requests[id], data);\n        delete requests[id];\n    } else if (respType == TYPE_ERROR) {\n        emit ErrorReceived(id, requests[id], data);\n        delete requests[id];\n    }\n}\n// .\n```\n\n`ArrayCoder` Static Array Example\n\n> Static arrays can be created by defining a `number` > 0. as the `length` parameter in the `Coders.ArrayCoder(coder: Coder, length: number, localName: string)` function.\n\n`index.ts`\n\n```typescript\n// ...\n// Encode String\nconst stringCoder = new Coders.StringCoder(\"string\");\nconst stringArrayCoder = new Coders.ArrayCoder(stringCoder, 3, \"string[]\");\nfunction encodeReply(reply: [number, number, string[]]): HexString {\n  return Coders.encode([uintCoder, uintCoder, stringArrayCoder], reply) as HexString;\n}\n// Defined in OracleConsumerContract.sol\nconst TYPE_RESPONSE = 0;\nconst TYPE_ERROR = 2;\n\n// main entry function\nexport default function main(request: HexString, settings: string): HexString {\n  //...\n   let requestId, encodedReqStr;\n  try {\n    [requestId, encodedReqStr] = Coders.decode([uintCoder, bytesCoder], request);\n  } catch (error) {\n    console.info(\"Malformed request received\");\n    // ...\n  }\n  //...\n  try {\n    const response = [\"Who?", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "fb6e7509-012d-48eb-b1ef-9f07a038cf58": {"__data__": {"id_": "fb6e7509-012d-48eb-b1ef-9f07a038cf58", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a0138f90-3a0d-4175-ae0f-00edab1ec349", "node_type": "1", "metadata": {}, "hash": "7cefecb920dc84960d950683df82d3a9f5bcd3fcaf6f04de411c7f3b9422ab48", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "3924e58a-1367-4579-87da-d266de7bce22", "node_type": "1", "metadata": {}, "hash": "d7bdffdb057a10ff836f4a2435a3440fac5078be20ebc780f8d7392d8c409354", "class_name": "RelatedNodeInfo"}}, "text": "\", \"Mike\", \"Jones\"];\n    return encodeReply([TYPE_RESPONSE, requestId, response]);\n  } catch (error) {\n    // Define error logic\n    // otherwise tell client we cannot process it\n    // ...\n  }\n}\n// ...\n```\n\n`OracleConsumerContract.sol`\n\n```solidity\n// ...\n// request action request for Phat Contract to respond to\nfunction request(string calldata reqData) public {\n    // assemble the request\n    uint id = nextRequest;\n    requests[id] = reqData;\n    _pushMessage(abi.encode(id, reqData));\n    nextRequest += 1;\n}\n//...\n// _onMessageReceived response from Phat Contract\nfunction _onMessageReceived(bytes calldata action) internal override {\n    // Optional to check length of action\n    // require(action.length == 32 * 3, \"cannot parse action\");\n    (uint respType, uint id, string [3] memory data) = abi.decode(\n        action,\n        (uint, uint, string[3])\n    );\n    // ...\n}\n// ...\n```\n\n`ArrayCoder` Dynamic Array Example\n\n> Dynamic arrays can be created by using `-1` as the `length` parameter in the `Coders.ArrayCoder(coder: Coder, length: number, localName: string)` function.\n\n`index.ts`\n\n```typescript\n// ...\n// Encode String\nconst stringCoder = new Coders.StringCoder(\"string\");\n// Dynamic arrays just put `-1` for the length parameter\nconst stringArrayCoder = new Coders.ArrayCoder(stringCoder, -1, \"string[]\");\nfunction encodeReply(reply: [number, number, string[]]): HexString {\n  return Coders.encode([uintCoder, uintCoder, stringArrayCoder], reply) as HexString;\n}\n// Defined in OracleConsumerContract.sol\nconst TYPE_RESPONSE = 0;\nconst TYPE_ERROR = 2;\n\n// main entry function\nexport default function main(request: HexString, settings: string): HexString {\n  //...\n   let requestId, encodedReqStr;\n  try {\n    [requestId, encodedReqStr] = Coders.decode([uintCoder, bytesCoder], request);\n  } catch (error) {\n    console.info(\"Malformed request received\");\n    // ...\n  }\n  //...\n  try {\n    const response = [\"Who?\", \"Mike\", \"Jones\", \"is\", \"dynamic\"];", "mimetype": "text/plain", "start_char_idx": 35094, "end_char_idx": 37066, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "3924e58a-1367-4579-87da-d266de7bce22": {"__data__": {"id_": "3924e58a-1367-4579-87da-d266de7bce22", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "fb6e7509-012d-48eb-b1ef-9f07a038cf58", "node_type": "1", "metadata": {}, "hash": "f99c760287d4aa40dede2a6b5270e899e0cf6e6649a35fd1f4964461eced167f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "661e43f0-273d-477f-a877-de4b1b4f1a60", "node_type": "1", "metadata": {}, "hash": "c6ba3c0b02066f33bcf17d46d45e98696052381340b66df157715803a8ce071b", "class_name": "RelatedNodeInfo"}}, "text": "return encodeReply([TYPE_RESPONSE, requestId, response]);\n  } catch (error) {\n    // Define error logic\n    // otherwise tell client we cannot process it\n    // .\n  }\n}\n// .\n```\n\n`OracleConsumerContract.sol`\n\n```solidity\n// .\n// request action request for Phat Contract to respond to\nfunction request(string calldata reqData) public {\n    // assemble the request\n    uint id = nextRequest;\n    requests[id] = reqData;\n    _pushMessage(abi.encode(id, reqData));\n    nextRequest += 1;\n}\n//.\n// _onMessageReceived response from Phat Contract\nfunction _onMessageReceived(bytes calldata action) internal override {\n    (uint respType, uint id, string[] memory data) = abi.decode(\n        action,\n        (uint, uint, string[3])\n    );\n    // .\n}\n// .\n```\n\nComplex example using\n\n* `BytesCoder`\n* `FixedBytesCoder`\n* `NullCoder`\n* `TupleCoder`\n\n`index.ts`\n\n```typescript\n// .\n// Encode Address\nimport { Coders } from \"@phala/ethers\";\n\nconst bytesCoder = new Coders.BytesCoder('bytes');\nconst fixedCoder = new Coders.FixedBytesCoder(16, 'bytes')\nconst nullCoder = new Coders.NullCoder('nullCoder')\nconst tupleCoder = new Coders.TupleCoder([bytesCoder, fixedCoder, nullCoder], 'tupleCoder')\n\nexport default function main() {\n  return Coders.encode([tupleCoder], [[new Uint8Array(0), new Uint8Array(16), null]])\n}\n// .\n```\n\n`OracleConsumerContract.sol`\n\n```solidity\n// .\n// request action request for Phat Contract to respond to\nfunction request(string calldata reqData) public {\n    // assemble the request\n    uint id = nextRequest;\n    requests[id] = reqData;\n    _pushMessage(abi.encode(id, reqData));\n    nextRequest += 1;\n}\n//.\n// _onMessageReceived response from Phat Contract\nfunction _onMessageReceived(bytes calldata action) internal override {\n    // .\n    (bytes16 bytesResp, bytes16 bytes16Resp, uint null) = abi.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "661e43f0-273d-477f-a877-de4b1b4f1a60": {"__data__": {"id_": "661e43f0-273d-477f-a877-de4b1b4f1a60", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "3924e58a-1367-4579-87da-d266de7bce22", "node_type": "1", "metadata": {}, "hash": "d7bdffdb057a10ff836f4a2435a3440fac5078be20ebc780f8d7392d8c409354", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a3ebc994-3eb7-4868-8e0a-92c0216e62cc", "node_type": "1", "metadata": {}, "hash": "9f9450eaec281213d7004692ee55fda7f60ca6f2aa0b9808d63d87d85e34a3cf", "class_name": "RelatedNodeInfo"}}, "text": "decode(\n       action,\n       (bytes16, bytes16, uint)\n    );\n    //.\n}\n// .\n```\n{% endtab %}\n{% endtabs %}\n\n### Example\n\nIn the Phat Contract 2.0 Starter Kit, there is a file in `src/viem/coder.ts` which will look like the following:\n\n```typescript\nimport {decodeAbiParameters, encodeAbiParameters, parseAbiParameters} from \"viem\";\n\nexport type HexString = `0x${string}`\nexport const encodeReplyAbiParams = 'uint respType, uint id, uint256 data';\nexport const decodeRequestAbiParams = 'uint id, string reqData';\n\nexport function encodeReply(abiParams: string, reply: [bigint, bigint, bigint]): HexString {\n    return encodeAbiParameters(parseAbiParameters(abiParams),\n        reply\n    );\n}\n\nexport function decodeRequest(abiParams: string, request: HexString): any {\n    return decodeAbiParameters(parseAbiParameters(abiParams),\n        request\n    );\n}\n```\n\nThe 2 important functions in this file are:\n\n* `decodeRequest(abiParams, request)` - decodes the action `request` `HexString` that is passed into the `main(request, secrets)` entry function of the Phat Contract. You can find the expected encoded `HexString` in the `OracleConsumerContract.sol` `request(string calldata reqData)` function where the action is encoded with a `uint id` and `string reqData` in the `_pushMessage(abi.encode(id, reqData))` function.\n* `encodeReply(abiParams, reply)` - encodes the action reply to be sent back to the Consumer Contract on the EVM change. The Consumer Contract consumes the action reply via the `_onMessageReceived(bytes calldata action)` function where data encoded can be decoded and handled based on the Consumer Contract logic. The default example encodes a tuple of `uint respType`, `uint id`, and `uint256 data` that in turn gets decoded in  `OracleConsumerContract.sol`  `_onMessageReceived(bytes calldata action)` function with `(uint respType, uint id, uint256 data) = abi.decode(action, (uint, uint, uint256)`.\n\nLet's breakdown the example and step through the process.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a3ebc994-3eb7-4868-8e0a-92c0216e62cc": {"__data__": {"id_": "a3ebc994-3eb7-4868-8e0a-92c0216e62cc", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "661e43f0-273d-477f-a877-de4b1b4f1a60", "node_type": "1", "metadata": {}, "hash": "c6ba3c0b02066f33bcf17d46d45e98696052381340b66df157715803a8ce071b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "21671291-8359-4b01-be9d-f3c7fb9fad10", "node_type": "1", "metadata": {}, "hash": "a17c4d5a68ad434b1ebd0ec7b6dde3809ad6a2bb5edf39c4c5ff802ad872e86f", "class_name": "RelatedNodeInfo"}}, "text": "1. encode action request in `request(string calldata)` of `OracleConsumerContract.sol`\n2. decode action request when parsing the encoded action in the Phat Contract 2.0 `main(request, secrets)` entry function in the `src/index.ts` file.\n3. encode the action reply in the Phat Contract to send to the `OracleConsumerContract.sol`\n4. decode the action reply in the `OracleConsumerContract.sol` function `_onMessageReceived(bytes calldata action)`\n\n{% tabs %}\n{% tab title=\"Step 1\" %}\nHere is a snippet of the code to encode a tuple that includes the `uint id` representing the request id and `string calldata reqData` that is the request data string.\n\nFor the example, we will pass in:\n\n* `id` = `1`\n* `reqData` = `\"0x01\"`\n\n`OracleConsumerContract.sol`\n\n<pre class=\"language-solidity\"><code class=\"lang-solidity\">function request(string calldata reqData) public {\n   // assemble the request\n<strong>   uint id = nextRequest;\n</strong>   requests[id] = reqData;\n   _pushMessage(abi.encode(id, reqData));\n   nextRequest += 1;\n}\n   \n</code></pre>\n\nThis will produce a `HexString` `0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000` representing `(1, \"0x01\")`\n{% endtab %}\n\n{% tab title=\"Step 2\" %}\nIn the `src/index.ts` file, we handle the decoding by calling the `decodeRequest(abiParams, request)` to parse the expected variables of `id` equal to `1` and `reqData` equal to `\"0x01\"`.", "mimetype": "text/plain", "start_char_idx": 40899, "end_char_idx": 42488, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "21671291-8359-4b01-be9d-f3c7fb9fad10": {"__data__": {"id_": "21671291-8359-4b01-be9d-f3c7fb9fad10", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a3ebc994-3eb7-4868-8e0a-92c0216e62cc", "node_type": "1", "metadata": {}, "hash": "9f9450eaec281213d7004692ee55fda7f60ca6f2aa0b9808d63d87d85e34a3cf", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "df02491a-dd61-4da3-a1c9-60a375bc1669", "node_type": "1", "metadata": {}, "hash": "a24f806acc995e74de9822015e9978e80c5508b94e1fda188740065c1410b5e9", "class_name": "RelatedNodeInfo"}}, "text": "`src/main.ts`\n\n```typescript\nexport default function main(request: HexString, secrets: string): HexString {\n  console.log(`handle req: ${request}`);\n  let requestId, encodedReqStr;\n  try {\n    [requestId, encodedReqStr] = decodeRequest(decodeRequestAbiParams, request);\n    console.log(`[${requestId}]: ${encodedReqStr}`);\n  } catch (error) {\n    console.info(\"Malformed request received\");\n    return encodeReply(encodeReplyAbiParams, [BigInt(TYPE_ERROR), 0n, BigInt(errorToCode(error as Error))]);\n  }\n```\n\nYou will see logs that will look like the following when printing the encoded `request` and decoded values into `requestId` and `encodedReqStr`.\n\n```bash\nhandle req: 0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000\n[1]: 0x01\n```\n\nNotice that we have error handling to ensure that the `request` can be decoded or else the error will be sent back to the Consumer Contract with `encodeReply(abiParams, reply)`.\n{% endtab %}\n\n{% tab title=\"Step 3\" %}\nOnce the results are computed in the Phat Contract, the action reply is composed and sent via the `encodeReply(abiParams, reply)` function. In this example, we query the Lens v2 API to get profile id `\"0x01\"` and returns the total posts back as part of the encoded reply.", "mimetype": "text/plain", "start_char_idx": 42490, "end_char_idx": 43927, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "df02491a-dd61-4da3-a1c9-60a375bc1669": {"__data__": {"id_": "df02491a-dd61-4da3-a1c9-60a375bc1669", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "21671291-8359-4b01-be9d-f3c7fb9fad10", "node_type": "1", "metadata": {}, "hash": "a17c4d5a68ad434b1ebd0ec7b6dde3809ad6a2bb5edf39c4c5ff802ad872e86f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "1f2d5568-441e-4be5-b86d-bdc6bf79d927", "node_type": "1", "metadata": {}, "hash": "25d9011fca415c57a01949db43faca3ea966d46e21a5475a86f74d551bb0e10a", "class_name": "RelatedNodeInfo"}}, "text": "`src/index.ts`\n\n```typescript\ntry {\n    const respData = fetchApiStats(secrets, encodedReqStr);\n    let stats = respData.data.profile.stats.posts;\n    console.log(\"response:\", [TYPE_RESPONSE, requestId, stats]);\n    return encodeReply(encodeReplyAbiParams, [BigInt(TYPE_RESPONSE), requestId, stats]);\n  } catch (error) {\n    if (error === Error.FailedToFetchData) {\n      throw error;\n    } else {\n      // otherwise tell client we cannot process it\n      console.log(\"error:\", [TYPE_ERROR, requestId, error]);\n      return encodeReply(encodeReplyAbiParams, [BigInt(TYPE_ERROR), requestId, BigInt(errorToCode(error as Error))]);\n    }\n  }\n```\n\nThe expected posts count at the time of writing was `201` so the logs should print something similar to below where `0` equals `TYPE_RESPONSE`, `1` equals to the request id, and `201` is the total posts from profile `\"0x01\"`\n\n```bash\nresponse: 0,1,201\n{\"output\":\"0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c9\"}\n```\n{% endtab %}\n\n{% tab title=\"Step 4\" %}\nThe encoded action reply is lastly handled by the `OracleconsumerContract.sol` in the `_onMessageReceived(bytes calldata action)` with the expected value of action being `0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c9` which is decoded to equal `(0, 1, 201)`. This can be seen with the example below.", "mimetype": "text/plain", "start_char_idx": 43929, "end_char_idx": 45524, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "1f2d5568-441e-4be5-b86d-bdc6bf79d927": {"__data__": {"id_": "1f2d5568-441e-4be5-b86d-bdc6bf79d927", "embedding": null, "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "398085c0-bdd5-4da2-8dca-95d7c720913a", "node_type": "4", "metadata": {}, "hash": "7757589ef3f2151417cb5666c9d7d60437982ad9a3beb25ce4f0493e51414ce1", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "df02491a-dd61-4da3-a1c9-60a375bc1669", "node_type": "1", "metadata": {}, "hash": "a24f806acc995e74de9822015e9978e80c5508b94e1fda188740065c1410b5e9", "class_name": "RelatedNodeInfo"}}, "text": "`OracleConsumerContract.sol`\n\n```solidity\nfunction _onMessageReceived(bytes calldata action) internal override {\n    // Optional to check length of action\n    // require(action.length == 32 * 3, \"cannot parse action\");\n    (uint respType, uint id, uint256 data) = abi.decode(\n        action,\n        (uint, uint, uint256)\n    );\n    if (respType == TYPE_RESPONSE) {\n        emit ResponseReceived(id, requests[id], data);\n        delete requests[id];\n    } else if (respType == TYPE_ERROR) {\n        emit ErrorReceived(id, requests[id], data);\n        delete requests[id];\n    }\n}\n```\n{% endtab %}\n{% endtabs %}\n\n## [Closing](https://github.com/Phala-Network/phat-contract-starter-kit/blob/main/src/JS\\_API\\_DOC.md#closing) <a href=\"#user-content-closing\" id=\"user-content-closing\"></a>\n\nCongratulations! You now possess the power to extend the functionality of your functions in many unique ways. If this sparks some ideas that require some extensive functionality that is not supported in `@phala/pink-env`, jump in our [discord](https://discord.gg/dB4AuP4Q), and we can help you learn a little rust to build some Phat Contracts with the Rust SDK then leverage the functions `pink.invokeContract()` & `pink.invokeContractDelegate()` to make calls to the Rust SDK deployed Phat Contracts.", "mimetype": "text/plain", "start_char_idx": 45526, "end_char_idx": 46814, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ce9838c4-b01b-4ab7-a28d-966a6baee57b": {"__data__": {"id_": "ce9838c4-b01b-4ab7-a28d-966a6baee57b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/governance-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f69a4042-cc29-416f-a18b-1c16470427db", "node_type": "4", "metadata": {}, "hash": "acf16d0aa5ee0c6b91dd336a31f4c2ce541ecdc201e5998ab44e783075f22df9", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ddbc1ae9-2121-4286-93ec-112ce731dc14", "node_type": "1", "metadata": {}, "hash": "4039254934c0d78f9c1a5b3c8d53bc8fe6a0b60c91d1aabd9de3c3f5496d9708", "class_name": "RelatedNodeInfo"}}, "text": "# Governance Mechanism\n\n> Go to the [Governance](./) section for more detailed tutorials on voting and Treasury application.\n\nThe early Khala network will use a governance mechanism consistent with Polkadot and Kusama, enabling it to evolve gracefully over time at the ultimate behest of its assembled stakeholders. The stated goal is to ensure that the majority of the stake can always command the network.\n\nTherefore, the following Khala democratic mechanism basically adopts the same process and instructions as the [Polkadot wiki](https://wiki.polkadot.network/docs/learn-governance).\n\nTo do this, we bring together various novel mechanisms, including an amorphous state-transition function stored on-chain and defined in a platform-neutral intermediate language (i.e. WebAssembly) and several on-chain voting mechanisms such as referenda with adaptive super-majority thresholds and batch approval voting. All changes to the protocol must be agreed upon by stake-weighted referenda.\n\n## Mechanism <a href=\"#mechanism\" id=\"mechanism\"></a>\n\nTo make any changes to the network, the idea is to compose active token holders and the council together to administrate a network upgrade decision. No matter whether the proposal is proposed by the public (PHA token holders) or the council, it finally will have to go through a referendum to let all holders, weighted by stake, make the decision.\n\nTo better understand how the council is formed, please read the council section.\n\n## Referenda <a href=\"#referenda\" id=\"referenda\"></a>\n\nReferenda are simple, inclusive, stake-based voting schemes. Each referendum has a specific _proposal_ on-chain associated with it that takes the form of a privileged function call (that includes the most powerful call: `set_code`, which can switch out the entire code of the Runtime, achieving updates on-chain).\n\nReferenda are discrete events, have a fixed period where voting happens, and then are tallied and the function call is made if the vote is approved. Referenda are always binary; your only options in voting are \u201caye\u201d, \u201cnay\u201d, or abstaining entirely.\n\nReferenda can be started in one of several ways:\n\n* Publicly submitted proposals;\n* Proposals submitted by the council, either through a majority or unanimously;\n* Proposals submitted as part of the enactment of a prior referendum;\n* Emergency proposals submitted by the Technical Committee and approved by the Council.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2412, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ddbc1ae9-2121-4286-93ec-112ce731dc14": {"__data__": {"id_": "ddbc1ae9-2121-4286-93ec-112ce731dc14", "embedding": null, "metadata": {"file_path": "phala-docs_dist/governance-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f69a4042-cc29-416f-a18b-1c16470427db", "node_type": "4", "metadata": {}, "hash": "acf16d0aa5ee0c6b91dd336a31f4c2ce541ecdc201e5998ab44e783075f22df9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ce9838c4-b01b-4ab7-a28d-966a6baee57b", "node_type": "1", "metadata": {}, "hash": "58a6dd4620ef7394bdf347b59287138e4f5f357b0b48b6db45ed828b9c5c8f7f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "30ecf36b-5153-4eb1-9713-ba7f720f3759", "node_type": "1", "metadata": {}, "hash": "4a3690b44c9c7a410f3ce163bc4ae35a8a2b88823b8c00a42148eab58e614db1", "class_name": "RelatedNodeInfo"}}, "text": "All referenda have an _enactment delay_ associated with them. This is the period between the referendum ending and, assuming the proposal was approved, the changes being enacted. For the first two ways that a referendum is launched, this is a fixed time. In Phala, it is 7 days. For the third type, it can be set as desired.\n\nEmergency proposals deal with major problems with the network that need to be \u201cfast-tracked\u201d. These will have a shorter enactment time.\n\n## Proposing a Referendum <a href=\"#proposing-a-referendum\" id=\"proposing-a-referendum\"></a>\n\n### **Public Referenda**\n\nAnyone can propose a referendum by depositing the minimum amount of PHA for a certain period (number of blocks). If someone agrees with the proposal, they may deposit the same amount of tokens to support it - this action is called _seconding_. The proposal with the highest amount of bonded support will be selected to be a referendum in the next voting cycle.\n\nNote that this may be different from the absolute number of seconds; for instance, three accounts bonding 20 PHA each would \u201coutweigh\u201d ten accounts bonding a single PHA each. The bonded tokens will be released once the proposal is tabled (that is, brought to a vote).\n\nThere can be a maximum of 100 public proposals in the proposal queue.\n\n### **Council Referenda**\n\nUnanimous Council - When all members of the council agree on a proposal, it can be moved to a referendum. This referendum will have a negative turnout bias (that is, the smaller the amount of stake voting, the smaller the amount necessary for it to pass - see \u201cAdaptive Quorum Biasing\u201d, below).\n\nMajority Council - When agreement from only a simple majority of council members occurs, the referendum can also be voted upon, but it will be majority-carries (51% wins).\n\nThere can only be one active referendum at any given time, except when there is also an emergency referendum in progress.\n\n### **Voting Timetable**\n\nEvery 7 days on Phala, a new referendum will come up for a vote, assuming there is at least one proposal in one of the queues. There is a queue for Council-approved proposals and a queue for publicly submitted proposals. The referendum to be voted upon alternates between the top proposal in the two queues.", "mimetype": "text/plain", "start_char_idx": 2414, "end_char_idx": 4651, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "30ecf36b-5153-4eb1-9713-ba7f720f3759": {"__data__": {"id_": "30ecf36b-5153-4eb1-9713-ba7f720f3759", "embedding": null, "metadata": {"file_path": "phala-docs_dist/governance-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f69a4042-cc29-416f-a18b-1c16470427db", "node_type": "4", "metadata": {}, "hash": "acf16d0aa5ee0c6b91dd336a31f4c2ce541ecdc201e5998ab44e783075f22df9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ddbc1ae9-2121-4286-93ec-112ce731dc14", "node_type": "1", "metadata": {}, "hash": "4039254934c0d78f9c1a5b3c8d53bc8fe6a0b60c91d1aabd9de3c3f5496d9708", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f49d18ad-f848-4689-8013-9b8af9b1c0f2", "node_type": "1", "metadata": {}, "hash": "c29a4b2ec034d20e267fe6c9c604ca9297232f6b9d756f3bd50892d078e3b712", "class_name": "RelatedNodeInfo"}}, "text": "The \u201ctop\u201d proposal is determined by the amount of stake bonded behind it. If the given queue whose turn it is to create a referendum that has no proposals (is empty), and proposals are waiting in the other queue, the top proposal in the other queue will become a referendum.\n\nMultiple referenda cannot be voted upon in the same period, excluding emergency referenda. An emergency referendum occurring at the same time as a regular referendum (either public- or council-proposed) is the only time that multiple referenda will be able to be voted on at once.\n\n### **Voting on a referendum**\n\nTo vote, a voter generally must lock their PHA up for at least the enactment delay period beyond the end of the referendum. This is to ensure that some minimal economic buy-in to the result is needed and to dissuade vote selling.\n\nIt is possible to vote without locking at all, but your vote is worth a small fraction of a normal vote, given your stake. At the same time, holding only a small amount of tokens does not mean that the holder cannot influence the referendum result, thanks to time-locking. You can read more about this at Voluntary Locking.\n\n```\nExample:\n\nPeter: Votes `No` with 10 PHA for a 32 week lock period  => 10 * 6 = 60 Votes\n\nLogan: Votes `Yes` with 20 PHA for a 2 week lock period => 20 * 2 = 40 Votes\n\nKevin: Votes `Yes` with 15 PHA for a 8 week lock period => 15 * 4 = 60 Votes\n```\n\nEven though combined both Logan and Kevin vote with more PHA than Peter, the lock period for both of them is less than Peter, leading to their voting power counting as less.\n\n### **Tallying**\n\nDepending on which entity proposed the proposal and whether all council members voted yes, there are three different scenarios. We can use the following table for reference.", "mimetype": "text/plain", "start_char_idx": 4653, "end_char_idx": 6418, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f49d18ad-f848-4689-8013-9b8af9b1c0f2": {"__data__": {"id_": "f49d18ad-f848-4689-8013-9b8af9b1c0f2", "embedding": null, "metadata": {"file_path": "phala-docs_dist/governance-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f69a4042-cc29-416f-a18b-1c16470427db", "node_type": "4", "metadata": {}, "hash": "acf16d0aa5ee0c6b91dd336a31f4c2ce541ecdc201e5998ab44e783075f22df9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "30ecf36b-5153-4eb1-9713-ba7f720f3759", "node_type": "1", "metadata": {}, "hash": "4a3690b44c9c7a410f3ce163bc4ae35a8a2b88823b8c00a42148eab58e614db1", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a18dbfe8-2ee2-414e-b6ef-6b50f84ca0b3", "node_type": "1", "metadata": {}, "hash": "be22a2187da7f5ef5a9bf566efa03668830dadc984d97e9454347015ab1a2160", "class_name": "RelatedNodeInfo"}}, "text": "|          **Entity**          |                   **Metric**                   |\n| :--------------------------: | :--------------------------------------------: |\n|            Public            | Positive Turnout Bias (Super-Majority Approve) |\n| Council (Complete agreement) | Negative Turnout Bias (Super-Majority Against) |\n| Council (Majority agreement) |                 Simple Majority                |\n\nAlso, we need the following information and apply one of the formulas listed below to calculate the voting result. For example, let\u2019s use the public proposal as an example, so the `Super-Majority Approve` formula will be applied. There is no strict quorum, but the super-majority required increases with lower turnout.\n\n```\napprove - the number of aye votes\n\nagainst - the number of nay votes\n\nturnout - the total number of voting tokens (does not include conviction)\n\nelectorate - the total number of PHA tokens issued in the network\n```\n\n### **Super-Majority Approve**\n\nA `positive turnout bias`, whereby a heavy super-majority of aye votes is required to carry at low turnouts, but as turnout increases towards 100%, it becomes a simple majority-carries as below.\n\n$$\n\\frac{against}{\\sqrt{turnout}} < \\frac{approve}{\\sqrt{electorate}}\n$$\n\n### **Super-Majority Against**\n\nA `negative turnout bias`, whereby a heavy super-majority of nay votes is required to reject at low turnouts, but as turnout increases towards 100%, it becomes a simple majority-carries as below.\n\n$$\n\\frac{against}{\\sqrt{electorate}} < \\frac{approve}{\\sqrt{turnout}}\n$$\n\n### **Simple-Majority**\n\nMajority-carries, a simple comparison of votes; if there are more aye votes than nay, then the proposal is carried, no matter how much stake votes on the proposal.\n\n$$\napprove > against\n$$\n\n```\nExample:\n\nAssume:\n- We only have 1,500 PHA tokens in total.\n- Public proposal\n\nJohn  - 500 PHA\nPeter - 100 PHA\nLilly - 150 PHA\nJJ    - 150 PHA\nKen   - 600 PHA", "mimetype": "text/plain", "start_char_idx": 6420, "end_char_idx": 8353, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a18dbfe8-2ee2-414e-b6ef-6b50f84ca0b3": {"__data__": {"id_": "a18dbfe8-2ee2-414e-b6ef-6b50f84ca0b3", "embedding": null, "metadata": {"file_path": "phala-docs_dist/governance-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f69a4042-cc29-416f-a18b-1c16470427db", "node_type": "4", "metadata": {}, "hash": "acf16d0aa5ee0c6b91dd336a31f4c2ce541ecdc201e5998ab44e783075f22df9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f49d18ad-f848-4689-8013-9b8af9b1c0f2", "node_type": "1", "metadata": {}, "hash": "c29a4b2ec034d20e267fe6c9c604ca9297232f6b9d756f3bd50892d078e3b712", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "7c7438bd-f6c6-426e-9dbd-e023092859d0", "node_type": "1", "metadata": {}, "hash": "3e15c92ac3466b8f123434da3e4a2a12b07b5c772cd62ab040058daea0e6a72f", "class_name": "RelatedNodeInfo"}}, "text": "John: Votes `Yes` for a 1 week lock period  => 500 * 1 = 500 Votes\n\nPeter: Votes `Yes` for a 1 week lock period => 100 * 1 = 100 Votes\n\nJJ: Votes `No` for a 4 week lock period => 150 * 3 = 450 Votes\n\napprove = 600\nagainst = 450\nturnout = 750\nelectorate = 1500\n```\n\n$$\n\\frac{450}{\\sqrt{750}} < \\frac{600}{\\sqrt{1500}}\n$$\n\n$$\n16.432 < 15.492\n$$\n\nSince the above example is a public referendum, `Super-Majority Approve` would be used to calculate the result. `Super-Majority Approve` requires more `aye` votes to pass the referendum when turnout is low, therefore, based on the above result, the referendum will be rejected. In addition, only the winning voter\u2019s tokens are locked. If the voters on the losing side of the referendum believe that the outcome will have negative effects, their tokens are transferable so they will not be locked into the decision. Moreover, winning proposals are autonomously enacted only after some enactment period.\n\n### **Voluntary Locking**\n\nPhala follows Polkadot\u2019s idea called `Voluntary Locking` which allows token holders to increase their voting power by declaring how long they are willing to lock up their tokens, hence, the number of votes for each token holder will be calculated by the following formula:\n\n```\nvotes = tokens * conviction_multiplier\n```\n\nThe conviction multiplier increases the vote multiplier by one every time the number of lock periods doubles.\n\n| Lock Periods | Vote Multiplier |\n| :----------: | :-------------: |\n|       0      |       0.1       |\n|       1      |        1        |\n|       2      |        2        |\n|       4      |        3        |\n|       8      |        4        |\n|      16      |        5        |\n|      32      |        6        |\n\nThe maximum number of \u201cdoublings\u201d of the lock period is set to 6 (and thus 32 lock periods in total), and one lock period equals 7 days on Phala.", "mimetype": "text/plain", "start_char_idx": 8356, "end_char_idx": 10224, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7c7438bd-f6c6-426e-9dbd-e023092859d0": {"__data__": {"id_": "7c7438bd-f6c6-426e-9dbd-e023092859d0", "embedding": null, "metadata": {"file_path": "phala-docs_dist/governance-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f69a4042-cc29-416f-a18b-1c16470427db", "node_type": "4", "metadata": {}, "hash": "acf16d0aa5ee0c6b91dd336a31f4c2ce541ecdc201e5998ab44e783075f22df9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a18dbfe8-2ee2-414e-b6ef-6b50f84ca0b3", "node_type": "1", "metadata": {}, "hash": "be22a2187da7f5ef5a9bf566efa03668830dadc984d97e9454347015ab1a2160", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "656f6b3d-ecbb-4021-9181-baf828f096e4", "node_type": "1", "metadata": {}, "hash": "2071c6079c664aae89444d989fdaf232da63242282a097c766b6cec0ac339367", "class_name": "RelatedNodeInfo"}}, "text": "Only doublings are allowed; you cannot lock for, say, 24 periods and increase your conviction by 5.5, for instance.\n\nWhile a token is locked, you can still use it for voting and staking; you are only prohibited from transferring these tokens to another account.\n\nVotes are still \u201ccounted\u201d at the same time (at the end of the voting period), no matter how long the tokens are locked.\n\n### **Adaptive Quorum Biasing**\n\nPhala follows the concept, \u201cAdaptive Quorum Biasing\u201d, which functions as a lever that the council can use to alter the effective super-majority required to make it easier or more difficult for a proposal to pass in the case that there is no clear majority of voting power backing it or against it.\n\n![img](https://wiki.polkadot.network/assets/images/adaptive-quorum-biasing-18c2e70b6b9d2c3abf563219b11974dc.png)\n\nLet\u2019s use the above image as an example.\n\nIf a publicly submitted referendum only has a 25% turnout, the tally of \u201caye\u201d votes has to reach 66% for it to pass since we applied `Positive Turnout Bias`.\n\nIn contrast, when it has a 75% turnout, the tally of \u201caye\u201d votes has to reach 54%, which means that the super-majority required decreases as the turnout increases.\n\nWhen the council proposes a new proposal through unanimous consent, the referendum would be put to a vote using \u201cNegative Turnout Bias\u201d. In this case, it is easier to pass this proposal with a low turnout and requires a super-majority to reject. As more token holders participate in voting, the bias approaches a plain majority carries.\n\nReferring to the above image, when a referendum only has a 25% turnout, the tally of \u201caye\u201d votes has to reach 34% for it to pass.\n\nIn short, when the turnout rate is low, a super-majority is required to reject the proposal, which means a lower threshold of \u201caye\u201d votes has to be reached, but as turnout increases towards 100%, it becomes a simple majority.\n\nAll three tallying mechanisms - majority carries, super-majority approve, and super-majority against - equate to a simple majority-carries system at 100% turnout.", "mimetype": "text/plain", "start_char_idx": 10225, "end_char_idx": 12279, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "656f6b3d-ecbb-4021-9181-baf828f096e4": {"__data__": {"id_": "656f6b3d-ecbb-4021-9181-baf828f096e4", "embedding": null, "metadata": {"file_path": "phala-docs_dist/governance-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f69a4042-cc29-416f-a18b-1c16470427db", "node_type": "4", "metadata": {}, "hash": "acf16d0aa5ee0c6b91dd336a31f4c2ce541ecdc201e5998ab44e783075f22df9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "7c7438bd-f6c6-426e-9dbd-e023092859d0", "node_type": "1", "metadata": {}, "hash": "3e15c92ac3466b8f123434da3e4a2a12b07b5c772cd62ab040058daea0e6a72f", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "46f36d43-ad4a-400c-a2b2-4fcac120e5a6", "node_type": "1", "metadata": {}, "hash": "404d985d7d1b1914d2cee6c4f81b045ffdbde76155515165257c9370da1498bd", "class_name": "RelatedNodeInfo"}}, "text": "## Council <a href=\"#council\" id=\"council\"></a>\n\nTo represent passive stakeholders, Phala introduces the idea of a \u201ccouncil\u201d. The council is an on-chain entity comprising several actors, each represented as an on-chain account. On Phala, the council currently consists of 5 members. This is expected to increase over the next few months to 11 seats. In general, the council will end up having a fixed number of seats.\n\nAlong with controlling the treasury, the council is called upon primarily for three tasks of governance: proposing sensible referenda, canceling uncontroversially dangerous or malicious referenda, and electing the technical committee.\n\nFor a referendum to be proposed by the council, a strict majority of members must be in favor, with no member exercising a veto. Vetoes may be exercised only once by a member for any single proposal; if, after a cool-down period, the proposal is resubmitted, they may not veto it a second time.\n\nCouncil motions that pass with a 3/5 (60%) super-majority - but without reaching unanimous support - will move to a public referendum under a neutral, majority-carries voting scheme. In the case that all members of the council vote in favor of a motion, the vote is considered unanimous and becomes a referendum with negative adaptive quorum biasing.\n\n### Canceling <a href=\"#canceling\" id=\"canceling\"></a>\n\nA proposal can be canceled if the technical committee unanimously agrees to do so, or if Root origin (e.g. sudo) triggers this functionality. A canceled proposal\u2019s deposit is burned.\n\nAdditionally, a two-thirds majority of the council can cancel a referendum. This may function as a last-resort if there is an issue found late in a referendum\u2019s proposal such as a bug in the parameter configuration of the on-chain call to be executed is incorrect.\n\nIf the cancellation is controversial enough that the council cannot get a two-thirds majority, then it will be left to the stakeholders _en masse_ to determine the fate of the proposal.\n\n### Blacklisting <a href=\"#blacklisting\" id=\"blacklisting\"></a>\n\nA proposal can be blacklisted by Root origin (e.g. sudo). A blacklisted proposal and its related referendum (if any) are immediately canceled. Additionally, a blacklisted proposal\u2019s hash cannot re-appear in the proposal queue.", "mimetype": "text/plain", "start_char_idx": 12281, "end_char_idx": 14568, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "46f36d43-ad4a-400c-a2b2-4fcac120e5a6": {"__data__": {"id_": "46f36d43-ad4a-400c-a2b2-4fcac120e5a6", "embedding": null, "metadata": {"file_path": "phala-docs_dist/governance-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f69a4042-cc29-416f-a18b-1c16470427db", "node_type": "4", "metadata": {}, "hash": "acf16d0aa5ee0c6b91dd336a31f4c2ce541ecdc201e5998ab44e783075f22df9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "656f6b3d-ecbb-4021-9181-baf828f096e4", "node_type": "1", "metadata": {}, "hash": "2071c6079c664aae89444d989fdaf232da63242282a097c766b6cec0ac339367", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "fd6d06aa-9464-4bdf-aecf-fdd659c3fba5", "node_type": "1", "metadata": {}, "hash": "faf81210f326248f4c24120eaf0f62d9fab235e6b3149a615c4337a49278400e", "class_name": "RelatedNodeInfo"}}, "text": "Blacklisting is useful when removing erroneous proposals that could be submitted with the same hash, i.e.proposal #2 in which the submitter used plain text to make a suggestion.\n\nUpon seeing their proposal removed, a submitter who is not properly introduced to the democracy system of Phala might be tempted to re-submit the same proposal. That said, this is far from a fool-proof method of preventing invalid proposals from being submitted - a single changed character in a proposal\u2019s text will also change the hash of the proposal, rendering the per-hash blacklist invalid.\n\n### How to be a council member? <a href=\"#how-to-be-a-council-member\" id=\"how-to-be-a-council-member\"></a>\n\n![](https://i.imgur.com/A3iCGJ0.png)\n\nAll stakeholders are free to signal their approval of any of the registered candidates.\n\nCouncil elections are handled by the same Phragm\u00e9n election process that selects validators from the available pool based on nominations. However, token holders' votes for councillors are isolated from any of the nominations they may have on validators. Council terms last for one week on Phala.\n\nAt the end of each term, Phragm\u00e9n election algorithm runs and the result will choose the new councillors based on the vote configurations of all voters. The election also chooses a set number of runners up (currently 10 on Phala) that will remain in the queue with their votes intact.\n\nAs opposed to a \u201cfirst-past-the-post\u201d electoral system, where voters can only vote for a single candidate from a list, a Phragm\u00e9n election is a more expressive way to include each voter\u2019s views. Token holders can treat it as a way to support as many candidates as they want. The election algorithm will find a fair subset of the candidates that most closely match the expressed indications of the electorate as a whole.\n\nLet\u2019s take a look at the example below.", "mimetype": "text/plain", "start_char_idx": 14569, "end_char_idx": 16424, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "fd6d06aa-9464-4bdf-aecf-fdd659c3fba5": {"__data__": {"id_": "fd6d06aa-9464-4bdf-aecf-fdd659c3fba5", "embedding": null, "metadata": {"file_path": "phala-docs_dist/governance-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f69a4042-cc29-416f-a18b-1c16470427db", "node_type": "4", "metadata": {}, "hash": "acf16d0aa5ee0c6b91dd336a31f4c2ce541ecdc201e5998ab44e783075f22df9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "46f36d43-ad4a-400c-a2b2-4fcac120e5a6", "node_type": "1", "metadata": {}, "hash": "404d985d7d1b1914d2cee6c4f81b045ffdbde76155515165257c9370da1498bd", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b9233951-7fb8-4bd9-96b9-1ceafdaa951e", "node_type": "1", "metadata": {}, "hash": "ef2beec581d414135cb38b9cee1184083c3933038ddc0005670e2a8a13c09f35", "class_name": "RelatedNodeInfo"}}, "text": "| Round 1           |   |                |   |   |   |\n| ----------------- | - | -------------- | - | - | - |\n| **Token Holders** |   | **Candidates** |   |   |   |\n|                   | A | B              | C | D | E |\n| Peter             | X |                | X | X | X |\n| Alice             |   | X              |   |   |   |\n| Bob               |   |                | X | X | X |\n| Kelvin            | X |                | X |   |   |\n| **Total**         | 2 | 1              | 3 | 2 | 2 |\n\nThe above example shows that candidate C wins the election in round 1, while candidates A, B, D & E keep remaining on the candidates' list for the next round.\n\n| Round 2           |   |                |   |   |\n| ----------------- | - | -------------- | - | - |\n| **Token Holders** |   | **Candidates** |   |   |\n|                   | A | B              | D | E |\n| Peter             | X | X              |   |   |\n| Alice             | X | X              |   |   |\n| Bob               | X | X              | X | X |\n| Kelvin            | X | X              |   |   |\n| **Total**         | 4 | 4              | 1 | 1 |\n\nFor the top-N (say 4 in this example) runners-up, they can remain and their votes persist until the next election. After round 2, even though candidates A & B get the same number of votes in this round, candidate A gets elected because after adding the older unused approvals, it is higher than B.\n\nThis is a temporary governance configuration for the initial phase of Phala. If any security vulnerabilities are found after a third-party audit, it will be changed. Further changes can be made through on-chain governance.\n\n### Prime Members <a href=\"#prime-members\" id=\"prime-members\"></a>\n\nThe council, being an instantiation of Substrate\u2019s Collective pallet, implements what\u2019s called a _prime member_ whose vote acts as the default for other members that fail to vote before the timeout.\n\nThe prime member is chosen based on a Borda count.", "mimetype": "text/plain", "start_char_idx": 16426, "end_char_idx": 18383, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b9233951-7fb8-4bd9-96b9-1ceafdaa951e": {"__data__": {"id_": "b9233951-7fb8-4bd9-96b9-1ceafdaa951e", "embedding": null, "metadata": {"file_path": "phala-docs_dist/governance-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f69a4042-cc29-416f-a18b-1c16470427db", "node_type": "4", "metadata": {}, "hash": "acf16d0aa5ee0c6b91dd336a31f4c2ce541ecdc201e5998ab44e783075f22df9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "fd6d06aa-9464-4bdf-aecf-fdd659c3fba5", "node_type": "1", "metadata": {}, "hash": "faf81210f326248f4c24120eaf0f62d9fab235e6b3149a615c4337a49278400e", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "eba9387a-deed-4725-8463-0d312cb899da", "node_type": "1", "metadata": {}, "hash": "ba39c56754c10faed30163160509555e27fc9231a83aeb60d58ce95b79aa583f", "class_name": "RelatedNodeInfo"}}, "text": "The purpose of having a prime member of the council is to ensure a quorum, even when several members abstain from a vote. Council members might be tempted to vote a \u201csoft rejection\u201d or a \u201csoft approval\u201d by not voting and letting the others vote. With the existence of a prime member, it forces Councillors to be explicit in their votes or have their vote counted for whatever is voted on by the prime.\n\n## Technical Committee <a href=\"#technical-committee\" id=\"technical-committee\"></a>\n\nThe Technical Committee was introduced in the Phala rollout and governance post as one of the three chambers of Phala governance (along with the Council and the Referendum chamber). The Technical Committee is composed of the teams that have successfully implemented or specified either a Phala parachain or Phala Host. Teams are added or removed from the Technical Committee via a simple majority vote of the Council.\n\nThe Technical Committee can, along with the Council, produce emergency referenda, which are fast-tracked for voting and implementation. These are used for emergency bug fixes or rapid implementation of new but battle-tested features into the Phala parachain.\n\nFast-tracked referenda are the only type of referenda that can be active alongside another active referendum. Thus, with fast-tracked referenda, it is possible to have two active referendums at the same time. Voting on one does not prevent a user from voting on the other.\n\n## Frequently Asked Questions <a href=\"#frequently-asked-questions\" id=\"frequently-asked-questions\"></a>\n\n### How can I appeal to the council to enact a change on my behalf? <a href=\"#how-can-i-appeal-to-the-council-to-enact-a-change-on-my-behalf\" id=\"how-can-i-appeal-to-the-council-to-enact-a-change-on-my-behalf\"></a>\n\nIn some circumstances, you may want to appeal to the on-chain council to enact a change on your behalf. One example of this circumstance is the case of lost or locked funds when the funds were lost due to a human interface error (such as inputting an address for another network). When these circumstances can be proven beyond a reasonable doubt to be an error, the council _may_ consider a governance motion to correct it.\n\nThe first step to appeal to the council is to get in contact with the councillors.", "mimetype": "text/plain", "start_char_idx": 18385, "end_char_idx": 20655, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "eba9387a-deed-4725-8463-0d312cb899da": {"__data__": {"id_": "eba9387a-deed-4725-8463-0d312cb899da", "embedding": null, "metadata": {"file_path": "phala-docs_dist/governance-mechanism.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "f69a4042-cc29-416f-a18b-1c16470427db", "node_type": "4", "metadata": {}, "hash": "acf16d0aa5ee0c6b91dd336a31f4c2ce541ecdc201e5998ab44e783075f22df9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b9233951-7fb8-4bd9-96b9-1ceafdaa951e", "node_type": "1", "metadata": {}, "hash": "ef2beec581d414135cb38b9cee1184083c3933038ddc0005670e2a8a13c09f35", "class_name": "RelatedNodeInfo"}}, "text": "There is no singular place where you are guaranteed to grab every councillor\u2019s ear with your message. However, there are a handful of good places to start where you can get the attention of some of them. The Phala Forum is one such place. After creating an account and joining this room, you can post a well-thought-through message here that lays down your case and provides justification for why you think the council should consider enacting a change to the protocol on your behalf.\n\nAt some points you will likely need a place for a longer-form discussion. For this, making a [post](https://khala.polkassembly.network/onchain) on [Khala\u2019s Polkassembly](https://khala.polkassembly.network/onchain) is the recommended place to do so. When you write a post on Polkassembly make sure you present all the evidence for your circumstances and state clearly what kind of change you would suggest to the councillors to enact. Remember - the councillors do not need to make the change, it is your responsibility to make a strong case for why the change should be made.", "mimetype": "text/plain", "start_char_idx": 20656, "end_char_idx": 21717, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4b412cc4-6143-4f0a-ae61-78817c73fbe1": {"__data__": {"id_": "4b412cc4-6143-4f0a-ae61-78817c73fbe1", "embedding": null, "metadata": {"file_path": "phala-docs_dist/how-mirrored-price-feeds-work.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "eea0255c-244d-4afe-8aff-a6da2fbcb193", "node_type": "4", "metadata": {}, "hash": "e6016b74597ee879e834ce53c6f6dcb1056912c5e7f18903a9f98fefff60b4fe", "class_name": "RelatedNodeInfo"}}, "text": "# How Mirrored Price Feeds Work\n\n<figure><img src=\"../../../.gitbook/assets/image (1) (1) (1).png\" alt=\"\"><figcaption></figcaption></figure>", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 140, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "4aca5d8d-2737-4695-8e90-fcd3da7b7e00": {"__data__": {"id_": "4aca5d8d-2737-4695-8e90-fcd3da7b7e00", "embedding": null, "metadata": {"file_path": "phala-docs_dist/phala-agent-gateway.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "4741a496-f709-4f91-a32b-b5be79e9d70c", "node_type": "4", "metadata": {}, "hash": "80513acbb0edcb98487870fbbb6c9266143ae3d9cf67bb8b393b3ab6f302c944", "class_name": "RelatedNodeInfo"}}, "text": "# Phala Agent Gateway\n\nThe Phala Agent Gateway is a solution that converts typical HTTP request into AI Agent Contract requests to execute in a decentralized TEE node on Phala Network.\n\n|                 | SideVM QuickJS                           | WapoJS (Latest)                                |\n| --------------- | ---------------------------------------- | ---------------------------------------------- |\n| **Gateway URL** | https://agents.phala.network/ipfs/\\<CID> | https://wapo-testnet.phala.network/ipfs/\\<CID> |", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 521, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "857f7064-c693-41c6-98df-41eb13fcc493": {"__data__": {"id_": "857f7064-c693-41c6-98df-41eb13fcc493", "embedding": null, "metadata": {"file_path": "phala-docs_dist/get-pha-and-transfer.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "64788d25-398a-4de0-a87b-bc8a44364a36", "node_type": "4", "metadata": {}, "hash": "7b3cb528e43bf51432e0c0223438a6997270f9ee308dd83a18f50c090e4a1d29", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "320a208f-3d96-46c5-93b9-a03e5f088328", "node_type": "1", "metadata": {}, "hash": "93cbe9f0d7e0253e7ba11bb2dcc6c4800143777473099877b01ee99d841e4231", "class_name": "RelatedNodeInfo"}}, "text": "# Acquiring PHA\n\nPHA token is the native token of Phala Network. Its uses include paying gas fees on the blockchain, performing governance, and staking. To learn more about PHA's uses and utility, head to the [PHA Token](../../overview/pha-token/) section of the docs.\n\n## Get your Phala Tokens (PHA) <a href=\"#get-your-phala-tokens-pha\" id=\"get-your-phala-tokens-pha\"></a>\n\nIf you do not hold any PHA, you can purchase PHA from any of the following exchanges:\n\n* <img src=\"../../.gitbook/assets/1-Binance.png\" alt=\"\" data-size=\"line\"> [Binance](https://www.binance.com/en)\n* <img src=\"../../.gitbook/assets/kraken.jpeg\" alt=\"\" data-size=\"line\"> [Kraken](https://www.kraken.com/prices/pha-phala-price-chart/eur-euro?interval=1m)\n* <img src=\"../../.gitbook/assets/3-OKEx.png\" alt=\"\" data-size=\"line\"> [OKEX](https://www.okex.com/trade-spot/pha-usdt)\n* <img src=\"../../.gitbook/assets/2-Huobi.png\" alt=\"\" data-size=\"line\"> [Huobi](https://www.huobi.com/en-us/exchange/pha\\_usdt)\n* <img src=\"../../.gitbook/assets/4-KuCoin.png\" alt=\"\" data-size=\"line\"> [Kucoin](https://trade.kucoin.com/PHA-USDT)\n* <img src=\"../../.gitbook/assets/7-Gate.png\" alt=\"\" data-size=\"line\"> [Gate.io](https://www.gate.io/trade/PHA\\_USDT)\n\n> Not all brokers may be available in your jurisdiction. Note that some brokers require you to have an account with them for a certain period before you can transfer your funds to another wallet, such as the [Khala Wallet](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkhala-api.phala.network%2Fws#/accounts).", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1522, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "320a208f-3d96-46c5-93b9-a03e5f088328": {"__data__": {"id_": "320a208f-3d96-46c5-93b9-a03e5f088328", "embedding": null, "metadata": {"file_path": "phala-docs_dist/get-pha-and-transfer.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "64788d25-398a-4de0-a87b-bc8a44364a36", "node_type": "4", "metadata": {}, "hash": "7b3cb528e43bf51432e0c0223438a6997270f9ee308dd83a18f50c090e4a1d29", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "857f7064-c693-41c6-98df-41eb13fcc493", "node_type": "1", "metadata": {}, "hash": "79b7d565ee583eaf41e46d89ed7b6a75f0678d549e044b156e9253247f57a204", "class_name": "RelatedNodeInfo"}}, "text": "## Transfer PHA to and from Other Chains <a href=\"#transfer-pha-fromto-other-chains\" id=\"transfer-pha-fromto-other-chains\"></a>\n\nFor now, you can transfer your PHA between Ethereum, Khala, and Phala, as well as several other Parachains with [SubBridge](../subbridge/). Refer to the introduction and our tutorial for more details.", "mimetype": "text/plain", "start_char_idx": 1524, "end_char_idx": 1853, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "2e74da85-e58f-405b-8c77-66d176f820af": {"__data__": {"id_": "2e74da85-e58f-405b-8c77-66d176f820af", "embedding": null, "metadata": {"file_path": "phala-docs_dist/use-pink-extension.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a38b05ca-bb2b-48c1-8e4b-efacd0326334", "node_type": "4", "metadata": {}, "hash": "7361ceb73be4b6929d937766cf5e0ce04553af4c93f10d5bb3efb27930c75c28", "class_name": "RelatedNodeInfo"}}, "text": "# Use Pink Extension\n\n### Introduction <a href=\"#introduction\" id=\"introduction\"></a>\n\nAll the unique capabilities of Phat Contract are implemented in [pink-extension](https://github.com/Phala-Network/phala-blockchain/tree/master/crates/pink). Informally speaking:\n\n$$\nPhat\\ Contract = ink! + Pink\\ Extension\n$$\n\nIt is worth noting that the Phat Contract is not a trivial extension of ink! contract since all these extra functions only work under the off-chain computation.\n\n### Pink Extension Functions <a href=\"#pink-extension-functions\" id=\"pink-extension-functions\"></a>\n\n| Functionality   | Function Name            | Query Support | Transaction Support |\n| --------------- | ------------------------ | ------------- | ------------------- |\n| Internet Access | http\\_request            | \u2705             | \u274c                   |\n| Crypto          | getrandom                | \u2705             | \u274c                   |\n|                 | ecdsa\\_sign\\_prehashed   | \u2705             | \u2705                   |\n|                 | ecdsa\\_verify\\_prehashed | \u2705             | \u2705                   |\n|                 | sign (ecdsa/ed25519)     | \u2705             | \u2705                   |\n|                 | sign (sr25519)           | \u2705             | \u274c                   |\n|                 | verify                   | \u2705             | \u2705                   |\n|                 | derive\\_sr25519\\_key     | \u2705             | \u2705                   |\n|                 | get\\_public\\_key         | \u2705             | \u2705                   |\n| Volatile Cache  | cache\\_set               | \u2705             | \u2705                   |\n|                 | cache\\_set\\_expire       | \u2705             | \u2705                   |\n|                 | cache\\_get               | \u2705             | \u274c                   |\n|                 | cache\\_remove            | \u2705             | \u2705                   |\n| Misc            | log                      | \u2705             | \u2705                   |\n|                 | is\\_running\\_in\\_command | \u2705             | \u2705                   |\n\nRefer to our [Phat Hello World](https://github.com/Phala-Network/phat-hello/blob/master/lib.rs) contract to see how you can import these functions to your contract.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2186, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "46f6040e-650f-4a59-85fc-172911ef93b5": {"__data__": {"id_": "46f6040e-650f-4a59-85fc-172911ef93b5", "embedding": null, "metadata": {"file_path": "phala-docs_dist/update-your-workers-node.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "fb17f80e-bb9b-4278-811e-5bf63ff7ea5f", "node_type": "4", "metadata": {}, "hash": "00726ec9face0bde828881098d0e3dc81b0e5230f7e025cbb4831df08837a78c", "class_name": "RelatedNodeInfo"}}, "text": "# Update your Worker's Node\n\nTo upgrade your worker requires it to stop first.\n\n```\nsudo phala stop\n```\n\nThe worker node can be updated in a clean way which removes all the saved data\n\n```\nsudo phala update clean\n```\n\nor with the data preserved\n\n```\nsudo phala update\n```\n\nFinally, restart your worker with:\n\n```\nsudo phala start\n```", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 333, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ea542a50-86c8-4f74-84f7-b1ba25502055": {"__data__": {"id_": "ea542a50-86c8-4f74-84f7-b1ba25502055", "embedding": null, "metadata": {"file_path": "phala-docs_dist/whats-share.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "36b6256c-a79a-47a5-9c5e-3ed62ef954a1", "node_type": "4", "metadata": {}, "hash": "48b33ae9f8f7bfa3261f9fb8618e03611fdfcc5f832a47dbe6b15b376f8a3e7b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ec181a28-cd67-4266-92da-5de2f61dbac6", "node_type": "1", "metadata": {}, "hash": "d2163fa1c01e1a0464a5e55fb95154b162f5de377d5fc4e15870850d4c842077", "class_name": "RelatedNodeInfo"}}, "text": "# What is Share\n\nHere is a universal concept in the Stakepool and Vault: **Share**\n\nA user\u2019s \u2018Share\u2019 is a conversion unit that records the ratio of their contribution to a given pool. When delegator rewards are distributed, the rewards are evenly distributed to each Share to realize the distribution of rewards to each delegation in the Stakepool.\n\n## Share has a Price\n\nPrice means \u201cHow much PHA is worth for each Share\u201d, A \u2018unit price\u2019 refers to the total value of your share of PHA in a pool.\n\nPrice = Total Value / Total Share\n\n* Total Value: How many PHAs (delegation) are there in the pool:\n* Total Share: How many Shares are there in the pool:\n\nTwo values above of the pool ( either Stakepool or Vault) will be stored on chain. Therefore, Share in different pools have different price.\n\nPrice will not be impacted by withdrawals or the actions of delegates. Fluctuations will only occur due to slashing and the allocation of rewards in the pool. Please note slashing is not currently active.\n\nWhen rewards are allocated, the total delegation of the pool will increase, but the shares will not change, thus the price of each Share will rise. Likewise, slash will cause the share price to decrease.\n\n## How Share Changes\n\nOnly two factors can affect shares, delegations and withdrawals.\n\nThe change of Share will only happen when the user delegates or withdraws from the pool, and when different delegators delegate to the pool respectively, it will change the proportion of delegations owned by delegators in the pool by continuously issuing shares. When the delegators want to withdraw the delegation, it will withdraw the corresponding PHA from the pool to the delegators through the real-time share price.\n\nDespite one exception, Vault shares will be issued when Vault owners receive their rewards, at which point the shares will also increase.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1854, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ec181a28-cd67-4266-92da-5de2f61dbac6": {"__data__": {"id_": "ec181a28-cd67-4266-92da-5de2f61dbac6", "embedding": null, "metadata": {"file_path": "phala-docs_dist/whats-share.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "36b6256c-a79a-47a5-9c5e-3ed62ef954a1", "node_type": "4", "metadata": {}, "hash": "48b33ae9f8f7bfa3261f9fb8618e03611fdfcc5f832a47dbe6b15b376f8a3e7b", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ea542a50-86c8-4f74-84f7-b1ba25502055", "node_type": "1", "metadata": {}, "hash": "3e3a96221345cf8034d29f295fc2b1ca1e518dd28ec71a1d164858a33a5321c6", "class_name": "RelatedNodeInfo"}}, "text": "[Learn more about Vault](whats-vault.md)\n\nHere is an example:\n\n| Action                           | Delegation in Vault | Total Share | Share price | remarks                                             |\n| -------------------------------- | ------------------- | ----------- | ----------- | --------------------------------------------------- |\n| Tom Create the Vault #001        | 0                   | 0           | 1           | The initial price is 1                              |\n| Bob delegates 10000 $PHA in #001 | 10000               | 10000       | 1           | Bob has 1000 Shares                                 |\n| #001 earned 50 $PHA rewards      | 10050               | 10000       | 1.005       | Bob still has 1000 Shares                           |\n| Jack delegates 3000 $PHA in #001 | 13050               | 12985.07    | 1.005       | Jack has 2,985.07 shares because the price is 1.005 |\n| Tom execute the commission(5%)   | 13050               | 12988.3     | 1.00475     | Tom got 3.23 Shares as the Vault owner reward       |", "mimetype": "text/plain", "start_char_idx": 1855, "end_char_idx": 2904, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d5ef7692-7ed0-4002-b39e-5f37cc0b8e9b": {"__data__": {"id_": "d5ef7692-7ed0-4002-b39e-5f37cc0b8e9b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/supported-chains.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "505f830c-3cc9-4fe4-8b3a-ec184bc0aaae", "node_type": "4", "metadata": {}, "hash": "ab084365bc6d3f34471aed9bef4ae57e703e8f5b71f4da67fb3f9336d2102968", "class_name": "RelatedNodeInfo"}}, "text": "# \u26d3\ufe0f Supported Chains\n\nAI Agent Contract can technically connect to any blockchain for reading and writing operations, as it can effortlessly read from arbitrary blockchain nodes and trigger signed transactions via RPC calls. However, in practice, supporting a specific blockchain requires the corresponding AI Agent Contract RPC client, serialization library, and signing library to facilitate read and write operations. Presently, EVM and Substrate blockchains have more extensive library support.\n\n## EVM Blockchains\n\nAt the Native AI Agent Contract level, it is possible to interact with any EVM-compatible blockchains through their RPC nodes, including:\n\n* Ethereum\n* Polygon\n* Arbitrum\n* BSC\n* Optimism\n* Base\n* any other EVM-compatible blockchains\n\nLearn more in the advanced topic section.\n\n## Substrate Blockchains\n\nNative AI Agent Contract fully supports Substrate-based blockchains, including:\n\n* Polkadot\n* Kusama\n* Phala Network\n* Astar\n* any other Substrate-based blockchains\n\nYou can learn more about AI Agent Contract's cross-chain capabilities and how to implement them in the advanced topics section:\n\n[cross-chain-solutions.md](../references/advanced-topics/cross-chain-solutions.md \"mention\")\n\n## Expanding Support to Additional Blockchains\n\nSupporting additional blockchains does not necessitate any changes to Phala Network's infrastructure. Developers can independently implement their RPC client, serialization, and signing libraries in Native AI Agent Contract and share them with the community.\n\nThe following blockchains are expected to receive support soon:\n\n* Cosmos-based blockchains\n* Solana\n* Move-based blockchains\n\nLet us know which blockchain you would like to see supported in the `#ai-agent-contract` channel on our [Discord server](https://discord.gg/phala-network).", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1804, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "9124bb8e-1069-4f1e-8fbf-02dd25f9963c": {"__data__": {"id_": "9124bb8e-1069-4f1e-8fbf-02dd25f9963c", "embedding": null, "metadata": {"file_path": "phala-docs_dist/worker-rewards.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2", "node_type": "4", "metadata": {}, "hash": "7d077d9a6befec03a5bbbc286c29c6fa9d802987bed5169424bd6450abc102ff", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "693e7439-3e6e-4d27-b05e-8c8d2cb7dad9", "node_type": "1", "metadata": {}, "hash": "c80ea0a95652a8a6a00c211573617fcb35cfe71295644e5203e02f2d088dbeb7", "class_name": "RelatedNodeInfo"}}, "text": "# Gemini Tokenomics (Worker Rewards)\n\nThis document contains the _Supply-end Tokenomics_ for Phala Network, which defines how workers get their rewards by sharing the computing power.\n\nTo read about how Demand-end users can stake PHA to use the network, see [Stake to Compute](staking-mechanism.md).\n\n> After the approval of the \u201cGemini Tokenomics upgrade\" democratic referendum on the block height #1,467,069, we have updated the content of the Supply-end Tokenomics as follows:\n\n## Design Targets <a href=\"#design-targets\" id=\"design-targets\"></a>\n\nThe overall economic design is built to address these points:\n\n1. Support Phala Network\u2019s trustless cloud computing architecture\n   * Consensus-Computation Separation\n   * Linearly-scalable computing workers (100k order of magnitude number of workers)\n2. Incentivize workers to join the network\n   * Ensure payment for power supplied irrespective of demand, especially at network bootstrap\n   * Subsidize mining pool with 70% of the initial supply over time\n   * Bitcoin-like budget halving schedule\n   * Power the Phala and Khala at the same time\n3. Application pricing\n4. On-chain performance\n\nThe following details some key elements of the economic model.\n\n## Overall Design <a href=\"#overall-design\" id=\"overall-design\"></a>\n\n### Related Workers\n\nPhala Supply-end Tokenomics applies to any workers running on Phala or Khala.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1379, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "693e7439-3e6e-4d27-b05e-8c8d2cb7dad9": {"__data__": {"id_": "693e7439-3e6e-4d27-b05e-8c8d2cb7dad9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/worker-rewards.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2", "node_type": "4", "metadata": {}, "hash": "7d077d9a6befec03a5bbbc286c29c6fa9d802987bed5169424bd6450abc102ff", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "9124bb8e-1069-4f1e-8fbf-02dd25f9963c", "node_type": "1", "metadata": {}, "hash": "524d26d8fcc943d2ce558801ef292c0d5b5e26c29899895c86c343e5179fcd6b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "65d85a16-25b8-472b-a89e-d07c51062250", "node_type": "1", "metadata": {}, "hash": "7f801c1ac94e65d8883affcda8b39c713516487f468431f5708fd26cfb5dbb41", "class_name": "RelatedNodeInfo"}}, "text": "### Value Promise $$(V)$$ <a href=\"#value-promise-v\" id=\"value-promise-v\"></a>\n\n* A virtual score for an individual worker representing value earned which is payable in the future, to motivate workers to behave honestly and reliably\n* Equal to the expected value of the revenues earned by the worker for providing power for the platform\n* Changes dynamically based on the worker\u2019s behaviors and the repayment of Rewards\n  * Mining honestly: $$V$$ grows gradually over time\n  * Harmful conduct: punished by reduction of $$V$$\n\n### Initial $$V$$ <a href=\"#initial-v\" id=\"initial-v\"></a>\n\nA Worker will run a _**Performance Test**_ and stake some tokens to get the initial $$V$$:\n\n$$\nV^e = f(R^e, \\text{ConfidenceScore}) \\times (S + C)\n$$\n\n* $$R^e > 1$$ is a _**Stake Multiplier**_ set by the network (Khala or Phala).\n* $$S$$ is the worker stake; a _**Minimum Stake**_ is required to start mining. The stake can\u2019t be increased or decreased while mining, but can be set higher than the Minimum.\n* $$C$$ is the estimated cost of the worker rigs, inferred from the _**Performance Test**_.\n* $$\\text{ConfidenceScore}$$ is based on the worker\u2019s Intel\u00a9 SGX capabilities.\n* $$f(R^e, \\text{ConfidenceScore}) = 1 + (\\text{ConfidenceScore} \\cdot (R^e - 1))$$\n* $$V$$ is always less than or equals to $$V_{max}$$.", "mimetype": "text/plain", "start_char_idx": 1381, "end_char_idx": 2681, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "65d85a16-25b8-472b-a89e-d07c51062250": {"__data__": {"id_": "65d85a16-25b8-472b-a89e-d07c51062250", "embedding": null, "metadata": {"file_path": "phala-docs_dist/worker-rewards.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2", "node_type": "4", "metadata": {}, "hash": "7d077d9a6befec03a5bbbc286c29c6fa9d802987bed5169424bd6450abc102ff", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "693e7439-3e6e-4d27-b05e-8c8d2cb7dad9", "node_type": "1", "metadata": {}, "hash": "c80ea0a95652a8a6a00c211573617fcb35cfe71295644e5203e02f2d088dbeb7", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "90a02b35-b256-46d5-8d9d-c792a2d119f9", "node_type": "1", "metadata": {}, "hash": "c591123cff47f5b6d819940ee03b3f87e04bcc2d580e4a627ae65a28393220ab", "class_name": "RelatedNodeInfo"}}, "text": "Params used in simulation:\n\n* $$R^e_{\\text{Phala}} =R^e_{\\text{Khala}} = 1.5$$\n* $$\\text{ConfidenceScore}$$ for different Confidence Levels\n  * $$\\text{ConfidenceScore}_{1,2,3} = 1$$\n  * $$\\text{ConfidenceScore}_{4} = 0.8$$\n  * $$\\text{ConfidenceScore}_{5} = 0.7$$\n* $$V_{max} = 30000$$\n\n### Performance Test <a href=\"#performance-test\" id=\"performance-test\"></a>\n\nA performance test measures how much computation can be done in a unit of time:\n\n$$\nP = \\frac{\\text{Iterations}}{\\Delta t}\n$$\n\nFor reference,\n\n| Platform               | Cores | Score | Approximate Price |\n| ---------------------- | ----- | ----- | ----------------- |\n| Low-End Celeron        | 4     | 450   | $150              |\n| Intel Xeon E Processor | 6     | 1900  | $500              |\n| Mid-End i5 10-Gen      | 8     | 2000  | $500              |\n| High-End i9 9-Gen      | 10    | 2800  | $790              |\n\n> The table is based on the version while writing of this documentation and is subject to changes.\n\nThe performance test will be performed:\n\n1. **Before mining** to determine the _**Minimum Stake**_\n2.", "mimetype": "text/plain", "start_char_idx": 2683, "end_char_idx": 3771, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "90a02b35-b256-46d5-8d9d-c792a2d119f9": {"__data__": {"id_": "90a02b35-b256-46d5-8d9d-c792a2d119f9", "embedding": null, "metadata": {"file_path": "phala-docs_dist/worker-rewards.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2", "node_type": "4", "metadata": {}, "hash": "7d077d9a6befec03a5bbbc286c29c6fa9d802987bed5169424bd6450abc102ff", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "65d85a16-25b8-472b-a89e-d07c51062250", "node_type": "1", "metadata": {}, "hash": "7f801c1ac94e65d8883affcda8b39c713516487f468431f5708fd26cfb5dbb41", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "8944e966-4884-4e58-a394-59595de8ec5f", "node_type": "1", "metadata": {}, "hash": "6dca44f3be4af235cb5ba6062c8dd58131c7e735043e8a15e4ede77f6bca65bc", "class_name": "RelatedNodeInfo"}}, "text": "**During mining** to measure the current performance, and to adjust the $V$ increment dynamically\n\n### Minimum Stake <a href=\"#minimum-stake\" id=\"minimum-stake\"></a>\n\n$$\nS_{min}=k \\sqrt{P}\n$$\n\n* $$P$$ - _**Performance Test**_ score\n* $$k$$ - adjustable multiplier factor\n\nProposed parameter:\n\n* $$k_{\\text{Phala}} =k_{\\text{Khala}} = 50$$\n\n> Locked state $PHA token can also be used for mining staking, e.g., Khala Crowdloan reward\n\n### Cost <a href=\"#cost\" id=\"cost\"></a>\n\n$$\nC = \\frac{0.3 P}{\\phi}\n$$\n\n* $$\\phi$$ is the current PHA/USD quote, dynamically updated on-chain via Oracles\n* $$P$$ is the initial _**Performance Test**_ score.\n* In the early stages, we are compensating the equipment cost $$C$$ with a higher Value Promise.\n* In the future, we plan to compensate for higher amortization costs (adding equipment amortization cost to the running costs $$c^i$$ and $$c^a$$), thus increasing the speed of growth of the Worker\u2019s $$V$$.\n\n### General mining process <a href=\"#general-mining-process\" id=\"general-mining-process\"></a>\n\n![](https://i.imgur.com/IpEnlGR.png)\n\n![](https://i.imgur.com/zKWAI1S.png)\n\nEach individual\u2019s $$V$$ is updated at every block:\n\n* Increased by $$\\Delta V_t$$ if the worker keeps mining\n* Decreased by $$w(V_t)$$ if the worker got a payout\n* Decreased according to the _**Slash Rules**_ if the worker misbehaves\n\nWhen a worker gets a payout $$w(V_t)$$, they will receive the amount immediately in their Phala wallet. The payout follows _**Payout Schedule**_ and cannot exceed the _**Subsidy Budget**_.\n\nFinally, once the worker decides to stop mining, they will wait for a Cooling Down period $\\delta$. They will receive an one-time final payout after the cooldown.", "mimetype": "text/plain", "start_char_idx": 3772, "end_char_idx": 5474, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "8944e966-4884-4e58-a394-59595de8ec5f": {"__data__": {"id_": "8944e966-4884-4e58-a394-59595de8ec5f", "embedding": null, "metadata": {"file_path": "phala-docs_dist/worker-rewards.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2", "node_type": "4", "metadata": {}, "hash": "7d077d9a6befec03a5bbbc286c29c6fa9d802987bed5169424bd6450abc102ff", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "90a02b35-b256-46d5-8d9d-c792a2d119f9", "node_type": "1", "metadata": {}, "hash": "c591123cff47f5b6d819940ee03b3f87e04bcc2d580e4a627ae65a28393220ab", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "d2bd4212-cc14-4060-9d95-ed2cc415464b", "node_type": "1", "metadata": {}, "hash": "c632d8d2d675a7d2c8917b7a54b78273d7a194594625f259fd40f59935c1331d", "class_name": "RelatedNodeInfo"}}, "text": "| Block number  | $t$          | $t+1$         | $\\dots$ | $T$          | $\\dots$                         | $T+\\delta$               |\n| ------------- | ------------ | ------------- | ------- | ------------ | ------------------------------- | ------------------------ |\n| Value Promise | $V\\_t$       | $V\\_{t+1}$    | $\\dots$ | $V\\_T$       | $\\dots$                         | $\\dots$                  |\n| Payment       | $w(V\\_t)$    | $w(V\\_{t+1})$ | $\\dots$ | $w(V\\_T)$    | $0$                             | $\\kappa \\min(V\\_T, V^e)$ |\n|               | Block reward | \u2026             | \u2026       | Block reward | Cooling off for $\\delta$ blocks | Final payout             |\n\nProposed parameter:\n\n* $$\\delta = \\text{blocks equivalent to 7 days}$$\n\n### Update of $$V$$ <a href=\"#update-of-v\" id=\"update-of-v\"></a>\n\nWhen there\u2019s no payout or slash event:\n\n$$\n\\Delta V_t = k_p \\cdot \\big((\\rho^m - 1) V_t + c(s_t) + \\gamma(V_t)h(V_t)\\big)\n$$\n\n* $$ho^m$$ is the unconditional $$V$$ increment factor for worker\n* $$c(s_t)$$ is the operational cost to run the worker\n* $$\\gamma(V_t)h(V_t)$$ represents a factor to compensate for accidental/unintentional slashing (ignored in simulated charts)\n* $$k_p = \\min(\\frac{P_t}{P}, 120\\%)$$, where $$P_t$$ is the instant performance score, and $P$ is the initial score\n* If $$V > V_{max}$$ after the update, it will be capped to $$V_{max}$$\n\nProposed parameters:\n\n* $$ho^m_{\\text{Phala}} =\\rho^m_{\\text{Khala}} = 1.00020$$ (hourly)\n\n### Payout Event <a href=\"#payout-event\" id=\"payout-event\"></a>\n\nIn order to stay within the subsidy budget,", "mimetype": "text/plain", "start_char_idx": 5476, "end_char_idx": 7052, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "d2bd4212-cc14-4060-9d95-ed2cc415464b": {"__data__": {"id_": "d2bd4212-cc14-4060-9d95-ed2cc415464b", "embedding": null, "metadata": {"file_path": "phala-docs_dist/worker-rewards.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2", "node_type": "4", "metadata": {}, "hash": "7d077d9a6befec03a5bbbc286c29c6fa9d802987bed5169424bd6450abc102ff", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "8944e966-4884-4e58-a394-59595de8ec5f", "node_type": "1", "metadata": {}, "hash": "6dca44f3be4af235cb5ba6062c8dd58131c7e735043e8a15e4ede77f6bca65bc", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "747a67a5-2630-4f12-931e-b12916a408e4", "node_type": "1", "metadata": {}, "hash": "af7ee7267756d0183e1b25a3f083cf8edd0657d65b844a7ae62990db33562afa", "class_name": "RelatedNodeInfo"}}, "text": "at every block the budget is distributed proportionally based on the current _**Worker Shares**_:\n\n$$\nw(V_t) = B \\frac{\\text{share}}{\\Sigma \\text{share}}\n$$\n\nwhere $$B$$ is the current network subsidy budget for the given payout period.\n\nWhenever $$w(V_t)$$ is paid to a worker, his $$V$$ will be updated accordingly:\n\n$$\n\\Delta V = -min(w(V_t),V_t-V_\\text{last}).\n$$\n\n$$V_\\text{last}$$ is the value promised at the last payout event, or $$V^e$$ if this is the first payout.\n\n> The update of V is limited to ensure the payout doesn\u2019t cause $$V$$ to drop lower than it was in the last payout event. The limit is necessary to make sure workers are well incentives to always accumulate credits in the network. Otherwise, workers are incentivized to constantly reset their mining session if V decreases over time.\n\nShare represents how much the worker is paid out from $$V$$. We expect it will approximate the share baseline, but with minor adjustments to reflect the property of the worker:\n\n$$\n\\text{share}_{\\text{Baseline}} = V_t.\n$$\n\n$$\\Sigma \\text{share}$$ contains the share of workers which are running on Phala or Khala with the same subsidy ratio.", "mimetype": "text/plain", "start_char_idx": 7053, "end_char_idx": 8205, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "747a67a5-2630-4f12-931e-b12916a408e4": {"__data__": {"id_": "747a67a5-2630-4f12-931e-b12916a408e4", "embedding": null, "metadata": {"file_path": "phala-docs_dist/worker-rewards.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2", "node_type": "4", "metadata": {}, "hash": "7d077d9a6befec03a5bbbc286c29c6fa9d802987bed5169424bd6450abc102ff", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "d2bd4212-cc14-4060-9d95-ed2cc415464b", "node_type": "1", "metadata": {}, "hash": "c632d8d2d675a7d2c8917b7a54b78273d7a194594625f259fd40f59935c1331d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "a36eb363-e29f-4cea-a6e7-c7a0db4fc946", "node_type": "1", "metadata": {}, "hash": "ad7b7ab34cdef67c88641d1a5e99b6803a1c2d7f3600c895bf4293575c124596", "class_name": "RelatedNodeInfo"}}, "text": "Proposed algorithm:\n\n* $$\\text{share}_{\\text{Khala}} = \\sqrt{V_t^2 + (2 P_t \\cdot \\text{ConfidenceScore})^2}$$\n* $$\\text{share}_{\\text{Phala}} = \\sqrt{V_t^2 + (2 P_t \\cdot \\text{ConfidenceScore})^2}$$\n* $$P_t$$ is the instant performance score\n\n### Subsidy Budget <a href=\"#subsidy-budget\" id=\"subsidy-budget\"></a>\n\n|                    | Phala / Khala    |\n| ------------------ | ---------------- |\n| Relaychain         | Polkadot/ Kusama |\n| Budget for Mining  | 700 mln          |\n| Halving Period     | 180 days         |\n| Halving Discount   | 25%              |\n| Treasure Share     | 20%              |\n| First Month Reward | 21.6 mln         |\n\n### Heartbeat & Payout Schedule <a href=\"#heartbeat--payout-schedule\" id=\"heartbeat--payout-schedule\"></a>\n\nIn any block $$t$$, if the Worker\u2019s VRF is smaller than their current Heartbeat Threshold $$\\gamma(V_t)$$, they must send the Heartbeat transaction to the chain, which will update the on-chain record of their Value Promise and send a Mining Reward $$w(V_t)$$ to their reward wallet:\n\n$$\n\\Delta V_t = - w(V_t).\n$$\n\nIf they fail to send the Heartbeat transaction to the chain within the challenge window, the update of their value promise will be\n\n$$\n\\Delta V_t = - h(V_t).\n$$\n\nand their status is changed to _unresponsive_, and they will get repeatedly punished until they send a heartbeat, or stop mining. The slash amount $$h$$ is defined in the _**Slash**_ section.\n\nThe target is to process around 20 heartbeat challenges per block. The heartbeat challenge probability $$\\gamma(V_t)$$ will be adjusted to target this number of challenges.\n\nPotential parameters:\n\n* $$\\text{ChallengeWindow} = 10$$ (blocks)\n\n### Slash rules <a href=\"#slash-rules\" id=\"slash-rules\"></a>\n\nThe slash rules for workers are defined below. No slash rules have been implemented at the moment but will start in the near future.", "mimetype": "text/plain", "start_char_idx": 8207, "end_char_idx": 10072, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a36eb363-e29f-4cea-a6e7-c7a0db4fc946": {"__data__": {"id_": "a36eb363-e29f-4cea-a6e7-c7a0db4fc946", "embedding": null, "metadata": {"file_path": "phala-docs_dist/worker-rewards.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2", "node_type": "4", "metadata": {}, "hash": "7d077d9a6befec03a5bbbc286c29c6fa9d802987bed5169424bd6450abc102ff", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "747a67a5-2630-4f12-931e-b12916a408e4", "node_type": "1", "metadata": {}, "hash": "af7ee7267756d0183e1b25a3f083cf8edd0657d65b844a7ae62990db33562afa", "class_name": "RelatedNodeInfo"}}, "text": "| Severity | Fault                               | Punishment                                |\n| -------- | ----------------------------------- | ----------------------------------------- |\n| Level1   | Worker offline                      | 0.1% V per hour (deducted block by block) |\n| Level2   | Good faith with bad result          | 1% from V                                 |\n| Level3   | Malicious intent or mass error      | 10% from V                                |\n| Level4   | Serious security risk to the system | 100% from V                               |\n\n### Final payout <a href=\"#final-payout\" id=\"final-payout\"></a>\n\nWhen a worker chooses to disconnect from the platform, they send an Exit Transaction and receive their Severance Pay after $$\\delta$$ blocks.\n\nAfter the cooling down period, the worker gets their final payout, representing the return of the initial stake. However, if $$V_T$$ goes lower than the initial $$V^e$$, the worker will get less stake returned as a punishment:\n\n$$\nw(T + \\sigma) = \\min(\\frac{V_T}{V^e}, 100\\%) \\cdot S\n$$\n\nwhere $$S$$ is the initial stake.", "mimetype": "text/plain", "start_char_idx": 10074, "end_char_idx": 11174, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "a55ebdf2-d7de-4568-bc70-17b11ecf3b15": {"__data__": {"id_": "a55ebdf2-d7de-4568-bc70-17b11ecf3b15", "embedding": null, "metadata": {"file_path": "phala-docs_dist/apply-for-project-funding.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a8192d72-d0d6-4b8e-b76b-d2e6b6cae954", "node_type": "4", "metadata": {}, "hash": "f4d482db5ae76ad96312870f0aacd8dd40772a0c03f3185857fb1e77b9bee798", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ef5b72e5-14fb-4e64-8e88-c912299779e2", "node_type": "1", "metadata": {}, "hash": "fc43be3bcaa86a5546ba5568488c67a7fffbe960bd60015619e978a6e1d517a8", "class_name": "RelatedNodeInfo"}}, "text": "# Apply for Project Funding\n\n<figure><img src=\"../../../.gitbook/assets/spending-proposal.png\" alt=\"\"><figcaption></figcaption></figure>\n\nThe Khala Treasury is a pot of funds collected through transaction fees, slashing, that can be spent by submitting a spending proposal that, if approved by the Council, will enter a waiting period before distribution.\n\nProposals may consist of (but not limited to):\n\n* Infrastructure deployment and continued operation;\n* Network security operations (monitoring services, continuous auditing);\n* Ecosystem provisions (collaborations with friendly chains);\n* Marketing activities (advertising, paid features, collaborations);\n* Community events and outreach (meetups, hackerspaces);\n* Projects focusing on the relationship between technology and art;\n* Software development (wallets and wallet integration, clients and client upgrades);\n* Ecosystem growth (Research program, Community plans).\n\nThe treasury is ultimately controlled by the Council, and how funds are spent is up to their judgment. But it is open to use for everyone willing to answer the question: **How can my project contribute to Khala\u2019s vision?** The Council attempts to spend as many proposals in the queue as it can without running out of funds.\n\nMake sure to be active on all channels and talk to your Council members to discuss your idea. Ultimately, the success of your proposal depends on the idea behind it but we suggest following these steps to cover the process:\n\n1. Join our communication channels to talk to Council members directly. To access the channels please create a [Discord](https://discord.com/) account if you do not have one yet.\\\n   [Khala Direction](https://discord.gg/GCuCrr3N): discusses Governance and initiatives of the Khala network, including any submissions to the treasury.\n2. Council members have agreed on a list of elements to be included to better-assess the quality of a submission. This is only a recommendation; however, this type of structure increases the chances of an informed discussion. A proposal template can be found here for you to use as a guide.\\\n   **Note: Your proposal should address a problem, a goal and an instrument to achieve this goal.** Think about your project in the mid and long-term and make sure to include notes about any type of funding required after development to maintain the project.\n3.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 2367, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ef5b72e5-14fb-4e64-8e88-c912299779e2": {"__data__": {"id_": "ef5b72e5-14fb-4e64-8e88-c912299779e2", "embedding": null, "metadata": {"file_path": "phala-docs_dist/apply-for-project-funding.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "a8192d72-d0d6-4b8e-b76b-d2e6b6cae954", "node_type": "4", "metadata": {}, "hash": "f4d482db5ae76ad96312870f0aacd8dd40772a0c03f3185857fb1e77b9bee798", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "a55ebdf2-d7de-4568-bc70-17b11ecf3b15", "node_type": "1", "metadata": {}, "hash": "4184508bebfe754797280fab2fed5a1e8450ea6ed174169ad84d1c1b4538c06a", "class_name": "RelatedNodeInfo"}}, "text": "In order to keep an organized record of the feedback related to a proposal, the Council advises to make sure all information is included on one of the available forums. One option is to open a new post on the [discussions tab](https://khala.subsquare.io/discussions) in **Subsquare** or open a post in [Phala Forum](https://forum.phala.network/c/51-category/59-category/59). Once the post is published, share it along with your initial message on the Direction channel to open the discussion.\n   * Make sure you include an accessible link to your proposal document in your message for the Council.\n   * Be ready to answer questions on the forums and on the channels.\n\n**The process of applying for a technical bounty:** [https://github.com/Phala-Network/phala-bounty-tracker](https://github.com/Phala-Network/phala-bounty-tracker)", "mimetype": "text/plain", "start_char_idx": 2368, "end_char_idx": 3198, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}}, "docstore/metadata": {"c9984c89-30d1-4089-9c5d-fe758fc9cdad": {"doc_hash": "1f731a0ab0e509be2d9f03c1a7447cac7f66d997d1eee1329f8351fdd924c0d0", "ref_doc_id": "c8ef2a01-36a7-4468-9b6f-e24d744bc58b"}, "dbe61b05-b284-42e3-96cf-d98a7e02e457": {"doc_hash": "afa5de921bda22f55bce4fd2b123e52013b46a12f4b45c1e4029b151e1bf7c63", "ref_doc_id": "c8ef2a01-36a7-4468-9b6f-e24d744bc58b"}, "7339c7e4-1602-4931-b622-4c9be7f5f183": {"doc_hash": "65b8cc2378c8bd71e9c65995920169923ca4f27d4e9c280052b7166cebc8a0a0", "ref_doc_id": "c8ef2a01-36a7-4468-9b6f-e24d744bc58b"}, "420796bb-f1b6-4d26-a42a-d06ac6cfd7bf": {"doc_hash": "0563c9e753259aa13a646dd7c0c9508f0dff3386333b9586e333b401d3439552", "ref_doc_id": "c8ef2a01-36a7-4468-9b6f-e24d744bc58b"}, "bac1b89c-b880-4cec-911a-015366f29681": {"doc_hash": "276d5b53b8b7ce8f1049d78a15c21a81aaffa8737df0b67d1d3e9869fffc7c14", "ref_doc_id": "8414b16a-51cf-4de3-9122-b3477e611f51"}, "b0036f4b-a010-449c-9f2e-eb1095fe5554": {"doc_hash": "248eeb6514c92be7e2b8092a8e3fd424723df1bceb58046e59e0749e6570e15a", "ref_doc_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb"}, "93b8fffa-5eb2-4fda-bd33-b3452a6cc9d7": {"doc_hash": "9a49deeab301096ece57f52a5e528f7779d51dc1068fbc7f6eb5b4de1c0e4337", "ref_doc_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb"}, "0f2621ae-c17e-4e77-b36e-fc37748b665d": {"doc_hash": "083dcecffde3e3a7989d80df603cffb33280d1bfdc4301d4299d2d56f0a9a271", "ref_doc_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb"}, "0dca9f70-6754-4422-88e7-53515f8f90ad": {"doc_hash": "096f606c99bb300d91655825bc11cbb52acf20db6bc52bc5f1a2509ef934bf99", "ref_doc_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb"}, "27ac237f-ed95-4694-8c71-f9251786f49d": {"doc_hash": "9b143d73b5763be83fad66808b1f9eb1edeafcaddc279068f18d1216153e27b6", "ref_doc_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb"}, "521e975b-a36f-4899-a124-90652cc8cdc2": {"doc_hash": "72fef5185b896dd2a35ca45e5e007fc10c8cf05df464bc343ac41b9c7faab982", "ref_doc_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb"}, "e0cc4e7c-4ce7-4cfe-aa42-433d01bc30b7": {"doc_hash": "36f9ff2da68832904eae1421e9946e190c8110f49bf89d2f70ca1b127f435667", "ref_doc_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb"}, "b5699e8a-d37a-4bc8-b10c-91835303ac70": {"doc_hash": "ed8de7c45d9c12ab53788e78686301b0d1aea9197e7a2ac2ae8b2ab091ae4f30", "ref_doc_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb"}, "91c3cb72-6b3c-4281-84df-82c032e3d276": {"doc_hash": "04276a5a6c383f3bddb77c08fbd45fcb4461bbc9b3e84837e39d50264265425f", "ref_doc_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb"}, "dd632383-6c01-47d5-8fa5-4460fedeb8df": {"doc_hash": "134853e5f5c784800c9b9003ff617c8a33ac82653be8f97d83443c7a5f6b46c3", "ref_doc_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb"}, "9f0b1ecc-8641-466d-9082-95bd6e0e2f48": {"doc_hash": "1b58f32cb91c6cc5820a81cb5cca386d2e4d0baf5af5bc14cd9a93e8997d01d0", "ref_doc_id": "bbe2c080-49b2-4e65-844b-68f91e623ebb"}, "218abb79-8114-4ab8-ad28-2b64ff5535f6": {"doc_hash": "b429f4849a46b063c7e1b6687961b39d645f1290601b5416f27ff6d6533ed3b3", "ref_doc_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33"}, "01f571f5-98c6-4aba-bff0-5b9813e9560e": {"doc_hash": "c5ab3264dafa8eade188acb6b652adcbf1633e27d28eda346b46b7d70be52b73", "ref_doc_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33"}, "d96915f6-6127-424b-9c6b-17a9785a2964": {"doc_hash": "18ef60889baf4aaa5fa5ab1b644bfbea6ac4ae517dcd11e65a83c774e9cbcfcf", "ref_doc_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33"}, "4cd93a78-7c88-4168-8231-0103c2db8e66": {"doc_hash": "85c3bc6c3c8d2f08ad2cc8d73175575721175c416f1565041f24a7924c79605c", "ref_doc_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33"}, "f504ba58-fc67-4c63-8888-b6579af50093": {"doc_hash": "0ce1d79e8b7bd481cc35aca04bd48710c1343b00fca4b94ced2bc920200c0409", "ref_doc_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33"}, "aef2f48c-cf0d-46bc-a2e6-801008c8327a": {"doc_hash": "2b654685825ef2ad706e38b0d2691ae1771c4638fe1d2a9fc7e9f4aa1c5bcf1f", "ref_doc_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33"}, "8fd53175-b691-4a72-9c76-ca79d7847376": {"doc_hash": "8ee3fc9d4cf2c9a51c71f8d04ad9d3d9c807306990b576a49f344037ecdad37b", "ref_doc_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33"}, "510d2b5f-1143-4af7-8ae8-d6eb2e59b083": {"doc_hash": "f0eb3470610f198e8113b4e797d2d76a66da7b17c7ca95c9bf5b373fbcfdbd19", "ref_doc_id": "da69ac29-d69f-420b-aec6-ac023c5fbb33"}, "ee4e3602-7035-4aa0-9e80-9db78cd3d56d": {"doc_hash": "ac2b8ad7a1c40b9a9eaad65a4fdba7f99fd32405da4c49d3f62cca4ff9d0bb5a", "ref_doc_id": "9e5be949-8f78-433e-b475-259a252e05bd"}, "ec7d0d0c-99e2-4955-9808-ba6bead2dbcb": {"doc_hash": "1cad6d65a186742452271038a867e6fac3c0ccbb070c5665966ea04fe27d7012", "ref_doc_id": "9e5be949-8f78-433e-b475-259a252e05bd"}, "f009a205-0e36-4963-a0ca-515460e59cf5": {"doc_hash": "5e914e6c04aaa5c4abf692d7eb1f782b4d1540371d29e5200d04cccf627d1783", "ref_doc_id": "9e5be949-8f78-433e-b475-259a252e05bd"}, "7ce9ee5f-c9c0-4e39-a278-9da48800ae20": {"doc_hash": "f3dcd30b80580e222ef7936ee4ab86795077c4eaa1c2ad534f15f8fe4ee8459e", "ref_doc_id": "3a0fc6e6-646d-4d0f-a1cc-88a9d68cb045"}, "ba477c28-2940-4ebd-8ca5-7601eda57082": {"doc_hash": "2f92b451c2215f53ae29142fd0184761416c2dba64e653aa8fba565cb9b8a29f", "ref_doc_id": "63932883-a029-4ad9-aea6-1a8894eb02dd"}, "253c7cf8-a3c6-4f17-b2e0-9f0ef37124d7": {"doc_hash": "928d5b0608376e75a7176ae22fe919b55f5c90dad2ddf71aea2e5d6aa6b93108", "ref_doc_id": "63932883-a029-4ad9-aea6-1a8894eb02dd"}, "983592b6-ca6d-4b1d-9a5d-6cfae8940017": {"doc_hash": "f16484544a58272ec53f8ba943a94c49ab9ae8c68e3467293a46740006ee2537", "ref_doc_id": "63932883-a029-4ad9-aea6-1a8894eb02dd"}, "d5047fa7-b0c6-4296-b4d9-99999e99152f": {"doc_hash": "26d6ab1f72b1af7d24f00f1d77800ac012fe3814734aa4d7f879dea2e05b6756", "ref_doc_id": "5e1257f0-751b-4336-b6eb-8b187e368904"}, "444df373-b34b-4ce1-86f9-9d635090f8b6": {"doc_hash": "00e574182431b0279f1d2575d1eb265654bcd4db8e422b3b4bb3c5a1203be999", "ref_doc_id": "5e1257f0-751b-4336-b6eb-8b187e368904"}, "ac9266c2-bc8d-4a24-b116-80a3dc2380c1": {"doc_hash": "7a7022a01742697a7632cb1898326f2cf16ed27de020a1878ece3fe67cdb9637", "ref_doc_id": "5e1257f0-751b-4336-b6eb-8b187e368904"}, "f3a7eff2-ddf1-44ff-af65-f3f2630f1fa5": {"doc_hash": "9d268170012c9a2683e3f14b1a0d6c086f669d2ac676b2942a82ae00cf312968", "ref_doc_id": "5d3e58fe-9b67-499c-a738-8eeecbd66f37"}, "40253e65-9ca5-4038-a557-5d58429109d8": {"doc_hash": "6c4a4f8713241089ebe7eaefeb2c789eb905c6c1dde4ab70ebfa932bfa5491b6", "ref_doc_id": "4ef2603e-462d-4bb6-bab8-785bc848a684"}, "8fc7e2d2-f5d2-45a7-ba99-d8ef4e69d8e9": {"doc_hash": "398b7ad6a54982551658072183f49f7cf123f57cc442ad2ea7d643d71a7fd062", "ref_doc_id": "6dc5aa10-e555-4656-b63a-e4dbbdc9da59"}, "bf5abd89-c750-4168-af07-447e48dc895c": {"doc_hash": "e4231c204743f72731fb2fa9d01f8124119dc5cad8d67fd584ee619f365edd12", "ref_doc_id": "8c17c1e8-7a5d-4faa-80b7-52b6e054f3e9"}, "c6f9952b-1dff-4207-893f-adbdb1c7d393": {"doc_hash": "1c1fa91ceec7840df9a396f1f0a7fd54567328e1b3087bbee057739ae8b3e26c", "ref_doc_id": "25ffb768-e9d3-4978-ad98-0eb8765b01a6"}, "661884b2-19a3-4731-a13e-e678668775af": {"doc_hash": "aa0066cf76966c9ddff052d6759cc83b0023206b209f22099dfe0406f315b14b", "ref_doc_id": "2e92a757-0686-4f31-980b-b742f6a67efb"}, "c9423d09-6394-4c5d-a428-32bfe0b2c563": {"doc_hash": "4cc50099b0a4b39ff24415638f029f73b858b9401bce533e95cabef007ee62a3", "ref_doc_id": "a6a5cc87-e099-4ac1-ab49-37fd5379aadf"}, "3b379737-9a53-4c7a-ab95-ebdb98b92b7f": {"doc_hash": "2fdf58d8cc934c0448863414a1844d878addad3b393ab2ac223aa39f0a9ee95c", "ref_doc_id": "5c14c8ab-4c40-4fe1-82bc-8d044635ce6c"}, "7aa3c3c1-f09e-4aec-929d-796ee04ce5ce": {"doc_hash": "ff6426a8f124749eb58fe8a3e06fd5da1464b695b24de0749fdb5175b7ff22ba", "ref_doc_id": "a53edfbb-ded7-4527-a274-a9813568a5c1"}, "0eaa648d-a6bd-4ef1-bf18-bb40a6e04e3a": {"doc_hash": "bd5fab05e152787ff59e761d1a4dff1358c5945ca121183e4eb608145e8fc7a2", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "5fcd07d3-db46-475b-86c4-fed2592fa40a": {"doc_hash": "b079ff975519730ac0e81e7bac7b05849156b1a42dfb785362f5907a4a750274", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "c2ffe13b-04b8-4953-8811-2b9316986787": {"doc_hash": "0a6cb3eb87e82405295c73b4b013c9d6182669143ecb17c375ec216de5fd1037", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "71854785-92c0-4061-8701-c8fca24fc1df": {"doc_hash": "8b51b494a09e79ceca7b3634824d5ebc10547efce730086a2ee19ac814480e34", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "09758bdf-b827-4e82-87ad-43609b41be27": {"doc_hash": "4edc5e24df827d7f33892e4afcba2527992fdfacbdcee8d49360c1f27e836fe5", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "5d50ca51-8d55-4c54-a0a0-1f33f2b8539c": {"doc_hash": "6bdfbe7a024f2b311df65a94589aae0f09bb70828d5ccc761fd763a5fabd7a19", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "c0c506c7-1164-40c4-a5b4-2ccaff0f688e": {"doc_hash": "2bca7ff2e9940a2a24fe8c17d9240e6f5539d2be9787dc3e2f1d285c07ab7364", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "c0375d4d-28b2-4053-abfd-ab7383c4acf3": {"doc_hash": "bfaac7e24bb2e30cee43593634dea6655825558ec5e6dd0323caf35f8a7c1647", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "3ca8bbee-8f80-41da-ad5c-a03b4161564a": {"doc_hash": "1ebccf6b28908a2f0a1397eb3492068f0fc851f543b72823bec17f1e5584aae5", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "8c4c2de4-254c-4e0c-ba72-9e9f4198c034": {"doc_hash": "1cd501b3b9e3a30f0e2ca8d41d9d19a138d09df5399ce3768eb427889dfab045", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "6ba1a58c-4941-4d99-974c-9b7df14b1912": {"doc_hash": "2733bb4ad3cff9731aeff5a250588ef2c3f0cc2915079e4d9d022e432d3b2d2a", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "1d0f5633-39cd-4d32-bef4-9fbed685153f": {"doc_hash": "171ab41b08e6cb0e818ef3e78df978ba57347e6a760b27e34df680b55b8b6c3f", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "4f8eb095-f85d-465f-ba8e-0618196010ef": {"doc_hash": "983dcc8d94e45c675c9efbd15af45e3b589c1926e97279dd9863e77f5ca93bd7", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "5f0e0039-4a54-4216-abdd-ce9a7cb0e837": {"doc_hash": "1a01e7493a4547be91d467b3a4f03155afed6dc1b9898bd6518ea88d5983f111", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "004cc633-2261-4ba4-8596-4448dcbed85b": {"doc_hash": "0772b81d38583325b3ef81b293107fd03d581a4f59627d15f2abcf080c261d7c", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "6c647c1e-824e-41df-b594-693c6dd1e923": {"doc_hash": "22b9c6cf7336698061f352b438736e40d66941c38dd0a0a0ef68cd2e760a5438", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "328111e6-56f2-4362-8668-ba4286a747e5": {"doc_hash": "2628a923f70e13ce7090fca1b87e512de1cb851a21abd9d2aa2d613a1d079d5e", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "6829efe5-25fe-40cf-8fcb-348f94b6f3ce": {"doc_hash": "bcaf97bfa8697293f29a01524132e301f65cda053817f665e48af0c45bdf53eb", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "8f3ddd7c-e54e-4bbf-9abe-f2aed45c625d": {"doc_hash": "c6e304fb3f191ccc67a45064e436d716704d347a20e758a0c73c6f195ebc4d9d", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "48f7a985-7632-413f-a701-c077fae4455f": {"doc_hash": "e3344a378c8b3e4142c364054ddc8c36af0be5f3ce1144799fe63e4c5f661f47", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "ea61934e-26f3-48ef-a810-965ca2b9498e": {"doc_hash": "c8383ad8ce1d9c8a1a1431f8769bf320f020c13037f64602ea602b87ab94bd6b", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "4b79c314-1c0e-4e31-9b16-5fbcb5fab11b": {"doc_hash": "82e1ffe422d164080bbdf38b26e4c3076f57f80ba5ec52c9a887b76aa76e851b", "ref_doc_id": "a7bd75c0-78da-4a88-b7ed-b8612b93cdad"}, "f0e87cc5-2e2b-4b81-9dd1-0bb66aec88e0": {"doc_hash": "ef9df24979c21ca0a0b65ad8bcabda4e64deaeff0124d1bb7a491280c5298d55", "ref_doc_id": "f3c032c1-9905-468b-accf-e95821366a3a"}, "f87b0d55-80b0-4c89-9bd2-2107672e6235": {"doc_hash": "b59698720575c4c291b4bf7184df986408dee18a598acdfbbebf1e34135a9812", "ref_doc_id": "f3c032c1-9905-468b-accf-e95821366a3a"}, "39139ae0-d787-4ea4-9dde-fb5915be0211": {"doc_hash": "975d5af2088528a63af11fb6854e5b8812702354fbe11082478b06cec66aa684", "ref_doc_id": "f3c032c1-9905-468b-accf-e95821366a3a"}, "313c4042-1b79-4b14-8a7d-22585abb5234": {"doc_hash": "fe1479485bb96a064d22100f8f2faa868b82a59d2f1b08f5c5fb71257c0099f8", "ref_doc_id": "01b25634-c273-42f2-8e77-1391bca42203"}, "1e406d39-7cff-4960-8462-30cae67f3dd6": {"doc_hash": "932c27268479ced116780804fb24720f75636136ac54b11cef6444fd4a213e85", "ref_doc_id": "01b25634-c273-42f2-8e77-1391bca42203"}, "61c5e031-75d0-4232-be51-987ce8fe8935": {"doc_hash": "fd71a5e2d86d776d0331d7f8b505b893288a786bc5956ef9884df4c5fcf5c584", "ref_doc_id": "01b25634-c273-42f2-8e77-1391bca42203"}, "2241d840-b04f-40c3-8aa9-9f2cd473658c": {"doc_hash": "edfff090b993bd1401f478edc32eabca88943ac5fa9a4ce6a9b96c51dfd97bda", "ref_doc_id": "01b25634-c273-42f2-8e77-1391bca42203"}, "83e3fbed-da02-4f00-9900-7ba5f10867f0": {"doc_hash": "3bf17a057443d9371decbf6e4901cbe8a595093cc51a0bc967a875368284eae3", "ref_doc_id": "2fa9ff2c-d7ea-4b9f-90e9-c705bc6fad99"}, "f0f92408-e371-4618-999b-f0c7c54640b2": {"doc_hash": "a940aba4879d4192913acdd08a0cfe3be948ee3e7a93b17256d03e24aa427d5b", "ref_doc_id": "2fa9ff2c-d7ea-4b9f-90e9-c705bc6fad99"}, "33074e4c-d42c-4ba0-b913-4273ca386676": {"doc_hash": "92164240bf736820ed3afba3c8ce75c2708a1a1c9f05cc484d8502d1f2c33c1f", "ref_doc_id": "2fa9ff2c-d7ea-4b9f-90e9-c705bc6fad99"}, "2aacd6b5-06f0-4768-9557-d912fd984081": {"doc_hash": "6b8b14fc09223a813bf1272812f33883f73dec8ca4ba771035232370d50cf649", "ref_doc_id": "0700ad4b-aecb-4725-b750-4cdca264a36c"}, "04457e25-31b6-4ece-894c-4d858cf467dc": {"doc_hash": "468e034e3f06cdad8bafd22384c6d163c2ace92198c4215f739f70396f79aa28", "ref_doc_id": "0700ad4b-aecb-4725-b750-4cdca264a36c"}, "6dafc8f1-69cf-40c3-8355-5934a327c9c5": {"doc_hash": "d9a6e18508d0b0df04b84d83ffa104560c210c49c6cab3f8d5ad42edfc7ec77a", "ref_doc_id": "500f5bf0-4994-4954-b069-6ed2e43cda0c"}, "12b4f9ac-4c84-456e-826a-d74334aa406f": {"doc_hash": "f38873faadfe0796004437dfd34e411d3a8ace06bab81a39945dd15ba5814deb", "ref_doc_id": "043a364a-ffe8-4acc-a2af-bda8366b06f0"}, "86869b8a-acb9-4688-8e49-df1361bddae8": {"doc_hash": "5c2d095ea821cdd4c2058661c76d0422d37449e5fc9423bd1de21145d4172cb6", "ref_doc_id": "003a24a6-401e-49c8-afaf-e3d680346bbb"}, "8ccb1bbb-461d-4ec0-ab08-a0d7beab7576": {"doc_hash": "9cb54929fe8d6ebe573e225f694822dda7842aab6a913502047ae467c5b6cae0", "ref_doc_id": "30e4242e-dde2-42c3-81aa-9063efdf6da1"}, "c0fe8691-693f-497c-83d9-6167a8e5a9b7": {"doc_hash": "cb7cbd10256fd6614c9904aa98c1280033676c90c7aef647aac36fad2370b9b6", "ref_doc_id": "30e4242e-dde2-42c3-81aa-9063efdf6da1"}, "14a9fada-3171-4bfe-946d-bfd8bb012437": {"doc_hash": "ef197d864aed4ddfeeacfbab65142d96a47a0dbc695ebffec7ab17b24865f2b6", "ref_doc_id": "30e4242e-dde2-42c3-81aa-9063efdf6da1"}, "5a18a4aa-f877-40d7-bfa8-428e47a2a75b": {"doc_hash": "3836158f4d122981ac004613bb3bd266861139bde98725571a31859b862da352", "ref_doc_id": "30e4242e-dde2-42c3-81aa-9063efdf6da1"}, "5036d751-e2a4-4bfb-a037-9bc27e51d686": {"doc_hash": "c77aaa2103ccf598b8aad2a016b465475c17a79a307afb35924bedd01f461dac", "ref_doc_id": "30e4242e-dde2-42c3-81aa-9063efdf6da1"}, "c9d6a5a0-7a7f-4e10-afda-4b1fbe59319e": {"doc_hash": "ef4721136f7ce29225448bc0e4cf030034bd4f0c3a31534961e2fae8ca9bf66b", "ref_doc_id": "b55e1e04-9025-4715-a83a-9cc2abd9175f"}, "f8c381fe-cd31-4d5d-b1ce-638da593e9f9": {"doc_hash": "f6b9e00483dae9e731e934ea1c30389d1805818c9b4a2a44646f8ec1418f8631", "ref_doc_id": "b55e1e04-9025-4715-a83a-9cc2abd9175f"}, "6dff8296-b7d6-4f2d-8ea7-c30f5da375b8": {"doc_hash": "20c241b59838bcb91deeb9420c4b7f415772a3a3ce7cf73436f51763e08bcaed", "ref_doc_id": "b55e1e04-9025-4715-a83a-9cc2abd9175f"}, "b43ab247-3a9c-4561-9863-a29bd46bacb4": {"doc_hash": "1a8079134c0257756449ef0b13551ca36271503893ef874c1461102a8d306655", "ref_doc_id": "b55e1e04-9025-4715-a83a-9cc2abd9175f"}, "00b375e7-17c1-4913-8983-e6d17124d0e0": {"doc_hash": "e67c74b9f1142c51d25192bfeec8ba44667956fc2844454f2a258b15bddb07b7", "ref_doc_id": "b55e1e04-9025-4715-a83a-9cc2abd9175f"}, "dffc8fcc-d650-4b5e-b9b2-2696a94d5cfb": {"doc_hash": "651e30880a09f0594a1607caf65b650f6886ddcafff6c19e9740d9c2eab5d5da", "ref_doc_id": "b55e1e04-9025-4715-a83a-9cc2abd9175f"}, "a0e4d58c-b4d6-474b-81b5-41996a0872c0": {"doc_hash": "e4e20e4ce51f5ae7eb3a25704ff628592e215bfb33b1ee69208011e197ac8307", "ref_doc_id": "35d0b890-0eb6-4a01-97e1-6b4f695108fa"}, "12777536-ed0f-4c6e-b56f-217c5e392a8d": {"doc_hash": "2dda28ed3d590cf1fb7bc889d57836827a9c91575af878cb05f5fb2533a86573", "ref_doc_id": "35d0b890-0eb6-4a01-97e1-6b4f695108fa"}, "a2c3f961-21d6-498f-a411-08701481c3e7": {"doc_hash": "4251e58e0c8678757157b978120770983f5b6678444ebf7a399568a7d20b59df", "ref_doc_id": "35d0b890-0eb6-4a01-97e1-6b4f695108fa"}, "252ce6b8-4b9f-45f2-9be5-fddcfe8a5a88": {"doc_hash": "274fed1ac9c9191ef6a882e498036dcf5303f758b63e6efb53cc101ae67498ff", "ref_doc_id": "35d0b890-0eb6-4a01-97e1-6b4f695108fa"}, "5fd61517-9a5f-4abc-9b42-f170a931212e": {"doc_hash": "597870eb46d77fa0149f37f99ec425ee8f894d99fdd3d6eb49b182bc7f97a81b", "ref_doc_id": "5eddd77b-e491-4c34-8131-223fb436a650"}, "f7bd4697-0209-4919-9020-bdc069101124": {"doc_hash": "19d26dc41a7b51a629ee05a4940552c1a4a36c8edc49f33b2f4276f653663648", "ref_doc_id": "5eddd77b-e491-4c34-8131-223fb436a650"}, "52d9b7bc-8724-4dac-8562-23694a40c21a": {"doc_hash": "d57ff6729fb68c9ac0e42b452a15e9843452758d738c580b3d3026bfd4542bb9", "ref_doc_id": "5eddd77b-e491-4c34-8131-223fb436a650"}, "30cc0192-170c-4ed9-8d51-c3f58724c9da": {"doc_hash": "1912613074790550cd099ba79fa8f336147ba8ecdaca6eec938d43dcd181d068", "ref_doc_id": "499248cd-8d1b-4223-ab15-da5f30c4c088"}, "4d2a3531-2ef3-44e7-86d4-59a68d18419d": {"doc_hash": "e299a7715f4b01a1fe48a96308b088b8ca3094cb9e59d0f86d560238ec497d85", "ref_doc_id": "b249013c-0cb7-462e-90c4-24d3cb9faf69"}, "aa4d5d01-7e28-4aa1-99a9-1f8ddf3f56f8": {"doc_hash": "1d20c893407fe3163afab18b81bb1e19ba36768e9f948a664c4f269753232f89", "ref_doc_id": "1d1d0ff8-6327-42eb-9191-3a9b32c89ea5"}, "84b1d7a7-ade2-4fd8-8516-fb2307f7db92": {"doc_hash": "86b10a003f7ca68726dace7fd983e9013164a9f35d58060d967c4ae2464ea665", "ref_doc_id": "b4aa2986-211b-4cca-9b97-989baa3c3ad6"}, "f641cc80-beab-48ed-b54b-af58340cbb5c": {"doc_hash": "98a7af78660d943292f13647c4894a8b0c191ae2a9df64a5ff470e44cbe07b91", "ref_doc_id": "21c4d294-e20e-4923-80c2-b5fb42b52f8b"}, "612197e1-3572-4462-9010-53eb0f2017fd": {"doc_hash": "f81c2833530cc7766aed951143cac4b62797f76b7cf149a5d02135a91cabf43a", "ref_doc_id": "21c4d294-e20e-4923-80c2-b5fb42b52f8b"}, "aac93046-4dfe-4349-8986-2a57dfeb19d3": {"doc_hash": "9b7482ad440f374be4203f9af42674ae2ab8b9d70cfa2aacdb92a1ebf0f23eda", "ref_doc_id": "21c4d294-e20e-4923-80c2-b5fb42b52f8b"}, "67f5827e-5b01-43ad-a8ae-b55053e34b09": {"doc_hash": "9dad21f3deb7f91abcef8df81239c77f25072dfef0c214cf6987971c7bee898c", "ref_doc_id": "21c4d294-e20e-4923-80c2-b5fb42b52f8b"}, "726d1005-8160-402e-a83f-eff4b78ee64c": {"doc_hash": "a79f379498182be206448b2eb05281a1ede453e7e1fd5d82dbc03ae921a8de04", "ref_doc_id": "21c4d294-e20e-4923-80c2-b5fb42b52f8b"}, "d53c2ce5-af01-4ef6-934a-d78981d9d717": {"doc_hash": "69fe85b386962182ca4ef43ba717494a3b1bb81411b920725d133344b71e4e97", "ref_doc_id": "be784468-d046-4670-aef0-486824e83488"}, "63f3f431-f5bb-486f-98e6-5cb1d14377ee": {"doc_hash": "79d3a6c561d0d1a78c03e736e2c2a163c81555602cb3f584c160adcb943a085d", "ref_doc_id": "be784468-d046-4670-aef0-486824e83488"}, "b1ab0de1-16f0-4f0f-b88c-6fcc4d86d6fe": {"doc_hash": "f456fafd159aa4446d7a84e2dbca500cec60c9f0888d65547f01d4d586f7495d", "ref_doc_id": "be784468-d046-4670-aef0-486824e83488"}, "d1a2ee8b-0eb9-432f-8922-ab8631034fc8": {"doc_hash": "68b6d9d5175d781f017e0b7f1b2954c0bc29c6adad2562abfcb53e03963ba647", "ref_doc_id": "be784468-d046-4670-aef0-486824e83488"}, "b5b37d19-fac6-4ce9-9189-b67266fbe7aa": {"doc_hash": "c622e12b752d151328eb1a3b4a7d6c29859bc1dd7e8b4f5a558ea33a37af73e8", "ref_doc_id": "be784468-d046-4670-aef0-486824e83488"}, "d7753ba1-84de-477f-b575-e8671552c23c": {"doc_hash": "073617347ee9e88706f8fdbbe1d78248cc29d2580d81e13df2e5cd2e97724865", "ref_doc_id": "be784468-d046-4670-aef0-486824e83488"}, "4313eefb-69a2-454f-98c2-50cfe164ecd7": {"doc_hash": "3ef287be446185e2f3664783affe9529a7b18bf531148efc838b2c63164774fe", "ref_doc_id": "be784468-d046-4670-aef0-486824e83488"}, "e2c19408-4c11-498a-898f-281a76d017b5": {"doc_hash": "643f99e888b6bd81e1aa2821eeeb9658d07a107a4420e6e594ec12694870572f", "ref_doc_id": "be784468-d046-4670-aef0-486824e83488"}, "1be79d38-ed2d-4dd3-9702-dd3f3d1c24ce": {"doc_hash": "781f9c3de19382b78b7f45202aadd102353e17e90a3c2c9a56b1a8ea373e17b0", "ref_doc_id": "be784468-d046-4670-aef0-486824e83488"}, "ba06d0e3-a7e0-4c28-9201-fc03d5dba085": {"doc_hash": "4eb4df8f86035b9acdc387a9c1b7bdcae211888e3df13e990e920870ce625b46", "ref_doc_id": "5d80a010-a7b0-43c9-95e0-6172f2fd38e5"}, "2da1f0e3-5f06-47c4-898f-e831c5605eff": {"doc_hash": "32659e8eec0db0d4fb8a0fecb954d4d53be5eb3c8aa9c3ddef44115ecdf043ed", "ref_doc_id": "5d80a010-a7b0-43c9-95e0-6172f2fd38e5"}, "26e3b3d4-e1f8-454b-ac87-37cd468968d6": {"doc_hash": "2cc725383738f72f8b3eafeffbc5d6a5d0247eb2bde9d0a03b002ba8ddeac17c", "ref_doc_id": "358650eb-6a71-42a8-9230-cd099df9d7af"}, "c91edf56-f778-4b5b-b689-4424d6dc44ab": {"doc_hash": "10462788aa285400d7ede615f1ff78f8346758287e7d9f2679a355b42fe4a9cc", "ref_doc_id": "d1b08f7e-92c1-45b8-947b-209ee9fe47bc"}, "855e6b0c-5963-4237-9068-f365569cb3f9": {"doc_hash": "7df6713780b1992e9e865ef518f7be2537f1fa3904e9578d72b144532ed7a388", "ref_doc_id": "a8b7d718-3b44-4dfc-a8a2-c92454050c3c"}, "6807b6d7-d907-4460-9b5c-ed9e228bc6cf": {"doc_hash": "ec422ba15e9b7ea59d948ce83d1f305e33dca752b76537c2062ac2119dbc5ef2", "ref_doc_id": "4faed7ad-fe6d-46f6-9866-0b4ad8f459ce"}, "e164ed8c-6f54-41a2-8b6a-32bb7340c17d": {"doc_hash": "5823591a31227e7863cfbb27351ec470e9131e5e757bb1e6ab01edfa684284be", "ref_doc_id": "4faed7ad-fe6d-46f6-9866-0b4ad8f459ce"}, "ea7057f9-c245-4443-bf06-77bee5499f53": {"doc_hash": "e7baaf59246aeff816b9272b57abbdbcebabc3051e9da88a09d27d8b1d96c192", "ref_doc_id": "cf0a0c3a-358b-4362-b6c7-53047073867c"}, "674cb410-e846-40ed-b2bf-5a02350c1b7b": {"doc_hash": "4311cbd9ceedbe282db5e42addb1eed70286bd781c58d548a2b4d76600655bb0", "ref_doc_id": "3632f624-7681-461a-9e17-753d767e6c1c"}, "c8872060-3fe0-4340-befb-087fdb93bc94": {"doc_hash": "6cd581553a68edabecd405c0096c046f1789c0e2291ca86586214ffef5890e96", "ref_doc_id": "ee21aa3f-dafd-4ab3-b0fb-31f9021b3efb"}, "40b733a3-a303-40f4-bb9d-3a9873959535": {"doc_hash": "1913935d206e4d5d21929fc2513292f63eca828e592ed1fc8b221da79368030e", "ref_doc_id": "ad851f66-0434-428a-bc05-97f97dc7302d"}, "f0bfac17-42ff-4a48-b0e5-828bb9bb4cb7": {"doc_hash": "c35ec7d4f284e36ba81f9d60728120c52ded71d15ea6ee3a5a86a53ba2014cde", "ref_doc_id": "ad851f66-0434-428a-bc05-97f97dc7302d"}, "965778df-b946-40f9-b422-023cc046f091": {"doc_hash": "74e4992c6e745bb89ccbc7682614429ddcc7b80d2ba3213baae468badabcc004", "ref_doc_id": "8588b396-96f7-4222-9fc6-7e57fa3d14b6"}, "302de6ad-a664-4f6c-8711-57049a819f9a": {"doc_hash": "1024032aa9ec52e8db28f019077e643a21747fbe6613df990cbdc90849076f45", "ref_doc_id": "0ef98432-7f00-456b-9133-9729a08167df"}, "bd84b296-7bc8-4a46-93ab-98008decdf6a": {"doc_hash": "7dbf63c86b9dd4c8ace5fe12fe79197b6bbb9f8dba3d8e530aed0d5d1af54d52", "ref_doc_id": "0ef98432-7f00-456b-9133-9729a08167df"}, "ac27581f-25f9-498c-82e5-c566904c5f48": {"doc_hash": "639ab380050695991fc2b74ce9383aa4596adf7c8015c9a9027307c1984a9532", "ref_doc_id": "0d011c27-6352-49c2-8af2-23928ed39ed9"}, "8b619a26-5d05-4982-8998-6e864cfd3439": {"doc_hash": "5c0e89eb4e0c69a8040e97f774193363fb08394a04dbfd277de9c78afa220094", "ref_doc_id": "429fbba6-81f6-4391-9bf1-c798887e1c18"}, "f6e878ae-75f4-4932-91cd-ec44f27ba69f": {"doc_hash": "a2babeb5c89b869dbb138da0616fef001b4e1f7032959c50f85643129254adc6", "ref_doc_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd"}, "a309979a-85c2-4ce1-8bc1-7c8b7190fe6d": {"doc_hash": "974c1343a8af5d931db0c0786d6908ca8fe64ea8853eaf476212a23b9da3fceb", "ref_doc_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd"}, "beb015b7-2e06-4129-88f4-3b0acb297a22": {"doc_hash": "e6f8f593d55221a091daa3773246104418ac22f421dbebed18046fcb95f1a344", "ref_doc_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd"}, "608f4b92-5e13-4206-8bdf-4d8321e3025e": {"doc_hash": "19bd73ce6eec6eb57e55c5b1b25233e28946d127e406171fc31427d87616dd2f", "ref_doc_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd"}, "87cd70a4-ba8d-449b-9db5-7c3f4e686d75": {"doc_hash": "ecb3a876033b88b3bdfe205ee231cca650b53815889613d557f99dab1867f6e3", "ref_doc_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd"}, "b5436dfc-ce2b-48a0-a662-292f528f72ca": {"doc_hash": "d42cca924fcdbd16c58b340a780b1796ff50461813d3f1c368dbcc8faebdb342", "ref_doc_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd"}, "a4680770-5dcf-4059-9848-7a02ab63b011": {"doc_hash": "2bc3e1e0bc5806ee418f77d0a8cbafccb448118ab77d93e7d6526914eeb1889c", "ref_doc_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd"}, "ec94c439-fada-4010-bb19-05b34a5e48f6": {"doc_hash": "9ed97a2ee6028cb48b82feb87ddce0c1182112126e5a9768e766f0c653318ec3", "ref_doc_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd"}, "a9cb8fa0-d8eb-45f6-9d2c-05d68669fd13": {"doc_hash": "abd4f7900f27bd97195758efaabca661a119f1eaebaee2fda820a710aadc6079", "ref_doc_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd"}, "3121841c-374f-4c34-b638-be72aede595b": {"doc_hash": "64f7260da6f093a6ecbc7dcac32ae8b0453aae8e049d8476d501f8463b696082", "ref_doc_id": "bf0b9be5-f216-4287-8e59-5a2743dae5fd"}, "6e3144ea-aeb2-401a-92ef-20f997ab9882": {"doc_hash": "4aef7e39df49c5300ce33fcfe036d1cbefd8c2c67b1534f0ea658887c015a9e6", "ref_doc_id": "6b4b34c1-8ff4-44fc-8927-bbc5c693128c"}, "4d0f1828-87be-4540-84c6-920d77015745": {"doc_hash": "38ebc22d4be08015e040d92413c50cf0b481631d63c00e4ca5555c512ecffdc3", "ref_doc_id": "6b4b34c1-8ff4-44fc-8927-bbc5c693128c"}, "e80d4a95-4b78-4b83-b912-a95a2d772edf": {"doc_hash": "0141125e68d311878d8e1c40090241c0041e2ace75a1afc7429b919ec900eb75", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "226a033f-7fb0-4563-a8a3-5fda9b552751": {"doc_hash": "39604a0c7ea0d97387963b4d8630af5c398570d78713a35df533f1aa0a93bfe4", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "aa989ec9-c72b-4fe3-a42e-e1c2ed50d9bc": {"doc_hash": "e3d046d751bbabb9181983b1474260e3bacaa824fb1bb3df7170e812b81e236d", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "9041d467-b366-42ba-a3bc-7ccd88fd4b40": {"doc_hash": "2e5a7ed4445b31cda8634304b8ced6ed5c5319ec18766d97242ee5a64d041bb8", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "54690056-116c-4553-86e4-068540bbcbfb": {"doc_hash": "cdd23148430edd0885f72c385aa97217084eaebf197cb2789b701b14a70c871a", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "85f0a004-b576-4100-a4d1-8bd8b7b8e588": {"doc_hash": "075dd41d8e5a58eec62c03c27d53de17e3f62786e2b9df5fb3182e4a6a5e7769", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "cbb146b3-d351-4f60-8f45-7d51c56ec85a": {"doc_hash": "a51e773799823c887d51081920cd1c0d94d6a8ce73d88937add1fbf899f8757c", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "05ede7ca-c2e7-4b90-b586-4489b6d23799": {"doc_hash": "f90adafc22f5044b5caaa15aa5745e26a2119fdbe1bdd17c66771c9bb57a7e20", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "039ad2a0-598b-4c50-9a01-e0169c74e388": {"doc_hash": "684773d3cce94c4c94f5a1ace5fe02aa659695d47f3373c26ad8772946622853", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "f0dddd6e-2a9f-44a8-baa6-7d47b88fa97c": {"doc_hash": "992e4366ab820131d16c369e64f84a6bfd3ed270ea82681c4c0e5be5e59dec7e", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "deffc310-9a50-4f45-9292-12f91e002625": {"doc_hash": "7e31260309a09132ffd8690fc7944b15ca3143cf4796d00dfa7a592216e31025", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "d6aef0db-9972-425c-b292-909c9ec528da": {"doc_hash": "98f8a0930127e116d2e27715efac6bba3ad00026f114645c530aeb3c3922ce79", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "2f1e1287-3f88-4aa5-a7ce-1e0c89384842": {"doc_hash": "9c227e7380ea8ce43486f9d398fa7009ef1c3b20162963cd228ba73b347b912e", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "cc991195-6664-4135-8a38-50d703ceb056": {"doc_hash": "660cac419a1b57225e5ee8ffda8b3ccc5cde38f285d1ab83193d59d632c6779c", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "8709ed23-b210-496e-87c3-e32cada758c3": {"doc_hash": "6ad909e230a71e2e362924f41d8867252949217750e2c09b1dcdc29130f7dd2f", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "7c098cf3-50ba-415b-8bfd-6ee7939090ab": {"doc_hash": "ad579457f73aad5663daf22fa186ecf2ddc3f82a5ba08650de8331b8934737ef", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "66b0c14f-b2db-4533-a6dc-8fcef8decdf8": {"doc_hash": "29b4616dc86e815e891a923c8882b393d3f627a42ea6abbd4ac63d36442490b1", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "489766c0-9f72-4846-8b73-65ddfd3b5c84": {"doc_hash": "fe934bd85e9101af846322eb9aacad02075bd2d24a959e4c6d7cf386aae81c6f", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "3ed20fa7-ce9e-4f51-95eb-1f439b46e155": {"doc_hash": "1c4a13fed3deb698d85ab7a13acdcc42f7d402a9c7db7baf3e6f369c0db64c47", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "ae6a704c-e678-4945-898c-2afc2ff64f26": {"doc_hash": "7ad1c70439d6f9d05c4e12f0dc430aade14fd86ab7bc03b3f26861dd5e6bddfc", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "eee49905-628a-40c4-8635-792393872d2f": {"doc_hash": "3bb72bf3ad24583aeb3ae908d1976ae154932832e218db9b006e897feec0cdec", "ref_doc_id": "030e9228-69b5-4088-852a-bc31e3cebb8f"}, "296369bb-bb42-4e8a-831e-77b5456293e0": {"doc_hash": "dc5ad0675072ee8d51e50f685b3a1905005d83633d34d8fdcb7db0205fdee1d9", "ref_doc_id": "8731218c-3bf6-40b8-a1de-d97dcce7fc63"}, "a223f9c0-9e8a-491b-ba07-aa8fac336435": {"doc_hash": "3cff71607d0dd4a5f1abd731894ecf54abf6e1c407239e1e4022aaf7d896db7d", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "bf1b1077-9c6f-4743-a380-94d5fcfd75e5": {"doc_hash": "4c29393c353660a263bc69a76b8d7125e99c72c464ce9e466e7b32cd076e06a8", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "45a32a1f-ec48-4b1d-b65c-278ad4b8ed7a": {"doc_hash": "41920fa30b223961014f7831f5257ad3f56eb87bc558af23ffcfbb39d86bb9ed", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "8e04e776-5e73-4854-8658-030c16172ca9": {"doc_hash": "f24f2dba05d28173f5ea7567c49d8f3fe569c98e1d16392119d2425bb8034570", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "f51ae8ab-c1f7-4bec-89be-b64c646271f0": {"doc_hash": "3df07793e200f92c19f0696cb2260f5ee8293cebefd9124f2201f16941a9ba69", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "2f2a8c68-ccc5-4f17-b99f-7c37e37d4888": {"doc_hash": "cf00cde680186cd27e7be52ab51a8d5476d645c72ffdcc3af2ba21e294790c53", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "f6531208-fa4d-43fe-9855-11c98628dbfc": {"doc_hash": "0ac3a6b340464f024dc714f10e84ed4144e6deff0b9bac1954e92282d0fa6c90", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "5053e5cf-d83b-498b-9636-a0da1b73ea3b": {"doc_hash": "4d46b54b754b5c10d608516d4021cdf8227342bd95d38acc6390e85ece6cd964", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "ab3097db-7c26-4895-be56-a4831e6a9d02": {"doc_hash": "a61df17837c88f192cbceceac01302cb910ad14811c1397b3e83c4e1ee7f66f4", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "27a66b91-f02a-488d-8f0b-b26b1db768f6": {"doc_hash": "f25e056a68bc2a71484794216ef01fdb334634cf679c3ece248a40c794b847af", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "cffdbfc1-c554-4da5-99c5-c4afff5499b5": {"doc_hash": "bc854431fea744ea67800f99f65f882572051dd7887427846b3897f115e13c40", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "4dc8065b-6df4-4508-b07d-ad4cbdf05e2b": {"doc_hash": "80a174ee76568e5d5c5adda1da308a89d4aa16280932d6ee2f0be58e67648d28", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "95801549-91d2-491c-b2d2-fdc5e36c2dfd": {"doc_hash": "e250b918f76282b249b0e1dc172c43b18a51a462ec121ff48a21c373ce6bbefa", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "d29b916b-c20a-4e66-b6cf-d346de5fb9ee": {"doc_hash": "44ad40c536ad729cf78ceec8fcef29789b0c36bbc5fc28ddefb3116b44cf5932", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "ac30b6de-450e-49a1-a792-af3100e4e4be": {"doc_hash": "059c3ceba808fb841a2876d42eabf44be30d02a34f2790cc13607014b9258b03", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "45aa3e85-42e5-4888-9be5-bf888c700da1": {"doc_hash": "2fb7d9272b71735cdaadfa65e70836fb059815751dfc7c5228bd4d79004887fa", "ref_doc_id": "bc480f60-aa20-422f-95d1-50126b6c2a34"}, "a40e26c4-7d5c-4f4a-b480-6722e7220980": {"doc_hash": "cac919132928ad80f47500d993e039431e83de87556a99379a324cc7b6a8b43b", "ref_doc_id": "129cdf80-ca1b-48f6-83bc-088bede33a02"}, "27515e30-e5e7-4bc3-9450-de5b7e6e445c": {"doc_hash": "2c357ae1d42b7f840a3bfaf4866746b812850914e6e4444227b0ce34bff33a9a", "ref_doc_id": "129cdf80-ca1b-48f6-83bc-088bede33a02"}, "fc9e69b0-5199-490b-8a2a-4ce2402902f2": {"doc_hash": "58d2bfa85e0a6063c17964cc30eacece5beb638afe706b239ee393a64eece2d8", "ref_doc_id": "129cdf80-ca1b-48f6-83bc-088bede33a02"}, "2693cc99-de21-49a8-b49a-aea3a3733676": {"doc_hash": "e8b839b82bf9bafd0bf570d6541a0ac8d47266a1136b07ce02b4d56cfc18edfc", "ref_doc_id": "129cdf80-ca1b-48f6-83bc-088bede33a02"}, "e2366d02-3fbd-4a5d-8c2f-e312c8acda19": {"doc_hash": "ea6a35b8c00beabf4ebad3b3ec7534db27624a3bc90b6def16c7be7dbb83b864", "ref_doc_id": "129cdf80-ca1b-48f6-83bc-088bede33a02"}, "558e63f0-3196-4b15-a0ac-ebf0cf1ed094": {"doc_hash": "d8fc27af5809667c919b157576ff0da96d319e4e7b6e41b6b64b3823b454b8cf", "ref_doc_id": "129cdf80-ca1b-48f6-83bc-088bede33a02"}, "df2e76c4-968c-4294-851c-04a433cd5eef": {"doc_hash": "6256ae8d76a5c21968fdb9029ea7f6ff4a187d6be2c0caa2f2e5f63a20f3a7d2", "ref_doc_id": "129cdf80-ca1b-48f6-83bc-088bede33a02"}, "92e84378-47b3-4f6c-b98a-ee8e6c731f2a": {"doc_hash": "243b3ed2f78c61e22340c13ecdf159ca207f54943734b878e04d7d52e6795ddc", "ref_doc_id": "129cdf80-ca1b-48f6-83bc-088bede33a02"}, "e22870bf-d107-4895-a9d8-88eabd1305fc": {"doc_hash": "7b452bf50255ac66104e618a516ef9a27ad44260d460051011b5e36394d17fba", "ref_doc_id": "129cdf80-ca1b-48f6-83bc-088bede33a02"}, "8102ad44-b13e-4393-81cc-6081ff7e4bb1": {"doc_hash": "fdfbdaf7f1bb57a99cd82d48f7fb06bf89b299d9ae05832152621004797d8453", "ref_doc_id": "129cdf80-ca1b-48f6-83bc-088bede33a02"}, "c5994994-6f76-4cf1-a2c7-50132960b2f4": {"doc_hash": "b25ff2e383ec73f6c0412a86a9cc93773d9f3b953aa2c5797950fa4a54cb3825", "ref_doc_id": "129cdf80-ca1b-48f6-83bc-088bede33a02"}, "099b92a5-a419-48b0-b7b7-581ae5afc52d": {"doc_hash": "a8b4d168147cd8b400e6faf887167c3b5aa0b07a322e66551b5d63e607cc1386", "ref_doc_id": "1f1d8b79-659e-40bf-a944-ec935ac7ee6e"}, "15c4e7dc-5025-4a70-b124-0989d7c488af": {"doc_hash": "deb0c35a1480b0ad9f6d6a74210b3fbaabe2e9a47292f338d9c63eba84d2bc89", "ref_doc_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d"}, "7f63c05a-909d-4005-87d9-e32d7d6b4059": {"doc_hash": "3f97fd235f039183d8b7d61057aef0ca42651c23a40c9fe4251baed3b16b41a6", "ref_doc_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d"}, "70d23144-719e-4911-b080-efec2142b01b": {"doc_hash": "1ed57e3ee52409afe4493e7627b70b463b656292935d9e54b93d5f201e04a812", "ref_doc_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d"}, "8af7b5ea-c380-46d1-ba69-750e46666ca0": {"doc_hash": "3127dc433a2e8493a4ec83e0b3fc23ff3c18a0420c2741dcf2bb7c03fb42b3e7", "ref_doc_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d"}, "d4b20a6b-aca6-4c76-9468-ecc09ce8a291": {"doc_hash": "f96add7e4e5dbf3684db3ed5a6a91ec85fb96e5859ff459820ee3994b2e64ac9", "ref_doc_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d"}, "6f6d9f94-3e21-4772-817e-67256532bb0c": {"doc_hash": "3526c24c552a68168577e8dea0fe2f316a10289ec6fdbddbf39ccd0c70f0539e", "ref_doc_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d"}, "1cd92497-2469-46c7-acb4-17ab91937017": {"doc_hash": "fd02c681a1841f20b19f842d5c06428c94c30c0f8c6caa82fae4a423bc39d3be", "ref_doc_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d"}, "e5cdfb49-1780-485b-a5a1-498d6a0bd40a": {"doc_hash": "fa4c2aa8a2bb698befe90e30942b0af40b5fdeb363ebe095534943db0b973384", "ref_doc_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d"}, "f630ecaf-afdf-41d6-bc3f-12299596db18": {"doc_hash": "84557029446305eea49c3dc1652a304965a383af249ae644c7f6e7ee74de8b6c", "ref_doc_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d"}, "5459378f-4a76-417f-a4c7-86cf1e595f06": {"doc_hash": "178f57f97789fcc5a7935eb6f3f5411fc9c87f4780c907b288fbbc2b1d73f7dd", "ref_doc_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d"}, "23edfb72-841d-459a-8d92-0e5d0d2960dd": {"doc_hash": "edf4181ef05c857ebb6bbfa567794f01d1f0d0c1d9a02afe4e18470cd725ebb5", "ref_doc_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d"}, "d379c656-97a0-4fcc-b684-ef1febbe9130": {"doc_hash": "650c80ff8ce6032b9749017f3c1ae517fd2728f4a6e6ca88844995d217092b4b", "ref_doc_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d"}, "5c4171f9-7173-4ebc-9493-b760a5a82490": {"doc_hash": "381faa130c2dc33e3f10eac8e4bb9116f08b29c8ac73d9aefaecea638703b5d9", "ref_doc_id": "9676009c-d28d-4be4-91dc-80d50ccbcd6d"}, "916cedb9-59b7-4af5-a330-c3be641033fe": {"doc_hash": "376f33cfd6e5ac7a808f88e61fe6b061f7de5a77a16d2d8bf6d1ce610e736d37", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "036a404b-0157-4e7a-b19b-84e8af99393f": {"doc_hash": "1b8b479710bf5b19b908bea666ed592d35ee0ef161afec9c64fd6907a987833a", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "beb3e9a2-6e48-4ac8-8ce0-ccdedd4beaa7": {"doc_hash": "2a6961e9e081cd0400308a9ef32bd2cdd526c1d4d4614914c700ee6956eaf74f", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "2fadb61f-5412-46b7-a52f-ab009ab80dc7": {"doc_hash": "c6a69ad8e5967a98f0654f0741a3a3052bcd1862ae1b0105d379d0215b0dddd2", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "e7012b03-0f7a-4348-b6f5-c0fda88c531a": {"doc_hash": "63725fb773eb888fbfd7194e6dcff00849f34e737902cf3118a0f44228a2f93c", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "32d723dd-658d-4d97-86c6-aaedef55abe0": {"doc_hash": "3e93c0f3add9818ba4de6925a80fd0e4161fadf69cbc4fc1c29127f109f36074", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "25f3601c-0e0e-470a-ae9b-ee7c4829d354": {"doc_hash": "c999412d0463b3a0199b7acb14fd953a3c70f3e705afe2c3bab84a35f9084971", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "15638d57-4af8-4ed9-9d50-a8759dfff94c": {"doc_hash": "f1da7abd5ff1ad2422087843b17d02ebcee4ebfd0ef0fc343e0c6fcd20c2be02", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "18724a23-da86-41b9-8ef1-11c2aab37b8e": {"doc_hash": "4371f23121543bf7cfa44e03831d096ee880d4193e034d75210aaf83a5865fe2", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "6a160a87-441b-45a3-97d1-2182cc6ff195": {"doc_hash": "8e99b6643b11f0d4b4a0737d1026178c6fc4c910203f9676d91cf99317732b6c", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "e4ea2dc6-9213-48c6-b0e0-2d7fa77a3c69": {"doc_hash": "46e5a3e3d8b42b0f17178b7443ba35f60591d6c6508c596de6508d6d380beb4a", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "bdcdda2d-ced1-419a-88cb-f1b05261ed33": {"doc_hash": "6ab4ffda0595985aac9c973cfaa299257c075b5dc818dca235b03eb47fc40b6f", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "b9a09de8-305e-4adb-9bf1-51853322f1a4": {"doc_hash": "4b14998ddfc26beac6fa7c98f62a04d04df30cf72e4b88d69d420b602771401b", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "37d928c1-1a36-4090-9784-c7a165337c09": {"doc_hash": "28b4753cca26e16c3d43ef3c3a77ed528c38329f34d7e2d05922c0c8111eff98", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "c06b2168-0ccf-439d-9fb7-574f1847abf1": {"doc_hash": "0610987306b075a2c814d67251d5524080f71a0ada1e88855fdefdd2d066023d", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "45d60209-50a1-4fae-935e-2a098a3d8517": {"doc_hash": "ca97ed0988afe954cc02b058fd13f872e26cdfbb72c1d6ffb48ed17296626d4e", "ref_doc_id": "6bef3dec-1708-4401-95b3-264644cf7b21"}, "33f73c7f-2bbd-454a-854c-1318b0856064": {"doc_hash": "e8616c2c5ce4835ceda6fb4ebc4465679428a68953502215615a744ec48cf835", "ref_doc_id": "e23c6654-98ae-4eab-acc7-1a0823e295ab"}, "f2d423d2-0987-4134-a327-366b240a25c0": {"doc_hash": "dd9eb0b4060da6b616b8c2a48e28b8ee78b77068be6ce1ba96eb4b451dae3489", "ref_doc_id": "e23c6654-98ae-4eab-acc7-1a0823e295ab"}, "178db20b-053c-4519-b39b-9c4fa3014f38": {"doc_hash": "a3a6da56bc20c04a1be090ec4a9585ba3998714c539b02cc038578a4e5f5cb70", "ref_doc_id": "9eb32387-8c34-4936-b506-ebdfc3f1dfb0"}, "53f393bd-1c47-4c08-a83f-e13c03d6109c": {"doc_hash": "cac2c65281ed1b80393fc3f934c38b0fb471d632caed02e68d9911517bebd800", "ref_doc_id": "9eb32387-8c34-4936-b506-ebdfc3f1dfb0"}, "6d691917-8802-49ba-94a6-1ae8bf0b25ed": {"doc_hash": "808803b915a2ad3a1fdfb698aec4e5e2fe5a714d3888f1c871d549d9ae7e999c", "ref_doc_id": "9eb32387-8c34-4936-b506-ebdfc3f1dfb0"}, "55fd57db-43b5-4aca-84a1-7ebaac1acfc3": {"doc_hash": "9693089243b57bc54e4774c8409feaf69f6f83cee73ae4a0b1bcfa4032a987c3", "ref_doc_id": "9eb32387-8c34-4936-b506-ebdfc3f1dfb0"}, "11c44e8c-3fa0-4e3b-b727-cc1aa369bc0c": {"doc_hash": "109b665ef067298c318d2f280b9ec25f7a2ee237e57db0d826b249b3d13e19fa", "ref_doc_id": "9eb32387-8c34-4936-b506-ebdfc3f1dfb0"}, "e620f8e9-d3e8-4f83-a4b8-546261e4098e": {"doc_hash": "5cf61178b305dfc004b20e20f0916c0e936a894bbed1f40aeae6dd4d836dcca2", "ref_doc_id": "d0012f5b-8adf-434f-8eb1-f08972054914"}, "0eaa3233-bc6a-430c-a918-3b10d7fb81b8": {"doc_hash": "f84ee2f29334048439ee78d70b878fd9ad393c7b25fc20f09c81567df253a068", "ref_doc_id": "d0012f5b-8adf-434f-8eb1-f08972054914"}, "4cd99b9a-7f5b-4134-a176-77725d7899d4": {"doc_hash": "8e204a303fd04e652c7bfde4ef7fa2f168b9c2325797bc6d613700d4d99890de", "ref_doc_id": "d0012f5b-8adf-434f-8eb1-f08972054914"}, "56e37b60-6292-4698-af8b-2f11704afefa": {"doc_hash": "d0d73df39eab216bd9578dbc29db62efc8ce9caffdfe1d22b2b1388db9c9b875", "ref_doc_id": "d0012f5b-8adf-434f-8eb1-f08972054914"}, "feda2f68-8811-4b6a-a3cd-387346f6be95": {"doc_hash": "de818cc4f0335552decb6d362edec98aa82e804796c41bb6cd68bf1496ab75b0", "ref_doc_id": "94a5a5fe-88df-480e-afd4-30c9e1bd5de2"}, "357ceae7-47da-49b6-906b-a96a7182426d": {"doc_hash": "c74834b26dc567b92ccb60a88a82b0321ee564d0742cd3b226c1c1bbf59d25d1", "ref_doc_id": "ee378d0f-bb3d-4b16-ae4c-93b45e111998"}, "c9261018-525c-495e-8f9e-9a9541698ae9": {"doc_hash": "c2e019595a2a9e33be5fb7a35f77fd025b8483f1de80fd419b8082d1ccb28116", "ref_doc_id": "2a150c0d-6900-49e4-be11-0129ad1ff0a9"}, "872e3569-1d77-4889-9fa4-2b32e95e612e": {"doc_hash": "8848fa0cb67209ec7957c7ddee2e5ee605611ea15848f10a037b2db356f210f7", "ref_doc_id": "2a150c0d-6900-49e4-be11-0129ad1ff0a9"}, "fa893b48-67cf-4d9a-bd40-fba8a3cf7a7a": {"doc_hash": "fde14c50fdb280bae58fa64278249cc4563a67af917678ceec8fd4ba6c3bb5e4", "ref_doc_id": "a8d76ca1-7cee-420c-b994-cd523c7a05fe"}, "73091678-575e-4d8f-bf61-299ff12bca45": {"doc_hash": "cfab9c44f93ce7a54fcb54840e09c8ae0e550cda27f266d405760ff5bef2108c", "ref_doc_id": "04566d32-cfff-471f-8400-cfc01eca5e69"}, "c1f5047f-e390-4e42-a521-2ee059e3406d": {"doc_hash": "5118d1b3352056ac028faa91673991298818248d58c6daf62654988557f1a42c", "ref_doc_id": "04566d32-cfff-471f-8400-cfc01eca5e69"}, "f0ac1733-d9ca-4704-a1ba-f27a605b6c53": {"doc_hash": "f2e10aeccc3169d36e67e263de3ce728bddd2cc66583618c2cd69168b6899a43", "ref_doc_id": "632c9998-7894-4bf3-89c5-b795e9f34993"}, "1a8b7567-25e1-4ef3-8ded-37b9aa672b79": {"doc_hash": "42c2700bd04f15b7fa825841995a7eb5e9aa6008083a35f0d0a4c751d66b5426", "ref_doc_id": "632c9998-7894-4bf3-89c5-b795e9f34993"}, "456c9d8c-eb09-4a48-bf73-05efc7b6abf1": {"doc_hash": "41d777513d66e32fc5752daa269a575209b0f7f7dec12d23f6831ccfdddd81a3", "ref_doc_id": "375684a5-c302-432b-821b-1c22ffc7cfd1"}, "4c065d1f-7710-4af0-b820-5100c1b79dd7": {"doc_hash": "d3ad5f9fce643bf2a5daba05f311d99d8e68345b3bf04fe2e277d09b29a10888", "ref_doc_id": "375684a5-c302-432b-821b-1c22ffc7cfd1"}, "0295d9f2-2080-4ae7-8d3a-a3baebe10dfc": {"doc_hash": "08e0d4e557c0734d55b79481f31749ddc97fe4d92fcf4f2235e4db2e2f63f8d5", "ref_doc_id": "375684a5-c302-432b-821b-1c22ffc7cfd1"}, "6b6bc4ed-bc89-4e60-991a-84f73de9a2df": {"doc_hash": "a9abec65aaed3a5dce2c2f082be0969fe4cdeebf45561e3889671f9e3f2d6207", "ref_doc_id": "9e8bb349-ce3f-40f4-8555-0c50643f84e2"}, "a89adc71-68b5-41c3-9763-142bf1f867b3": {"doc_hash": "8e55336d2be1d7a24a9d23f6fa373ce6791ccf834015713fe5c1d02f0042cf25", "ref_doc_id": "9e8bb349-ce3f-40f4-8555-0c50643f84e2"}, "6512d727-bbac-4f8b-aba0-2de85107b031": {"doc_hash": "36ccd0078819aba39411c55c6a00bb05885e9e8ae2dd4738242835957d39cbe7", "ref_doc_id": "9e8bb349-ce3f-40f4-8555-0c50643f84e2"}, "b7cec1c0-c472-4c7a-be59-59dfdd354f74": {"doc_hash": "1010b3de74c137219ce0064a5016cd5d9132a871dd987ba9739669c6f3152cea", "ref_doc_id": "9e8bb349-ce3f-40f4-8555-0c50643f84e2"}, "642f716b-a2e0-48ad-a49e-f049c9249237": {"doc_hash": "1af0899569a06ef21479cd58bc5956c39eb0b3868d17e5a3ffb62afbc85308f7", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "015f861f-e44d-4f18-b6da-37d1debba8c3": {"doc_hash": "8feb39e91232d5d25785a1ff20c7141d6db492b6fc652558afde6c81de935509", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "18d442e2-a9ad-419f-a81f-f2479e073d04": {"doc_hash": "79dd6b403a29ebd181139d0558458782b00f3abcda2e662aa4f014069fd2fe29", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "68f0d708-caa7-4ad6-a04c-44b6303ce570": {"doc_hash": "6313cdcc696477adf8b3136fdac7752d3633401375c47359a4a2420b27d63379", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "9304a8a2-7d60-4be8-b089-06b81d760198": {"doc_hash": "8f7801ef798fa1ca3bc4ee4c3362bef12b16217bf8ca61c87cc2390e9a24ae18", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "36b0483c-375f-4b56-992e-1d64eb94cfac": {"doc_hash": "f9c43f408e414d8b0086d0081a4ee60f4681ea27b7a0aee83f4764c3d880e3ba", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "c648f211-3ec2-4e11-b524-b1a375e10ac4": {"doc_hash": "260411f3f411516f1f0a8eaddfe7c1a1712d827066e66e68b4bc0e8c07ceeadc", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "08167894-b979-4a82-98e2-672db922885d": {"doc_hash": "a398a42b9973332ad5ac64ff6076946edb6421b1a0785689a9b9ed9540cc8004", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "0a48f20f-64cf-476c-9162-082e3e84b40a": {"doc_hash": "7d938b95fcf34288d0b58b50d9d6543f084b932402f7f4012c9b188c85259c2e", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "335cc0a4-1dab-4c59-85ec-dc9afa737f8d": {"doc_hash": "cb0236b3fa2f038b9b89b9bef4ea249ca1bf6b9d7a1a4f7b76c8a723e0273f8d", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "b1e2778b-2faa-429b-a509-4b4b71923e9f": {"doc_hash": "25028084a060221b2b0ae6407027f68d1783cc088be0b5ce72d9dc5dea3a3f3f", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "cde64662-2320-4143-9efd-22474a2c1e62": {"doc_hash": "bc0d055dd960738be93ada927b5364abf97dc8148c0a79ef09fbab561641a6db", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "0de1a9f7-da60-459c-8e59-e1972bf3a7e1": {"doc_hash": "9514f1cd533d6ebf6de8bc9b14479b21a7bc622bef87f8ddcd28ef9902b9576a", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "8c7ceb60-904e-49f0-ba8c-f91bcc6a0c06": {"doc_hash": "7d95d0080fa30c65441162c7b18222249247e5f9af4809b240dcd84049477b5f", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "a7044042-008f-4136-bf3a-b925e678cfb9": {"doc_hash": "828a8c3e4230b21df69ccfe3ba32b0319ab4871489d2769fef1660e5c33a4c66", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "3886631b-abbd-4f62-8e50-f93ba1aa6e33": {"doc_hash": "7996a87b5eaa9e097bf368141b1305300564c64c9872b039f0436ca855735745", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "babd6db6-b439-4160-bff2-d53d09999ef7": {"doc_hash": "3ce35b49742e5df9510fb153fb7ab7594a53aab788705c6146a1a9051a7fb9b4", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "f1256d81-e25d-42c2-bc9b-9380a550d40d": {"doc_hash": "f30f1649829619c5845a89a47a4d1c516d7274d978a25b753bf28d637e56fa0d", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "f5dabb94-d271-40a5-92bb-6a58190f6a30": {"doc_hash": "49bf2a0b8961c805ac501979ac5bc57417082fc10c6817992c9ff7eff6e8c34f", "ref_doc_id": "386be83e-e394-4b37-8896-fffe4d3efdee"}, "c70b0011-fe2c-4e52-9c7b-35e0836e0cd2": {"doc_hash": "37fef8d0d8b286309b12623ca34ba06fa4387d89ddc0a24f0d358d79fcae21f0", "ref_doc_id": "58b44cce-15dc-40ac-ada6-24005530c5c8"}, "41fc9d25-23af-401a-ba73-bb0e24151d9f": {"doc_hash": "9c2035a0ad08f2f482303576e1a8805708a52d99dd364553b0617aca533d5299", "ref_doc_id": "a12891ca-476d-493f-8a7b-39aa25f63b26"}, "613c7c5a-babe-4a19-84a7-7b6f875eb751": {"doc_hash": "95da69b308ffd0790107eb276e87d4c0a800923840742aa5f84dd37adbf01f47", "ref_doc_id": "e78c2de3-af3e-4222-926a-2f3ec59396f3"}, "d27c1677-bb40-469d-9a02-31c931b9aee7": {"doc_hash": "7c761146d1d8391461d23e2ccbbb7cbab2def578d0213bcfe16fba20ec88d485", "ref_doc_id": "e78c2de3-af3e-4222-926a-2f3ec59396f3"}, "13f7fdb5-cff1-4d3a-a4ed-ee9449408141": {"doc_hash": "ebf95553eba32489b37026cbabc747307ef16b3811c0bee54f5b878301588ad4", "ref_doc_id": "e78c2de3-af3e-4222-926a-2f3ec59396f3"}, "0b48c105-4da3-4de5-b046-b7c78b0f65ab": {"doc_hash": "38dcd2010710a44c81bba0114112fbf61084fd74a465960780a258016d99825b", "ref_doc_id": "c5188efa-8d1d-4299-be98-73a17db82280"}, "be4879b7-1fbc-41bf-b32d-62f82d48ae2b": {"doc_hash": "0d4c3997429c9d0013e6ccd2e4ab3a0041883e9c3b18e3ce4fecf793ccdce555", "ref_doc_id": "c5188efa-8d1d-4299-be98-73a17db82280"}, "6b6867e3-d775-4a81-a6e8-3457c3032c84": {"doc_hash": "bb4df898d4ab3a5911b7dcdcb9c771378f152abc4aa06b8e9282f9cf90a7b21b", "ref_doc_id": "c5188efa-8d1d-4299-be98-73a17db82280"}, "6c3bd0bd-6d8e-4c59-af90-1dc98d039b17": {"doc_hash": "4ba3319f9c154ed6ecff8f7cca9476bb9b61d288c6a31cad1f61d58b7c12e7b4", "ref_doc_id": "da27b964-9989-4833-b81d-cf68385bb800"}, "f045dc83-4886-4f44-9b62-87df081e343f": {"doc_hash": "8a505d04b1707bc1bd7501ace59d9159f837f14caa1b9482f15814cff2f67898", "ref_doc_id": "da27b964-9989-4833-b81d-cf68385bb800"}, "67a31168-656f-461d-9c97-6e4cbeb0d2e2": {"doc_hash": "ffe5649731e699c31a4f6695a479708758f157ba7315bf5b7f66450c381ba1f8", "ref_doc_id": "da27b964-9989-4833-b81d-cf68385bb800"}, "66d046c7-bc17-4a72-8008-b697db7eb8e9": {"doc_hash": "9c65efa2f12126583a1096753e1001605a5fa97215175c99be764a1144f3f73b", "ref_doc_id": "da27b964-9989-4833-b81d-cf68385bb800"}, "e6191116-a7b4-48f3-834a-9f15ca8e5db9": {"doc_hash": "773cef56d4058f492c0ef250cddacb5de939b9f655663edd63eba99c5e969349", "ref_doc_id": "fc88b9d1-b571-4f78-b6c3-b47bb9a3c5fe"}, "96640968-7d84-4eda-a8d0-48d1b801a5a6": {"doc_hash": "f58033de3ef0455a8629b527cea30fd4926671e65973223cd27965e7f699b630", "ref_doc_id": "fc88b9d1-b571-4f78-b6c3-b47bb9a3c5fe"}, "84bbd52a-546e-468a-a114-fe5e08161589": {"doc_hash": "ac7306c5cc14451950fdddec4f4003bd6ad3f141a4d69ce3a530982ab30bd328", "ref_doc_id": "fc88b9d1-b571-4f78-b6c3-b47bb9a3c5fe"}, "b1d38547-fbd1-4fab-857d-4352579b77ed": {"doc_hash": "70179320410e261930360e30b79038626fd8b80d88b6d4d5a70b6f7c0cd5b7c3", "ref_doc_id": "fc88b9d1-b571-4f78-b6c3-b47bb9a3c5fe"}, "2f12add8-1fe9-4ee6-9c5b-69368efb4ecc": {"doc_hash": "ec787d9df8fc2b824d6194a1f1cc9ec95146cbd93b11ff296ee08212bc288448", "ref_doc_id": "fc88b9d1-b571-4f78-b6c3-b47bb9a3c5fe"}, "87e2f789-1116-48c4-96ca-683b65938d71": {"doc_hash": "ca2951eb2b830650e052c1a5637fb493807e82d6926d83029fc72dbe4dd57f5f", "ref_doc_id": "e7987774-37b5-41c0-b11d-e3dc713dd591"}, "135592b8-8c14-4e6f-993c-376bd36e8dcc": {"doc_hash": "a49e02948aa318986a3a45cd3ce675c9e17f09ee49748f3f07e2c04454276f4c", "ref_doc_id": "efedb385-51ac-4032-b428-5c22e7ebfccb"}, "95e2717c-503a-4844-abb6-52be382f8803": {"doc_hash": "34598eb2156a2ef46dfc75091f41d4e0be45abac53807d06dc016f6bd997adf7", "ref_doc_id": "efedb385-51ac-4032-b428-5c22e7ebfccb"}, "3e28470f-1744-429d-8474-85fa5d779d1a": {"doc_hash": "adf915083bc24911b698d165924faa53c18d97d19238dc93214b280ef3dbbdab", "ref_doc_id": "efedb385-51ac-4032-b428-5c22e7ebfccb"}, "5559da3c-4c4b-40d5-a5ee-a22039bba44b": {"doc_hash": "a8184962a9028d5cfc5d3797eaa106b9787ed6ee15b3ea60d147fa530a71b0c4", "ref_doc_id": "efedb385-51ac-4032-b428-5c22e7ebfccb"}, "f065052c-211c-46e3-86a5-d851c6673a7c": {"doc_hash": "85983f91d19cdb1846b36f2a9703f9f288b0a5480677ce3e8bbe473eadfb0b51", "ref_doc_id": "fd536039-a969-4e29-8034-3836af76e2b3"}, "b34141a2-263d-4be4-99ec-5a05bedf43c3": {"doc_hash": "38f2a9079639d74d3b900f2ae713343aeb52947e080a764c58067a0fc08c51e5", "ref_doc_id": "fd536039-a969-4e29-8034-3836af76e2b3"}, "60c446a5-8636-4a78-bc30-a0855ab678bc": {"doc_hash": "bdddc88e3051d81f7e3ee6308691a1f6f54e1bcf5f0d45df6d62d7d67b0e5e0f", "ref_doc_id": "fd536039-a969-4e29-8034-3836af76e2b3"}, "6321e8e6-92c6-4d1a-b2e2-49f245846fe2": {"doc_hash": "8e92c93001bf90e75de838037eabb3e237974a1dfdf3d0b8cd21732ea765dac7", "ref_doc_id": "fd536039-a969-4e29-8034-3836af76e2b3"}, "1d5f77cf-8005-43c7-b8a1-cc06cd256229": {"doc_hash": "f02b6ca54c58e299fa39b0a6a22d7cff21eb91589e9c5b7d6da47c47dcab3020", "ref_doc_id": "fd536039-a969-4e29-8034-3836af76e2b3"}, "74ae9d44-ba47-483a-8a27-4c8d234602c1": {"doc_hash": "00d795910d8bdf21fb2a5e937b993dd6c41645ce3af580635f7bfe2fb3e91bc9", "ref_doc_id": "fd536039-a969-4e29-8034-3836af76e2b3"}, "21d18e35-8894-4bcb-9a43-dfa7220cb039": {"doc_hash": "80f74847964beb78375ee27a54a375e7e085ab931dd84fa65973ffe78a9d75ab", "ref_doc_id": "fd536039-a969-4e29-8034-3836af76e2b3"}, "8f531ec7-6726-480d-925a-93459d26d7d4": {"doc_hash": "b4f4fa10802068b3af0b13de07c1ffd0cf2125944ef3a93971942cfeeb4ec782", "ref_doc_id": "fd536039-a969-4e29-8034-3836af76e2b3"}, "cffc8e82-d713-443b-be88-3b379e3503f6": {"doc_hash": "3b432a94c6d0f4a81f3e40e09dded8824ab3f4f4bde087e9d499e4ce88c8faec", "ref_doc_id": "fd536039-a969-4e29-8034-3836af76e2b3"}, "f4b61da6-f5cb-4041-b410-c5b7b510cd93": {"doc_hash": "84fea75bdf24ee5e0ba332cc89ce1b7ab4cd11dd97cad9e6cd6ecf467a9d8c67", "ref_doc_id": "fd536039-a969-4e29-8034-3836af76e2b3"}, "0e53a53b-1f0b-4ba9-9318-3a72877bc374": {"doc_hash": "9a9453407d93a6177ac9383bf3a98d8f81d1fcd032d27fd7f2d4ea9167db9d44", "ref_doc_id": "156d6ab7-38b0-42f9-bdb0-030ee1fa3afd"}, "2b384deb-bf37-4a8f-a4a2-f0ab8c690e4a": {"doc_hash": "0891405dca2ebe4665f483a3b084bb272397dce837b2f41705f5109fd2a59b0b", "ref_doc_id": "156d6ab7-38b0-42f9-bdb0-030ee1fa3afd"}, "85d1d450-dbe3-49f9-b56d-8b27639e97eb": {"doc_hash": "ae6a2a6d7540ca0cc0592e51a5a481708d979362f085562af970aea3a4b7fdef", "ref_doc_id": "156d6ab7-38b0-42f9-bdb0-030ee1fa3afd"}, "689718a8-db50-43c3-9ab5-ed48a2024c4e": {"doc_hash": "d07df951e4e26ae1b559047cf833ef2db7d79f356008a201bf0f650ab22883b6", "ref_doc_id": "156d6ab7-38b0-42f9-bdb0-030ee1fa3afd"}, "17fde8c3-ce16-4c76-a1c8-2b1d88c6a35a": {"doc_hash": "28617002fab118c51844a50d8ee96e31172b8a65ab28eeda2cb280e96bed5527", "ref_doc_id": "156d6ab7-38b0-42f9-bdb0-030ee1fa3afd"}, "22ed22ba-fc0b-4406-a380-a47b25559a22": {"doc_hash": "d859cd654f2ecdae56442adf22de682b9d9e39188b3bc789b1552b99bf436b08", "ref_doc_id": "4db4e53f-159d-4dff-9a73-6b02c77e59d2"}, "832bf062-780f-48ae-ab60-581ec83c0719": {"doc_hash": "2d02d23cca9efece6bd71b751ac91196d555de6c10860f56272a0dbd91f27764", "ref_doc_id": "4db4e53f-159d-4dff-9a73-6b02c77e59d2"}, "8f25fac2-7d5a-4e56-b3f2-d7e59cf35d36": {"doc_hash": "3e0efcbd5ffb6642ba550a530e4dd63e3946b674739c8a366bb9bd51cea9e4c7", "ref_doc_id": "6131f5e5-1d7c-4d4e-ae35-1f6da10024d7"}, "b771582f-ac20-4972-8b63-c881e595ee11": {"doc_hash": "a1055795188feaee21487b0f74ccaabedc2d17cb12d58a8376b02c5957af752e", "ref_doc_id": "6131f5e5-1d7c-4d4e-ae35-1f6da10024d7"}, "17244134-8e12-4d19-b435-37207b96afbb": {"doc_hash": "49a0f26fabe2ec5d7122cba4810997af1d6e6cccec3bc9523a08160b3de81465", "ref_doc_id": "6131f5e5-1d7c-4d4e-ae35-1f6da10024d7"}, "6016ff9a-e83c-4797-924e-59d698e7cea6": {"doc_hash": "f9b2c8fde3407c85ca7f120a59721967796c916ff451d3e02d8b4b0ff420a79c", "ref_doc_id": "6131f5e5-1d7c-4d4e-ae35-1f6da10024d7"}, "7be02fb4-d224-4cdf-b15f-97f91cf1b43d": {"doc_hash": "c454493cc840e43f4b218da83c1492d8583d2b10060ab4bb33af8a7fbf4107c7", "ref_doc_id": "30affdf8-fbc8-438a-863a-d986b424c71c"}, "c9220e96-80ba-4364-805f-09520e844a11": {"doc_hash": "ef9689f55c9d32cbfc1ba089695ddf113964d0985581365a37d4a7db340702bb", "ref_doc_id": "30affdf8-fbc8-438a-863a-d986b424c71c"}, "7fd6da47-793d-43ec-9f96-fed1bf64b4fe": {"doc_hash": "db3722fb57463f3c87b7d75307d9ca83be35f0d4a8fbaa16ea52fd1f37856207", "ref_doc_id": "b97982b0-8202-438f-b247-bdf5d1cb34d9"}, "e672cf69-a405-4592-a932-fd5f2be558b7": {"doc_hash": "c1e12f1beaab540432ff1abe840431ca655efec1cf54806128c458931e8ecc99", "ref_doc_id": "e1282358-cb68-401e-8f00-ab6537fd6204"}, "05f73831-d55b-4c8b-bc2b-13d6da9ddfa9": {"doc_hash": "84d41122d3dc9a18fb4608e36807547f96d6aa959f92ee89b79c39a56018d424", "ref_doc_id": "7098720b-ca69-490b-8851-0355d00e896c"}, "15a16b5f-4b40-48cc-9900-0250b88c2511": {"doc_hash": "021f971985f719b1a3898d0fd13b6cde6c8e8ebfd721a59cc5cff82b46812693", "ref_doc_id": "7098720b-ca69-490b-8851-0355d00e896c"}, "330ac0d4-f745-468c-8655-aee537e237d1": {"doc_hash": "cd8b0fe4e4a30a66b90370e175a49ae5a785fdaed307c50fd3d26c28c0605695", "ref_doc_id": "7098720b-ca69-490b-8851-0355d00e896c"}, "de02a404-d2c2-4ee4-8bd7-6639ea804a0b": {"doc_hash": "179eeb0d6075d402b17d71d2b9f659b92fdf8243b78969cf5040b1214152a143", "ref_doc_id": "7098720b-ca69-490b-8851-0355d00e896c"}, "85d67446-05ad-4796-ab6b-c20e26d2dc21": {"doc_hash": "5c67957f651fbedcc09308d2b3ae963b1818bbd6260171b131224b561516d8b7", "ref_doc_id": "7098720b-ca69-490b-8851-0355d00e896c"}, "de90e004-ff2f-418b-9671-8da5c6df48cb": {"doc_hash": "a589a70a07974370f23e8b44cad5219103eeb4e45490653c9489a6c82af951eb", "ref_doc_id": "7098720b-ca69-490b-8851-0355d00e896c"}, "dc77b532-cc15-4e53-8df9-ea77bf7756a5": {"doc_hash": "f242038218ac7b74bc399199252a8b8f09b0602faf39d349fc6b012f008f0c4f", "ref_doc_id": "7098720b-ca69-490b-8851-0355d00e896c"}, "f7561e66-02ca-4da4-a6c0-f384f9b6e0ea": {"doc_hash": "5318faa871f1d4fbca9e435bfe6d562adf76c7fea4974d23a94bdce995bc2760", "ref_doc_id": "7098720b-ca69-490b-8851-0355d00e896c"}, "3b6545cb-5382-44be-9ca7-79f7e8891c00": {"doc_hash": "33c270806c2f9fe5ce90d4ebca87c696462a87c41dfad0e6a2cb96543522444d", "ref_doc_id": "7098720b-ca69-490b-8851-0355d00e896c"}, "e5b91e2c-a46d-46b7-b0b4-cc25da7fb7f4": {"doc_hash": "2b7533a360d0a51b0e727dec00c9ebebb8c8904a59f09eb03f4916af838151b1", "ref_doc_id": "7098720b-ca69-490b-8851-0355d00e896c"}, "625c9d0d-5cb8-445d-82c8-aceef61b9aac": {"doc_hash": "a452925a3b635df02e75a0c5628e8d6dd558c4e3384495c94864041a20ae98df", "ref_doc_id": "7098720b-ca69-490b-8851-0355d00e896c"}, "7149b8a3-c58f-4e06-9950-68c7d453ee40": {"doc_hash": "fd2a814054e20b605a0b2c6c5c4d969197ed3d8b54cacf049e65c3bf46d91dfe", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "d8d88919-ef78-43ce-a359-86defc92ac7d": {"doc_hash": "1f51d249551170b89d8c0b001e4db414789dd38e0a49a145e54770df76c658ec", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "046ef454-364c-47d1-8167-1b2a0e4d86a3": {"doc_hash": "e29808330626b5a3a9cdfbeca58049ed9f3f1b08ae08043b1c7b191b0092a1c4", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "b9ef0e73-16c3-48d7-852b-c32548d086c9": {"doc_hash": "c7710c7bcc6e2c7a8d35bbb332ff1e26f819d94e2344e1fecb78aa76bd0a62ae", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "1322fa93-421f-4a1e-bd69-8cdc92766708": {"doc_hash": "10205a49f96b932206557c5a26785e24e2f67e38921f129d62e43d0440016583", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "f1e106ec-3c26-411f-8f6c-f76106a4c0ec": {"doc_hash": "0732586c493e5e5d64c73984465e960ad0f776c48ced9c5c13a26ee149412586", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "5fd5c905-bf55-4028-bed3-f7f320f2fb8b": {"doc_hash": "b7775c05ead2f1539e9383155663ae1e08ccd64cfc3a9849b0ff62ba841add19", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "4b491e60-b4c6-4df6-b12f-11d975a42cd2": {"doc_hash": "8ed9c1d08ab996c10ebc37378c7c76feeac7b0f649f5d1ba8db26fbaf9024ffe", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "dad99d03-32e9-4e37-8cab-bf8a261bf9fe": {"doc_hash": "ad7b575efadaa75041297d215cdcc323e8d9117238104597a99488bb19688b3f", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "b40aead8-9ba3-4102-9ec2-c0cd8f6ad294": {"doc_hash": "0d1e7a4a8fd25dd84926be46002d8839704d85e9a32f539b0e45ac79a58a95ab", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "f2bba4e7-aa78-4708-97db-df939bf4dae3": {"doc_hash": "4e996201fb4d43ec7cd6e61ae2874e848659882c2420a6717265bdfd3eabbb78", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "c81d3541-6ad3-4d61-9176-221576be2502": {"doc_hash": "be5a84e4e41dd1e075de12b70f88fa112172b58e548f04035cbaca555c8ebb8a", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "d526427e-b1f2-4c67-a490-f29dbd566e4a": {"doc_hash": "f9d7521ccc05a5e42d35667ee4649cfbd67a28642bea353de268aaec5fb18576", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "61c3d22a-4923-4279-9237-2124eb161990": {"doc_hash": "d31ec8eca9dedfc0f397762ce2882f6a862ae155b8dfe4d954e1085fb1b085b3", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "490c035a-c582-48db-9d96-fdcb1b510602": {"doc_hash": "98f277175a49bc8bd8da3d6bb68f96ae7104a4571ebbf160ad46528863d0767a", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "3fc2e8ac-7022-4be6-a8d9-25d0bf10a1a1": {"doc_hash": "8dd74e5cb77a35633728469d0be8af549280b85465c3b517093ea087b69ecdbe", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "452c45bb-5c70-4826-9549-b87a872325be": {"doc_hash": "5e111e56e07feef16d10f74c6cb6298f0f42a2ad38771838917a9014c9f276cc", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "525b6b39-c10a-4889-9e35-76fdf7d01f1c": {"doc_hash": "1424ed922aa34bbf2d56740bb52ff5ca9c3c51a9fe084962ee5ab8b3a488223d", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "9a1a1281-b7cb-4cfe-9b7e-fdf85ea1383c": {"doc_hash": "6443d0ffa5f2440deca3e4db67e9c947c65a7983c53bb9c35ea055f0a835653b", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "f6a5fb76-a144-437f-a2ec-fe77bd899226": {"doc_hash": "e8c90d479b95ab4980c595c33aa36ffefbeebd2e5d5f3839d518280399fa62fb", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "765f5d0a-d3bb-4c34-82a5-6fafe361738b": {"doc_hash": "dc1e6eb4190e5ec0a81a15e7611da5b072ced9c11007962d247d3e19d2b589c3", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "5de0a6e7-71f6-4ce3-89f9-06c33f3ad740": {"doc_hash": "c6223c31a34e8c7fe706e4f2a9f57b41cf27fa7b1d92b61755d98471acc607b8", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "c0ffb2cb-b729-40ca-8b71-852a77ccee38": {"doc_hash": "ed80e8fb5f77bc65a243442da9dc1fd5c7f4d1d21d369b3f47eb3ac06e81ba53", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "60d8db21-9157-4688-90ba-61ca1ea06022": {"doc_hash": "9cde8f26838a6bcef81f98b5a70df3eab4e94250882e0a3b357f08cbf69b6d2e", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "8526f99f-3bf7-49e3-8d54-67989d393fb8": {"doc_hash": "fbb1fa76cc5c9effe1458ee24aa8c8963e3416835f14317e0d91009d1dd8b1c9", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "ff50379e-baa0-40fe-aed0-e60b17b899d4": {"doc_hash": "a1a535ad896d1ce0c05450312173f455f5e02a01e6104d5d3370d52e24a5fe72", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "329f478a-0baf-400a-b390-38bcf4d2e611": {"doc_hash": "af9b835fc1e95d792125ac6962ac1e23c226811f3cffba8b638d6510ba57e83c", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "32ca947c-58ec-4a9f-a1cc-ed4f4b294f16": {"doc_hash": "18aa15a738b093e8d6f7268ebdcf5de3bb353ff2a436b3279ee99419d543dca3", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "18e1d441-c270-4186-84d6-8b9a8f84a225": {"doc_hash": "039ce6f520861eb985f6cfad5fe00405cbd7b95950e803ece037003a92fcb3d3", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "deb7c9f1-5c8f-4521-9f58-a10c05a16688": {"doc_hash": "97b0ad758e049fe2a2ef58b51ae2732ee14a02a7e2b7795079d78a315e28af68", "ref_doc_id": "6b358d97-48fa-44f3-a70f-ce0afe5bdf22"}, "d154e78b-9763-4aa9-8eb3-0af6b556c6c1": {"doc_hash": "c01c61055b6742393ecc54c2e1c1d0bd17d0d042df7b34393e9b4d232d617ef7", "ref_doc_id": "457f4450-af45-4315-a5ae-6132b1516166"}, "cc7d6f03-602b-4ee7-bc4b-20417c24cb89": {"doc_hash": "fc2ea4d15cd802ce7b894c4034d8e20f95c0d94dd760cbaf17bd1822a654b388", "ref_doc_id": "457f4450-af45-4315-a5ae-6132b1516166"}, "ca3fce4d-56dd-43ef-8b49-503b01f29315": {"doc_hash": "533f7744937af3a53718481789427c30485a94e19a33c0e9d8d558969a899de5", "ref_doc_id": "36b6c17a-7b40-451a-b619-a1d4cfe9fba4"}, "3feaa4c6-1e23-4a0c-9df4-ce75ab17a2fb": {"doc_hash": "e30e2daa38eff2481fcc572fad4c335f8d94a211c160d222386bd643b3534fb7", "ref_doc_id": "36b6c17a-7b40-451a-b619-a1d4cfe9fba4"}, "0fc46bee-4d83-4d62-be47-97111726af69": {"doc_hash": "60b2a5ec2e12fcf389bc80a5af54495b4ebf193a1544fcc2cbf262120c940292", "ref_doc_id": "7209c06f-72f8-42c9-8d9e-80f68146862a"}, "bc28a4b4-53bb-420b-8d39-53fa81e180f1": {"doc_hash": "0d433287e423094165f7522aa3ea1e212d54b9ccdfed9fee7d5e173e588c5eda", "ref_doc_id": "fa07fe36-2da4-4504-9464-1c4578676764"}, "5d762a68-d8fa-46e6-bd2e-459692d7f32c": {"doc_hash": "43ec1faf9dd19d9d6e7060ee35cd1b1c877819440ee5a8ae9517ba38da547a74", "ref_doc_id": "39bb7120-2ae2-4bd2-acf2-17669962abc2"}, "ca0202e0-57e6-4858-a28f-fd7d2c8c42ec": {"doc_hash": "520e88b0a6e938cc572dd48320a1a930ee7aa2c7fe08b4e58cfc3496f270cd8c", "ref_doc_id": "39bb7120-2ae2-4bd2-acf2-17669962abc2"}, "710f3060-0d74-4fbc-8f9b-114dd4486236": {"doc_hash": "91b731bdf1f4d34179dc63b875c9cff00d4ff4afc57e7bfa4b2bdcbaa767069c", "ref_doc_id": "39bb7120-2ae2-4bd2-acf2-17669962abc2"}, "b26b2cf8-39da-4a82-a4c8-7e99d1a6d232": {"doc_hash": "8b4e7f728296d937e16e746fd6afe65cda5972812c61dc90eb1e442c0ab8ba10", "ref_doc_id": "39bb7120-2ae2-4bd2-acf2-17669962abc2"}, "917b662a-4b10-46fc-9d92-9931ad8e016d": {"doc_hash": "bef6f22b9d3f65244f6699c8a3a79e6df7a413c08fdbe38c5743461957a36a9c", "ref_doc_id": "063335c8-e881-45cb-8e4f-3991603da90d"}, "227aea20-0ed4-488e-b0fa-8999ccc4b22c": {"doc_hash": "d1abe6ba80efd778ae274d0fe9ff379a7ccc853c774cb5bcbf6af78877256620", "ref_doc_id": "063335c8-e881-45cb-8e4f-3991603da90d"}, "5eef2db4-c43b-4be2-b567-e6213a7ea6a3": {"doc_hash": "6f70f8aca27fbf2b563df556803664878a488b9da80ebab49b4f351c40e670c8", "ref_doc_id": "e614e01a-2b10-470f-99fd-186db26545c1"}, "d6083096-5cdb-427b-b379-d329c8a2cace": {"doc_hash": "e8bfa1ff3d98b40cbb8a6e3fd9aa70878ec91f26729c71a8cae30f3d23113994", "ref_doc_id": "e5b44697-e508-4ed7-867c-ac90455e7e20"}, "f263413e-0d60-4341-8146-bbee4acd18b4": {"doc_hash": "188d67ffe9bf0599d3f84253507d174088c944eb0cd6470fcfbcc8432b50513d", "ref_doc_id": "e5b44697-e508-4ed7-867c-ac90455e7e20"}, "7dde3b5c-3b95-4202-8c15-e1989fab1f69": {"doc_hash": "858f5ad1ae7cbc6d4041a566a11743732e3eb79908a4484829f5413e21f82b2e", "ref_doc_id": "b0cf9fd8-85af-49c5-93ad-d34e816ba45b"}, "b17b28ec-0fba-40e3-948d-cb51077d9d1f": {"doc_hash": "6b3dee94b9337f066f857ceb6035594fbe19736c0f557464cd2ebf6ca214c4f6", "ref_doc_id": "969f6e90-aae7-4103-909d-6c883a2558d3"}, "3ff0b9d9-f2e3-4c33-b40d-aecb3b386fde": {"doc_hash": "a5dabea54f28d1f0b14a2c75d22d0fd2ac45784778e820c341ccd2a48998610f", "ref_doc_id": "969f6e90-aae7-4103-909d-6c883a2558d3"}, "a914a65f-5c9d-466e-aa7c-d58618339303": {"doc_hash": "84290dd1471256d16af5b1a96a2474513f5ffaeb4b3ab4eb8018910e86a71a17", "ref_doc_id": "969f6e90-aae7-4103-909d-6c883a2558d3"}, "01813b4c-204d-4b3c-8a12-b2f8dbb72a37": {"doc_hash": "f3a9f25a0d3756ac4524ca7efc9ace0550be6f4c465a4959e30b640634c5728c", "ref_doc_id": "969f6e90-aae7-4103-909d-6c883a2558d3"}, "c63d5025-44fd-4865-b345-79e9e22034b0": {"doc_hash": "e5bbc44511c5c53c0cecb8fde210c367eb841736d49cc4fb0788c2d53a21e63a", "ref_doc_id": "969f6e90-aae7-4103-909d-6c883a2558d3"}, "6fdefd24-6033-455b-b112-c098d0354fef": {"doc_hash": "4466afbe41f9af0c67250b84da1da70527e283f33be9ef5bf0047de33128e3fc", "ref_doc_id": "969f6e90-aae7-4103-909d-6c883a2558d3"}, "d9a92c69-d82b-45bb-9ea4-4c8aea70d3ee": {"doc_hash": "48319bcb067a42290ab5996e29bfc56f0c6736b00a800f8dd7ade72a6bcca840", "ref_doc_id": "d7324c50-a9ba-4244-a962-c7b656ebcfa0"}, "89742653-4819-4895-9ffe-d2cbda24bce2": {"doc_hash": "d89f241f3d9776eed6136e0984283c27888d4c78e1ff5bb75007c866fe4358a5", "ref_doc_id": "d7324c50-a9ba-4244-a962-c7b656ebcfa0"}, "ad83ec56-2f1d-44e1-9070-d73398aea038": {"doc_hash": "6fc2e6fe89a345d8a5f14f9da3e71b54ce1bd8f845d564554d642463777b317b", "ref_doc_id": "d7324c50-a9ba-4244-a962-c7b656ebcfa0"}, "2d7b1c07-6c51-4f4c-a1a1-80c0cb683d76": {"doc_hash": "5903ff515b1f7cdf7f517db043d39f74b7378938356b405926bc36e7f5c174f8", "ref_doc_id": "d7324c50-a9ba-4244-a962-c7b656ebcfa0"}, "669593ac-543c-460d-8570-1fabe9ccdf15": {"doc_hash": "d9692fd8f3e88f3b84afd476aab9dfd7e4a4506686eb16c17a7f3cb41aae47e1", "ref_doc_id": "d7324c50-a9ba-4244-a962-c7b656ebcfa0"}, "9b2e6a66-847d-4b49-b014-346d331cdc9f": {"doc_hash": "7f5578b1b29e9333a7eb8d269bfb09ffde72516b3f74462b6a7449d3c4a56897", "ref_doc_id": "d7324c50-a9ba-4244-a962-c7b656ebcfa0"}, "0e04eae7-9b40-46f8-b9fc-f6cb8bc807f3": {"doc_hash": "f9bb8e60a45d277dae6f7d1c0e56ab71fde31fb3cca86e1a4b85a19840bfe8ef", "ref_doc_id": "d762892b-4abe-4326-a7b0-45195c3f29da"}, "bed71e4d-414b-4d28-8226-499b283529aa": {"doc_hash": "772e6cb07d639fb2b847118adfe717fe38b8ea046072d88d558aaf48f2c63003", "ref_doc_id": "bc11d025-9d3b-4a7d-a5d2-da13e7627ea6"}, "c6047017-5967-4854-9738-bc6e3f5d2635": {"doc_hash": "456a16d0c8b9c1927449dc924e401a88499ff99aa59403b7cd1d6776e384ddc2", "ref_doc_id": "bc11d025-9d3b-4a7d-a5d2-da13e7627ea6"}, "05ea17cd-c7b3-4b48-a392-dbbd4c1f37a3": {"doc_hash": "da8a7de36a40341388f843edaeaf7d3825475ee0fc5a93d53eef1a075356ec85", "ref_doc_id": "ad4e9ae2-6b2b-42a4-ad8a-6730fb0b2a63"}, "21c36f7d-aaa1-406b-bf6d-3658c961daf8": {"doc_hash": "7c05cbc7ea4cb4d94105c908d9c8d1db3113bfece7dff0ad7df80aacddaa9721", "ref_doc_id": "52136ccc-ff23-4b51-875e-73cef967ddf8"}, "4b7e23d3-5c95-4493-8850-ca9d46439f04": {"doc_hash": "9f2d54a16a7605a81c3aa2176f04badaf9790f29db329421377a062e2ca53f80", "ref_doc_id": "52136ccc-ff23-4b51-875e-73cef967ddf8"}, "f332cbbf-531a-4d49-b3ae-c76c993a57e0": {"doc_hash": "f700e50147dea1ebb77b5347ba391373679343fb485bd1a379b2b81454606f08", "ref_doc_id": "52136ccc-ff23-4b51-875e-73cef967ddf8"}, "4a8b4a96-baf2-4d78-8f58-cd307946cdb9": {"doc_hash": "d07b6ab0914127d338e54cbfec4809517b9e718ad051ea90acc4dd3f407d7f55", "ref_doc_id": "bd0a1782-7211-49e3-9839-fe9f213e28b0"}, "bb0d4c4a-abed-4a76-8ce5-6615af66b8ee": {"doc_hash": "a3397d48c5578471537116ff71374712276a9160c034bbab7f45a6fef9f80b65", "ref_doc_id": "984da713-f6c8-48c4-9ded-94d7de7575ac"}, "b85d2ea6-ee98-4435-8a11-89adbaa77d13": {"doc_hash": "d2fd694b22378cf32d1d737d903475048b291136a038adda044c00c8a938548e", "ref_doc_id": "984da713-f6c8-48c4-9ded-94d7de7575ac"}, "8b8731d9-033f-4ab1-8d96-c483294182c1": {"doc_hash": "9c5eed430d5aa0d294c0d90bf74cbf9d1650cc2da57bcb3aab9a7b396864bd50", "ref_doc_id": "d32f3e9d-fcf1-471b-bc3b-31dbd9078a1b"}, "ba3c7d1f-c384-422c-83c9-f302e40205d4": {"doc_hash": "22b6c54a3fac352d5973a1c8cc2b108de925814e230efc21ed09a20e4d915988", "ref_doc_id": "a4d837e7-b28c-45e4-850b-76d68eef214e"}, "0a95b98f-45a5-46fa-8c27-7f34dbe440aa": {"doc_hash": "09b37f426f2d5ef878ee4ed987371ff39cae5327a8601bb4501ec167bac4f6b2", "ref_doc_id": "a4d837e7-b28c-45e4-850b-76d68eef214e"}, "b1dcf4c5-e23f-48e3-baec-6c89ceebd03a": {"doc_hash": "0ac8e865ac3b71a0f4a4982152427152d11e4df1e504517e24fcca138b1f8d18", "ref_doc_id": "a4d837e7-b28c-45e4-850b-76d68eef214e"}, "c13b642b-2ef7-427e-9d79-804bcaaa45ad": {"doc_hash": "8477b385592413f43e9a24b81ff92da44ee1124f9edadb6cf1584fd96d1ba803", "ref_doc_id": "a4d837e7-b28c-45e4-850b-76d68eef214e"}, "a5d18479-6515-40f8-8c94-262162b3a601": {"doc_hash": "a7a1c932c786287f44026c0bed73ffbd10c3ba536092ebf225618d856c3739f0", "ref_doc_id": "a4d837e7-b28c-45e4-850b-76d68eef214e"}, "f896687b-f7c9-452e-9577-6c2072214340": {"doc_hash": "53d52f349acf73d46569a02bad32458fbabe32bbfd178f34a9234e82d8860ace", "ref_doc_id": "a4d837e7-b28c-45e4-850b-76d68eef214e"}, "85498229-252a-4393-9c71-4d5cac0d43ea": {"doc_hash": "3add70dddde025f0f7a6745cdd590cc89b79cc4170e8df30863986b2ce5682f5", "ref_doc_id": "a4d837e7-b28c-45e4-850b-76d68eef214e"}, "0e8ae87e-80fd-4c4e-aa96-4a031035b0c9": {"doc_hash": "be4e55f43830fef2d14ffe0732df80d71ca543c281a7843f58ab37246692e554", "ref_doc_id": "837dd890-373d-4fee-b6a7-3f7de4527571"}, "736e9ce6-a6d7-453b-9576-10aea608b936": {"doc_hash": "7dea90a99d00bdbe0a25c34e2b4ef99f3a746c7f09b9eeaa03ab33323175fc4f", "ref_doc_id": "278a1202-cd20-42aa-b45b-777874488bc1"}, "b52eb525-a592-45f5-bbce-25e35e6d14df": {"doc_hash": "75f646c4f3af545dba988a09edf2d5bba7ad8f0353ac52d5b2878c40bfffb3ea", "ref_doc_id": "278a1202-cd20-42aa-b45b-777874488bc1"}, "72eabe6c-083a-49c1-8bfa-1a98beb4e4e7": {"doc_hash": "2b569e723ace359482ac4f0f4468df4db3806ac0e6ec29a5bf2b7d28ec7e2b3a", "ref_doc_id": "278a1202-cd20-42aa-b45b-777874488bc1"}, "f823ccac-6dff-4fc4-a0e0-a48ca9f743eb": {"doc_hash": "ae9e5413706f44fd673ae9530b870833ca37846919f94ba130c295a9c241f3d1", "ref_doc_id": "278a1202-cd20-42aa-b45b-777874488bc1"}, "684cd40a-9548-4789-8de0-581f0e65cab9": {"doc_hash": "148519b5b5b42a87e57dd97bca2ac0c463bc7d2ff215e2b754c377bf5381c40b", "ref_doc_id": "278a1202-cd20-42aa-b45b-777874488bc1"}, "4240add0-1034-47f7-91d4-67ec04ffa382": {"doc_hash": "d359dccf5abfd299034061b0ab4155bdb5eebb238c90b18ccd5445143cd6b87e", "ref_doc_id": "278a1202-cd20-42aa-b45b-777874488bc1"}, "7caab142-8bc7-47a1-b53c-c4ffeca4ea40": {"doc_hash": "2ccdcc1c002e37d7f92a360b6ffa530d8e2820fdd1fe2194f235c9548c36ebcf", "ref_doc_id": "278a1202-cd20-42aa-b45b-777874488bc1"}, "22206664-efdb-4e8a-862c-c39e89de4665": {"doc_hash": "23663f4846c696517e94166eb0fcd739d11e0c01ae6845bb0458f7acef40a5ff", "ref_doc_id": "278a1202-cd20-42aa-b45b-777874488bc1"}, "7fcc454c-04f3-4f14-b1ec-8ddc8d76e30b": {"doc_hash": "81cc106bb9a6f3a0fa87aa0a46a30dbde13113099f6c7238c40999d60bb5cef3", "ref_doc_id": "278a1202-cd20-42aa-b45b-777874488bc1"}, "a7f9b6a4-b7bc-4bc6-97f9-171f8866ea61": {"doc_hash": "2edfc207cbca9a361e1015f19ba0adb6d1fd5770d342107b5039c9deab4b28b0", "ref_doc_id": "278a1202-cd20-42aa-b45b-777874488bc1"}, "3a0842b3-94ed-4da7-9f4d-889227615630": {"doc_hash": "a10efdbbb7fef307473aac4020cd678beeb32773b2fc8d29430919f3a2525533", "ref_doc_id": "18c9d3c4-a0b3-45bc-8e0d-81085c6843cb"}, "4bcee946-88f7-4161-8a2f-029fd8868d73": {"doc_hash": "f56a53c5eb053efcc4a85c02528d6c80fc2d5aba7c79be0ad6b2af26aa0ab752", "ref_doc_id": "7bdd8b10-de82-4843-a571-5f3553eb148c"}, "0ec8fbd9-1c13-4d6d-aa09-1bd4bbf17975": {"doc_hash": "466da2c52d118ba279c20932117d310e736018533359de93cfee943804270a84", "ref_doc_id": "7bdd8b10-de82-4843-a571-5f3553eb148c"}, "88eef3d5-a57c-4ace-8525-44249484076a": {"doc_hash": "0ef972b403c4a138b53c7046661bec09bc7b5d65b7a950bdc135ad4c5eb64dc2", "ref_doc_id": "613009ac-d31e-4ecc-b9a7-6ea825c34b90"}, "6db322f9-04a0-4e7f-beb9-b826c19216f7": {"doc_hash": "06c5ad80843c5aeac8514919320248a241ca7dc16a520e0f5df3fb7796285bb9", "ref_doc_id": "1beae184-b472-46df-bdef-874fab8d1ed7"}, "365ce463-2426-4930-95c3-add3a5c9ca45": {"doc_hash": "853307ee5b0f7e38374b6abd04aa9577209b5143ea0d9bb55d6f3cfcba65d7d2", "ref_doc_id": "1beae184-b472-46df-bdef-874fab8d1ed7"}, "abe74e04-3488-40f7-83fb-a2cc9cbf0bf9": {"doc_hash": "db6b916ad6d2d2483ddc3e83c4fcfc45bb0bd4374740b012335ab8afcde252b5", "ref_doc_id": "1beae184-b472-46df-bdef-874fab8d1ed7"}, "541a7f8c-00b8-4093-b919-1e189f0ba50c": {"doc_hash": "af8b3c2509c24c04a9c82f74ec14ba5495af88155b319130ce497a7a04446787", "ref_doc_id": "8b1c7989-d84d-493d-906b-474194050eab"}, "80dad35a-05f5-4b6a-b42d-0b41724f537b": {"doc_hash": "8aabd02e09caece398570197d516926a6211c13832b977eebf9630ec34d809b4", "ref_doc_id": "8b1c7989-d84d-493d-906b-474194050eab"}, "2ea43607-7507-4c0f-a044-d33f0777eb75": {"doc_hash": "82dfb84b7d984333cdfa0e1533ab236ca7c77250380a800e012df03f9d7095a1", "ref_doc_id": "8b1c7989-d84d-493d-906b-474194050eab"}, "4b3ffcaa-1772-48d5-a5cb-29e94194a95d": {"doc_hash": "e57c21efc11c67a0ef3951e640a1328fca5e602b576cc5ef3aa8fe57e24f5a84", "ref_doc_id": "8b1c7989-d84d-493d-906b-474194050eab"}, "834d8d01-e615-48b0-a3f7-2cac164d1526": {"doc_hash": "73babd19f1258231fdcee584639c2dfb71d3c4f456d023ce4f2cce3c8baf6107", "ref_doc_id": "8b1c7989-d84d-493d-906b-474194050eab"}, "7dcd6756-f417-4593-85d3-be25359c539f": {"doc_hash": "87fda089c72ab7b666226a8e97b985387d04c43182945240859ba130efeec08b", "ref_doc_id": "8b1c7989-d84d-493d-906b-474194050eab"}, "a8ca7ec7-43fb-4ebf-ae57-b3cbf4376d9c": {"doc_hash": "7d7b0b35d09e5d73d276294af5b647f08608aa74794645d756a303912e91f8d0", "ref_doc_id": "8b1c7989-d84d-493d-906b-474194050eab"}, "a8813c47-f01b-45d7-a64c-d9b0562d2526": {"doc_hash": "7f8cb6a38a5905c36dcea59bb69bfb14ca4edf2273d656ab67dd3664187fec29", "ref_doc_id": "8b1c7989-d84d-493d-906b-474194050eab"}, "975ab6de-556e-451a-ac89-3ccd9eb2d1d6": {"doc_hash": "48062d18c10f58a2e7907824842653790a033a35915f23c750a3842611d9db0d", "ref_doc_id": "8b1c7989-d84d-493d-906b-474194050eab"}, "5ee85879-b6ea-4138-8846-93eb15568d3f": {"doc_hash": "928a2b2b8d4dec3ded285e7d2babd1e6ddedc59d69d5c3029a6d1e83992cccdb", "ref_doc_id": "8b1c7989-d84d-493d-906b-474194050eab"}, "5e7f6628-b561-44fa-9aa4-4d2b7f61d913": {"doc_hash": "9d7c28fafc7c1bd82d0e6d97957c718d0bab8f22fbbf80da1e1dfb5f83622b9e", "ref_doc_id": "8b1c7989-d84d-493d-906b-474194050eab"}, "0c295f77-b4ec-405b-92f0-0446e5bcaa94": {"doc_hash": "29a8205aa1430ec082f5071590dd914ecc825eeae55871e7ada2cf38318c7706", "ref_doc_id": "8b1c7989-d84d-493d-906b-474194050eab"}, "db2c12ee-1234-4111-af73-874dc3b2c5fc": {"doc_hash": "10036d0d85148785ab8ca7413ec4c2d8a0ab93254688ad1fef42cc9ccc311571", "ref_doc_id": "14512d84-58d1-453d-8d58-f4d886bd5d6a"}, "0b505679-35bd-4c59-b287-8c45313750b4": {"doc_hash": "ae4b68281ffe40f9baf4bcb342697f830f7cb1c821c88760b23c3fe918afb5c2", "ref_doc_id": "14512d84-58d1-453d-8d58-f4d886bd5d6a"}, "ae4e4e03-d9d5-4896-a2d4-bbaa8625b9e3": {"doc_hash": "98e120edd81285ed8f13b81a5ff6d1303a07e4d479e3f46657b6973db73663ed", "ref_doc_id": "14512d84-58d1-453d-8d58-f4d886bd5d6a"}, "7f02dc89-cffa-404e-8916-a8bc76656a9e": {"doc_hash": "2d5726a2a654277f1ba706622582636d76ebca6c5f8cd01ce38d9d438ef67ba3", "ref_doc_id": "14512d84-58d1-453d-8d58-f4d886bd5d6a"}, "3ca07eed-4e8a-494a-be10-705575a9102f": {"doc_hash": "fdecada8be7e4bde48a3041767bb6586b01bc903320c1485ce781bc7648f229f", "ref_doc_id": "14512d84-58d1-453d-8d58-f4d886bd5d6a"}, "46d11022-960c-48a8-ada4-c96acb7d06c5": {"doc_hash": "d3b28148127422ba2a1497b80d14bcb77bd9cec214546ffc765e2b1fdf09cbcf", "ref_doc_id": "14512d84-58d1-453d-8d58-f4d886bd5d6a"}, "885dffe0-10c0-44ea-9b58-6a4653c08bcc": {"doc_hash": "5d9b80e215117966dd6035e965b2669db5ded3f96e9bea2f3ec33e0b7b76f121", "ref_doc_id": "14512d84-58d1-453d-8d58-f4d886bd5d6a"}, "b8d7b554-f1ea-4575-8673-af2a9fda93e6": {"doc_hash": "3a25801c6ac68b5e9817d9f50d5157284c7f38136f697de1cedccb929c3f2a98", "ref_doc_id": "da50815e-56ad-4295-a8ba-d5a2e65c40c4"}, "1c0e04b6-12de-407b-805a-5cfa5d2b7868": {"doc_hash": "28c2677a8b85590ec76c36858e71208584a10d9f14805ec297f7b06af79f2441", "ref_doc_id": "fe5ee9b6-2ac9-405d-a534-237a8623f7e2"}, "70659892-d446-4e89-9f7e-181b0f002cd5": {"doc_hash": "307be735178a394c23348c8c679d358190eef20d77f7e4e5027c017e30407abe", "ref_doc_id": "82d9d1c1-283b-4a67-b164-b46353bea26f"}, "2535effc-ea57-4a42-991f-9131f85569bf": {"doc_hash": "f22e55a808983a5b77f6fb59150c5690c22f72e0c20f18dc17fdea3825c04ba8", "ref_doc_id": "82d9d1c1-283b-4a67-b164-b46353bea26f"}, "54be4629-3578-4da7-ab3d-283b1adebb61": {"doc_hash": "b2cb17ee62b566e725b01b0ad848d40b57000ee0b036aef638e439ae6768d8e7", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "77036cc3-ca61-471b-a045-a6af13206079": {"doc_hash": "2e94cac3f2e2a976f761a5bdd68c0e7ea6c657423232424d46b9a249e59fc3a3", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "8f7ac2bd-0bf4-42a9-b2ce-a210a011d302": {"doc_hash": "e35a60f02bff3da98ebd332c1937804b583ab8d9643b05c08050e84da787eb19", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "32dd3b43-4d68-4be9-a094-8a4ded87d3e7": {"doc_hash": "3758076792752dcafe0b8b8a4688ef4858ae3d8bfd35190442475bd425b7d423", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "0ad18cf6-443d-47bf-af4b-233a856f9728": {"doc_hash": "614466c6897464a2fca9a157ddedba3de7e7a0d6ab28bbf8fff005206e2e5de6", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "5a309476-6af7-4bc9-8d96-7ec84bcce71f": {"doc_hash": "8329d5972b0596465ead369fbc0923538cc61f85905f3e3a66c20d6a53bc12a9", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "659e10e3-acd5-4fb0-a30b-7d30655ceff7": {"doc_hash": "1f6be2bf35c2cab8aded07c01ca31f3e7d95f2fb1c2f86fdb54f23826ecdbd1d", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "ab51cbd4-0db8-4992-99a5-74913269ae0c": {"doc_hash": "4b2b58970f06b3b2a23ac082c523c58365577ff9737339364aae416409c757e7", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "c34958e3-7d04-45f2-becd-529abf0f56c9": {"doc_hash": "d5e7029b08f11f98b315b7caf7a698d4e9d8e402b31801d4c77709d8fe43f2db", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "413727c3-c882-48ba-81f7-aa0aec274a23": {"doc_hash": "10fa4ff56ae65fcb4cdb5d9d213392c8af401778efc06f325942a5bbd08d8af6", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "da1896ac-5b9e-4d94-9d67-3e0544a55bda": {"doc_hash": "0a5e8ec5f31fa448aa92e7a27d2cfa8fa848e09a6d91e18684943699b6ba0c67", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "68b393ce-7f7a-4269-8932-f5a8e29e4e1a": {"doc_hash": "3334988b04b2c9abbda00160528f729c037916adb45cd5a15103cca3e7dab46e", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "61542b5b-3004-4dc1-843b-11850bde8092": {"doc_hash": "6141ca87dc2dd952c74d7b147cd956045002078bcc2d71543d6d946901cb548c", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "3f9e41b3-ca89-4380-9d3f-87c2bb104b58": {"doc_hash": "630cf458bd02739988cb575ad2f1fc6433f40c9ec01e0f80b7c38f190f6248a0", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "ba1c9f78-5791-4953-8a66-ad9c3f77b66e": {"doc_hash": "fcebf8ea10b67ae115238925208f3a7f5e35edd934b582e1f88a9767a9eb5e9b", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "5e0d8a01-bd3c-4dd6-8426-b72148bd0a98": {"doc_hash": "a8fcfc280d448934443a3e10acbd2a8c9ce22028751cbdf0b26ab8fa4904e826", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "37b04196-a9fb-43c5-ba44-844ba241bfa9": {"doc_hash": "95c97773f5595c9aa79cc5f73933535b91e4fb97e78039bf304a8cc453d3af86", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "b79072c6-7276-49f8-a8fb-67ce3e764a70": {"doc_hash": "af99763b65efaa9c5b0ffea0ddc6a3adc91a09a2271804d7617de56283e638fd", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "ead8c586-71e2-4521-8ab7-8c7188218602": {"doc_hash": "16db69c2a85bdb489914509cadc6e5fdffd271ec2f82ca2eb4790bc58fab1ad9", "ref_doc_id": "eb9b8b9c-b739-4f46-b00d-59800fd42358"}, "8ee1f65b-b659-4e24-86b4-8f53d246ff8a": {"doc_hash": "27598b2473c1cb171910cbf22652fe84ee34a10554527b0661c8e43f24126792", "ref_doc_id": "5ae3e0cc-340d-4dd9-ab13-15c2cf2c99cf"}, "26b63057-ab2d-49b6-9cdf-37995c286bee": {"doc_hash": "5197d40e816f3e3ced45cc4f96d4cfbb52044cafd17a113ca862084be5634423", "ref_doc_id": "c454bb15-bb46-4763-b920-358d7465abde"}, "eeb0ce69-dd45-429b-8ef8-16847940f059": {"doc_hash": "2355f0b7c167bf886977df4cc5f18184566cdf5cb1a2e4227f07aa0bd15b4ada", "ref_doc_id": "c454bb15-bb46-4763-b920-358d7465abde"}, "66011b89-b820-44c7-bd9c-c7d944c0a51c": {"doc_hash": "2b700b65f1a4f3764f04f1af4934f0538fd225a886130baeda80698e9036cd0d", "ref_doc_id": "12ba18ad-2b64-404b-8274-bb26fb834b59"}, "623c50a6-61af-4a63-baf1-f4d27f2c513f": {"doc_hash": "3a1e0af5f59e2816883e990deb45b6ad81be14dd8dcd3bb3b85b13799d22cd95", "ref_doc_id": "d3b4286e-4c44-4314-a433-7357a497ee83"}, "d68c200d-0822-463f-ba5b-00101110a1c4": {"doc_hash": "99d744cea629053312c27da1bdc928881c494a4ef8ee05b418ffba059d8b0c06", "ref_doc_id": "01f7946b-001a-444e-b363-18176de71645"}, "5f0c767c-4bb4-4cb2-aa5f-589d2634a0d0": {"doc_hash": "4f096b5de58aaaaafaf7b780f6a70f1046e5526e78fcc80895d49844112047b8", "ref_doc_id": "01f7946b-001a-444e-b363-18176de71645"}, "487fe872-80ab-4dcc-abed-2da490888c14": {"doc_hash": "f444ce4c00959aba16305f91f1862087f460b3d84278842905f845daef252228", "ref_doc_id": "eca0c7e0-8783-4a72-8f2a-ae125d3ca884"}, "51429796-daf7-41b5-b8b5-76e961bf75e4": {"doc_hash": "723ec9febfb8a90ffd0d0e60864b71041cd2e76c80f5f71d0a4941ce8d11250e", "ref_doc_id": "eca0c7e0-8783-4a72-8f2a-ae125d3ca884"}, "b40da088-bf8f-45b5-90ab-7ee5f8f5827b": {"doc_hash": "c44e501181d504826d2d68be7069a66f6915c44e5c0b299532802f56625353e7", "ref_doc_id": "eca0c7e0-8783-4a72-8f2a-ae125d3ca884"}, "390e6d88-19dd-48fc-9e6d-db10311681e5": {"doc_hash": "3ab469a9ceff2f28d2a004f92ce36545be56d160f545ad1dccf23a21a630faa4", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "69441acb-5d8e-49ad-84af-34a9aded7e12": {"doc_hash": "267d6b4123076ab829296f3be20cd7df7ec0fba02d30cd8ac68be9c8204ffa46", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "a9288e9b-a380-4e60-bbf8-2b0097949d4b": {"doc_hash": "300e3a1e42981e13b5893c923366e5f63ad5131863728f4501495e9f97fe6d5f", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "76622f7a-340e-4409-8a28-4e0a6e84778a": {"doc_hash": "e44c93b9e9a4adef28be39a15c4e5fb2af652c9ed9038e8f83fead89a67f1712", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "b9223cf8-b893-4096-a81a-ad92cc446700": {"doc_hash": "134d70d4d5f698dcaa01d4910ae0614621d385991ef2ed2776dad97de0840e2d", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "a05ecddb-844f-410f-865a-b728fbba1550": {"doc_hash": "b8dadce6f56462f72d9bb649365d7c92dfbc49da23735e56de7c058236b95b8d", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "3cfaaf27-053d-45a4-b160-02ea40a4c47e": {"doc_hash": "83b35511e86945f3a36f139f6f07895c54ef7faeb9b92eb899c0e9d0b043a638", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "6c1bf2d1-42ef-4d59-ba95-119a311c0ae0": {"doc_hash": "1ff02da58219561708d967ae3665096e216629b61d8aba38eec02c2ea5a9fd94", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "ac50a72b-0936-4e13-84c2-29244674951f": {"doc_hash": "ac8844109e7cc86dcebc769e9ed21e01e8b201efd2b3e9eb6e092239a5f28a3b", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "d3b79b84-e793-4949-b9c7-dfbb3948c0ef": {"doc_hash": "c95675edd20d3bc5d4d790691b3bc3bf1b0550a3a213ef98f5fc85d506870d02", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "c3b8fa4d-32b1-42d5-947f-ed8625f3df50": {"doc_hash": "8df04c797f82e585e2f210f82b277d6f9a5495708e33e59e81e51bd5e97c431e", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "7205d61c-f208-45d2-ada2-3ea1cf25386c": {"doc_hash": "a25e7a4a28cadd8afe5bbbdd26c1386ed2d863b62d6eaba9c8edb560f37cdbef", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "de5ec8d3-0e75-4375-9774-e3f59ec6fccc": {"doc_hash": "e497fe8d9d14a85f3f373488c5432a4f79006534104c9553027f2d86c538266e", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "4841af32-7cc8-4f3f-9e1f-5c1326e2ea6e": {"doc_hash": "311866eb929b15e2ac611be14de169d8a201bd63cef70f60a100a7f489c3593c", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "aa8a93a5-38c7-4a76-8df1-1a56881332de": {"doc_hash": "30472b352ff5f8ef8e558271136ef9684ff92991f68548e6811734489a0eb83b", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "d35d118a-642a-453c-87a3-33c3a6c6ec43": {"doc_hash": "5628454a16ccc2bdbfe062ed02a2dd50398ada52fff80bd7da42b57adf785ce7", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "446f8dea-11f2-4583-81cb-fa1bcb1f8f73": {"doc_hash": "e9a33f238746a026b3034c39bbdf9cc2a8a2277fa9fee63a9b1cab9643456aad", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "f3268763-0f70-4d52-8f62-00204930199a": {"doc_hash": "6b9d25cb8987810234a43bc5e4a102e1c733948fc4c782f796f37a70f2b1d600", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "de12e360-105a-480c-9d2f-f0173242858f": {"doc_hash": "075525183b3c86f344f038f1e65eb9559d3a032b71d22dab3488e67dc27dab83", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "e3ed512a-d7bc-4015-a903-cecedcae0192": {"doc_hash": "67703f8f4924a9943840734beb40f67dfcbb620c979c4bf83d1f8dce344455c4", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "f5512b69-ea7e-42b6-98ee-339c96e549f0": {"doc_hash": "a80fcde62fc2e3f83a05c7a6170ef97df6e0ff829eadf3815e9d4bbddbf9eade", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "f8c63016-4928-4fba-acee-86cf616cf46c": {"doc_hash": "366d86d9bfddf0cade5c72c48fa4a581fd9e7f952db4f8bf7703bdae67116467", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "00b1725f-1a81-4c47-91dd-7ee904532395": {"doc_hash": "58d1ad1924cc92ba0fe7ec41385dda85792a26b79619eaf7ab52f4bd30d2218c", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "9ec50dfa-778f-4e3d-bf66-dab35e669b81": {"doc_hash": "92cb9cf907efb729fec1d5652f42432dfe0bb476e8496d972cbcc2ebdfc54f23", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "5afd871a-5d06-4734-8bad-e4ae0b5dfc05": {"doc_hash": "fa0e0f9ef948fe9c5998a3cf7deea78cc59b45886bd4158526ff84ef9a8c3d6d", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "fb0070de-07f0-418f-8df6-b6ee96828600": {"doc_hash": "3e92dac49ab33dabee87e94c254a480374f1d2f320a4e213cbfa8ede04b6b6ca", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "bbbce49c-0d14-4160-8d18-270da82bc56d": {"doc_hash": "0bf5292d01a724ac37e3a46f8e5f08b635f200b2c14dffe3b0cd1403094e40e1", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "a950c5e0-a565-40bf-b424-4d3001cd3a4c": {"doc_hash": "0f10b4d4ab4414aaa51ac1e1ebc9bb553cc725eb238a761571b9647f6f376b92", "ref_doc_id": "77355499-01e7-4164-8a0c-530784643823"}, "5c5a9428-3294-47bd-8fa5-44445d0a4c67": {"doc_hash": "a08f54cfcf26d37aa8e2292426526ae88f3f039639709532b2787df8a61f4d7b", "ref_doc_id": "88a122d4-8580-4e00-9d8b-e306763112b8"}, "66eb5adb-4cb9-4df1-95ee-167056c89232": {"doc_hash": "a0836eb003e691f57270cf89222edc4e16acfc7705dbc064299ee9c198da7079", "ref_doc_id": "88a122d4-8580-4e00-9d8b-e306763112b8"}, "5f8a2106-757d-47de-b4c8-d9d0ad6254b0": {"doc_hash": "32ffcd6633b08461c0f6137a0f779094b9bfd34d8fe4b4ca7435d55fed27b4fa", "ref_doc_id": "88a122d4-8580-4e00-9d8b-e306763112b8"}, "759072fa-af3c-474e-92f5-ca8516dfdb2c": {"doc_hash": "a9af74a441aaada95b7e49cfb9ae11cf4ccda74a5b8dbc7b54f08289a744efaa", "ref_doc_id": "88a122d4-8580-4e00-9d8b-e306763112b8"}, "b13cf6f8-8867-49d5-95ec-382c88535965": {"doc_hash": "05c2629e6473eb33fd08b2690ab5842dedcdc417cbb15f0d9e85ee97e0607923", "ref_doc_id": "88a122d4-8580-4e00-9d8b-e306763112b8"}, "231cf6d7-c3af-4689-b581-e5c5d834f8cf": {"doc_hash": "9ac6a8f9f2f0fa35a8a6490f9b3e5f53fb5e73223138503677f9240e4616d14a", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "bc2b173d-892d-46a0-a99f-b435ce782cac": {"doc_hash": "d79158a205403bdfc40b8363d8c16fc975b5b407027dced8a4d3af454793fdda", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "ea048e53-10ce-446c-aece-2529b5755db2": {"doc_hash": "75cc10682c870266e4e43ba61cc30d675562f1aa08b712cd6be56523c2ea6634", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "f3875881-bbea-4662-b4a5-58b2dd327616": {"doc_hash": "586ecd87bc5548afaebebb7363157ef94697541d934dfc17f88fd4cc48132685", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "17e31bad-d21f-4567-bb50-20bd515e0428": {"doc_hash": "d3d6238e701a681da74e8aa440425fe0c7534a4ee07d431c75c7099e69c17aec", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "e686a7ed-b348-488e-b9ce-02ff39db2835": {"doc_hash": "1b714694c7b0fb54be3c37268939a981c0533d984398f091a3bfac0f27fe38e5", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "1970d802-a9d6-4448-9640-406eff126faa": {"doc_hash": "d9c6d1642a0365eac703c18324e1386de26789962fb0d3a834560bd95981ff94", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "08abb08a-7f77-4787-9997-9f4e4e62513a": {"doc_hash": "b6b772bcd008780b4a0e345bc3c44d0df7f4b61d99d69d940fe08c12d1c7a5b3", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "ea586b2f-cab5-4415-a4ee-e5b0099dbbe3": {"doc_hash": "7aa6761fd527d0ea2644d2c45f2e115d48a1f2d118a0e059f3a4778ffa50b752", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "338a1091-3f9b-4cbd-997b-9dfea726df55": {"doc_hash": "6bcb00b7f4c0b30110083b241f3344a400a9d996061397dc870038951146bf75", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "1a72ae8c-0ada-4451-8775-71f383ec24aa": {"doc_hash": "50fb4080e386faafb0a3d0913e34dc9524e899f97d5f2d18a2aa3fa5a74b6492", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "e59bd846-f141-4ec3-b8ba-ae50cdceda80": {"doc_hash": "5e91c57cf0b15444d11b0c7a334434c358ed0643311db34cfe1cf6cf76a1d485", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "bb9784a8-4820-4b69-9538-aba4f49c041e": {"doc_hash": "2a4e24f7a1c42747cb26d205a715e27983b49949ceeb575b07dcbe5af059a0a4", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "159f9555-17a7-45e5-ac71-bc5e193e7442": {"doc_hash": "41f5434d20bc5bd3602bffa5195864ff8b17884f645b10016dbbc601c2e1bb8d", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "ad4f8907-8b38-4622-86cf-1e095c4e01c2": {"doc_hash": "2959ef56a56fab0bb41b58baa13187a38ce1ae21b82c982b0878eb5fe7311570", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "621535c9-45ed-495c-aeaa-e7d7e3089bcc": {"doc_hash": "05625ad7de679034cf71e0737ac05c93e55507d022aa4255fe93cb01dff337ff", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "9b6457a7-38a7-4461-bf22-714570121e59": {"doc_hash": "446c2111445d10c31e74e27c7b2577f62cfa5fb3470dc1d3b8e008393071bcfa", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "cfe3edbd-7ece-44b4-b7a5-74907957c301": {"doc_hash": "80b52944ed9ad0e0ed223530edf99cea715432cecb9c32b68fae14c16d8e0bf3", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "c5a91ff1-af00-49ed-9a4e-54ab705a20d9": {"doc_hash": "240d39f227cbc1d21d8edf01169424f93377f47a151d0882cbaf64b009a9ee20", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "d9c54045-f382-47cf-89aa-ad0f4622a304": {"doc_hash": "ddb7dc6c33423ce97c0e6d5ea160732d392656d7a8bb30e1340fb8f55e56660c", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "c50812fa-071a-4787-8b1e-3838f3ef3411": {"doc_hash": "635b3341a68d50e382389d9facdf6398fead3e36f32aadcc86cd84e631a7be73", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "a0138f90-3a0d-4175-ae0f-00edab1ec349": {"doc_hash": "3ab9dcab2b2b3ad202c25a3d9a16568f49079bdeeaa1ec91e21d24b8c955279b", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "fb6e7509-012d-48eb-b1ef-9f07a038cf58": {"doc_hash": "d8895fb10b4bf76869b59a82134e233f0c038208f41b1a465748a11cac397473", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "3924e58a-1367-4579-87da-d266de7bce22": {"doc_hash": "0971874458e8ba643078a8269b2c63e4f1f779075d8d36bf3bc3aecca9650ccf", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "661e43f0-273d-477f-a877-de4b1b4f1a60": {"doc_hash": "aab95e319ef8fa7b7d59bfbbb2952e4eadf5d2820683aa0c0101973429e841a6", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "a3ebc994-3eb7-4868-8e0a-92c0216e62cc": {"doc_hash": "79b300eb383d2fb41a9edf3f960c194617286264bd9cc07bacfad36ce7e00890", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "21671291-8359-4b01-be9d-f3c7fb9fad10": {"doc_hash": "09637d48d39ab97cc8f47ba73364b6257d87e660cb76c97bc117b84ba46f4cb8", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "df02491a-dd61-4da3-a1c9-60a375bc1669": {"doc_hash": "f2419fc37dad73c572d48f261d468cc2fc31cb224ddaf2e6dec6e0b592d99103", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "1f2d5568-441e-4be5-b86d-bdc6bf79d927": {"doc_hash": "1477a6f54b70c28b4b44f6ec8723d93757396ccb567500c30a9aff4c6cd935f8", "ref_doc_id": "398085c0-bdd5-4da2-8dca-95d7c720913a"}, "ce9838c4-b01b-4ab7-a28d-966a6baee57b": {"doc_hash": "9bc837bcba77d22a1fc7b7ee55ebc4d0d4b1daf1e58f8d79347925ce9865a1ec", "ref_doc_id": "f69a4042-cc29-416f-a18b-1c16470427db"}, "ddbc1ae9-2121-4286-93ec-112ce731dc14": {"doc_hash": "653234f79ec8b13aeff4696d6886005930526ad9fa1e05d0a1c4dae5a0abf0cd", "ref_doc_id": "f69a4042-cc29-416f-a18b-1c16470427db"}, "30ecf36b-5153-4eb1-9713-ba7f720f3759": {"doc_hash": "b62394095aa79268556664926bd3a8519f5dceb8aec86ee146b24ff933921fed", "ref_doc_id": "f69a4042-cc29-416f-a18b-1c16470427db"}, "f49d18ad-f848-4689-8013-9b8af9b1c0f2": {"doc_hash": "f4b9919b7c8bb325b093b5903b9398b54f4b0420e7c3c4c373cb14cf9ce76f45", "ref_doc_id": "f69a4042-cc29-416f-a18b-1c16470427db"}, "a18dbfe8-2ee2-414e-b6ef-6b50f84ca0b3": {"doc_hash": "b6e2e74055707cb8b35fbc614bc33b3780ff63af10d7099c495c9188735f715f", "ref_doc_id": "f69a4042-cc29-416f-a18b-1c16470427db"}, "7c7438bd-f6c6-426e-9dbd-e023092859d0": {"doc_hash": "bd06e2471758c4538a3e51980e327efb3e38025c1881a8c8c024f62ef7d159ae", "ref_doc_id": "f69a4042-cc29-416f-a18b-1c16470427db"}, "656f6b3d-ecbb-4021-9181-baf828f096e4": {"doc_hash": "567df2474ec212a626708ca3d1ba1faa510fe41dd1b79dae748970508934acdd", "ref_doc_id": "f69a4042-cc29-416f-a18b-1c16470427db"}, "46f36d43-ad4a-400c-a2b2-4fcac120e5a6": {"doc_hash": "e829b35ee844b1cea4bf343be8d3767a872490b998846314900377377c9d858d", "ref_doc_id": "f69a4042-cc29-416f-a18b-1c16470427db"}, "fd6d06aa-9464-4bdf-aecf-fdd659c3fba5": {"doc_hash": "2cb291af760177cb661a181963539acf7b8e416d8330b7f1bcb4f4ebc30c4d83", "ref_doc_id": "f69a4042-cc29-416f-a18b-1c16470427db"}, "b9233951-7fb8-4bd9-96b9-1ceafdaa951e": {"doc_hash": "b7399e41f5ac9215412ee80a8c8ebbfde91855a164e7c7f2ae9b723910854587", "ref_doc_id": "f69a4042-cc29-416f-a18b-1c16470427db"}, "eba9387a-deed-4725-8463-0d312cb899da": {"doc_hash": "a3608f5999b413e261ece2eb856a9136b8b82f1cb5a29d2a69e8c8a3427688c5", "ref_doc_id": "f69a4042-cc29-416f-a18b-1c16470427db"}, "4b412cc4-6143-4f0a-ae61-78817c73fbe1": {"doc_hash": "091d08f42e8e8dbacaeb8e024767f9326c079af4381fe1db764abe3df03701ac", "ref_doc_id": "eea0255c-244d-4afe-8aff-a6da2fbcb193"}, "4aca5d8d-2737-4695-8e90-fcd3da7b7e00": {"doc_hash": "94450a4ee362fff408d825574d7f31f34c2a3fcc5b21b0998f75cd5bfaf2addf", "ref_doc_id": "4741a496-f709-4f91-a32b-b5be79e9d70c"}, "857f7064-c693-41c6-98df-41eb13fcc493": {"doc_hash": "c6b0070a399f3081a819755cc7604ef9d680b75d3efabfae32e3c9bec247bc44", "ref_doc_id": "64788d25-398a-4de0-a87b-bc8a44364a36"}, "320a208f-3d96-46c5-93b9-a03e5f088328": {"doc_hash": "0a554a488947e2adfb04d2882e993c76a210b4ab50e75dcaeed5a79fe19cddc6", "ref_doc_id": "64788d25-398a-4de0-a87b-bc8a44364a36"}, "2e74da85-e58f-405b-8c77-66d176f820af": {"doc_hash": "f3202aaa3d9cce184ea4cfa12240a75b2b4abebce6fb0c75f0d10ef8199b1f2c", "ref_doc_id": "a38b05ca-bb2b-48c1-8e4b-efacd0326334"}, "46f6040e-650f-4a59-85fc-172911ef93b5": {"doc_hash": "7db8e6400fe0e9dfabe374a6ecaf64997b81cef8df4663841728a54397533a5b", "ref_doc_id": "fb17f80e-bb9b-4278-811e-5bf63ff7ea5f"}, "ea542a50-86c8-4f74-84f7-b1ba25502055": {"doc_hash": "b022cab294c032f029246968521b914857e94bcc4f930a86d2326c741c83f2b7", "ref_doc_id": "36b6256c-a79a-47a5-9c5e-3ed62ef954a1"}, "ec181a28-cd67-4266-92da-5de2f61dbac6": {"doc_hash": "05eeff12c32fd4ef8e7bb561f80a401dd25ff94d287259a7443f5a98afac4fa7", "ref_doc_id": "36b6256c-a79a-47a5-9c5e-3ed62ef954a1"}, "d5ef7692-7ed0-4002-b39e-5f37cc0b8e9b": {"doc_hash": "33eb37d917a647a82c4245deab252fd2a92975b372009e74d24574b399779ff0", "ref_doc_id": "505f830c-3cc9-4fe4-8b3a-ec184bc0aaae"}, "9124bb8e-1069-4f1e-8fbf-02dd25f9963c": {"doc_hash": "c26feb128dc862513432836505e16d92cd5d337aaeed997ac5018e0aad7692ad", "ref_doc_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2"}, "693e7439-3e6e-4d27-b05e-8c8d2cb7dad9": {"doc_hash": "201bf7d57a6e813d17765ddf2f8dcebe6801101775a138a817ff569bf4934ec8", "ref_doc_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2"}, "65d85a16-25b8-472b-a89e-d07c51062250": {"doc_hash": "360a1051625d0a72dd93699bede0432f400105a429dbc7a2214814c4e57decb9", "ref_doc_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2"}, "90a02b35-b256-46d5-8d9d-c792a2d119f9": {"doc_hash": "d025d8ab97db38c06be458edd26e85064ec0dfbfa5a0eb48228524cb66101328", "ref_doc_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2"}, "8944e966-4884-4e58-a394-59595de8ec5f": {"doc_hash": "04c4f1758b57f2dee91bf46b8b02b042e1a30972d144876007c523d83c8b067e", "ref_doc_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2"}, "d2bd4212-cc14-4060-9d95-ed2cc415464b": {"doc_hash": "d32127003b46c0bf45ad0547418c65161f1bb71571b624c744b1df0c2e59c9cb", "ref_doc_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2"}, "747a67a5-2630-4f12-931e-b12916a408e4": {"doc_hash": "cda562a7407aee7072a37804b668143c2b7b52647998f8719ad55bb1515a9ba7", "ref_doc_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2"}, "a36eb363-e29f-4cea-a6e7-c7a0db4fc946": {"doc_hash": "63d7dbb0a912705bfefc5f508dc03132f03be89a2f7370becb898296adccf840", "ref_doc_id": "6c223ce4-62df-4f80-8dab-f88ebbc179c2"}, "a55ebdf2-d7de-4568-bc70-17b11ecf3b15": {"doc_hash": "e6f49c8024ddfd4441bf01bd3e9899781ec98a00506e92974de7ff718e1b9a81", "ref_doc_id": "a8192d72-d0d6-4b8e-b76b-d2e6b6cae954"}, "ef5b72e5-14fb-4e64-8e88-c912299779e2": {"doc_hash": "f0f8da7c17fa36acf383ca78a1e1aa7f0833d34ecbb207e171a6eab98db21c90", "ref_doc_id": "a8192d72-d0d6-4b8e-b76b-d2e6b6cae954"}}, "docstore/ref_doc_info": {"c8ef2a01-36a7-4468-9b6f-e24d744bc58b": {"node_ids": ["c9984c89-30d1-4089-9c5d-fe758fc9cdad", "dbe61b05-b284-42e3-96cf-d98a7e02e457", "7339c7e4-1602-4931-b622-4c9be7f5f183", "420796bb-f1b6-4d26-a42a-d06ac6cfd7bf"], "metadata": {"file_path": "phala-docs_dist/trusted-execution-environments-tee-and-compute-verifiability.md"}}, "8414b16a-51cf-4de3-9122-b3477e611f51": {"node_ids": ["bac1b89c-b880-4cec-911a-015366f29681"], "metadata": {"file_path": "phala-docs_dist/run-a-local-testnet-with-docker.md"}}, "bbe2c080-49b2-4e65-844b-68f91e623ebb": {"node_ids": ["b0036f4b-a010-449c-9f2e-eb1095fe5554", "93b8fffa-5eb2-4fda-bd33-b3452a6cc9d7", "0f2621ae-c17e-4e77-b36e-fc37748b665d", "0dca9f70-6754-4422-88e7-53515f8f90ad", "27ac237f-ed95-4694-8c71-f9251786f49d", "521e975b-a36f-4899-a124-90652cc8cdc2", "e0cc4e7c-4ce7-4cfe-aa42-433d01bc30b7", "b5699e8a-d37a-4bc8-b10c-91835303ac70", "91c3cb72-6b3c-4281-84df-82c032e3d276", "dd632383-6c01-47d5-8fa5-4460fedeb8df", "9f0b1ecc-8641-466d-9082-95bd6e0e2f48"], "metadata": {"file_path": "phala-docs_dist/asset-integration-guide.md"}}, "da69ac29-d69f-420b-aec6-ac023c5fbb33": {"node_ids": ["218abb79-8114-4ab8-ad28-2b64ff5535f6", "01f571f5-98c6-4aba-bff0-5b9813e9560e", "d96915f6-6127-424b-9c6b-17a9785a2964", "4cd93a78-7c88-4168-8231-0103c2db8e66", "f504ba58-fc67-4c63-8888-b6579af50093", "aef2f48c-cf0d-46bc-a2e6-801008c8327a", "8fd53175-b691-4a72-9c76-ca79d7847376", "510d2b5f-1143-4af7-8ae8-d6eb2e59b083"], "metadata": {"file_path": "phala-docs_dist/solo-worker-deployment.md"}}, "9e5be949-8f78-433e-b475-259a252e05bd": {"node_ids": ["ee4e3602-7035-4aa0-9e80-9db78cd3d56d", "ec7d0d0c-99e2-4955-9808-ba6bead2dbcb", "f009a205-0e36-4963-a0ca-515460e59cf5"], "metadata": {"file_path": "phala-docs_dist/why-multi-proof-and-how-we-can-help.md"}}, "3a0fc6e6-646d-4d0f-a1cc-88a9d68cb045": {"node_ids": ["7ce9ee5f-c9c0-4e39-a278-9da48800ae20"], "metadata": {"file_path": "phala-docs_dist/access-from-ui.md"}}, "63932883-a029-4ad9-aea6-1a8894eb02dd": {"node_ids": ["ba477c28-2940-4ebd-8ca5-7601eda57082", "253c7cf8-a3c6-4f17-b2e0-9f0ef37124d7", "983592b6-ca6d-4b1d-9a5d-6cfae8940017"], "metadata": {"file_path": "phala-docs_dist/error-summary.md"}}, "5e1257f0-751b-4336-b6eb-8b187e368904": {"node_ids": ["d5047fa7-b0c6-4296-b4d9-99999e99152f", "444df373-b34b-4ce1-86f9-9d635090f8b6", "ac9266c2-bc8d-4a24-b116-80a3dc2380c1"], "metadata": {"file_path": "phala-docs_dist/sidevm.md"}}, "5d3e58fe-9b67-499c-a738-8eeecbd66f37": {"node_ids": ["f3a7eff2-ddf1-44ff-af65-f3f2630f1fa5"], "metadata": {"file_path": "phala-docs_dist/archive-node-deployment.md"}}, "4ef2603e-462d-4bb6-bab8-785bc848a684": {"node_ids": ["40253e65-9ca5-4038-a557-5d58429109d8"], "metadata": {"file_path": "phala-docs_dist/test-and-benchmark.md"}}, "6dc5aa10-e555-4656-b63a-e4dbbdc9da59": {"node_ids": ["8fc7e2d2-f5d2-45a7-ba99-d8ef4e69d8e9"], "metadata": {"file_path": "phala-docs_dist/monitor-workers-status.md"}}, "8c17c1e8-7a5d-4faa-80b7-52b6e054f3e9": {"node_ids": ["bf5abd89-c750-4168-af07-447e48dc895c"], "metadata": {"file_path": "phala-docs_dist/framehub.md"}}, "25ffb768-e9d3-4978-ad98-0eb8765b01a6": {"node_ids": ["c6f9952b-1dff-4207-893f-adbdb1c7d393"], "metadata": {"file_path": "phala-docs_dist/switch-workers-from-solo-to-prb-mode.md"}}, "2e92a757-0686-4f31-980b-b742f6a67efb": {"node_ids": ["661884b2-19a3-4731-a13e-e678668775af"], "metadata": {"file_path": "phala-docs_dist/connect-from-morpheus-plugin.md"}}, "a6a5cc87-e099-4ac1-ab49-37fd5379aadf": {"node_ids": ["c9423d09-6394-4c5d-a428-32bfe0b2c563"], "metadata": {"file_path": "phala-docs_dist/khala-governance.md"}}, "5c14c8ab-4c40-4fe1-82bc-8d044635ce6c": {"node_ids": ["3b379737-9a53-4c7a-ab95-ebdb98b92b7f"], "metadata": {"file_path": "phala-docs_dist/community-builders.md"}}, "a53edfbb-ded7-4527-a274-a9813568a5c1": {"node_ids": ["7aa3c3c1-f09e-4aec-929d-796ee04ce5ce"], "metadata": {"file_path": "phala-docs_dist/create-a-dashboard-profile.md"}}, "a7bd75c0-78da-4a88-b7ed-b8612b93cdad": {"node_ids": ["0eaa648d-a6bd-4ef1-bf18-bb40a6e04e3a", "5fcd07d3-db46-475b-86c4-fed2592fa40a", "c2ffe13b-04b8-4953-8811-2b9316986787", "71854785-92c0-4061-8701-c8fca24fc1df", "09758bdf-b827-4e82-87ad-43609b41be27", "5d50ca51-8d55-4c54-a0a0-1f33f2b8539c", "c0c506c7-1164-40c4-a5b4-2ccaff0f688e", "c0375d4d-28b2-4053-abfd-ab7383c4acf3", "3ca8bbee-8f80-41da-ad5c-a03b4161564a", "8c4c2de4-254c-4e0c-ba72-9e9f4198c034", "6ba1a58c-4941-4d99-974c-9b7df14b1912", "1d0f5633-39cd-4d32-bef4-9fbed685153f", "4f8eb095-f85d-465f-ba8e-0618196010ef", "5f0e0039-4a54-4216-abdd-ce9a7cb0e837", "004cc633-2261-4ba4-8596-4448dcbed85b", "6c647c1e-824e-41df-b594-693c6dd1e923", "328111e6-56f2-4362-8668-ba4286a747e5", "6829efe5-25fe-40cf-8fcb-348f94b6f3ce", "8f3ddd7c-e54e-4bbf-9abe-f2aed45c625d", "48f7a985-7632-413f-a701-c077fae4455f", "ea61934e-26f3-48ef-a810-965ca2b9498e", "4b79c314-1c0e-4e31-9b16-5fbcb5fab11b"], "metadata": {"file_path": "phala-docs_dist/connect-airstack-phat-contract-to-evm-consumer-contract.md"}}, "f3c032c1-9905-468b-accf-e95821366a3a": {"node_ids": ["f0e87cc5-2e2b-4b81-9dd1-0bb66aec88e0", "f87b0d55-80b0-4c89-9bd2-2107672e6235", "39139ae0-d787-4ea4-9dde-fb5915be0211"], "metadata": {"file_path": "phala-docs_dist/blockchain-entities.md"}}, "01b25634-c273-42f2-8e77-1391bca42203": {"node_ids": ["313c4042-1b79-4b14-8a7d-22585abb5234", "1e406d39-7cff-4960-8462-30cae67f3dd6", "61c5e031-75d0-4232-be51-987ce8fe8935", "2241d840-b04f-40c3-8aa9-9f2cd473658c"], "metadata": {"file_path": "phala-docs_dist/wrappedbalances-and-w-pha.md"}}, "2fa9ff2c-d7ea-4b9f-90e9-c705bc6fad99": {"node_ids": ["83e3fbed-da02-4f00-9900-7ba5f10867f0", "f0f92408-e371-4618-999b-f0c7c54640b2", "33074e4c-d42c-4ba0-b913-4273ca386676"], "metadata": {"file_path": "phala-docs_dist/language-basics.md"}}, "0700ad4b-aecb-4725-b750-4cdca264a36c": {"node_ids": ["2aacd6b5-06f0-4768-9557-d912fd984081", "04457e25-31b6-4ece-894c-4d858cf467dc"], "metadata": {"file_path": "phala-docs_dist/collator.md"}}, "500f5bf0-4994-4954-b069-6ed2e43cda0c": {"node_ids": ["6dafc8f1-69cf-40c3-8355-5934a327c9c5"], "metadata": {"file_path": "phala-docs_dist/khala-worker-rewards.md"}}, "043a364a-ffe8-4acc-a2af-bda8366b06f0": {"node_ids": ["12b4f9ac-4c84-456e-826a-d74334aa406f"], "metadata": {"file_path": "phala-docs_dist/access-from-other-agents.md"}}, "003a24a6-401e-49c8-afaf-e3d680346bbb": {"node_ids": ["86869b8a-acb9-4688-8e49-df1361bddae8"], "metadata": {"file_path": "phala-docs_dist/introduction.md"}}, "30e4242e-dde2-42c3-81aa-9063efdf6da1": {"node_ids": ["8ccb1bbb-461d-4ec0-ab08-a0d7beab7576", "c0fe8691-693f-497c-83d9-6167a8e5a9b7", "14a9fada-3171-4bfe-946d-bfd8bb012437", "5a18a4aa-f877-40d7-bfa8-428e47a2a75b", "5036d751-e2a4-4bfb-a037-9bc27e51d686"], "metadata": {"file_path": "phala-docs_dist/quick-start.md"}}, "b55e1e04-9025-4715-a83a-9cc2abd9175f": {"node_ids": ["c9d6a5a0-7a7f-4e10-afda-4b1fbe59319e", "f8c381fe-cd31-4d5d-b1ce-638da593e9f9", "6dff8296-b7d6-4f2d-8ea7-c30f5da375b8", "b43ab247-3a9c-4561-9863-a29bd46bacb4", "00b375e7-17c1-4913-8983-e6d17124d0e0", "dffc8fcc-d650-4b5e-b9b2-2696a94d5cfb"], "metadata": {"file_path": "phala-docs_dist/setup-account-identity.md"}}, "35d0b890-0eb6-4a01-97e1-6b4f695108fa": {"node_ids": ["a0e4d58c-b4d6-474b-81b5-41996a0872c0", "12777536-ed0f-4c6e-b56f-217c5e392a8d", "a2c3f961-21d6-498f-a411-08701481c3e7", "252ce6b8-4b9f-45f2-9be5-fddcfe8a5a88"], "metadata": {"file_path": "phala-docs_dist/prbv3-deployment.md"}}, "5eddd77b-e491-4c34-8131-223fb436a650": {"node_ids": ["5fd61517-9a5f-4abc-9b42-f170a931212e", "f7bd4697-0209-4919-9020-bdc069101124", "52d9b7bc-8724-4dac-8562-23694a40c21a"], "metadata": {"file_path": "phala-docs_dist/compatibility-matrix.md"}}, "499248cd-8d1b-4223-ab15-da5f30c4c088": {"node_ids": ["30cc0192-170c-4ed9-8d51-c3f58724c9da"], "metadata": {"file_path": "phala-docs_dist/tutorial.md"}}, "b249013c-0cb7-462e-90c4-24d3cb9faf69": {"node_ids": ["4d2a3531-2ef3-44e7-86d4-59a68d18419d"], "metadata": {"file_path": "phala-docs_dist/wapojs-functions.md"}}, "1d1d0ff8-6327-42eb-9191-3a9b32c89ea5": {"node_ids": ["aa4d5d01-7e28-4aa1-99a9-1f8ddf3f56f8"], "metadata": {"file_path": "phala-docs_dist/define-your-agent.md"}}, "b4aa2986-211b-4cca-9b97-989baa3c3ad6": {"node_ids": ["84b1d7a7-ade2-4fd8-8516-fb2307f7db92"], "metadata": {"file_path": "phala-docs_dist/faucet.md"}}, "21c4d294-e20e-4923-80c2-b5fb42b52f8b": {"node_ids": ["f641cc80-beab-48ed-b54b-af58340cbb5c", "612197e1-3572-4462-9010-53eb0f2017fd", "aac93046-4dfe-4349-8986-2a57dfeb19d3", "67f5827e-5b01-43ad-a8ae-b55053e34b09", "726d1005-8160-402e-a83f-eff4b78ee64c"], "metadata": {"file_path": "phala-docs_dist/whats-vault.md"}}, "be784468-d046-4670-aef0-486824e83488": {"node_ids": ["d53c2ce5-af01-4ef6-934a-d78981d9d717", "63f3f431-f5bb-486f-98e6-5cb1d14377ee", "b1ab0de1-16f0-4f0f-b88c-6fcc4d86d6fe", "d1a2ee8b-0eb9-432f-8922-ab8631034fc8", "b5b37d19-fac6-4ce9-9189-b67266fbe7aa", "d7753ba1-84de-477f-b575-e8671552c23c", "4313eefb-69a2-454f-98c2-50cfe164ecd7", "e2c19408-4c11-498a-898f-281a76d017b5", "1be79d38-ed2d-4dd3-9702-dd3f3d1c24ce"], "metadata": {"file_path": "phala-docs_dist/technical-details.md"}}, "5d80a010-a7b0-43c9-95e0-6172f2fd38e5": {"node_ids": ["ba06d0e3-a7e0-4c28-9201-fc03d5dba085", "2da1f0e3-5f06-47c4-898f-e831c5605eff"], "metadata": {"file_path": "phala-docs_dist/estimate-your-reward.md"}}, "358650eb-6a71-42a8-9230-cd099df9d7af": {"node_ids": ["26e3b3d4-e1f8-454b-ac87-37cd468968d6"], "metadata": {"file_path": "phala-docs_dist/invoke-other-agents.md"}}, "d1b08f7e-92c1-45b8-947b-209ee9fe47bc": {"node_ids": ["c91edf56-f778-4b5b-b689-4424d6dc44ab"], "metadata": {"file_path": "phala-docs_dist/get-an-api-key-for-the-graph.md"}}, "a8b7d718-3b44-4dfc-a8a2-c92454050c3c": {"node_ids": ["855e6b0c-5963-4237-9068-f365569cb3f9"], "metadata": {"file_path": "phala-docs_dist/next-step.md"}}, "4faed7ad-fe6d-46f6-9866-0b4ad8f459ce": {"node_ids": ["6807b6d7-d907-4460-9b5c-ed9e228bc6cf", "e164ed8c-6f54-41a2-8b6a-32bb7340c17d"], "metadata": {"file_path": "phala-docs_dist/configuration-migrate-from-prbv2-to-v3.md"}}, "cf0a0c3a-358b-4362-b6c7-53047073867c": {"node_ids": ["ea7057f9-c245-4443-bf06-77bee5499f53"], "metadata": {"file_path": "phala-docs_dist/generate-test-account.md"}}, "3632f624-7681-461a-9e17-753d767e6c1c": {"node_ids": ["674cb410-e846-40ed-b2bf-5a02350c1b7b"], "metadata": {"file_path": "phala-docs_dist/README.md"}}, "ee21aa3f-dafd-4ab3-b0fb-31f9021b3efb": {"node_ids": ["c8872060-3fe0-4340-befb-087fdb93bc94"], "metadata": {"file_path": "phala-docs_dist/system-contract-and-drivers.md"}}, "ad851f66-0434-428a-bc05-97f97dc7302d": {"node_ids": ["40b733a3-a303-40f4-bb9d-3a9873959535", "f0bfac17-42ff-4a48-b0e5-828bb9bb4cb7"], "metadata": {"file_path": "phala-docs_dist/handling-secrets.md"}}, "8588b396-96f7-4222-9fc6-7e57fa3d14b6": {"node_ids": ["965778df-b946-40f9-b422-023cc046f091"], "metadata": {"file_path": "phala-docs_dist/lensapi-oracle-agent.md"}}, "0ef98432-7f00-456b-9133-9729a08167df": {"node_ids": ["302de6ad-a664-4f6c-8711-57049a819f9a", "bd84b296-7bc8-4a46-93ab-98008decdf6a"], "metadata": {"file_path": "phala-docs_dist/join-the-council.md"}}, "0d011c27-6352-49c2-8af2-23928ed39ed9": {"node_ids": ["ac27581f-25f9-498c-82e5-c566904c5f48"], "metadata": {"file_path": "phala-docs_dist/deploy-the-worker.md"}}, "429fbba6-81f6-4391-9bf1-c798887e1c18": {"node_ids": ["8b619a26-5d05-4982-8998-6e864cfd3439"], "metadata": {"file_path": "phala-docs_dist/tanssi-dancebox-testnet.md"}}, "bf0b9be5-f216-4287-8e59-5a2743dae5fd": {"node_ids": ["f6e878ae-75f4-4932-91cd-ec44f27ba69f", "a309979a-85c2-4ce1-8bc1-7c8b7190fe6d", "beb015b7-2e06-4129-88f4-3b0acb297a22", "608f4b92-5e13-4206-8bdf-4d8321e3025e", "87cd70a4-ba8d-449b-9db5-7c3f4e686d75", "b5436dfc-ce2b-48a0-a662-292f528f72ca", "a4680770-5dcf-4059-9848-7a02ab63b011", "ec94c439-fada-4010-bb19-05b34a5e48f6", "a9cb8fa0-d8eb-45f6-9d2c-05d68669fd13", "3121841c-374f-4c34-b638-be72aede595b"], "metadata": {"file_path": "phala-docs_dist/khala-treasury.md"}}, "6b4b34c1-8ff4-44fc-8927-bbc5c693128c": {"node_ids": ["6e3144ea-aeb2-401a-92ef-20f997ab9882", "4d0f1828-87be-4540-84c6-920d77015745"], "metadata": {"file_path": "phala-docs_dist/voting-for-councillors.md"}}, "030e9228-69b5-4088-852a-bc31e3cebb8f": {"node_ids": ["e80d4a95-4b78-4b83-b912-a95a2d772edf", "226a033f-7fb0-4563-a8a3-5fda9b552751", "aa989ec9-c72b-4fe3-a42e-e1c2ed50d9bc", "9041d467-b366-42ba-a3bc-7ccd88fd4b40", "54690056-116c-4553-86e4-068540bbcbfb", "85f0a004-b576-4100-a4d1-8bd8b7b8e588", "cbb146b3-d351-4f60-8f45-7d51c56ec85a", "05ede7ca-c2e7-4b90-b586-4489b6d23799", "039ad2a0-598b-4c50-9a01-e0169c74e388", "f0dddd6e-2a9f-44a8-baa6-7d47b88fa97c", "deffc310-9a50-4f45-9292-12f91e002625", "d6aef0db-9972-425c-b292-909c9ec528da", "2f1e1287-3f88-4aa5-a7ce-1e0c89384842", "cc991195-6664-4135-8a38-50d703ceb056", "8709ed23-b210-496e-87c3-e32cada758c3", "7c098cf3-50ba-415b-8bfd-6ee7939090ab", "66b0c14f-b2db-4533-a6dc-8fcef8decdf8", "489766c0-9f72-4846-8b73-65ddfd3b5c84", "3ed20fa7-ce9e-4f51-95eb-1f439b46e155", "ae6a704c-e678-4945-898c-2afc2ff64f26", "eee49905-628a-40c4-8635-792393872d2f"], "metadata": {"file_path": "phala-docs_dist/connect-phat-contract-to-evm-consumer-contract.md"}}, "8731218c-3bf6-40b8-a1de-d97dcce7fc63": {"node_ids": ["296369bb-bb42-4e8a-831e-77b5456293e0"], "metadata": {"file_path": "phala-docs_dist/installing-phala-mining-tools.md"}}, "bc480f60-aa20-422f-95d1-50126b6c2a34": {"node_ids": ["a223f9c0-9e8a-491b-ba07-aa8fac336435", "bf1b1077-9c6f-4743-a380-94d5fcfd75e5", "45a32a1f-ec48-4b1d-b65c-278ad4b8ed7a", "8e04e776-5e73-4854-8658-030c16172ca9", "f51ae8ab-c1f7-4bec-89be-b64c646271f0", "2f2a8c68-ccc5-4f17-b99f-7c37e37d4888", "f6531208-fa4d-43fe-9855-11c98628dbfc", "5053e5cf-d83b-498b-9636-a0da1b73ea3b", "ab3097db-7c26-4895-be56-a4831e6a9d02", "27a66b91-f02a-488d-8f0b-b26b1db768f6", "cffdbfc1-c554-4da5-99c5-c4afff5499b5", "4dc8065b-6df4-4508-b07d-ad4cbdf05e2b", "95801549-91d2-491c-b2d2-fdc5e36c2dfd", "d29b916b-c20a-4e66-b6cf-d346de5fb9ee", "ac30b6de-450e-49a1-a792-af3100e4e4be", "45aa3e85-42e5-4888-9be5-bf888c700da1"], "metadata": {"file_path": "phala-docs_dist/swanky-phala-cli-tool.md"}}, "129cdf80-ca1b-48f6-83bc-088bede33a02": {"node_ids": ["a40e26c4-7d5c-4f4a-b480-6722e7220980", "27515e30-e5e7-4bc3-9450-de5b7e6e445c", "fc9e69b0-5199-490b-8a2a-4ce2402902f2", "2693cc99-de21-49a8-b49a-aea3a3733676", "e2366d02-3fbd-4a5d-8c2f-e312c8acda19", "558e63f0-3196-4b15-a0ac-ebf0cf1ed094", "df2e76c4-968c-4294-851c-04a433cd5eef", "92e84378-47b3-4f6c-b98a-ee8e6c731f2a", "e22870bf-d107-4895-a9d8-88eabd1305fc", "8102ad44-b13e-4393-81cc-6081ff7e4bb1", "c5994994-6f76-4cf1-a2c7-50132960b2f4"], "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-langchain.md"}}, "1f1d8b79-659e-40bf-a944-ec935ac7ee6e": {"node_ids": ["099b92a5-a419-48b0-b7b7-581ae5afc52d"], "metadata": {"file_path": "phala-docs_dist/base-sepolia-testnet.md"}}, "9676009c-d28d-4be4-91dc-80d50ccbcd6d": {"node_ids": ["15c4e7dc-5025-4a70-b124-0989d7c488af", "7f63c05a-909d-4005-87d9-e32d7d6b4059", "70d23144-719e-4911-b080-efec2142b01b", "8af7b5ea-c380-46d1-ba69-750e46666ca0", "d4b20a6b-aca6-4c76-9468-ecc09ce8a291", "6f6d9f94-3e21-4772-817e-67256532bb0c", "1cd92497-2469-46c7-acb4-17ab91937017", "e5cdfb49-1780-485b-a5a1-498d6a0bd40a", "f630ecaf-afdf-41d6-bc3f-12299596db18", "5459378f-4a76-417f-a4c7-86cf1e595f06", "23edfb72-841d-459a-8d92-0e5d0d2960dd", "d379c656-97a0-4fcc-b684-ef1febbe9130", "5c4171f9-7173-4ebc-9493-b760a5a82490"], "metadata": {"file_path": "phala-docs_dist/build-an-agent-to-transact-onchain.md"}}, "6bef3dec-1708-4401-95b3-264644cf7b21": {"node_ids": ["916cedb9-59b7-4af5-a330-c3be641033fe", "036a404b-0157-4e7a-b19b-84e8af99393f", "beb3e9a2-6e48-4ac8-8ce0-ccdedd4beaa7", "2fadb61f-5412-46b7-a52f-ab009ab80dc7", "e7012b03-0f7a-4348-b6f5-c0fda88c531a", "32d723dd-658d-4d97-86c6-aaedef55abe0", "25f3601c-0e0e-470a-ae9b-ee7c4829d354", "15638d57-4af8-4ed9-9d50-a8759dfff94c", "18724a23-da86-41b9-8ef1-11c2aab37b8e", "6a160a87-441b-45a3-97d1-2182cc6ff195", "e4ea2dc6-9213-48c6-b0e0-2d7fa77a3c69", "bdcdda2d-ced1-419a-88cb-f1b05261ed33", "b9a09de8-305e-4adb-9bf1-51853322f1a4", "37d928c1-1a36-4090-9784-c7a165337c09", "c06b2168-0ccf-439d-9fb7-574f1847abf1", "45d60209-50a1-4fae-935e-2a098a3d8517"], "metadata": {"file_path": "phala-docs_dist/run-local-testnet.md"}}, "e23c6654-98ae-4eab-acc7-1a0823e295ab": {"node_ids": ["33f73c7f-2bbd-454a-854c-1318b0856064", "f2d423d2-0987-4134-a327-366b240a25c0"], "metadata": {"file_path": "phala-docs_dist/use-rust-crates.md"}}, "9eb32387-8c34-4936-b506-ebdfc3f1dfb0": {"node_ids": ["178db20b-053c-4519-b39b-9c4fa3014f38", "53f393bd-1c47-4c08-a83f-e13c03d6109c", "6d691917-8802-49ba-94a6-1ae8bf0b25ed", "55fd57db-43b5-4aca-84a1-7ebaac1acfc3", "11c44e8c-3fa0-4e3b-b727-cc1aa369bc0c"], "metadata": {"file_path": "phala-docs_dist/worker-confidence-level.md"}}, "d0012f5b-8adf-434f-8eb1-f08972054914": {"node_ids": ["e620f8e9-d3e8-4f83-a4b8-546261e4098e", "0eaa3233-bc6a-430c-a918-3b10d7fb81b8", "4cd99b9a-7f5b-4134-a176-77725d7899d4", "56e37b60-6292-4698-af8b-2f11704afefa"], "metadata": {"file_path": "phala-docs_dist/prb-worker-deployment.md"}}, "94a5a5fe-88df-480e-afd4-30c9e1bd5de2": {"node_ids": ["feda2f68-8811-4b6a-a3cd-387346f6be95"], "metadata": {"file_path": "phala-docs_dist/conclusion-and-future-developments.md"}}, "ee378d0f-bb3d-4b16-ae4c-93b45e111998": {"node_ids": ["357ceae7-47da-49b6-906b-a96a7182426d"], "metadata": {"file_path": "phala-docs_dist/connect-from-autonolas-plugin.md"}}, "2a150c0d-6900-49e4-be11-0129ad1ff0a9": {"node_ids": ["c9261018-525c-495e-8f9e-9a9541698ae9", "872e3569-1d77-4889-9fa4-2b32e95e612e"], "metadata": {"file_path": "phala-docs_dist/buy-and-sell-keys.md"}}, "a8d76ca1-7cee-420c-b994-cd523c7a05fe": {"node_ids": ["fa893b48-67cf-4d9a-bd40-fba8a3cf7a7a"], "metadata": {"file_path": "phala-docs_dist/supported-assets.md"}}, "04566d32-cfff-471f-8400-cfc01eca5e69": {"node_ids": ["73091678-575e-4d8f-bf61-299ff12bca45", "c1f5047f-e390-4e42-a521-2ee059e3406d"], "metadata": {"file_path": "phala-docs_dist/getting-started.md"}}, "632c9998-7894-4bf3-89c5-b795e9f34993": {"node_ids": ["f0ac1733-d9ca-4704-a1ba-f27a605b6c53", "1a8b7567-25e1-4ef3-8ded-37b9aa672b79"], "metadata": {"file_path": "phala-docs_dist/agent-war-tokenomics.md"}}, "375684a5-c302-432b-821b-1c22ffc7cfd1": {"node_ids": ["456c9d8c-eb09-4a48-bf73-05efc7b6abf1", "4c065d1f-7710-4af0-b820-5100c1b79dd7", "0295d9f2-2080-4ae7-8d3a-a3baebe10dfc"], "metadata": {"file_path": "phala-docs_dist/store-contract-states.md"}}, "9e8bb349-ce3f-40f4-8555-0c50643f84e2": {"node_ids": ["6b6bc4ed-bc89-4e60-991a-84f73de9a2df", "a89adc71-68b5-41c3-9763-142bf1f867b3", "6512d727-bbac-4f8b-aba0-2de85107b031", "b7cec1c0-c472-4c7a-be59-59dfdd354f74"], "metadata": {"file_path": "phala-docs_dist/builders-program.md"}}, "386be83e-e394-4b37-8896-fffe4d3efdee": {"node_ids": ["642f716b-a2e0-48ad-a49e-f049c9249237", "015f861f-e44d-4f18-b6da-37d1debba8c3", "18d442e2-a9ad-419f-a81f-f2479e073d04", "68f0d708-caa7-4ad6-a04c-44b6303ce570", "9304a8a2-7d60-4be8-b089-06b81d760198", "36b0483c-375f-4b56-992e-1d64eb94cfac", "c648f211-3ec2-4e11-b524-b1a375e10ac4", "08167894-b979-4a82-98e2-672db922885d", "0a48f20f-64cf-476c-9162-082e3e84b40a", "335cc0a4-1dab-4c59-85ec-dc9afa737f8d", "b1e2778b-2faa-429b-a509-4b4b71923e9f", "cde64662-2320-4143-9efd-22474a2c1e62", "0de1a9f7-da60-459c-8e59-e1972bf3a7e1", "8c7ceb60-904e-49f0-ba8c-f91bcc6a0c06", "a7044042-008f-4136-bf3a-b925e678cfb9", "3886631b-abbd-4f62-8e50-f93ba1aa6e33", "babd6db6-b439-4160-bff2-d53d09999ef7", "f1256d81-e25d-42c2-bc9b-9380a550d40d", "f5dabb94-d271-40a5-92bb-6a58190f6a30"], "metadata": {"file_path": "phala-docs_dist/integrate-with-3rd-party-api-with-http-request.md"}}, "58b44cce-15dc-40ac-ada6-24005530c5c8": {"node_ids": ["c70b0011-fe2c-4e52-9c7b-35e0836e0cd2"], "metadata": {"file_path": "phala-docs_dist/get-an-airstack-api-key.md"}}, "a12891ca-476d-493f-8a7b-39aa25f63b26": {"node_ids": ["41fc9d25-23af-401a-ba73-bb0e24151d9f"], "metadata": {"file_path": "phala-docs_dist/the-graph-agent.md"}}, "e78c2de3-af3e-4222-926a-2f3ec59396f3": {"node_ids": ["613c7c5a-babe-4a19-84a7-7b6f875eb751", "d27c1677-bb40-469d-9a02-31c931b9aee7", "13f7fdb5-cff1-4d3a-a4ed-ee9449408141"], "metadata": {"file_path": "phala-docs_dist/wallet-setup-and-get-pha.md"}}, "c5188efa-8d1d-4299-be98-73a17db82280": {"node_ids": ["0b48c105-4da3-4de5-b046-b7c78b0f65ab", "be4879b7-1fbc-41bf-b32d-62f82d48ae2b", "6b6867e3-d775-4a81-a6e8-3457c3032c84"], "metadata": {"file_path": "phala-docs_dist/unit-tests.md"}}, "da27b964-9989-4833-b81d-cf68385bb800": {"node_ids": ["6c3bd0bd-6d8e-4c59-af90-1dc98d039b17", "f045dc83-4886-4f44-9b62-87df081e343f", "67a31168-656f-461d-9c97-6e4cbeb0d2e2", "66d046c7-bc17-4a72-8008-b697db7eb8e9"], "metadata": {"file_path": "phala-docs_dist/delegate-to-stakepool.md"}}, "fc88b9d1-b571-4f78-b6c3-b47bb9a3c5fe": {"node_ids": ["e6191116-a7b4-48f3-834a-9f15ca8e5db9", "96640968-7d84-4eda-a8d0-48d1b801a5a6", "84bbd52a-546e-468a-a114-fe5e08161589", "b1d38547-fbd1-4fab-857d-4352579b77ed", "2f12add8-1fe9-4ee6-9c5b-69368efb4ecc"], "metadata": {"file_path": "phala-docs_dist/confidence-level-and-sgx-function.md"}}, "e7987774-37b5-41c0-b11d-e3dc713dd591": {"node_ids": ["87e2f789-1116-48c4-96ca-683b65938d71"], "metadata": {"file_path": "phala-docs_dist/ai-execution-layer.md"}}, "efedb385-51ac-4032-b428-5c22e7ebfccb": {"node_ids": ["135592b8-8c14-4e6f-993c-376bd36e8dcc", "95e2717c-503a-4844-abb6-52be382f8803", "3e28470f-1744-429d-8474-85fa5d779d1a", "5559da3c-4c4b-40d5-a5ee-a22039bba44b"], "metadata": {"file_path": "phala-docs_dist/use-phala-app-to-delegate.md"}}, "fd536039-a969-4e29-8034-3836af76e2b3": {"node_ids": ["f065052c-211c-46e3-86a5-d851c6673a7c", "b34141a2-263d-4be4-99ec-5a05bedf43c3", "60c446a5-8636-4a78-bc30-a0855ab678bc", "6321e8e6-92c6-4d1a-b2e2-49f245846fe2", "1d5f77cf-8005-43c7-b8a1-cc06cd256229", "74ae9d44-ba47-483a-8a27-4c8d234602c1", "21d18e35-8894-4bcb-9a43-dfa7220cb039", "8f531ec7-6726-480d-925a-93459d26d7d4", "cffc8e82-d713-443b-be88-3b379e3503f6", "f4b61da6-f5cb-4041-b410-c5b7b510cd93"], "metadata": {"file_path": "phala-docs_dist/SUMMARY.md"}}, "156d6ab7-38b0-42f9-bdb0-030ee1fa3afd": {"node_ids": ["0e53a53b-1f0b-4ba9-9318-3a72877bc374", "2b384deb-bf37-4a8f-a4a2-f0ab8c690e4a", "85d1d450-dbe3-49f9-b56d-8b27639e97eb", "689718a8-db50-43c3-9ab5-ed48a2024c4e", "17fde8c3-ce16-4c76-a1c8-2b1d88c6a35a"], "metadata": {"file_path": "phala-docs_dist/gatekeeper.md"}}, "4db4e53f-159d-4dff-9a73-6b02c77e59d2": {"node_ids": ["22ed22ba-fc0b-4406-a380-a47b25559a22", "832bf062-780f-48ae-ab60-581ec83c0719"], "metadata": {"file_path": "phala-docs_dist/configure-the-worker.md"}}, "6131f5e5-1d7c-4d4e-ae35-1f6da10024d7": {"node_ids": ["8f25fac2-7d5a-4e56-b3f2-d7e59cf35d36", "b771582f-ac20-4972-8b63-c881e595ee11", "17244134-8e12-4d19-b435-37207b96afbb", "6016ff9a-e83c-4797-924e-59d698e7cea6"], "metadata": {"file_path": "phala-docs_dist/how-to-build-with-multi-proof.md"}}, "30affdf8-fbc8-438a-863a-d986b424c71c": {"node_ids": ["7be02fb4-d224-4cdf-b15f-97f91cf1b43d", "c9220e96-80ba-4364-805f-09520e844a11"], "metadata": {"file_path": "phala-docs_dist/build-stateless-backend.md"}}, "b97982b0-8202-438f-b247-bdf5d1cb34d9": {"node_ids": ["7fd6da47-793d-43ec-9f96-fed1bf64b4fe"], "metadata": {"file_path": "phala-docs_dist/add-a-data-source.md"}}, "e1282358-cb68-401e-8f00-ab6537fd6204": {"node_ids": ["e672cf69-a405-4592-a932-fd5f2be558b7"], "metadata": {"file_path": "phala-docs_dist/how-to-switch-from-solo-mining-to-prb-mining.md"}}, "7098720b-ca69-490b-8851-0355d00e896c": {"node_ids": ["05f73831-d55b-4c8b-bc2b-13d6da9ddfa9", "15a16b5f-4b40-48cc-9900-0250b88c2511", "330ac0d4-f745-468c-8655-aee537e237d1", "de02a404-d2c2-4ee4-8bd7-6639ea804a0b", "85d67446-05ad-4796-ab6b-c20e26d2dc21", "de90e004-ff2f-418b-9671-8da5c6df48cb", "dc77b532-cc15-4e53-8df9-ea77bf7756a5", "f7561e66-02ca-4da4-a6c0-f384f9b6e0ea", "3b6545cb-5382-44be-9ca7-79f7e8891c00", "e5b91e2c-a46d-46b7-b0b4-cc25da7fb7f4", "625c9d0d-5cb8-445d-82c8-aceef61b9aac"], "metadata": {"file_path": "phala-docs_dist/build-your-first-ai-agent-contract.md"}}, "6b358d97-48fa-44f3-a70f-ce0afe5bdf22": {"node_ids": ["7149b8a3-c58f-4e06-9950-68c7d453ee40", "d8d88919-ef78-43ce-a359-86defc92ac7d", "046ef454-364c-47d1-8167-1b2a0e4d86a3", "b9ef0e73-16c3-48d7-852b-c32548d086c9", "1322fa93-421f-4a1e-bd69-8cdc92766708", "f1e106ec-3c26-411f-8f6c-f76106a4c0ec", "5fd5c905-bf55-4028-bed3-f7f320f2fb8b", "4b491e60-b4c6-4df6-b12f-11d975a42cd2", "dad99d03-32e9-4e37-8cab-bf8a261bf9fe", "b40aead8-9ba3-4102-9ec2-c0cd8f6ad294", "f2bba4e7-aa78-4708-97db-df939bf4dae3", "c81d3541-6ad3-4d61-9176-221576be2502", "d526427e-b1f2-4c67-a490-f29dbd566e4a", "61c3d22a-4923-4279-9237-2124eb161990", "490c035a-c582-48db-9d96-fdcb1b510602", "3fc2e8ac-7022-4be6-a8d9-25d0bf10a1a1", "452c45bb-5c70-4826-9549-b87a872325be", "525b6b39-c10a-4889-9e35-76fdf7d01f1c", "9a1a1281-b7cb-4cfe-9b7e-fdf85ea1383c", "f6a5fb76-a144-437f-a2ec-fe77bd899226", "765f5d0a-d3bb-4c34-82a5-6fafe361738b", "5de0a6e7-71f6-4ce3-89f9-06c33f3ad740", "c0ffb2cb-b729-40ca-8b71-852a77ccee38", "60d8db21-9157-4688-90ba-61ca1ea06022", "8526f99f-3bf7-49e3-8d54-67989d393fb8", "ff50379e-baa0-40fe-aed0-e60b17b899d4", "329f478a-0baf-400a-b390-38bcf4d2e611", "32ca947c-58ec-4a9f-a1cc-ed4f4b294f16", "18e1d441-c270-4186-84d6-8b9a8f84a225", "deb7c9f1-5c8f-4521-9f58-a10c05a16688"], "metadata": {"file_path": "phala-docs_dist/connect-the-graph-phat-contract-to-evm-consumer-contract.md"}}, "457f4450-af45-4315-a5ae-6132b1516166": {"node_ids": ["d154e78b-9763-4aa9-8eb3-0af6b556c6c1", "cc7d6f03-602b-4ee7-bc4b-20417c24cb89"], "metadata": {"file_path": "phala-docs_dist/phala-network.md"}}, "36b6c17a-7b40-451a-b619-a1d4cfe9fba4": {"node_ids": ["ca3fce4d-56dd-43ef-8b49-503b01f29315", "3feaa4c6-1e23-4a0c-9df4-ce75ab17a2fb"], "metadata": {"file_path": "phala-docs_dist/using-prbv3-ui.md"}}, "7209c06f-72f8-42c9-8d9e-80f68146862a": {"node_ids": ["0fc46bee-4d83-4d62-be47-97111726af69"], "metadata": {"file_path": "phala-docs_dist/token-gated-access.md"}}, "fa07fe36-2da4-4504-9464-1c4578676764": {"node_ids": ["bc28a4b4-53bb-420b-8d39-53fa81e180f1"], "metadata": {"file_path": "phala-docs_dist/airstack-agent.md"}}, "39bb7120-2ae2-4bd2-acf2-17669962abc2": {"node_ids": ["5d762a68-d8fa-46e6-bd2e-459692d7f32c", "ca0202e0-57e6-4858-a28f-fd7d2c8c42ec", "710f3060-0d74-4fbc-8f9b-114dd4486236", "b26b2cf8-39da-4a82-a4c8-7e99d1a6d232"], "metadata": {"file_path": "phala-docs_dist/troubleshooting.md"}}, "063335c8-e881-45cb-8e4f-3991603da90d": {"node_ids": ["917b662a-4b10-46fc-9d92-9931ad8e016d", "227aea20-0ed4-488e-b0fa-8999ccc4b22c"], "metadata": {"file_path": "phala-docs_dist/rent-hardware.md"}}, "e614e01a-2b10-470f-99fd-186db26545c1": {"node_ids": ["5eef2db4-c43b-4be2-b567-e6213a7ea6a3"], "metadata": {"file_path": "phala-docs_dist/publish-agent-script.md"}}, "e5b44697-e508-4ed7-867c-ac90455e7e20": {"node_ids": ["d6083096-5cdb-427b-b379-d329c8a2cace", "f263413e-0d60-4341-8146-bbee4acd18b4"], "metadata": {"file_path": "phala-docs_dist/migration-from-prbv2-to-v3.md"}}, "b0cf9fd8-85af-49c5-93ad-d34e816ba45b": {"node_ids": ["7dde3b5c-3b95-4202-8c15-e1989fab1f69"], "metadata": {"file_path": "phala-docs_dist/headers-cache-deployment.md"}}, "969f6e90-aae7-4103-909d-6c883a2558d3": {"node_ids": ["b17b28ec-0fba-40e3-948d-cb51077d9d1f", "3ff0b9d9-f2e3-4c33-b40d-aecb3b386fde", "a914a65f-5c9d-466e-aa7c-d58618339303", "01813b4c-204d-4b3c-8a12-b2f8dbb72a37", "c63d5025-44fd-4865-b345-79e9e22034b0", "6fdefd24-6033-455b-b112-c098d0354fef"], "metadata": {"file_path": "phala-docs_dist/faq.md"}}, "d7324c50-a9ba-4244-a962-c7b656ebcfa0": {"node_ids": ["d9a92c69-d82b-45bb-9ea4-4c8aea70d3ee", "89742653-4819-4895-9ffe-d2cbda24bce2", "ad83ec56-2f1d-44e1-9070-d73398aea038", "2d7b1c07-6c51-4f4c-a1a1-80c0cb683d76", "669593ac-543c-460d-8570-1fabe9ccdf15", "9b2e6a66-847d-4b49-b014-346d331cdc9f"], "metadata": {"file_path": "phala-docs_dist/deploy-contract.md"}}, "d762892b-4abe-4326-a7b0-45195c3f29da": {"node_ids": ["0e04eae7-9b40-46f8-b9fc-f6cb8bc807f3"], "metadata": {"file_path": "phala-docs_dist/requirements-in-phala-khala.md"}}, "bc11d025-9d3b-4a7d-a5d2-da13e7627ea6": {"node_ids": ["bed71e4d-414b-4d28-8226-499b283529aa", "c6047017-5967-4854-9738-bc6e3f5d2635"], "metadata": {"file_path": "phala-docs_dist/environment-setup.md"}}, "ad4e9ae2-6b2b-42a4-ad8a-6730fb0b2a63": {"node_ids": ["05ea17cd-c7b3-4b48-a392-dbbd4c1f37a3"], "metadata": {"file_path": "phala-docs_dist/accelerate-khala-syncing.md"}}, "52136ccc-ff23-4b51-875e-73cef967ddf8": {"node_ids": ["21c36f7d-aaa1-406b-bf6d-3658c961daf8", "4b7e23d3-5c95-4493-8850-ca9d46439f04", "f332cbbf-531a-4d49-b3ae-c76c993a57e0"], "metadata": {"file_path": "phala-docs_dist/transaction-costs.md"}}, "bd0a1782-7211-49e3-9839-fe9f213e28b0": {"node_ids": ["4a8b4a96-baf2-4d78-8f58-cd307946cdb9"], "metadata": {"file_path": "phala-docs_dist/connect-to-smart-contracts.md"}}, "984da713-f6c8-48c4-9ded-94d7de7575ac": {"node_ids": ["bb0d4c4a-abed-4a76-8ce5-6615af66b8ee", "b85d2ea6-ee98-4435-8a11-89adbaa77d13"], "metadata": {"file_path": "phala-docs_dist/endpoints.md"}}, "d32f3e9d-fcf1-471b-bc3b-31dbd9078a1b": {"node_ids": ["8b8731d9-033f-4ab1-8d96-c483294182c1"], "metadata": {"file_path": "phala-docs_dist/examples-of-delegation.md"}}, "a4d837e7-b28c-45e4-850b-76d68eef214e": {"node_ids": ["ba3c7d1f-c384-422c-83c9-f302e40205d4", "0a95b98f-45a5-46fa-8c27-7f34dbe440aa", "b1dcf4c5-e23f-48e3-baec-6c89ceebd03a", "c13b642b-2ef7-427e-9d79-804bcaaa45ad", "a5d18479-6515-40f8-8c94-262162b3a601", "f896687b-f7c9-452e-9577-6c2072214340", "85498229-252a-4393-9c71-4d5cac0d43ea"], "metadata": {"file_path": "phala-docs_dist/staking-mechanism.md"}}, "837dd890-373d-4fee-b6a7-3f7de4527571": {"node_ids": ["0e8ae87e-80fd-4c4e-aa96-4a031035b0c9"], "metadata": {"file_path": "phala-docs_dist/agent-wars-introduction.md"}}, "278a1202-cd20-42aa-b45b-777874488bc1": {"node_ids": ["736e9ce6-a6d7-453b-9576-10aea608b936", "b52eb525-a592-45f5-bbce-25e35e6d14df", "72eabe6c-083a-49c1-8bfa-1a98beb4e4e7", "f823ccac-6dff-4fc4-a0e0-a48ca9f743eb", "684cd40a-9548-4789-8de0-581f0e65cab9", "4240add0-1034-47f7-91d4-67ec04ffa382", "7caab142-8bc7-47a1-b53c-c4ffeca4ea40", "22206664-efdb-4e8a-862c-c39e89de4665", "7fcc454c-04f3-4f14-b1ec-8ddc8d76e30b", "a7f9b6a4-b7bc-4bc6-97f9-171f8866ea61"], "metadata": {"file_path": "phala-docs_dist/deployment-guide-for-prbv2.md"}}, "18c9d3c4-a0b3-45bc-8e0d-81085c6843cb": {"node_ids": ["3a0842b3-94ed-4da7-9f4d-889227615630"], "metadata": {"file_path": "phala-docs_dist/phala-sdk.md"}}, "7bdd8b10-de82-4843-a571-5f3553eb148c": {"node_ids": ["4bcee946-88f7-4161-8a2f-029fd8868d73", "0ec8fbd9-1c13-4d6d-aa09-1bd4bbf17975"], "metadata": {"file_path": "phala-docs_dist/cross-chain-transfer.md"}}, "613009ac-d31e-4ecc-b9a7-6ea825c34b90": {"node_ids": ["88eef3d5-a57c-4ace-8525-44249484076a"], "metadata": {"file_path": "phala-docs_dist/block-explorers.md"}}, "1beae184-b472-46df-bdef-874fab8d1ed7": {"node_ids": ["6db322f9-04a0-4e7f-beb9-b826c19216f7", "365ce463-2426-4930-95c3-add3a5c9ca45", "abe74e04-3488-40f7-83fb-a2cc9cbf0bf9"], "metadata": {"file_path": "phala-docs_dist/phat-contract-console.md"}}, "8b1c7989-d84d-493d-906b-474194050eab": {"node_ids": ["541a7f8c-00b8-4093-b919-1e189f0ba50c", "80dad35a-05f5-4b6a-b42d-0b41724f537b", "2ea43607-7507-4c0f-a044-d33f0777eb75", "4b3ffcaa-1772-48d5-a5cb-29e94194a95d", "834d8d01-e615-48b0-a3f7-2cac164d1526", "7dcd6756-f417-4593-85d3-be25359c539f", "a8ca7ec7-43fb-4ebf-ae57-b3cbf4376d9c", "a8813c47-f01b-45d7-a64c-d9b0562d2526", "975ab6de-556e-451a-ac89-3ccd9eb2d1d6", "5ee85879-b6ea-4138-8846-93eb15568d3f", "5e7f6628-b561-44fa-9aa4-4d2b7f61d913", "0c295f77-b4ec-405b-92f0-0446e5bcaa94"], "metadata": {"file_path": "phala-docs_dist/build-your-ai-agent-contract-with-openai.md"}}, "14512d84-58d1-453d-8d58-f4d886bd5d6a": {"node_ids": ["db2c12ee-1234-4111-af73-874dc3b2c5fc", "0b505679-35bd-4c59-b287-8c45313750b4", "ae4e4e03-d9d5-4896-a2d4-bbaa8625b9e3", "7f02dc89-cffa-404e-8916-a8bc76656a9e", "3ca07eed-4e8a-494a-be10-705575a9102f", "46d11022-960c-48a8-ada4-c96acb7d06c5", "885dffe0-10c0-44ea-9b58-6a4653c08bcc"], "metadata": {"file_path": "phala-docs_dist/ethglobal-hackathon-guide.md"}}, "da50815e-56ad-4295-a8ba-d5a2e65c40c4": {"node_ids": ["b8d7b554-f1ea-4575-8673-af2a9fda93e6"], "metadata": {"file_path": "phala-docs_dist/astar-zkatana-testnet.md"}}, "fe5ee9b6-2ac9-405d-a534-237a8623f7e2": {"node_ids": ["1c0e04b6-12de-407b-805a-5cfa5d2b7868"], "metadata": {"file_path": "phala-docs_dist/resource-limits.md"}}, "82d9d1c1-283b-4a67-b164-b46353bea26f": {"node_ids": ["70659892-d446-4e89-9f7e-181b0f002cd5", "2535effc-ea57-4a42-991f-9131f85569bf"], "metadata": {"file_path": "phala-docs_dist/secret-key-hierarchy.md"}}, "eb9b8b9c-b739-4f46-b00d-59800fd42358": {"node_ids": ["54be4629-3578-4da7-ab3d-283b1adebb61", "77036cc3-ca61-471b-a045-a6af13206079", "8f7ac2bd-0bf4-42a9-b2ce-a210a011d302", "32dd3b43-4d68-4be9-a094-8a4ded87d3e7", "0ad18cf6-443d-47bf-af4b-233a856f9728", "5a309476-6af7-4bc9-8d96-7ec84bcce71f", "659e10e3-acd5-4fb0-a30b-7d30655ceff7", "ab51cbd4-0db8-4992-99a5-74913269ae0c", "c34958e3-7d04-45f2-becd-529abf0f56c9", "413727c3-c882-48ba-81f7-aa0aec274a23", "da1896ac-5b9e-4d94-9d67-3e0544a55bda", "68b393ce-7f7a-4269-8932-f5a8e29e4e1a", "61542b5b-3004-4dc1-843b-11850bde8092", "3f9e41b3-ca89-4380-9d3f-87c2bb104b58", "ba1c9f78-5791-4953-8a66-ad9c3f77b66e", "5e0d8a01-bd3c-4dd6-8426-b72148bd0a98", "37b04196-a9fb-43c5-ba44-844ba241bfa9", "b79072c6-7276-49f8-a8fb-67ce3e764a70", "ead8c586-71e2-4521-8ab7-8c7188218602"], "metadata": {"file_path": "phala-docs_dist/create-a-weather-agent-w-function-calling.md"}}, "5ae3e0cc-340d-4dd9-ab13-15c2cf2c99cf": {"node_ids": ["8ee1f65b-b659-4e24-86b4-8f53d246ff8a"], "metadata": {"file_path": "phala-docs_dist/create-and-play-with-social-agents.md"}}, "c454bb15-bb46-4763-b920-358d7465abde": {"node_ids": ["26b63057-ab2d-49b6-9cdf-37995c286bee", "eeb0ce69-dd45-429b-8ef8-16847940f059"], "metadata": {"file_path": "phala-docs_dist/call-your-contract.md"}}, "12ba18ad-2b64-404b-8274-bb26fb834b59": {"node_ids": ["66011b89-b820-44c7-bd9c-c7d944c0a51c"], "metadata": {"file_path": "phala-docs_dist/cluster-of-workers.md"}}, "d3b4286e-4c44-4314-a433-7357a497ee83": {"node_ids": ["623c50a6-61af-4a63-baf1-f4d27f2c513f"], "metadata": {"file_path": "phala-docs_dist/cross-chain-solutions.md"}}, "01f7946b-001a-444e-b363-18176de71645": {"node_ids": ["d68c200d-0822-463f-ba5b-00101110a1c4", "5f0c767c-4bb4-4cb2-aa5f-589d2634a0d0"], "metadata": {"file_path": "phala-docs_dist/create-contract.md"}}, "eca0c7e0-8783-4a72-8f2a-ae125d3ca884": {"node_ids": ["487fe872-80ab-4dcc-abed-2da490888c14", "51429796-daf7-41b5-b8b5-76e961bf75e4", "b40da088-bf8f-45b5-90ab-7ee5f8f5827b"], "metadata": {"file_path": "phala-docs_dist/ai-agent-contract-templates.md"}}, "77355499-01e7-4164-8a0c-530784643823": {"node_ids": ["390e6d88-19dd-48fc-9e6d-db10311681e5", "69441acb-5d8e-49ad-84af-34a9aded7e12", "a9288e9b-a380-4e60-bbf8-2b0097949d4b", "76622f7a-340e-4409-8a28-4e0a6e84778a", "b9223cf8-b893-4096-a81a-ad92cc446700", "a05ecddb-844f-410f-865a-b728fbba1550", "3cfaaf27-053d-45a4-b160-02ea40a4c47e", "6c1bf2d1-42ef-4d59-ba95-119a311c0ae0", "ac50a72b-0936-4e13-84c2-29244674951f", "d3b79b84-e793-4949-b9c7-dfbb3948c0ef", "c3b8fa4d-32b1-42d5-947f-ed8625f3df50", "7205d61c-f208-45d2-ada2-3ea1cf25386c", "de5ec8d3-0e75-4375-9774-e3f59ec6fccc", "4841af32-7cc8-4f3f-9e1f-5c1326e2ea6e", "aa8a93a5-38c7-4a76-8df1-1a56881332de", "d35d118a-642a-453c-87a3-33c3a6c6ec43", "446f8dea-11f2-4583-81cb-fa1bcb1f8f73", "f3268763-0f70-4d52-8f62-00204930199a", "de12e360-105a-480c-9d2f-f0173242858f", "e3ed512a-d7bc-4015-a903-cecedcae0192", "f5512b69-ea7e-42b6-98ee-339c96e549f0", "f8c63016-4928-4fba-acee-86cf616cf46c", "00b1725f-1a81-4c47-91dd-7ee904532395", "9ec50dfa-778f-4e3d-bf66-dab35e669b81", "5afd871a-5d06-4734-8bad-e4ae0b5dfc05", "fb0070de-07f0-418f-8df6-b6ee96828600", "bbbce49c-0d14-4160-8d18-270da82bc56d", "a950c5e0-a565-40bf-b424-4d3001cd3a4c"], "metadata": {"file_path": "phala-docs_dist/polygon-consumer-contract-for-lensapi-oracle.md"}}, "88a122d4-8580-4e00-9d8b-e306763112b8": {"node_ids": ["5c5a9428-3294-47bd-8fa5-44445d0a4c67", "66eb5adb-4cb9-4df1-95ee-167056c89232", "5f8a2106-757d-47de-b4c8-d9d0ad6254b0", "759072fa-af3c-474e-92f5-ca8516dfdb2c", "b13cf6f8-8867-49d5-95ec-382c88535965"], "metadata": {"file_path": "phala-docs_dist/budget-balancer.md"}}, "398085c0-bdd5-4da2-8dca-95d7c720913a": {"node_ids": ["231cf6d7-c3af-4689-b581-e5c5d834f8cf", "bc2b173d-892d-46a0-a99f-b435ce782cac", "ea048e53-10ce-446c-aece-2529b5755db2", "f3875881-bbea-4662-b4a5-58b2dd327616", "17e31bad-d21f-4567-bb50-20bd515e0428", "e686a7ed-b348-488e-b9ce-02ff39db2835", "1970d802-a9d6-4448-9640-406eff126faa", "08abb08a-7f77-4787-9997-9f4e4e62513a", "ea586b2f-cab5-4415-a4ee-e5b0099dbbe3", "338a1091-3f9b-4cbd-997b-9dfea726df55", "1a72ae8c-0ada-4451-8775-71f383ec24aa", "e59bd846-f141-4ec3-b8ba-ae50cdceda80", "bb9784a8-4820-4b69-9538-aba4f49c041e", "159f9555-17a7-45e5-ac71-bc5e193e7442", "ad4f8907-8b38-4622-86cf-1e095c4e01c2", "621535c9-45ed-495c-aeaa-e7d7e3089bcc", "9b6457a7-38a7-4461-bf22-714570121e59", "cfe3edbd-7ece-44b4-b7a5-74907957c301", "c5a91ff1-af00-49ed-9a4e-54ab705a20d9", "d9c54045-f382-47cf-89aa-ad0f4622a304", "c50812fa-071a-4787-8b1e-3838f3ef3411", "a0138f90-3a0d-4175-ae0f-00edab1ec349", "fb6e7509-012d-48eb-b1ef-9f07a038cf58", "3924e58a-1367-4579-87da-d266de7bce22", "661e43f0-273d-477f-a877-de4b1b4f1a60", "a3ebc994-3eb7-4868-8e0a-92c0216e62cc", "21671291-8359-4b01-be9d-f3c7fb9fad10", "df02491a-dd61-4da3-a1c9-60a375bc1669", "1f2d5568-441e-4be5-b86d-bdc6bf79d927"], "metadata": {"file_path": "phala-docs_dist/customizing-your-phat-contract.md"}}, "f69a4042-cc29-416f-a18b-1c16470427db": {"node_ids": ["ce9838c4-b01b-4ab7-a28d-966a6baee57b", "ddbc1ae9-2121-4286-93ec-112ce731dc14", "30ecf36b-5153-4eb1-9713-ba7f720f3759", "f49d18ad-f848-4689-8013-9b8af9b1c0f2", "a18dbfe8-2ee2-414e-b6ef-6b50f84ca0b3", "7c7438bd-f6c6-426e-9dbd-e023092859d0", "656f6b3d-ecbb-4021-9181-baf828f096e4", "46f36d43-ad4a-400c-a2b2-4fcac120e5a6", "fd6d06aa-9464-4bdf-aecf-fdd659c3fba5", "b9233951-7fb8-4bd9-96b9-1ceafdaa951e", "eba9387a-deed-4725-8463-0d312cb899da"], "metadata": {"file_path": "phala-docs_dist/governance-mechanism.md"}}, "eea0255c-244d-4afe-8aff-a6da2fbcb193": {"node_ids": ["4b412cc4-6143-4f0a-ae61-78817c73fbe1"], "metadata": {"file_path": "phala-docs_dist/how-mirrored-price-feeds-work.md"}}, "4741a496-f709-4f91-a32b-b5be79e9d70c": {"node_ids": ["4aca5d8d-2737-4695-8e90-fcd3da7b7e00"], "metadata": {"file_path": "phala-docs_dist/phala-agent-gateway.md"}}, "64788d25-398a-4de0-a87b-bc8a44364a36": {"node_ids": ["857f7064-c693-41c6-98df-41eb13fcc493", "320a208f-3d96-46c5-93b9-a03e5f088328"], "metadata": {"file_path": "phala-docs_dist/get-pha-and-transfer.md"}}, "a38b05ca-bb2b-48c1-8e4b-efacd0326334": {"node_ids": ["2e74da85-e58f-405b-8c77-66d176f820af"], "metadata": {"file_path": "phala-docs_dist/use-pink-extension.md"}}, "fb17f80e-bb9b-4278-811e-5bf63ff7ea5f": {"node_ids": ["46f6040e-650f-4a59-85fc-172911ef93b5"], "metadata": {"file_path": "phala-docs_dist/update-your-workers-node.md"}}, "36b6256c-a79a-47a5-9c5e-3ed62ef954a1": {"node_ids": ["ea542a50-86c8-4f74-84f7-b1ba25502055", "ec181a28-cd67-4266-92da-5de2f61dbac6"], "metadata": {"file_path": "phala-docs_dist/whats-share.md"}}, "505f830c-3cc9-4fe4-8b3a-ec184bc0aaae": {"node_ids": ["d5ef7692-7ed0-4002-b39e-5f37cc0b8e9b"], "metadata": {"file_path": "phala-docs_dist/supported-chains.md"}}, "6c223ce4-62df-4f80-8dab-f88ebbc179c2": {"node_ids": ["9124bb8e-1069-4f1e-8fbf-02dd25f9963c", "693e7439-3e6e-4d27-b05e-8c8d2cb7dad9", "65d85a16-25b8-472b-a89e-d07c51062250", "90a02b35-b256-46d5-8d9d-c792a2d119f9", "8944e966-4884-4e58-a394-59595de8ec5f", "d2bd4212-cc14-4060-9d95-ed2cc415464b", "747a67a5-2630-4f12-931e-b12916a408e4", "a36eb363-e29f-4cea-a6e7-c7a0db4fc946"], "metadata": {"file_path": "phala-docs_dist/worker-rewards.md"}}, "a8192d72-d0d6-4b8e-b76b-d2e6b6cae954": {"node_ids": ["a55ebdf2-d7de-4568-bc70-17b11ecf3b15", "ef5b72e5-14fb-4e64-8e88-c912299779e2"], "metadata": {"file_path": "phala-docs_dist/apply-for-project-funding.md"}}}}